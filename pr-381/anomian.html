
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="The Anoma specs is a collection of documents that describe the architecture, design, and implementation of the Anoma Network." name="description"/>
<meta content="Anoma Foundation" name="author"/>
<link href="https://specs.anoma.net/pr-381/anomian.juvix.html" rel="canonical"/>
<link href="arch/integrations/adapters/evm.html" rel="prev"/>
<link href="tutorial/principles_and_guidelines.html" rel="next"/>
<link href="assets/logo.svg" rel="icon"/>
<meta content="mkdocs-1.6.1, mkdocs-material-9.6.12+insiders-4.53.16" name="generator"/>
<title>Anomian - Anoma specs</title>
<link href="assets/stylesheets/main.ff49f96f.min.css" rel="stylesheet"/>
<link href="assets/stylesheets/palette.ab4e12ef.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Inter";--md-code-font:"JetBrains Mono"}</style>
<link href="assets/css/juvix-material-style.css" rel="stylesheet"/>
<link href="assets/css/juvix-highlighting.css" rel="stylesheet"/>
<link href="assets/css/juvix_codeblock_footer.css" rel="stylesheet"/>
<link href="assets/css/latte-light.css" rel="stylesheet"/>
<link href="assets/css/extra.css" rel="stylesheet"/>
<script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
<meta content="website" property="og:type">
<meta content="Anomian - Anoma specs" property="og:title">
<meta content="The Anoma specs is a collection of documents that describe the architecture, design, and implementation of the Anoma Network." property="og:description">
<meta content="https://specs.anoma.net/pr-381/assets/images/social/anomian.png" property="og:image">
<meta content="image/png" property="og:image:type">
<meta content="1200" property="og:image:width"/>
<meta content="630" property="og:image:height"/>
<meta content="https://specs.anoma.net/pr-381/anomian.juvix.html" property="og:url"/>
<meta content="summary_large_image" property="twitter:card"/>
<meta content="Anomian - Anoma specs" property="twitter:title"/>
<meta content="The Anoma specs is a collection of documents that describe the architecture, design, and implementation of the Anoma Network." property="twitter:description"/>
<meta content="https://specs.anoma.net/pr-381/assets/images/social/anomian.png" property="twitter:image"/>
<link href="assets/stylesheets/glightbox.min.css" rel="stylesheet"><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="assets/javascripts/glightbox.min.js"></script></link></meta></meta></meta></meta></meta></head>
<body data-md-color-accent="indigo" data-md-color-primary="white" data-md-color-scheme="default" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#anomian">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
<aside class="md-banner">
<div class="md-banner__inner md-grid md-typeset">
<button aria-label="Don't show this again" class="md-banner__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
</button>
            
            
  For updates follow <strong>@anoma</strong> on
  <a href="https://x.com/anoma" rel="me">
<span class="twemoji x-twitter">
<svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8l164.9-188.5L26.8 48h145.6l100.5 132.9zm-24.8 373.8h39.1L151.1 88h-42z"></path></svg>
</span>
<strong></strong>
</a>
  and discuss on our
  <a href="https://research.anoma.net">
<span class="twemoji discourse">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M225.9 32C103.3 32 0 130.5 0 252.1 0 256 .1 480 .1 480l225.8-.2c122.7 0 222.1-102.3 222.1-223.9S348.6 32 225.9 32M224 384c-19.4 0-37.9-4.3-54.4-12.1L88.5 392l22.9-75c-9.8-18.1-15.4-38.9-15.4-61 0-70.7 57.3-128 128-128s128 57.3 128 128-57.3 128-128 128"></path></svg>
</span>
<strong>forum</strong>
</a>
</div>
<script>var el=document.querySelector("[data-md-component=announce]");if(el){var content=el.querySelector(".md-typeset");__md_hash(content.innerHTML)===__md_get("__announce")&&(el.hidden=!0)}</script>
</aside>
</div>
<header class="md-header md-header--shadow" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="Anoma specs" class="md-header__button md-logo" data-md-component="logo" href="index.html" title="Anoma specs">
<img alt="logo" src="assets/logo.svg"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
<span class="first-letter">A</span>noma 
              
                <span class="first-letter">s</span>pecs
              
              
                <span class="md-header__topic-version">(PR381 - fix/snake-case-filenames-hook-8c27d9e1)</span>
</span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
              
                Anomian
              
            </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Switch to light mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme)" data-md-color-primary="white" data-md-color-scheme="default" id="__palette_0" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to light mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"></path></svg>
</label>
<input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="red" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="white" data-md-color-scheme="default" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_2" hidden="" title="Switch to dark mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
</label>
<input aria-label="Switch to system preference" class="md-option" data-md-color-accent="red" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="black" data-md-color-scheme="slate" id="__palette_2" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_0" hidden="" title="Switch to system preference">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
</label>
</form>
<script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M10.68 11.74a6 6 0 0 1-7.922-8.982 6 6 0 0 1 8.982 7.922l3.04 3.04a.749.749 0 0 1-.326 1.275.75.75 0 0 1-.734-.215ZM11.5 7a4.499 4.499 0 1 0-8.997 0A4.499 4.499 0 0 0 11.5 7"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M10.68 11.74a6 6 0 0 1-7.922-8.982 6 6 0 0 1 8.982 7.922l3.04 3.04a.749.749 0 0 1-.326 1.275.75.75 0 0 1-.734-.215ZM11.5 7a4.499 4.499 0 1 0-8.997 0A4.499 4.499 0 0 0 11.5 7"></path></svg>
<svg viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M7.78 12.53a.75.75 0 0 1-1.06 0L2.47 8.28a.75.75 0 0 1 0-1.06l4.25-4.25a.75.75 0 0 1 1.042.018.75.75 0 0 1 .018 1.042L4.81 7h7.44a.75.75 0 0 1 0 1.5H4.81l2.97 2.97a.75.75 0 0 1 0 1.06"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
</button>
</nav>
<div class="md-search__suggest" data-md-component="search-suggest"></div>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="" tabindex="0">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/anoma/nspec" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg>
</div>
<div class="md-source__repository">
    anoma/nspec
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<!--
  This is a modified version of the original mkdocs-material theme.
  Copyright (c) 2016-2025 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->
<!-- Determine classes -->
<!-- Navigation -->
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<!-- Site title -->
<label class="md-nav__title" for="__drawer">
<a aria-label="Anoma specs" class="md-nav__button md-logo" data-md-component="logo" href="index.html" title="Anoma specs">
<img alt="logo" src="assets/logo.svg"/>
</a>
    Anoma specs
  </label>
<!-- List of Versions -->
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="https://specs.anoma.net/latest" target="_blank">
     Latest version ((PR381 - fix/snake-case-filenames-hook-8c27d9e1))
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="https://specs.anoma.net/main">
        Development version
      </a>
</li>
</ul>
<!-- Navigation list -->
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="index.html">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"></path></svg>
<span class="md-ellipsis">
    
  
    Home
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="arch/overview.html">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M24 18.714v4.8c0 .288-.192.48-.48.48h-4.8c-.288 0-.48-.192-.48-.48v-4.8c0-.288.192-.48.48-.48h1.92v-1.92h-8.16v1.92h1.92c.288 0 .48.192.48.48v4.8c0 .288-.192.48-.48.48H9.6c-.288 0-.48-.192-.48-.48v-4.8c0-.288.192-.48.48-.48h1.92v-1.92H3.36v1.92h1.92c.288 0 .48.192.48.48v4.8c0 .288-.192.48-.48.48H.48c-.288 0-.48-.192-.48-.48v-4.8c0-.288.192-.48.48-.48H2.4v-2.4c0-.288.192-.48.48-.48h8.64v-1.44h.96v1.44h8.64c.288 0 .48.192.48.48v2.4h1.92c.288 0 .48.192.48.48m-13.92 4.32h3.84v-3.84h-3.84zm-9.12 0H4.8v-3.84H.96Zm18.24 0h3.84v-3.84H19.2ZM6.24 9.642V3.546c0-.192.096-.336.24-.432L11.76.042a.8.8 0 0 1 .48 0l5.28 3.072c.144.096.24.24.24.432v6.096c0 .144-.096.288-.24.384l-5.28 3.072q-.096.048-.24.048t-.24-.048l-5.28-3.072c-.144-.096-.24-.24-.24-.384m10.56-.288V4.362l-4.32 2.496v4.992zm-9.6 0 4.32 2.496V6.858L7.2 4.362Zm.48-5.808L12 5.994l4.32-2.448L12 1.05Z"></path></svg>
<span class="md-ellipsis">
    
  
    Anoma architecture
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="changelog.html">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 21.5c-1.35-.85-3.8-1.5-5.5-1.5-1.65 0-3.35.3-4.75 1.05-.1.05-.15.05-.25.05-.25 0-.5-.25-.5-.5V6c.6-.45 1.25-.75 2-1 1.11-.35 2.33-.5 3.5-.5 1.95 0 4.05.4 5.5 1.5 1.45-1.1 3.55-1.5 5.5-1.5 1.17 0 2.39.15 3.5.5.75.25 1.4.55 2 1v14.6c0 .25-.25.5-.5.5-.1 0-.15 0-.25-.05-1.4-.75-3.1-1.05-4.75-1.05-1.7 0-4.15.65-5.5 1.5M12 8v11.5c1.35-.85 3.8-1.5 5.5-1.5 1.2 0 2.4.15 3.5.5V7c-1.1-.35-2.3-.5-3.5-.5-1.7 0-4.15.65-5.5 1.5m1 3.5c1.11-.68 2.6-1 4.5-1 .91 0 1.76.09 2.5.28V9.23c-.87-.15-1.71-.23-2.5-.23q-2.655 0-4.5.84zm4.5.17c-1.71 0-3.21.26-4.5.79v1.69c1.11-.65 2.6-.99 4.5-.99 1.04 0 1.88.08 2.5.24v-1.5c-.87-.16-1.71-.23-2.5-.23m2.5 2.9c-.87-.16-1.71-.24-2.5-.24-1.83 0-3.33.27-4.5.8v1.69c1.11-.66 2.6-.99 4.5-.99 1.04 0 1.88.08 2.5.24z"></path></svg>
<span class="md-ellipsis">
    
  
    Changelog
  

    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
<span class="md-ellipsis">
    
  
    Indexes
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
            
  
    Indexes
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="indexes/tags.html">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M5.5 7A1.5 1.5 0 0 1 4 5.5 1.5 1.5 0 0 1 5.5 4 1.5 1.5 0 0 1 7 5.5 1.5 1.5 0 0 1 5.5 7m15.91 4.58-9-9C12.05 2.22 11.55 2 11 2H4c-1.11 0-2 .89-2 2v7c0 .55.22 1.05.59 1.41l8.99 9c.37.36.87.59 1.42.59s1.05-.23 1.41-.59l7-7c.37-.36.59-.86.59-1.41 0-.56-.23-1.06-.59-1.42"></path></svg>
<span class="md-ellipsis">
    
  
    List of tags
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="indexes/modules.html">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 10h-2V8h2m0 5h-2v-2h2m-3-1h-2V8h2m0 5h-2v-2h2m0 6H8v-2h8m-9-5H5V8h2m0 5H5v-2h2m1 0h2v2H8m0-5h2v2H8m3 1h2v2h-2m0-5h2v2h-2m9-5H4c-1.11 0-2 .89-2 2v10a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2"></path></svg>
<span class="md-ellipsis">
    
  
    List of modules
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="prelude.html">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M6 2a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6zm0 2h7v5h5v11H6zm2 8v2h8v-2zm0 4v2h5v-2z"></path></svg>
<span class="md-ellipsis">
    
  
    List of basic types
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
<span class="md-ellipsis">
    
  
    Node architecture
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_5_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_5">
<span class="md-nav__icon md-icon"></span>
            
  
    Node architecture
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="arch/node/concepts/engine.html">
<span class="md-ellipsis">
    
  
    Concepts
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="arch/node/types/anoma_message.html">
<span class="md-ellipsis">
    
  
    Types
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="arch/node/subsystems/hardware.html">
<span class="md-ellipsis">
    
  
    Subsystems
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
<span class="md-ellipsis">
    
  
    System architecture
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_6_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_6">
<span class="md-nav__icon md-icon"></span>
            
  
    System architecture
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="arch/system/identity/identity.html">
<span class="md-ellipsis">
    
  
    Identity Architecture
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="arch/system/state/resource_machine/index.html">
<span class="md-ellipsis">
    
  
    State Architecture
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_7" type="checkbox"/>
<label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="">
<span class="md-ellipsis">
    
  
    Integrations
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_7_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_7">
<span class="md-nav__icon md-icon"></span>
            
  
    Integrations
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="arch/integrations/adapters/index.html">
<span class="md-ellipsis">
    
  
    Protocol Adapters
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_8" type="checkbox"/>
<label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="">
<span class="md-ellipsis">
    
  
    Tutorials
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_8_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_8">
<span class="md-nav__icon md-icon"></span>
            
  
    Tutorials
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 3C6.5 3 2 6.6 2 11c0 2.1 1 4.1 2.8 5.5 0 .6-.4 2.2-2.8 4.5 0 0 3.5 0 6.5-2.5 1.1.3 2.3.5 3.5.5 5.5 0 10-3.6 10-8s-4.5-8-10-8m1 12h-2v-2h2zm1.8-5c-.3.4-.7.6-1.1.8-.3.2-.4.3-.5.5-.2.2-.2.4-.2.7h-2c0-.5.1-.8.3-1.1.2-.2.6-.5 1.1-.8.3-.1.5-.3.6-.5s.2-.5.2-.7c0-.3-.1-.5-.3-.7s-.5-.3-.8-.3-.5.1-.7.2q-.3.15-.3.6h-2c.1-.7.4-1.3.9-1.7s1.2-.5 2.1-.5 1.7.2 2.2.6.8 1 .8 1.7q.15.6-.3 1.2"></path></svg>
<span class="md-ellipsis">
    
  
    Anomian
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="anomian.html">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 3C6.5 3 2 6.6 2 11c0 2.1 1 4.1 2.8 5.5 0 .6-.4 2.2-2.8 4.5 0 0 3.5 0 6.5-2.5 1.1.3 2.3.5 3.5.5 5.5 0 10-3.6 10-8s-4.5-8-10-8m1 12h-2v-2h2zm1.8-5c-.3.4-.7.6-1.1.8-.3.2-.4.3-.5.5-.2.2-.2.4-.2.7h-2c0-.5.1-.8.3-1.1.2-.2.6-.5 1.1-.8.3-.1.5-.3.6-.5s.2-.5.2-.7c0-.3-.1-.5-.3-.7s-.5-.3-.8-.3-.5.1-.7.2q-.3.15-.3.6h-2c.1-.7.4-1.3.9-1.7s1.2-.5 2.1-.5 1.7.2 2.2.6.8 1 .8 1.7q.15.6-.3 1.2"></path></svg>
<span class="md-ellipsis">
    
  
    Anomian
  

    
  </span>
</a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#preface">
<span class="md-ellipsis">
      
        Preface
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#chapter-1-the-core-players-of-the-game">
<span class="md-ellipsis">
      
        Chapter 1: The core players of the game
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#chapter-2-communication-patterns">
<span class="md-ellipsis">
      
        Chapter 2: Communication patterns
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#chapter-3-engine-configurations">
<span class="md-ellipsis">
      
        Chapter 3: Engine configurations
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#chapter-4-mailboxes-for-anyone">
<span class="md-ellipsis">
      
        Chapter 4: Mailboxes for anyone
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#chapter-5-context-of-execution">
<span class="md-ellipsis">
      
        Chapter 5: Context of execution
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#chapter-6-what-engines-can-do">
<span class="md-ellipsis">
      
        Chapter 6: What engines can do
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#chapter-7-we-have-engines-and-now-what">
<span class="md-ellipsis">
      
        Chapter 7: We have engines, and now, what?
      
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="tutorial/principles_and_guidelines.html">
<span class="md-ellipsis">
    
  
    Contributor guidelines
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#preface">
<span class="md-ellipsis">
      
        Preface
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#chapter-1-the-core-players-of-the-game">
<span class="md-ellipsis">
      
        Chapter 1: The core players of the game
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#chapter-2-communication-patterns">
<span class="md-ellipsis">
      
        Chapter 2: Communication patterns
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#chapter-3-engine-configurations">
<span class="md-ellipsis">
      
        Chapter 3: Engine configurations
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#chapter-4-mailboxes-for-anyone">
<span class="md-ellipsis">
      
        Chapter 4: Mailboxes for anyone
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#chapter-5-context-of-execution">
<span class="md-ellipsis">
      
        Chapter 5: Context of execution
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#chapter-6-what-engines-can-do">
<span class="md-ellipsis">
      
        Chapter 6: What engines can do
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#chapter-7-we-have-engines-and-now-what">
<span class="md-ellipsis">
      
        Chapter 7: We have engines, and now, what?
      
    </span>
</a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<nav aria-label="Navigation" class="md-path">
<ol class="md-path__list">
<li class="md-path__item">
<a class="md-path__link" href="index.html">
<span class="md-ellipsis">
    Home
  </span>
</a>
</li>
<li class="md-path__item">
<a class="md-path__link" href="anomian.html">
<span class="md-ellipsis">
    Tutorials
  </span>
</a>
</li>
</ol>
</nav>
<article class="md-content__inner md-typeset">
<!--
  This is a modified version of the original mkdocs-material theme.
  Copyright (c) 2016-2025 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->
<!-- Tags -->
<nav class="md-tags">
<span class="md-tag">engine</span>
<span class="md-tag">tutorial</span>
<span class="md-tag">work-in-progress</span>
</nav>
<!-- Actions -->
<!--
  Copyright (c) 2016-2025 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->
<!-- Actions -->
<!-- Edit button -->
<a class="md-content__button md-icon" href="https://github.com/anoma/nspec/edit/main/docs/anomian.juvix.md" title="Edit this page">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M6 2c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-1.9l10-10V8l-6-6zm7 1.5L18.5 9H13zm7.1 9.5c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-2 1.8L12 20.9V23h2.1l6.1-6.1z"></path></svg>
</a>
<!-- View button -->
<a class="md-content__button md-icon" href="https://github.com/anoma/nspec/raw/main/docs/anomian.juvix.md" title="View source of this page">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20.56 18H3.44C2.65 18 2 17.37 2 16.59V7.41C2 6.63 2.65 6 3.44 6h17.12c.79 0 1.44.63 1.44 1.41v9.18c0 .78-.65 1.41-1.44 1.41M6.81 15.19v-3.66l1.92 2.35 1.92-2.35v3.66h1.93V8.81h-1.93l-1.92 2.35-1.92-2.35H4.89v6.38zM19.69 12h-1.92V8.81h-1.92V12h-1.93l2.89 3.28z"></path></svg>
</a>
<!-- If the page source ends with .juvix.md, we show a button to view the raw code -->
<a class="md-content__button md-icon" href="anomian-src.html" title="View Raw Juvix Code">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M8 3a2 2 0 0 0-2 2v4a2 2 0 0 1-2 2H3v2h1a2 2 0 0 1 2 2v4a2 2 0 0 0 2 2h2v-2H8v-5a2 2 0 0 0-2-2 2 2 0 0 0 2-2V5h2V3m6 0a2 2 0 0 1 2 2v4a2 2 0 0 0 2 2h1v2h-1a2 2 0 0 0-2 2v4a2 2 0 0 1-2 2h-2v-2h2v-5a2 2 0 0 1 2-2 2 2 0 0 1-2-2V5h-2V3z"></path></svg>
</a>
<!--
  Hack: check whether the content contains a h1 headline. If it doesn't, the
  page title (or respectively site name) is used as the main headline.
-->
<!-- Page content -->
<h1 id="anomian">Anomian<a class="headerlink" href="#anomian" title="Anchor link to this section for reference">¶</a></h1>
<h2 id="preface">Preface<a class="headerlink" href="#preface" title="Anchor link to this section for reference">¶</a></h2>
<p>As in the <a href="https://ieeexplore.ieee.org/servlet/opac?bknumber=8681597">Little Typer</a> book,
we explore some aspects of the Anoma model through a dialogue that presents the
notions considered in the specification. There are two participants in this
dialogue: the student, <em>Jordan</em>, and <em>Anomian</em>, the modeller. When Anomian
speaks, it is in the form of a quote. Otherwise, Jordan speaks.</p>
<blockquote>
<p>Hi, I am Anomian.</p>
</blockquote>
<p>The goal of this dialogue is to illustrate what the Anoma system <em>is</em> about and
how to <em>model</em> it. For the sake of concreteness, we present a few <a href="https://docs.juvix.org/0.6.9/tutorials/essential.html">Juvix code
snippets</a> that are
intended to clarify the model and help resolve potential ambiguities. Most of
the data types are <a href="https://docs.juvix.org/0.6.9/tutorials/essential.html#enumerations-and-inductive-types">enumerations and inductive
types</a>.
The quotes alone should convey the main idea. The Jordan interjections are to
confirm, ask questions, and reiterate the concepts.</p>
<p>Last, but not least, we have not only code snippets,
but we fully embrace <a href="https://www-cs-faculty.stanford.edu/~knuth/lp.html">literate programming</a>.
This comes at the inconvenience of some lines of boilerplate here,
but it can safely be skipped on a first reading.</p>
<details class="code">
<summary>Juvix imports</summary>
<p><pre class="highlight"><code class="juvix"><pre class="src-content"><span class="ju-keyword">module</span> <span id="anomian"><span class="annot"><a class="ju-code-link ju-module" href="https://specs.anoma.net/pr-381/anomian.html#anomian"><span class="annot"><a class="ju-code-link ju-module" href="https://specs.anoma.net/pr-381/anomian.html#anomian"><span class="ju-module"><span class="ju-module">anomian</span></span></a></span></a></span></span><span class="ju-delimiter">;</span><br/><br/><span class="ju-keyword">import</span> <span id="arch.node.types.basics"><span class="annot"><a class="ju-code-link ju-module" href="https://specs.anoma.net/pr-381/arch/node/types/basics.html#arch.node.types.basics"><span class="annot"><a class="ju-code-link ju-module" href="https://specs.anoma.net/pr-381/arch/node/types/basics.html#arch.node.types.basics"><span class="ju-module"><span class="ju-module">arch.node.types.basics</span></span></a></span></a></span></span> <span class="ju-keyword">open</span> <span class="ju-keyword">public</span><span class="ju-delimiter">;</span><br/><span class="ju-keyword">import</span> <span id="arch.node.types.identities"><span class="annot"><a class="ju-code-link ju-module" href="https://specs.anoma.net/pr-381/arch/node/types/identities.html#arch.node.types.identities"><span class="annot"><a class="ju-code-link ju-module" href="https://specs.anoma.net/pr-381/arch/node/types/identities.html#arch.node.types.identities"><span class="ju-module"><span class="ju-module">arch.node.types.identities</span></span></a></span></a></span></span> <span class="ju-keyword">open</span><span class="ju-delimiter">;</span><br/><span class="ju-keyword">import</span> <span id="arch.node.types.messages"><span class="annot"><a class="ju-code-link ju-module" href="https://specs.anoma.net/pr-381/arch/node/types/messages.html#arch.node.types.messages"><span class="annot"><a class="ju-code-link ju-module" href="https://specs.anoma.net/pr-381/arch/node/types/messages.html#arch.node.types.messages"><span class="ju-module"><span class="ju-module">arch.node.types.messages</span></span></a></span></a></span></span> <span class="ju-keyword">open</span> <span class="ju-keyword">hiding</span> <span class="ju-delimiter">{</span><span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/arch/node/types/messages.html#EngineMsg"><span class="ju-inductive">EngineMsg</span></a></span><span class="ju-delimiter">;</span> <span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/arch/node/types/messages.html#Mailbox"><span class="ju-inductive">Mailbox</span></a></span><span class="ju-delimiter">}</span><span class="ju-delimiter">;</span><br/></pre></code></pre></p>
</details>
<h2 id="chapter-1-the-core-players-of-the-game">Chapter 1: The core players of the game<a class="headerlink" href="#chapter-1-the-core-players-of-the-game" title="Anchor link to this section for reference">¶</a></h2>
<blockquote>
<p>At the core of the Anoma model, we find <strong>engines</strong>. They do most of the heavy lifting.</p>
</blockquote>
<p>So, what do you mean by an <em>engine</em>?</p>
<div class="grid">
<blockquote>
<p>Think of an engine as a <em>dynamic entity</em> that can do stuff, much like
us, and that has an <strong>engine-status</strong> that could be <em>running</em>, <em>dead</em>, or
<em>suspended</em>.</p>
</blockquote>
<pre class="highlight"><code class="juvix"><pre class="src-content"><span class="ju-keyword">type</span> <span id="EngineStatus"><span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/anomian.html#EngineStatus"><span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/anomian.html#EngineStatus"><span class="ju-inductive">EngineStatus</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>  <span class="ju-keyword">|</span> <span id="EngineStatus.Running"><span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#EngineStatus.Running"><span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#EngineStatus.Running"><span class="ju-constructor">Running</span></a></span></a></span></span><br/>  <span class="ju-keyword">|</span> <span id="EngineStatus.Dead"><span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#EngineStatus.Dead"><span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#EngineStatus.Dead"><span class="ju-constructor">Dead</span></a></span></a></span></span><br/>  <span class="ju-keyword">|</span> <span id="EngineStatus.Suspended"><span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#EngineStatus.Suspended"><span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#EngineStatus.Suspended"><span class="ju-constructor">Suspended</span></a></span></a></span></span><span class="ju-delimiter">;</span></pre>
</code></pre></div>
<div class="admonition todo">
<p class="admonition-title">Todo</p>
<ul>
<li>Explain that if the engine is dead, next time the system steps, engines marked
  as dead are removed from the system, similarly as a garbage collector
  would do.</li>
<li>Explain that the engine-status is not a property of the engine, but rather
  a property of the engine-instance.</li>
</ul>
</div>
<p>Dynamic entity? What is <em>dynamic</em> about it?</p>
<blockquote>
<p>You and I are not the same person we were yesterday because some events
happened to us. For engines, a typical event is the reception of an
<strong>engine-message</strong> and as a reaction to message reception, their <strong>state</strong> may
change. This ability to change their state is what makes them dynamic.
However, notice that this change of internal state is optional. We call those
engines that never change their state <strong>stateless</strong> engines.</p>
</blockquote>
<p>Huh, so, an engine has its own state, and that state can change by reacting to
messages that are sent to it. Easy.</p>
<blockquote>
<p>It's like when we receive a letter from the tax office. Once we read
the letter and understand it, we know that we have to pay taxes and eventually
do so. That letter may "change" us, some money may be gone.</p>
</blockquote>
<p>But wait, who really sends those messages actually?</p>
<blockquote>
<p>Any engine, including the same engine which receives the message.
For example, an engine could remind itself to do something by sending a message
to itself.</p>
</blockquote>
<p>I see, and the messages can be in different languages, right? I read English
but not French. How are engines able to communicate with each other? Do
they all speak the same language?</p>
<blockquote>
<p>Each engine has its own <strong>message interface</strong>, indicating the <em>language(s)</em> they speak.
This message interface defines the format and content of the messages it can
comprehend and process.</p>
</blockquote>
<div class="grid">
<blockquote>
<p>For example, let's say the engines in our model only speak English, French, and
Spanish.</p>
</blockquote>
<pre class="highlight"><code class="juvix"><pre class="src-content"><span class="ju-keyword">syntax</span> <span class="ju-keyword">alias</span> <span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/anomian.html#EnglishPayload"><span class="ju-axiom">EnglishPayload</span></a></span> <span class="ju-keyword">:=</span> <span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/Juvix/Builtin/V1/String.html#String"><span class="ju-axiom">String</span></a></span><span class="ju-delimiter">;</span><br/><br/><span class="ju-keyword">syntax</span> <span class="ju-keyword">alias</span> <span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/anomian.html#FrenchPayload"><span class="ju-axiom">FrenchPayload</span></a></span> <span class="ju-keyword">:=</span> <span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/Juvix/Builtin/V1/String.html#String"><span class="ju-axiom">String</span></a></span><span class="ju-delimiter">;</span><br/><br/><span class="ju-keyword">syntax</span> <span class="ju-keyword">alias</span> <span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/anomian.html#SpanishPayload"><span class="ju-axiom">SpanishPayload</span></a></span> <span class="ju-keyword">:=</span> <span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/Juvix/Builtin/V1/String.html#String"><span class="ju-axiom">String</span></a></span><span class="ju-delimiter">;</span></pre>
</code></pre></div>
<div class="grid">
<blockquote>
<p>If I, Anomian, speak English and French, my message interface would
look like this.</p>
</blockquote>
<pre class="highlight"><code class="juvix"><pre class="src-content"><span class="ju-keyword">type</span> <span id="AnomianMsgInterface"><span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/anomian.html#AnomianMsgInterface"><span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/anomian.html#AnomianMsgInterface"><span class="ju-inductive">AnomianMsgInterface</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>  <span class="ju-keyword">|</span> <span id="AnomianMsgInterface.AnomianMsgEnglish"><span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#AnomianMsgInterface.AnomianMsgEnglish"><span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#AnomianMsgInterface.AnomianMsgEnglish"><span class="ju-constructor">AnomianMsgEnglish</span></a></span></a></span></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span><br/>      <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:99"><span class="ju-var">msg</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#EnglishPayload"><span class="ju-axiom">EnglishPayload</span></a></span><span class="ju-delimiter">;</span><br/>    <span class="ju-delimiter">}</span><br/>  <span class="ju-keyword">|</span> <span id="AnomianMsgInterface.AnomianMsgFrench"><span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#AnomianMsgInterface.AnomianMsgFrench"><span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#AnomianMsgInterface.AnomianMsgFrench"><span class="ju-constructor">AnomianMsgFrench</span></a></span></a></span></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span><br/>      <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:101"><span class="ju-var">msg</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#FrenchPayload"><span class="ju-axiom">FrenchPayload</span></a></span><span class="ju-delimiter">;</span><br/>    <span class="ju-delimiter">}</span><span class="ju-delimiter">;</span></pre>
</code></pre></div>
<div class="grid">
<p>Hey, in my case, I speak English and Spanish. My message interface is the following.</p>
<pre class="highlight"><code class="juvix"><pre class="src-content"><span class="ju-keyword">type</span> <span id="JordanMsgInterface"><span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/anomian.html#JordanMsgInterface"><span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/anomian.html#JordanMsgInterface"><span class="ju-inductive">JordanMsgInterface</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>  <span class="ju-keyword">|</span> <span id="JordanMsgInterface.JordanMsgEnglish"><span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#JordanMsgInterface.JordanMsgEnglish"><span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#JordanMsgInterface.JordanMsgEnglish"><span class="ju-constructor">JordanMsgEnglish</span></a></span></a></span></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span><br/>      <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:103"><span class="ju-var">msg</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#EnglishPayload"><span class="ju-axiom">EnglishPayload</span></a></span><span class="ju-delimiter">;</span><br/>    <span class="ju-delimiter">}</span><br/>  <span class="ju-keyword">|</span> <span id="JordanMsgInterface.JordanMsgSpanish"><span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#JordanMsgInterface.JordanMsgSpanish"><span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#JordanMsgInterface.JordanMsgSpanish"><span class="ju-constructor">JordanMsgSpanish</span></a></span></a></span></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span><br/>      <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:105"><span class="ju-var">msg</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#SpanishPayload"><span class="ju-axiom">SpanishPayload</span></a></span><span class="ju-delimiter">;</span><br/>    <span class="ju-delimiter">}</span><span class="ju-delimiter">;</span></pre>
</code></pre></div>
<div class="grid">
<p>Got it. Here is a message you can understand, Anomian.</p>
<pre class="highlight"><code class="juvix"><pre class="src-content"><span id="helloAnomian"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#helloAnomian"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#helloAnomian"><span class="ju-function">helloAnomian</span></a></span></a></span></span> <span class="ju-keyword">:</span> <span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/anomian.html#AnomianMsgInterface"><span class="ju-inductive">AnomianMsgInterface</span></a></span> <span class="ju-keyword">:=</span><br/>  <span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#AnomianMsgInterface.AnomianMsgEnglish"><span class="ju-constructor">AnomianMsgInterface<span class="ju-delimiter">.</span>AnomianMsgEnglish</span></a></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span><br/>    <span id="anomian:106"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#anomian:106"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#anomian:106"><span class="ju-function">msg</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="ju-string">"Hello!"</span><span class="ju-delimiter">;</span><br/>  <span class="ju-delimiter">}</span><span class="ju-delimiter">;</span></pre>
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">Message Interface</p>
<ul>
<li>Each engine has a message interface.</li>
</ul>
<ul>
<li>By construction, it is safe to assume that every engine has at least one
  message constructor<sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup> in its message interface.</li>
</ul>
</div>
<blockquote>
<p>The model defines all the message interfaces defined by engines.</p>
</blockquote>
<pre class="highlight"><code class="juvix"><pre class="src-content"><span class="ju-keyword">type</span> <span id="MsgInterface"><span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/anomian.html#MsgInterface"><span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/anomian.html#MsgInterface"><span class="ju-inductive">MsgInterface</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>  <span class="ju-keyword">|</span> <span id="MsgInterface.MsgAnomian"><span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#MsgInterface.MsgAnomian"><span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#MsgInterface.MsgAnomian"><span class="ju-constructor">MsgAnomian</span></a></span></a></span></span> <span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/anomian.html#AnomianMsgInterface"><span class="ju-inductive">AnomianMsgInterface</span></a></span><br/>  <span class="ju-keyword">|</span> <span id="MsgInterface.MsgJordan"><span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#MsgInterface.MsgJordan"><span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#MsgInterface.MsgJordan"><span class="ju-constructor">MsgJordan</span></a></span></a></span></span> <span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/anomian.html#JordanMsgInterface"><span class="ju-inductive">JordanMsgInterface</span></a></span><span class="ju-delimiter">;</span></pre></code></pre>
<blockquote>
<p>To see the full list of message interfaces in the current model, check out the
sum type <code>Msg</code> in <a href="https://specs.anoma.net/pr-381/arch/node/types/anoma_message.html">Anoma Message</a>.</p>
</blockquote>
<h2 id="chapter-2-communication-patterns">Chapter 2: Communication patterns<a class="headerlink" href="#chapter-2-communication-patterns" title="Anchor link to this section for reference">¶</a></h2>
<blockquote>
<p>Now that we understand engines and their message interfaces, let's talk about
how they communicate with each other or better said, what patterns of communication
are there.</p>
</blockquote>
<p>I can send a message to you, Anomian, either to expect a response or simply to
inform you that I'm alive. What else can I do?</p>
<div class="grid">
<blockquote>
<p>There are many patterns indeed, but let us start with the most common ones.</p>
</blockquote>
<pre class="highlight"><code class="juvix"><pre class="src-content"><span class="ju-keyword">syntax</span> <span class="ju-keyword">alias</span> <span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/anomian.html#Timeout"><span class="ju-inductive">Timeout</span></a></span> <span class="ju-keyword">:=</span> <span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/Juvix/Builtin/V1/Nat/Base.html#Nat"><span class="ju-inductive">Nat</span></a></span><span class="ju-delimiter">;</span><br/><br/><span class="ju-keyword">type</span> <span id="CommunicationPattern"><span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/anomian.html#CommunicationPattern"><span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/anomian.html#CommunicationPattern"><span class="ju-inductive">CommunicationPattern</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>  <span class="ju-keyword">|</span> <span id="CommunicationPattern.FireAndForget"><span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#CommunicationPattern.FireAndForget"><span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#CommunicationPattern.FireAndForget"><span class="ju-constructor">FireAndForget</span></a></span></a></span></span><br/>  <span class="ju-keyword">|</span> <span id="CommunicationPattern.RequestReply"><span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#CommunicationPattern.RequestReply"><span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#CommunicationPattern.RequestReply"><span class="ju-constructor">RequestReply</span></a></span></a></span></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span><br/>      <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:109"><span class="ju-var">timeout</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/prelude.html#Option"><span class="ju-inductive">Option</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#Timeout"><span class="ju-inductive">Timeout</span></a></span><span class="ju-delimiter">;</span><br/>    <span class="ju-delimiter">}</span><br/>  <span class="ju-keyword">|</span> <span id="CommunicationPattern.PubSub"><span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#CommunicationPattern.PubSub"><span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#CommunicationPattern.PubSub"><span class="ju-constructor">PubSub</span></a></span></a></span></span><span class="ju-delimiter">;</span></pre>
</code></pre></div>
<blockquote>
<p>We can consider three patterns of communication. The pattern <code>FireAndForget</code>
allows us to communicate asynchronously. One can send a message and not expect
any response like notifications on your phone. However, if you need a response
or result and can wait for it, we can use the <code>RequestReply</code> pattern. That is
the pattern that every synchronous communication uses implicitly. And finally,
the <code>PubSub</code> pattern (pub/sub for short) that allows us to communicate
asynchronously and without a response, broadcasting messages to multiple
engines.</p>
</blockquote>
<!--ᚦ «Do we now plan to have a synchronous pattern?» -->
<div class="grid">
<blockquote>
<p>We can consider three purposes for a message:</p>
<ul>
<li>The first one is to request a reply.</li>
<li>The second one is to reply to a request.</li>
<li>The third one is to notify about something.</li>
</ul>
<p>We can represent these three cases with the <code>EngineMsgKind</code> type.</p>
</blockquote>
<pre class="highlight"><code class="juvix"><pre class="src-content"><span class="ju-keyword">type</span> <span id="EngineMsgKind"><span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/anomian.html#EngineMsgKind"><span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/anomian.html#EngineMsgKind"><span class="ju-inductive">EngineMsgKind</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>  <span class="ju-keyword">|</span> <span id="EngineMsgKind.Request"><span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#EngineMsgKind.Request"><span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#EngineMsgKind.Request"><span class="ju-constructor">Request</span></a></span></a></span></span><br/>  <span class="ju-keyword">|</span> <span id="EngineMsgKind.Reply"><span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#EngineMsgKind.Reply"><span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#EngineMsgKind.Reply"><span class="ju-constructor">Reply</span></a></span></a></span></span><br/>  <span class="ju-keyword">|</span> <span id="EngineMsgKind.Notify"><span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#EngineMsgKind.Notify"><span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#EngineMsgKind.Notify"><span class="ju-constructor">Notify</span></a></span></a></span></span><span class="ju-delimiter">;</span></pre>
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">Summary of communication patterns</p>
<p>We can have several communication patterns.
<!--ᚦ «Here I would like ideally compare to session types, choreographies, protocols etc.» --></p>
</div>
<h2 id="chapter-3-engine-configurations">Chapter 3: Engine configurations<a class="headerlink" href="#chapter-3-engine-configurations" title="Anchor link to this section for reference">¶</a></h2>
<p>Anomian, you mentioned that engines have an internal state, a message interface,
and specific communication patterns. Are there any other characteristics that
define an engine? And what about us, are we also engines? For instance, humans
have attributes such as name, age, and parents. Do engines have similar
attributes?</p>
<div class="grid">
<blockquote>
<p>Engines possess certain attributes. These attributes are stored in what we
call their <strong>engine-configuration</strong>, of type <code>EngineCfg</code>. This configuration
is <em>immutable</em> through the lifetime of the engine. The configuration of an
engine includes its <strong>parent</strong> that <strong>spawns</strong> it, its <strong>name</strong>, a virtual
location where the engine runs named <code>node</code>, and some configuration parameters
denoted by <code>cfg</code> of an engine-specific type that instantiates the type
parameter <code>C</code>.</p>
</blockquote>
<pre class="highlight"><code class="juvix"><pre class="src-content"><span class="ju-keyword">type</span> <span id="EngineCfg"><span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/anomian.html#EngineCfg"><span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/anomian.html#EngineCfg"><span class="ju-inductive">EngineCfg</span></a></span></a></span></span> <span id="anomian:110"><span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:110"><span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:110"><span class="ju-var">C</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>  <span id="EngineCfg.mkCfg"><span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#EngineCfg.mkCfg"><span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#EngineCfg.mkCfg"><span class="ju-constructor">mkCfg</span></a></span></a></span></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span><br/>    <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:115"><span class="ju-var">parent</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/prelude.html#Option"><span class="ju-inductive">Option</span></a></span> <span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/arch/node/types/identities.html#EngineID"><span class="ju-function">EngineID</span></a></span><span class="ju-delimiter">;</span><br/>    <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:116"><span class="ju-var">name</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/arch/node/types/identities.html#EngineName"><span class="ju-axiom">EngineName</span></a></span><span class="ju-delimiter">;</span><br/>    <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:117"><span class="ju-var">node</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/arch/node/types/identities.html#NodeID"><span class="ju-inductive">NodeID</span></a></span><span class="ju-delimiter">;</span><br/>    <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:118"><span class="ju-var">cfg</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:110"><span class="ju-var">C</span></a></span><span class="ju-delimiter">;</span><br/>  <span class="ju-delimiter">}</span><span class="ju-delimiter">;</span></pre>
</code></pre></div>
<blockquote>
<p>As we say the engine configuration is immutable by design. This means that
once an engine is created, attributes such as the name of the engine cannot be
changed. If you want to change the name of an engine, you have to create a new
engine with the new name.</p>
</blockquote>
<p>Tell me one thing about the parents of engines. Do they always know who their
parent is? I don't know who is my father, actually.</p>
<div class="grid">
<blockquote>
<p>Engines might not always know who their parent is.<sup id="fnref:2"><a class="footnote-ref" href="#fn:2">2</a></sup> The absence of this information is
stored in the engine's configuration with the <code>parent</code> field set to <code>none</code>.
If the parent is known, the <code>parent</code> field is set to <code>some creatorID</code>, where
<code>creatorID</code> is the engine-identifier of the parent engine.</p>
</blockquote>
<pre class="highlight"><code class="juvix"><pre class="src-content"><span class="ju-keyword">axiom</span> <span id="localhost"><span class="annot"><a class="ju-code-link ju-axiom" href="https://specs.anoma.net/pr-381/anomian.html#localhost"><span class="annot"><a class="ju-code-link ju-axiom" href="https://specs.anoma.net/pr-381/anomian.html#localhost"><span class="ju-axiom">localhost</span></a></span></a></span></span> <span class="ju-keyword">:</span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/arch/node/types/identities.html#NodeID"><span class="ju-inductive">NodeID</span></a></span><span class="ju-delimiter">;</span><br/><br/><span id="simpleConfig"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#simpleConfig"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#simpleConfig"><span class="ju-function">simpleConfig</span></a></span></a></span></span> <span class="ju-keyword">:</span> <span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/anomian.html#EngineCfg"><span class="ju-inductive">EngineCfg</span></a></span> <span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/Stdlib/Data/Unit/Base.html#Unit"><span class="ju-inductive">Unit</span></a></span> <span class="ju-keyword">:=</span><br/>  <span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#EngineCfg.mkCfg"><span class="ju-constructor">EngineCfg<span class="ju-delimiter">.</span>mkCfg</span></a></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span><br/>    <span id="anomian:127"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#anomian:127"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#anomian:127"><span class="ju-function">parent</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/prelude.html#none"><span class="ju-constructor">none</span></a></span><span class="ju-delimiter">;</span><br/>    <span id="anomian:128"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#anomian:128"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#anomian:128"><span class="ju-function">name</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="ju-string">"Anomian"</span><span class="ju-delimiter">;</span><br/>    <span id="anomian:129"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#anomian:129"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#anomian:129"><span class="ju-function">node</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a class="ju-code-link ju-axiom" href="https://specs.anoma.net/pr-381/anomian.html#localhost"><span class="ju-axiom">localhost</span></a></span><span class="ju-delimiter">;</span><br/>    <span id="anomian:130"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#anomian:130"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#anomian:130"><span class="ju-function">cfg</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/Stdlib/Data/Unit/Base.html#Unit.unit"><span class="ju-constructor">unit</span></a></span><span class="ju-delimiter">;</span><br/>  <span class="ju-delimiter">}</span><span class="ju-delimiter">;</span></pre>
</code></pre></div>
<p>So, we have one way to identify engines: by their name and their node if we know
where it runs.</p>
<div class="grid">
<blockquote>
<p>Roughly, a node is a
virtual place where the engine lives and operates. This place could be known
to be in the same neighbourhood, in which case, we can refer to it as a
<strong>local engine</strong>. Otherwise, the engine is an <strong>external engine</strong>.
<em>However, note that we have not yet <strong>defined</strong> what a node is!</em></p>
</blockquote>
<pre class="highlight"><code class="juvix"><pre class="src-content"><span id="EngineID"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/arch/node/types/identities.html#EngineID"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/arch/node/types/identities.html#EngineID"><span class="ju-function">EngineID</span></a></span></a></span></span> <span class="ju-keyword">:</span> <span class="ju-keyword">Type</span> <span class="ju-keyword">:=</span> <span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/Stdlib/Data/Pair/Base.html#Pair"><span class="ju-inductive">Pair</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/prelude.html#Option"><span class="ju-inductive"><span class="ju-delimiter">(</span>Option</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/arch/node/types/identities.html#NodeID"><span class="ju-inductive">NodeID</span></a></span><span class="ju-delimiter">)</span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/arch/node/types/identities.html#EngineName"><span class="ju-axiom">EngineName</span></a></span><span class="ju-delimiter">;</span></pre>
</code></pre></div>
<p>Okay, I guess that we can nevertheless start thinking about identifiers already.</p>
<pre class="highlight"><code class="juvix"><pre class="src-content"><span id="JordanID"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#JordanID"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#JordanID"><span class="ju-function">JordanID</span></a></span></a></span></span> <span class="ju-keyword">:</span> <span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/arch/node/types/identities.html#EngineID"><span class="ju-function">EngineID</span></a></span> <span class="ju-keyword">:=</span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/prelude.html#mkPair"><span class="ju-constructor">mkPair</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/prelude.html#some"><span class="ju-constructor"><span class="ju-delimiter">(</span>some</span></a></span> <span class="annot"><a class="ju-code-link ju-axiom" href="https://specs.anoma.net/pr-381/anomian.html#localhost"><span class="ju-axiom">localhost</span></a></span><span class="ju-delimiter">)</span> <span class="ju-string">"Jordan9121"</span><span class="ju-delimiter">;</span><br/><br/><span id="AnomianID"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#AnomianID"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#AnomianID"><span class="ju-function">AnomianID</span></a></span></a></span></span> <span class="ju-keyword">:</span> <span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/arch/node/types/identities.html#EngineID"><span class="ju-function">EngineID</span></a></span> <span class="ju-keyword">:=</span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/prelude.html#mkPair"><span class="ju-constructor">mkPair</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/prelude.html#some"><span class="ju-constructor"><span class="ju-delimiter">(</span>some</span></a></span> <span class="annot"><a class="ju-code-link ju-axiom" href="https://specs.anoma.net/pr-381/anomian.html#localhost"><span class="ju-axiom">localhost</span></a></span><span class="ju-delimiter">)</span> <span class="ju-string">"Anomian184"</span><span class="ju-delimiter">;</span></pre></code></pre>
<blockquote>
<p>With <strong>engine identifiers</strong> (of type <code>EngineID</code>), we can define <em>engine
messages</em>. These messages serve as events for engines, sent to them by some
other engine.</p>
</blockquote>
<div class="grid">
<blockquote>
<p>An <strong>engine-message</strong> consists of a <em>sender</em>, a <em>target</em>, an optional <em>mailbox
identifier</em>, the <em>communication pattern</em>, what kind of message it is, and the
message itself.</p>
<p>The mailbox identifier is used to identify the mailbox of the target engine,
the virtual place where the message is delivered. Recall that the <em>kind</em>
indicates whether the message is a command, a response, or an event, and the
<em>pattern</em> indicates the expected behaviour pattern for how the recipient
should react.</p>
</blockquote>
<!--ᚦ «Do we really want to restrict ourselves to command event response, in general?» -->
<pre class="highlight"><code class="juvix"><pre class="src-content"><span class="ju-keyword">type</span> <span id="EngineMsg"><span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/anomian.html#EngineMsg"><span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/anomian.html#EngineMsg"><span class="ju-inductive">EngineMsg</span></a></span></a></span></span> <span id="anomian:131"><span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:131"><span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:131"><span class="ju-var">M</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>  <span id="EngineMsg.mkMsg"><span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#EngineMsg.mkMsg"><span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#EngineMsg.mkMsg"><span class="ju-constructor">mkMsg</span></a></span></a></span></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span><br/>    <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:138"><span class="ju-var">sender</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/arch/node/types/identities.html#EngineID"><span class="ju-function">EngineID</span></a></span><span class="ju-delimiter">;</span><br/>    <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:139"><span class="ju-var">target</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/arch/node/types/identities.html#EngineID"><span class="ju-function">EngineID</span></a></span><span class="ju-delimiter">;</span><br/>    <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:140"><span class="ju-var">mailbox</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/prelude.html#Option"><span class="ju-inductive">Option</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/arch/node/types/messages.html#MailboxID"><span class="ju-inductive">MailboxID</span></a></span><span class="ju-delimiter">;</span><br/>    <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:141"><span class="ju-var">pattern</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/anomian.html#CommunicationPattern"><span class="ju-inductive">CommunicationPattern</span></a></span><span class="ju-delimiter">;</span><br/>    <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:142"><span class="ju-var">kind</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/anomian.html#EngineMsgKind"><span class="ju-inductive">EngineMsgKind</span></a></span><span class="ju-delimiter">;</span><br/>    <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:143"><span class="ju-var">msg</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:131"><span class="ju-var">M</span></a></span><span class="ju-delimiter">;</span><br/>  <span class="ju-delimiter">}</span><span class="ju-delimiter">;</span></pre>
</code></pre></div>
<div class="grid">
<p>Hah! So let me craft a message for you, Anomian.</p>
<pre class="highlight"><code class="juvix"><pre class="src-content"><span id="jordanToAnomian"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#jordanToAnomian"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#jordanToAnomian"><span class="ju-function">jordanToAnomian</span></a></span></a></span></span> <span class="ju-keyword">:</span> <span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/anomian.html#EngineMsg"><span class="ju-inductive">EngineMsg</span></a></span> <span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/anomian.html#MsgInterface"><span class="ju-inductive">MsgInterface</span></a></span> <span class="ju-keyword">:=</span><br/>  <span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#EngineMsg.mkMsg"><span class="ju-constructor">EngineMsg<span class="ju-delimiter">.</span>mkMsg</span></a></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span><br/>    <span id="anomian:156"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#anomian:156"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#anomian:156"><span class="ju-function">sender</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#JordanID"><span class="ju-function">JordanID</span></a></span><span class="ju-delimiter">;</span><br/>    <span id="anomian:157"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#anomian:157"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#anomian:157"><span class="ju-function">target</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#AnomianID"><span class="ju-function">AnomianID</span></a></span><span class="ju-delimiter">;</span><br/>    <span id="anomian:158"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#anomian:158"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#anomian:158"><span class="ju-function">mailbox</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/prelude.html#some"><span class="ju-constructor">some</span></a></span> <span class="ju-number">1</span><span class="ju-delimiter">;</span><br/>    <span id="anomian:160"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#anomian:160"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#anomian:160"><span class="ju-function">pattern</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>      <span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#CommunicationPattern.RequestReply"><span class="ju-constructor">CommunicationPattern<span class="ju-delimiter">.</span>RequestReply</span></a></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span><br/>        <span id="anomian:159"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#anomian:159"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#anomian:159"><span class="ju-function">timeout</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/prelude.html#none"><span class="ju-constructor">none</span></a></span><span class="ju-delimiter">;</span><br/>      <span class="ju-delimiter">}</span><span class="ju-delimiter">;</span><br/>    <span id="anomian:161"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#anomian:161"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#anomian:161"><span class="ju-function">kind</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#EngineMsgKind.Request"><span class="ju-constructor">EngineMsgKind<span class="ju-delimiter">.</span>Request</span></a></span><span class="ju-delimiter">;</span><br/>    <span id="anomian:163"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#anomian:163"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#anomian:163"><span class="ju-function">msg</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>      <span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#MsgInterface.MsgAnomian"><span class="ju-constructor">MsgInterface<span class="ju-delimiter">.</span>MsgAnomian</span></a></span><br/>        <span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#AnomianMsgInterface.AnomianMsgEnglish"><span class="ju-constructor">AnomianMsgInterface<span class="ju-delimiter">.</span>AnomianMsgEnglish</span></a></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span><br/>          <span id="anomian:162"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#anomian:162"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#anomian:162"><span class="ju-function">msg</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="ju-string">"What is the meaning of life?"</span><span class="ju-delimiter">;</span><br/>        <span class="ju-delimiter">}</span><span class="ju-delimiter">;</span><br/>  <span class="ju-delimiter">}</span><span class="ju-delimiter">;</span></pre>
</code></pre></div>
<div class="grid">
<blockquote>
<p>A reply engine-message is <code>anomianToJordan</code>.</p>
<p>Notice that the type parameter <code>MsgInterface</code> for <code>EngineMsg</code> is the same
as the one used in the request message, and not an engine-specific message
interface.</p>
</blockquote>
<pre class="highlight"><code class="juvix"><pre class="src-content"><span id="anomianToJordan"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#anomianToJordan"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#anomianToJordan"><span class="ju-function">anomianToJordan</span></a></span></a></span></span> <span class="ju-keyword">:</span> <span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/anomian.html#EngineMsg"><span class="ju-inductive">EngineMsg</span></a></span> <span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/anomian.html#MsgInterface"><span class="ju-inductive">MsgInterface</span></a></span> <span class="ju-keyword">:=</span><br/>  <span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#EngineMsg.mkMsg"><span class="ju-constructor">EngineMsg<span class="ju-delimiter">.</span>mkMsg</span></a></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span><br/>    <span id="anomian:164"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#anomian:164"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#anomian:164"><span class="ju-function">sender</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#AnomianID"><span class="ju-function">AnomianID</span></a></span><span class="ju-delimiter">;</span><br/>    <span id="anomian:165"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#anomian:165"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#anomian:165"><span class="ju-function">target</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#JordanID"><span class="ju-function">JordanID</span></a></span><span class="ju-delimiter">;</span><br/>    <span id="anomian:166"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#anomian:166"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#anomian:166"><span class="ju-function">mailbox</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/prelude.html#some"><span class="ju-constructor">some</span></a></span> <span class="ju-number">1</span><span class="ju-delimiter">;</span><br/>    <span id="anomian:167"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#anomian:167"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#anomian:167"><span class="ju-function">pattern</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#CommunicationPattern.FireAndForget"><span class="ju-constructor">CommunicationPattern<span class="ju-delimiter">.</span>FireAndForget</span></a></span><span class="ju-delimiter">;</span><br/>    <span id="anomian:168"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#anomian:168"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#anomian:168"><span class="ju-function">kind</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#EngineMsgKind.Reply"><span class="ju-constructor">EngineMsgKind<span class="ju-delimiter">.</span>Reply</span></a></span><span class="ju-delimiter">;</span><br/>    <span id="anomian:170"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#anomian:170"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#anomian:170"><span class="ju-function">msg</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>      <span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#MsgInterface.MsgJordan"><span class="ju-constructor">MsgInterface<span class="ju-delimiter">.</span>MsgJordan</span></a></span><br/>        <span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#JordanMsgInterface.JordanMsgEnglish"><span class="ju-constructor">JordanMsgInterface<span class="ju-delimiter">.</span>JordanMsgEnglish</span></a></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span><br/>          <span id="anomian:169"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#anomian:169"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#anomian:169"><span class="ju-function">msg</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="ju-string">"The meaning of life is 42."</span><span class="ju-delimiter">;</span><br/>        <span class="ju-delimiter">}</span><span class="ju-delimiter">;</span><br/>  <span class="ju-delimiter">}</span><span class="ju-delimiter">;</span></pre>
<div class="admonition todo">
<p class="admonition-title">Todo</p>
<p>Reevaluate if the message kind is actually needed. Replies may be
indistinguishable from notifications, following a fire-and-forget pattern to
reply.</p>
</div>
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">The social context of an engine</p>
<p>Each engine is known in its neighbourhood and may have connections abroad.
It still communicates via messages though and stays fixed in the place.</p>
</div>
<p>But how can I send it? Do I have to go to the post office?</p>
<h2 id="chapter-4-mailboxes-for-anyone">Chapter 4: Mailboxes for anyone<a class="headerlink" href="#chapter-4-mailboxes-for-anyone" title="Anchor link to this section for reference">¶</a></h2>
<p>Messages are sent to the engine's mailbox.</p>
<div class="grid">
<blockquote>
<p>What is a mailbox? A <strong>mailbox</strong> consists of a queue of messages and can also
contain additional data if needed. The data could be the state of the mailbox,
think of it as having extra information about the mailbox like the number of
messages in it.</p>
</blockquote>
<pre class="highlight"><code class="juvix"><pre class="src-content"><span class="ju-keyword">type</span> <span id="Mailbox"><span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/anomian.html#Mailbox"><span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/anomian.html#Mailbox"><span class="ju-inductive">Mailbox</span></a></span></a></span></span> <span id="anomian:171"><span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:171"><span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:171"><span class="ju-var">S</span></a></span></a></span></span> <span id="anomian:172"><span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:172"><span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:172"><span class="ju-var">M</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>  <span id="Mailbox.mkMailbox"><span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#Mailbox.mkMailbox"><span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#Mailbox.mkMailbox"><span class="ju-constructor">mkMailbox</span></a></span></a></span></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span><br/>    <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:175"><span class="ju-var">messages</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/Juvix/Builtin/V1/List.html#List"><span class="ju-inductive">List</span></a></span> <span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/anomian.html#EngineMsg"><span class="ju-inductive"><span class="ju-delimiter">(</span>EngineMsg</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:172"><span class="ju-var">M</span></a></span><span class="ju-delimiter">)</span><span class="ju-delimiter">;</span><br/>    <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:176"><span class="ju-var">mailboxState</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/prelude.html#Option"><span class="ju-inductive">Option</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:171"><span class="ju-var">S</span></a></span><span class="ju-delimiter">;</span><br/>  <span class="ju-delimiter">}</span><span class="ju-delimiter">;</span></pre>
</code></pre></div>
<div class="grid">
<blockquote>
<p>However, engines not only have a single mailbox, but a cluster of mailboxes.
That is, there is <em>at least one</em> mailbox per engine, but there can be more.
The type <code>MailboxCluster</code> for the cluster of mailboxes is really a mapping of
mailbox identifiers to the actual mailboxes.</p>
</blockquote>
<pre class="highlight"><code class="juvix"><pre class="src-content"><span id="MailboxCluster"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#MailboxCluster"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#MailboxCluster"><span class="ju-function">MailboxCluster</span></a></span></a></span></span> <span class="ju-delimiter">(</span><span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:183"><span class="ju-var">S</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:184"><span class="ju-var">M</span></a></span> <span class="ju-keyword">:</span> <span class="ju-keyword">Type</span><span class="ju-delimiter">)</span> <span class="ju-keyword">:</span> <span class="ju-keyword">Type</span> <span class="ju-keyword">:=</span> <span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/Stdlib/Data/Map.html#Map"><span class="ju-inductive">Map</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/arch/node/types/messages.html#MailboxID"><span class="ju-inductive">MailboxID</span></a></span> <span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/anomian.html#Mailbox"><span class="ju-inductive"><span class="ju-delimiter">(</span>Mailbox</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:183"><span class="ju-var">S</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:184"><span class="ju-var">M</span></a></span><span class="ju-delimiter">)</span><span class="ju-delimiter">;</span></pre>
</code></pre></div>
<p>Why bother with the mailbox cluster? One mailbox is enough, right?</p>
<blockquote>
<p>While a single mailbox would suffice for basic functionality, multiple
mailboxes provide valuable message organisation capabilities.</p>
</blockquote>
<!--ᚦ
        «mailboxes may lead to "threads" within engines,
        very much like passive objects in the active objects approach (cf. SALSA)»
-->
<p>That sounds like how my email works. It is a cluster of mailboxes, and in
principle, I have one big mailbox, but truly I can see it as having multiple
mailboxes, one for each folder, such as promotions, important, family, etc.</p>
<div class="grid">
<blockquote>
<p>Yes, the folder analogy is great. The following diagram illustrates a mailbox
cluster. Each mailbox<sup id="fnref:3"><a class="footnote-ref" href="#fn:3">3</a></sup> is intended to serve a specific purpose. For
simplicity, we refer to the entire cluster as the engine's mailbox if there is
no confusion. In the type <code>MailboxCluster</code>, we have a map of mailbox IDs to
mailboxes.</p>
</blockquote>
<figure>
<pre class="mermaid"><code>graph LR
    MailboxCluster["Jordan's Mailbox Cluster"] --&gt; Mailbox1
    MailboxCluster --&gt; Mailbox2
    MailboxCluster --&gt; Mailbox3

    subgraph Mailbox1["Mailbox#1 : 'Urgent'"]
        Queue1("Queue of Messages")
        Data1("Mailbox state")
    end

    subgraph Mailbox2["Mailbox #2 : 'Promotions'"]
        Queue2("Queue of Messages")
        Data2("Mailbox state")
    end

    subgraph Mailbox3["Mailbox #3 : 'Family'"]
        Queue3("Queue of Messages")
        Data3("Mailbox state")
    end</code></pre>
</figure>
</div>
<p>You have not answered yet how mail is actually sent.</p>
<blockquote>
<p>Well, imagine for a second that the communication process is magically handled
by one <em>mailelf</em> that delivers messages to the engines. When a message is sent
to an engine, the mailelf takes the message from the sender and puts it in the
engine's mailbox. In other words, for the moment, it suffices to assume that
all messages are delivered <em>eventually</em>.</p>
</blockquote>
<div class="admonition info">
<p class="admonition-title">Mailboxes for eventual message delivery</p>
<p>So, yes, the main purpose of mailboxes is where the elf delivers the messages.</p>
</div>
<h2 id="chapter-5-context-of-execution">Chapter 5: Context of execution<a class="headerlink" href="#chapter-5-context-of-execution" title="Anchor link to this section for reference">¶</a></h2>
<p>This is quite a fancy setup for sending messages, but how do engines "actually"
get things done?!</p>
<p>I mean, we've discussed that engines have certain attributes: an identifier, a
message interface, and a configuration that includes details like a parent, a
name, and a virtual location where the engine <em>runs</em>. So, maybe a better
question: how do engines actually run?</p>
<div class="grid">
<blockquote>
<p>To understand how an engine runs, we need to acknowledge that engines operate
within a <strong>context of execution</strong> referred to as their <strong>engine-environment</strong>.
This environment, defined by the <code>EngineEnv</code> type, includes the engine's
internal state, its mailboxes, and an address book of known engines it can
interact with, including itself.</p>
</blockquote>
<pre class="highlight"><code class="juvix"><pre class="src-content"><span id="AddressBook"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#AddressBook"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#AddressBook"><span class="ju-function">AddressBook</span></a></span></a></span></span> <span class="ju-keyword">:</span> <span class="ju-keyword">Type</span> <span class="ju-keyword">:=</span> <span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/Stdlib/Data/Set.html#Set"><span class="ju-inductive">Set</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/arch/node/types/identities.html#EngineName"><span class="ju-axiom">EngineName</span></a></span><span class="ju-delimiter">;</span><br/><br/><span class="ju-keyword">type</span> <span id="EngineEnv"><span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/anomian.html#EngineEnv"><span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/anomian.html#EngineEnv"><span class="ju-inductive">EngineEnv</span></a></span></a></span></span> <span id="anomian:185"><span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:185"><span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:185"><span class="ju-var">S</span></a></span></a></span></span> <span id="anomian:186"><span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:186"><span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:186"><span class="ju-var">Msg</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>  <span id="EngineEnv.mkEnv"><span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#EngineEnv.mkEnv"><span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#EngineEnv.mkEnv"><span class="ju-constructor">mkEnv</span></a></span></a></span></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span><br/>    <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:190"><span class="ju-var">state</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:185"><span class="ju-var">S</span></a></span><span class="ju-delimiter">;</span><br/>    <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:191"><span class="ju-var">mailbox</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#MailboxCluster"><span class="ju-function">MailboxCluster</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:185"><span class="ju-var">S</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:186"><span class="ju-var">Msg</span></a></span><span class="ju-delimiter">;</span><br/>    <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:192"><span class="ju-var">acq</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#AddressBook"><span class="ju-function">AddressBook</span></a></span><span class="ju-delimiter">;</span><br/>  <span class="ju-delimiter">}</span><span class="ju-delimiter">;</span></pre>
</code></pre></div>
<blockquote>
<p>Note that engine environments do not encompass the engine's configuration,
although they could. Instead, engine configurations are accessible separately
from the engine environments. This separation promotes modularity.</p>
</blockquote>
<div class="admonition info">
<p class="admonition-title">Local data of engines and the execution context</p>
<p>Each engine has its own local data, some of which is fixed,
and some of which is dynamic. All this data together forms the
<em>execution context</em>.</p>
</div>
<h2 id="chapter-6-what-engines-can-do">Chapter 6: What engines can do<a class="headerlink" href="#chapter-6-what-engines-can-do" title="Anchor link to this section for reference">¶</a></h2>
<div class="grid">
<p>So, refining the question: how do engines actually compute? With their
engine-environment in place, I imagine that engines run some sort of function
that uses the engine-environment and a message from the mailbox. Something like
the following type <code>Handler</code>, where <code>S</code> is the state of the engine and <code>M</code> is
the message interface, and the return type is <code>ReturnSomething</code>, which can be
whatever we want.</p>
<pre class="highlight"><code class="juvix"><pre class="src-content"><span class="ju-keyword">axiom</span> <span id="ReturnSomething"><span class="annot"><a class="ju-code-link ju-axiom" href="https://specs.anoma.net/pr-381/anomian.html#ReturnSomething"><span class="annot"><a class="ju-code-link ju-axiom" href="https://specs.anoma.net/pr-381/anomian.html#ReturnSomething"><span class="ju-axiom">ReturnSomething</span></a></span></a></span></span> <span class="ju-keyword">:</span> <span class="ju-keyword">Type</span><span class="ju-delimiter">;</span><br/><br/><span id="Handler"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#Handler"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#Handler"><span class="ju-function">Handler</span></a></span></a></span></span> <span class="ju-delimiter">(</span><span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:202"><span class="ju-var">M</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:203"><span class="ju-var">S</span></a></span> <span class="ju-keyword">:</span> <span class="ju-keyword">Type</span><span class="ju-delimiter">)</span> <span class="ju-keyword">:</span> <span class="ju-keyword">Type</span> <span class="ju-keyword">:=</span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:202"><span class="ju-var">M</span></a></span> <span class="ju-keyword">-&gt;</span> <span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/anomian.html#EngineEnv"><span class="ju-inductive">EngineEnv</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:203"><span class="ju-var">S</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:202"><span class="ju-var">M</span></a></span> <span class="ju-keyword">-&gt;</span> <span class="annot"><a class="ju-code-link ju-axiom" href="https://specs.anoma.net/pr-381/anomian.html#ReturnSomething"><span class="ju-axiom">ReturnSomething</span></a></span><span class="ju-delimiter">;</span></pre>
</code></pre></div>
<blockquote>
<p>The computational aspect of an engine is what we refer to as its
<strong>behaviour</strong>, and it is correct to think of it as a function that takes in a
message and the engine's environment. However, the return type of this
function cannot be anything: the type what an engine can produce is part of the
model of engines, and it is fixed for each engine.</p>
</blockquote>
<p>What exactly can an engine do if it's not just the same message passing we
already know?</p>
<div class="grid">
<blockquote>
<p>We decompose the engine's range of possible reactions into a set of
<strong>effects</strong>. These effects <em>describe</em> the valid actions that the engine can perform.
We can represent these effects with the <code>Effect</code> type.</p>
<p>To recall, we use the following convention for engine-related types:</p>
<ul>
<li><code>S</code> is the type of its internal state,</li>
<li><code>E</code> is the type of its environment,</li>
<li><code>M</code> is the type of its message interface.</li>
</ul>
</blockquote>
<pre class="highlight"><code class="juvix"><pre class="src-content"><span class="ju-keyword">syntax</span> <span class="ju-keyword">alias</span> <span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/anomian.html#TimeTrigger"><span class="ju-inductive">TimeTrigger</span></a></span> <span class="ju-keyword">:=</span> <span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/Juvix/Builtin/V1/Nat/Base.html#Nat"><span class="ju-inductive">Nat</span></a></span><span class="ju-delimiter">;</span><br/><br/><span class="ju-keyword">type</span> <span id="Effect"><span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/anomian.html#Effect"><span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/anomian.html#Effect"><span class="ju-inductive">Effect</span></a></span></a></span></span> <span id="anomian:205"><span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:205"><span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:205"><span class="ju-var">S</span></a></span></a></span></span> <span id="anomian:206"><span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:206"><span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:206"><span class="ju-var">E</span></a></span></a></span></span> <span id="anomian:207"><span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:207"><span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:207"><span class="ju-var">M</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>  <span class="ju-keyword">|</span> <span id="Effect.SendMsg"><span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#Effect.SendMsg"><span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#Effect.SendMsg"><span class="ju-constructor">SendMsg</span></a></span></a></span></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span><br/>      <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:209"><span class="ju-var">msg</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/anomian.html#EngineMsg"><span class="ju-inductive">EngineMsg</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:207"><span class="ju-var">M</span></a></span><span class="ju-delimiter">;</span><br/>    <span class="ju-delimiter">}</span><br/>  <span class="ju-keyword">|</span> <span id="Effect.UpdateState"><span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#Effect.UpdateState"><span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#Effect.UpdateState"><span class="ju-constructor">UpdateState</span></a></span></a></span></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span><br/>      <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:211"><span class="ju-var">state</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:205"><span class="ju-var">S</span></a></span><span class="ju-delimiter">;</span><br/>    <span class="ju-delimiter">}</span><br/>  <span class="ju-keyword">|</span> <span id="Effect.SpawnEngine"><span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#Effect.SpawnEngine"><span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#Effect.SpawnEngine"><span class="ju-constructor">SpawnEngine</span></a></span></a></span></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span><br/>      <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:213"><span class="ju-var">engine</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:206"><span class="ju-var">E</span></a></span><span class="ju-delimiter">;</span><br/>    <span class="ju-delimiter">}</span><br/>  <span class="ju-keyword">|</span> <span id="Effect.Chain"><span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#Effect.Chain"><span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#Effect.Chain"><span class="ju-constructor">Chain</span></a></span></a></span></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span><br/>      <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:215"><span class="ju-var">effects</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/Juvix/Builtin/V1/List.html#List"><span class="ju-inductive">List</span></a></span> <span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/anomian.html#Effect"><span class="ju-inductive"><span class="ju-delimiter">(</span>Effect</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:205"><span class="ju-var">S</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:206"><span class="ju-var">E</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:207"><span class="ju-var">M</span></a></span><span class="ju-delimiter">)</span><span class="ju-delimiter">;</span><br/>    <span class="ju-delimiter">}</span><br/>  <span class="ju-keyword">|</span> <span id="Effect.Schedule"><span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#Effect.Schedule"><span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#Effect.Schedule"><span class="ju-constructor">Schedule</span></a></span></a></span></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span><br/>      <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:218"><span class="ju-var">trigger</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#TimeTrigger"><span class="ju-inductive">TimeTrigger</span></a></span><span class="ju-delimiter">;</span><br/>      <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:219"><span class="ju-var">action</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/anomian.html#Effect"><span class="ju-inductive">Effect</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:205"><span class="ju-var">S</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:206"><span class="ju-var">E</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:207"><span class="ju-var">M</span></a></span><span class="ju-delimiter">;</span><br/>    <span class="ju-delimiter">}</span><span class="ju-delimiter">;</span></pre>
</code></pre></div>
<p>Based on the type for possible effects,<sup id="fnref:4"><a class="footnote-ref" href="#fn:4">4</a></sup> the only new aspect for me about engines is
that they record the need for actions to happen at a <em>later time</em>. We already have covered that
engines have a parent; the <code>SpawnEngine</code> effect is the other side of the same coin.
The rest remains the same as before.</p>
<blockquote>
<p>Our actions are restricted by certain pre-conditions, some inherent from the
environment. We only take action if the conditions are met. For engines, these
conditions are expressed as <strong>guards</strong>.<sup id="fnref:5"><a class="footnote-ref" href="#fn:5">5</a></sup></p>
</blockquote>
<p>I got it. This mirrors our situation perfectly. Taking the tax office
example: when I receive a notice to pay taxes, I first assess whether I have the
funds available. If I do, I take action to pay; otherwise, I might postpone the
payment.</p>
<div class="grid">
<blockquote>
<p>The essence of a <strong>guard</strong> is a predicate, a pre-condition, that must hold
true for the engine to take action.</p>
<p>Guards are evaluated based on incoming messages, the engine's environment, and
the engine's configuration. We can represent this with the type <code>Guard</code>. Since
guards involve computation, engine's preserve these computations as part of
the return type of the guard, that is <code>R</code> in the type <code>Guard</code>. Thus, if the
underlying condition is not satisfied, the guard returns nothing. The type
parameter <code>C</code> will be instantiated with the type for values in the engine's
configuration.</p>
</blockquote>
<pre class="highlight"><code class="juvix"><pre class="src-content"><span id="Guard"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#Guard"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#Guard"><span class="ju-function">Guard</span></a></span></a></span></span> <span class="ju-delimiter">(</span><span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:220"><span class="ju-var">S</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:221"><span class="ju-var">M</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:222"><span class="ju-var">C</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:223"><span class="ju-var">R</span></a></span> <span class="ju-keyword">:</span> <span class="ju-keyword">Type</span><span class="ju-delimiter">)</span> <span class="ju-keyword">:</span> <span class="ju-keyword">Type</span> <span class="ju-keyword">:=</span><br/>  <span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/anomian.html#EngineMsg"><span class="ju-inductive">EngineMsg</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:221"><span class="ju-var">M</span></a></span> <span class="ju-keyword">-&gt;</span> <span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/anomian.html#EngineEnv"><span class="ju-inductive">EngineEnv</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:220"><span class="ju-var">S</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:221"><span class="ju-var">M</span></a></span> <span class="ju-keyword">-&gt;</span> <span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/anomian.html#EngineCfg"><span class="ju-inductive">EngineCfg</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:222"><span class="ju-var">C</span></a></span> <span class="ju-keyword">-&gt;</span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/prelude.html#Option"><span class="ju-inductive">Option</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:223"><span class="ju-var">R</span></a></span><span class="ju-delimiter">;</span><br/><br/><span id="isSatisfied"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#isSatisfied"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#isSatisfied"><span class="ju-function">isSatisfied</span></a></span></a></span></span><br/>  <span class="ju-delimiter">{</span><span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:224"><span class="ju-var">S</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:225"><span class="ju-var">M</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:226"><span class="ju-var">C</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:227"><span class="ju-var">R</span></a></span><span class="ju-delimiter">}</span><br/>  <span class="ju-delimiter">(</span><span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:228"><span class="ju-var">guard</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#Guard"><span class="ju-function">Guard</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:224"><span class="ju-var">S</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:225"><span class="ju-var">M</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:226"><span class="ju-var">C</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:227"><span class="ju-var">R</span></a></span><span class="ju-delimiter">)</span><br/>  <span class="ju-delimiter">(</span><span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:229"><span class="ju-var">msg</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/anomian.html#EngineMsg"><span class="ju-inductive">EngineMsg</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:225"><span class="ju-var">M</span></a></span><span class="ju-delimiter">)</span><br/>  <span class="ju-delimiter">(</span><span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:230"><span class="ju-var">env</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/anomian.html#EngineEnv"><span class="ju-inductive">EngineEnv</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:224"><span class="ju-var">S</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:225"><span class="ju-var">M</span></a></span><span class="ju-delimiter">)</span><br/>  <span class="ju-delimiter">(</span><span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:231"><span class="ju-var">cfg</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/anomian.html#EngineCfg"><span class="ju-inductive">EngineCfg</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:226"><span class="ju-var">C</span></a></span><span class="ju-delimiter">)</span><br/>  <span class="ju-keyword">:</span> <span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/Juvix/Builtin/V1/Bool.html#Bool"><span class="ju-inductive">Bool</span></a></span> <span class="ju-keyword">:=</span><br/>  <span class="ju-keyword">case</span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:228"><span class="ju-var">guard</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:229"><span class="ju-var">msg</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:230"><span class="ju-var">env</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:231"><span class="ju-var">cfg</span></a></span> <span class="ju-keyword">of</span><br/>    <span class="ju-keyword">|</span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/prelude.html#none"><span class="ju-constructor">none</span></a></span> <span class="ju-keyword">:=</span> <span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/Juvix/Builtin/V1/Bool.html#Bool.false"><span class="ju-constructor">false</span></a></span><br/>    <span class="ju-keyword">|</span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/prelude.html#some"><span class="ju-constructor">some</span></a></span> <span class="ju-keyword">_</span> <span class="ju-keyword">:=</span> <span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/Juvix/Builtin/V1/Bool.html#Bool.true"><span class="ju-constructor">true</span></a></span><span class="ju-delimiter">;</span></pre>
</code></pre></div>
<p>Wait! I see an issue. What if the engine has several guards, and they are all satisfied?</p>
<div class="grid">
<blockquote>
<p>If several guards are satisfied, engines provide a strategy for how to act.
The model has the following options.</p>
<ul>
<li>Choose the first guard that is satisfied,</li>
<li>choose the last guard that is satisfied,</li>
<li>choose one of them (randomly/non-deterministically) if there are several
  satisfied guards,</li>
<li>check that it is the only one that is triggered, and</li>
<li>choose all of them if all guards are satisfied.</li>
</ul>
<p>And recall, If no guard conditions are met, the engine decides not to act.</p>
</blockquote>
<pre class="highlight"><code class="juvix"><pre class="src-content"><span class="ju-keyword">type</span> <span id="GuardStrategy"><span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/anomian.html#GuardStrategy"><span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/anomian.html#GuardStrategy"><span class="ju-inductive">GuardStrategy</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>  <span class="ju-keyword">|</span> <span id="GuardStrategy.FirstGuard"><span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#GuardStrategy.FirstGuard"><span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#GuardStrategy.FirstGuard"><span class="ju-constructor">FirstGuard</span></a></span></a></span></span><br/>  <span class="ju-keyword">|</span> <span id="GuardStrategy.LastGuard"><span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#GuardStrategy.LastGuard"><span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#GuardStrategy.LastGuard"><span class="ju-constructor">LastGuard</span></a></span></a></span></span><br/>  <span class="ju-keyword">|</span> <span id="GuardStrategy.OneGuard"><span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#GuardStrategy.OneGuard"><span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#GuardStrategy.OneGuard"><span class="ju-constructor">OneGuard</span></a></span></a></span></span><br/>  <span class="ju-keyword">|</span> <span id="GuardStrategy.UniqueGuard"><span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#GuardStrategy.UniqueGuard"><span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#GuardStrategy.UniqueGuard"><span class="ju-constructor">UniqueGuard</span></a></span></a></span></span><br/>  <span class="ju-keyword">|</span> <span id="GuardStrategy.AllGuards"><span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#GuardStrategy.AllGuards"><span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#GuardStrategy.AllGuards"><span class="ju-constructor">AllGuards</span></a></span></a></span></span><span class="ju-delimiter">;</span></pre>
<!--ᚦ «Do we really want OneGuard? Is this maybe something else?» -->
</code></pre></div>
<div class="grid">
<blockquote>
<p>Keep in mind that guards are formally speaking, a predicate with additional
information. If the guards give green light, the engine will act, by means
of <strong>actions</strong>.</p>
</blockquote>
<pre class="highlight"><code class="juvix"><pre class="src-content"><span class="ju-keyword">type</span> <span id="GuardEval"><span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/anomian.html#GuardEval"><span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/anomian.html#GuardEval"><span class="ju-inductive">GuardEval</span></a></span></a></span></span> <span id="anomian:232"><span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:232"><span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:232"><span class="ju-var">S</span></a></span></a></span></span> <span id="anomian:233"><span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:233"><span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:233"><span class="ju-var">M</span></a></span></a></span></span> <span id="anomian:234"><span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:234"><span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:234"><span class="ju-var">C</span></a></span></a></span></span> <span id="anomian:235"><span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:235"><span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:235"><span class="ju-var">R</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>  <span id="GuardEval.mkGuardEval"><span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#GuardEval.mkGuardEval"><span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#GuardEval.mkGuardEval"><span class="ju-constructor">mkGuardEval</span></a></span></a></span></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span><br/>    <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:238"><span class="ju-var">guards</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/Juvix/Builtin/V1/List.html#List"><span class="ju-inductive">List</span></a></span> <span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#Guard"><span class="ju-function"><span class="ju-delimiter">(</span>Guard</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:232"><span class="ju-var">S</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:233"><span class="ju-var">M</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:234"><span class="ju-var">C</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:235"><span class="ju-var">R</span></a></span><span class="ju-delimiter">)</span><span class="ju-delimiter">;</span><br/>    <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:239"><span class="ju-var">strategy</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/anomian.html#GuardStrategy"><span class="ju-inductive">GuardStrategy</span></a></span><span class="ju-delimiter">;</span><br/>  <span class="ju-delimiter">}</span><span class="ju-delimiter">;</span></pre>
</code></pre></div>
<p>Ah, I see! So the guards act as the rules the engine follows, and the actions
are the procedures executed when those rules are satisfied, and with the
possible outcomes of the guards.</p>
<div class="grid">
<blockquote>
<p>We can now define the engine's behaviour as a function that takes in a guard
evaluation and returns an effect.</p>
</blockquote>
<pre class="highlight"><code class="juvix"><pre class="src-content"><span id="EngineBehaviour"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#EngineBehaviour"><span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#EngineBehaviour"><span class="ju-function">EngineBehaviour</span></a></span></a></span></span> <span class="ju-delimiter">(</span><span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:250"><span class="ju-var">S</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:251"><span class="ju-var">E</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:252"><span class="ju-var">M</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:253"><span class="ju-var">C</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:254"><span class="ju-var">R</span></a></span> <span class="ju-keyword">:</span> <span class="ju-keyword">Type</span><span class="ju-delimiter">)</span> <span class="ju-keyword">:</span> <span class="ju-keyword">Type</span> <span class="ju-keyword">:=</span> <span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/anomian.html#GuardEval"><span class="ju-inductive">GuardEval</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:250"><span class="ju-var">S</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:252"><span class="ju-var">M</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:253"><span class="ju-var">C</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:254"><span class="ju-var">R</span></a></span> <span class="ju-keyword">-&gt;</span> <span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/anomian.html#Effect"><span class="ju-inductive">Effect</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:250"><span class="ju-var">S</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:251"><span class="ju-var">E</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:252"><span class="ju-var">M</span></a></span><span class="ju-delimiter">;</span></pre>
</code></pre></div>
<div class="grid">
<blockquote>
<p>With the concept of an engine now complete, it is appropriate to define the
type <code>Engine</code>. An engine is characterised by its configuration, environment,
and behaviour. Recall that <code>S</code> is the state of the engine, <code>E</code> is the environment,
<code>M</code> is the message interface, <code>C</code> is the configuration, and <code>R</code> is the return
type for guards.</p>
</blockquote>
<pre class="highlight"><code class="juvix"><pre class="src-content"><span class="ju-keyword">type</span> <span id="Engine"><span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/anomian.html#Engine"><span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/anomian.html#Engine"><span class="ju-inductive">Engine</span></a></span></a></span></span> <span id="anomian:255"><span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:255"><span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:255"><span class="ju-var"><span class="ju-delimiter">(</span>S</span></a></span></a></span></span> <span id="anomian:256"><span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:256"><span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:256"><span class="ju-var">E</span></a></span></a></span></span> <span id="anomian:257"><span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:257"><span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:257"><span class="ju-var">M</span></a></span></a></span></span> <span id="anomian:258"><span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:258"><span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:258"><span class="ju-var">C</span></a></span></a></span></span> <span id="anomian:259"><span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:259"><span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:259"><span class="ju-var">R</span></a></span></a></span></span> <span class="ju-keyword">:</span> <span class="ju-keyword">Type</span><span class="ju-delimiter">)</span> <span class="ju-keyword">:=</span><br/>  <span id="Engine.mk"><span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#Engine.mk"><span class="annot"><a class="ju-code-link ju-constructor" href="https://specs.anoma.net/pr-381/anomian.html#Engine.mk"><span class="ju-constructor">mk</span></a></span></a></span></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span><br/>    <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:264"><span class="ju-var">status</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/anomian.html#EngineStatus"><span class="ju-inductive">EngineStatus</span></a></span><span class="ju-delimiter">;</span><br/>    <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:265"><span class="ju-var">cfg</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/anomian.html#EngineCfg"><span class="ju-inductive">EngineCfg</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:258"><span class="ju-var">C</span></a></span><span class="ju-delimiter">;</span><br/>    <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:266"><span class="ju-var">state</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a class="ju-code-link ju-inductive" href="https://specs.anoma.net/pr-381/anomian.html#EngineEnv"><span class="ju-inductive">EngineEnv</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:255"><span class="ju-var">S</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:257"><span class="ju-var">M</span></a></span><span class="ju-delimiter">;</span><br/>    <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:267"><span class="ju-var">behavior</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a class="ju-code-link ju-function" href="https://specs.anoma.net/pr-381/anomian.html#EngineBehaviour"><span class="ju-function">EngineBehaviour</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:255"><span class="ju-var">S</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:256"><span class="ju-var">E</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:257"><span class="ju-var">M</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:258"><span class="ju-var">C</span></a></span> <span class="annot"><a class="ju-code-link ju-var" href="https://specs.anoma.net/pr-381/anomian.html#anomian:259"><span class="ju-var">R</span></a></span><span class="ju-delimiter">;</span><br/>  <span class="ju-delimiter">}</span><span class="ju-delimiter">;</span></pre>
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">What engines do</p>
<p>Engines react to incoming messages, taking into account their environment.
How they react is governed by guards of which the engine has several,
roughly one per relevant case. Cases may overlap, but often it is a unique case that
performs the reaction.</p>
</div>
<h2 id="chapter-7-we-have-engines-and-now-what">Chapter 7: We have engines, and now, what?<a class="headerlink" href="#chapter-7-we-have-engines-and-now-what" title="Anchor link to this section for reference">¶</a></h2>
<p>I think I am getting the hang of it. But what's next?</p>
<blockquote>
<p>Yes, I think we have made a good start. However, we have to fill in the
blanks and put everything together in a single system. In the upcoming
chapters, how the system looks like in more detail and how ensure the
following properties for engine-to-engine communication:</p>
</blockquote>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input checked="" type="checkbox"><span class="task-list-indicator"></span></input></label> Message delivery: All messages are eventually delivered</li>
<li class="task-list-item"><label class="task-list-control"><input checked="" type="checkbox"><span class="task-list-indicator"></span></input></label> Engine isolation: Each engine maintains independent state</li>
<li class="task-list-item"><label class="task-list-control"><input checked="" type="checkbox"><span class="task-list-indicator"></span></input></label> Type safety: All communication follows defined message interfaces</li>
<li class="task-list-item"><label class="task-list-control"><input checked="" type="checkbox"><span class="task-list-indicator"></span></input></label> Configuration immutability: Engine configurations cannot be modified after
  creation</li>
</ul>
<blockquote>
<p>A quick glossary of the terms we have seen so far.</p>
</blockquote>
<ul>
<li><strong>EngineStatus</strong>: Represents the possible states an engine can be
   in—<code>Running</code>, <code>Dead</code>, or <code>Suspended</code>.</li>
</ul>
<ul>
<li><strong>CommunicationPattern</strong>: Enumerates the types of communication patterns
   available, such as <code>FireAndForget</code>, <code>RequestReply</code> with an optional
   timeout, and <code>PubSub</code>.</li>
</ul>
<ul>
<li><strong>EngineMsgKind</strong>: Categorizes messages into <code>Request</code>, <code>Reply</code>, or
   <code>Notify</code>.</li>
</ul>
<ul>
<li><strong>EngineID</strong>: A composite identifier for engines, consisting of a <code>nodeId</code>
  and a <code>name</code>.</li>
</ul>
<ul>
<li><strong>MessageInterface</strong>: Defines the interface for messages specific to
   different engines (<code>AnomianMsgInterface</code>, <code>JordanMsgInterface</code>) and
   aggregates them into a general <code>MsgInterface</code>.</li>
</ul>
<ul>
<li><strong>EngineCfg</strong>: An immutable configuration for an engine, including optional
   parent information, engine name, node ID, and a generic configuration type
   <code>c</code>.</li>
</ul>
<ul>
<li><strong>Mailbox and MailboxCluster</strong>: Structure for message queues (<code>Mailbox</code>) and
   a collection of mailboxes (<code>MailboxCluster</code>) indexed by <code>MailboxID</code>.</li>
</ul>
<ul>
<li><strong>EngineEnv</strong>: The execution context of an engine, comprising its state,
   mailbox cluster, and an address book of known engines.</li>
</ul>
<ul>
<li><strong>Guard and GuardStrategy</strong>: Mechanisms to evaluate whether certain
  conditions are met (<code>Guard</code>) and strategies to handle multiple satisfied
  guards (<code>GuardStrategy</code>).</li>
</ul>
<ul>
<li><strong>Effect</strong>: The possible outcomes or actions an engine can perform, such as
  sending messages, updating state, spawning new engines, chaining effects, or
  scheduling future actions.</li>
</ul>
<ul>
<li><strong>EngineBehaviour</strong>: A function defining how an engine responds to evaluated
  guards and decides on an effect.</li>
</ul>
<ul>
<li><strong>Engine</strong>: The core representation of an engine, combining its status,
  configuration, state, and behaviour.</li>
</ul>
<ul>
<li><strong>EngineMsg</strong>: Structure of messages exchanged between engines, including
  sender and target identifiers, mailbox, communication pattern, message kind,
  and the message content itself.</li>
</ul>
<!-- list_wikilinks -->
<div class="footnote">
<hr/>
<ol>
<li id="fn:1">
<p>The constructors are very much like <em>message tags</em> in
  <a href="https://simonjf.com/writing/pat.pdf">the paper</a>
<sup id="fnref2:special-delivery-mailbox-types-2023"><a class="footnote-ref" href="#fn:special-delivery-mailbox-types-2023">6</a></sup>. <a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
<li id="fn:2">
<p>These engines roughly correspond to the <em>primeval</em> actors of Clinger <sup id="fnref:clinger1981"><a class="footnote-ref" href="#fn:clinger1981">7</a></sup>. <a class="footnote-backref" href="#fnref:2" title="Jump back to footnote 2 in the text">↩</a></p>
</li>
<li id="fn:3">
<p>See <sup id="fnref:special-delivery-mailbox-types-2023"><a class="footnote-ref" href="#fn:special-delivery-mailbox-types-2023">6</a></sup> for the paradigmatic example. <a class="footnote-backref" href="#fnref:3" title="Jump back to footnote 3 in the text">↩</a></p>
</li>
<li id="fn:4">
<p>Yes, we can do fancy monads for effects, but that's for a future version. <a class="footnote-backref" href="#fnref:4" title="Jump back to footnote 4 in the text">↩</a></p>
</li>
<li id="fn:5">
<p>This is in analogy to Dijkstra's <a href="https://en.wikipedia.org/wiki/Guarded_Command_Language">Guarded Command Language</a>. <a class="footnote-backref" href="#fnref:5" title="Jump back to footnote 5 in the text">↩</a></p>
</li>
<li id="fn:special-delivery-mailbox-types-2023">
<p>Simon Fowler, Duncan Paul Attard, Franciszek Sowul, Simon J. Gay, and Phil Trinder. Special delivery: programming with mailbox types. <em>Proceedings of the ACM on Programming Languages</em>, 7(ICFP):78–107, August 2023. URL: <a href="http://dx.doi.org/10.1145/3607832">http://dx.doi.org/10.1145/3607832</a>, <a href="https://doi.org/10.1145/3607832">doi:10.1145/3607832</a>. <a class="footnote-backref" href="#fnref:special-delivery-mailbox-types-2023" title="Jump back to footnote 6 in the text">↩</a><a class="footnote-backref" href="#fnref2:special-delivery-mailbox-types-2023" title="Jump back to footnote 6 in the text">↩</a></p>
</li>
<li id="fn:clinger1981">
<p>William Douglas Clinger. <em>Foundations of Actor Semantics</em>. PhD thesis, Massachusetts Institute of Technology (MIT), 1981. URL: <a href="https://dspace.mit.edu/handle/1721.1/6935">https://dspace.mit.edu/handle/1721.1/6935</a>. <a class="footnote-backref" href="#fnref:clinger1981" title="Jump back to footnote 7 in the text">↩</a></p>
</li>
</ol>
</div>
<!-- Source file information -->
<!-- Was this page helpful? -->
<form class="md-feedback" hidden="" name="feedback">
<fieldset>
<legend class="md-feedback__title">
        Was this page helpful?
      </legend>
<div class="md-feedback__inner">
<div class="md-feedback__list">
<button class="md-feedback__icon md-icon" data-md-value="1" title="This page was helpful" type="submit">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m12 21.35-1.45-1.32C5.4 15.36 2 12.27 2 8.5 2 5.41 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.08C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.41 22 8.5c0 3.77-3.4 6.86-8.55 11.53z"></path></svg>
</button>
<button class="md-feedback__icon md-icon" data-md-value="0" title="This page could be improved" type="submit">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m12 21.35-1.45-1.32C5.4 15.36 2 12.27 2 8.5 2 5.41 4.42 3 7.5 3c.67 0 1.32.12 1.94.33L13 9.35l-4 5zM16.5 3C19.58 3 22 5.41 22 8.5c0 3.77-3.4 6.86-8.55 11.53L12 21.35l-1-7 4.5-5-2.65-5.08C13.87 3.47 15.17 3 16.5 3"></path></svg>
</button>
</div>
<div class="md-feedback__note">
<div data-md-value="1" hidden="">
              
              
                
              
              
              
                
                
              
              Thanks for your feedback!
            </div>
<div data-md-value="0" hidden="">
              
              
                
              
              
              
                
                
              
              Thanks for your feedback! We'll try to improve this page in the future.
            </div>
</div>
</div>
</fieldset>
</form>
<!-- Comment system -->
</article>
</div>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
</main>
<footer class="md-footer">
<nav aria-label="Footer" class="md-footer__inner md-grid">
<a aria-label="Previous: Ethereum Virtual Machine" class="md-footer__link md-footer__link--prev" href="arch/integrations/adapters/evm.html">
<div class="md-footer__button md-icon">
<svg viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M7.78 12.53a.75.75 0 0 1-1.06 0L2.47 8.28a.75.75 0 0 1 0-1.06l4.25-4.25a.75.75 0 0 1 1.042.018.75.75 0 0 1 .018 1.042L4.81 7h7.44a.75.75 0 0 1 0 1.5H4.81l2.97 2.97a.75.75 0 0 1 0 1.06"></path></svg>
</div>
<div class="md-footer__title">
<span class="md-footer__direction">
                Previous
              </span>
<div class="md-ellipsis">
                Ethereum Virtual Machine
              </div>
</div>
</a>
<a aria-label="Next: Global principles and guidelines" class="md-footer__link md-footer__link--next" href="tutorial/principles_and_guidelines.html">
<div class="md-footer__title">
<span class="md-footer__direction">
                Next
              </span>
<div class="md-ellipsis">
                Global principles and guidelines
              </div>
</div>
<div class="md-footer__button md-icon">
<svg viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M8.22 2.97a.75.75 0 0 1 1.06 0l4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.75.75 0 0 1-1.042-.018.75.75 0 0 1-.018-1.042l2.97-2.97H3.75a.75.75 0 0 1 0-1.5h7.44L8.22 4.03a.75.75 0 0 1 0-1.06"></path></svg>
</div>
</a>
</nav>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
<div class="md-copyright__highlight">
      Powered by Mkdocs, Poetry , Material 9.6.12-insiders-4.53.16 and Juvix v0.6.10
    </div>
<strong>Version: (PR381 - fix/snake-case-filenames-hook-8c27d9e1) - Updated: June 03,
    2025 at 05:25 AM UTC</strong>
<br/>
<strong>Latest version: <a href="https://specs.anoma.net/latest">
    https://specs.anoma.net/latest</a></strong>
<br/>
<strong>Development version: <a href="https://specs.anoma.net/main">
    https://specs.anoma.net/main</a></strong>
<br/>
<strong>Anoma Official Resources:</strong>
<small> <a href="https://anoma.net/" target="_blank">Website</a> | <a href="https://art.anoma.net" target="_blank">Research</a> | <a href="https://anoma.net/blog" target="_blank">Blog</a> | <a href="https://anoma.net/talks" target="_blank">Talks</a> </small>
<br/>
<strong>For Specification Authors:</strong>
<small>
<a href="https://specs.anoma.net/pr-381/indexes/tags.html">Tags</a>
    | <a href="https://specs.anoma.net/pr-381/indexes/links.html">Quick links</a>
    | <a href="https://specs.anoma.net/pr-381/indexes/juvix_modules.html">Juvix modules</a>
    | <a href="https://specs.anoma.net/pr-381/tutorial/index.html">Guides</a>
</small>
</div>
<div class="md-social">
<a class="md-social__link" href="https://x.com/anoma" rel="noopener" target="_blank" title="x.com">
<svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8l164.9-188.5L26.8 48h145.6l100.5 132.9zm-24.8 373.8h39.1L151.1 88h-42z"></path></svg>
</a>
<a class="md-social__link" href="https://github.com/anoma" rel="noopener" target="_blank" title="github.com">
<svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg>
</a>
<a class="md-social__link" href="https://anoma.net/blog" rel="noopener" target="_blank" title="anoma.net">
<svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M192 32c0 17.7 14.3 32 32 32 123.7 0 224 100.3 224 224 0 17.7 14.3 32 32 32s32-14.3 32-32C512 128.9 383.1 0 224 0c-17.7 0-32 14.3-32 32m0 96c0 17.7 14.3 32 32 32 70.7 0 128 57.3 128 128 0 17.7 14.3 32 32 32s32-14.3 32-32c0-106-86-192-192-192-17.7 0-32 14.3-32 32m-96 16c0-26.5-21.5-48-48-48S0 117.5 0 144v224c0 79.5 64.5 144 144 144s144-64.5 144-144-64.5-144-144-144h-16v96h16c26.5 0 48 21.5 48 48s-21.5 48-48 48-48-21.5-48-48z"></path></svg>
</a>
<a class="md-social__link" href="https://research.anoma.net" rel="noopener" target="_blank" title="research.anoma.net">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M225.9 32C103.3 32 0 130.5 0 252.1 0 256 .1 480 .1 480l225.8-.2c122.7 0 222.1-102.3 222.1-223.9S348.6 32 225.9 32M224 384c-19.4 0-37.9-4.3-54.4-12.1L88.5 392l22.9-75c-9.8-18.1-15.4-38.9-15.4-61 0-70.7 57.3-128 128-128s128 57.3 128 128-57.3 128-128 128"></path></svg>
</a>
<a class="md-social__link" href="https://youtube.com/anoma" rel="noopener" target="_blank" title="youtube.com">
<svg viewbox="0 0 576 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305m-317.51 213.508V175.185l142.739 81.205z"></path></svg>
</a>
<a class="md-social__link" href="mailto:arts@heliax.dev" rel="noopener" target="_blank" title="">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m20 8-8 5-8-5V6l8 5 8-5m0-2H4c-1.11 0-2 .89-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2"></path></svg>
</a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"annotate": null, "base": ".", "features": ["announce.dismiss", "content.code.annotate", "content.code.copy", "content.tooltips", "content.action.edit", "content.action.view", "search.highlight", "search.suggest", "search.sharing", "navigation.instant.preview", "navigation.tracking", "navigation.prune", "navigation.indexes", "navigation.sections", "navigation.footer", "navigation.path", "toc.follow"], "search": "assets/javascripts/workers/search.c7c1ca2c.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
<script src="assets/javascripts/bundle.f807c082.min.js"></script>
<script src="assets/js/extra.js"></script>
<script src="assets/js/highlight.js"></script>
<script src="assets/js/mathjax.js"></script>
<script src="assets/js/tex-svg-full.js"></script>
<script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>