
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="The Anoma specs is a collection of documents that describe the architecture, design, and implementation of the Anoma Network." name="description"/>
<meta content="Anoma Foundation" name="author"/>
<link href="https://specs.anoma.net/pr-355/arch/node/integration/simulator.juvix.html" rel="canonical"/>
<link href="../../../assets/logo.svg" rel="icon"/>
<meta content="mkdocs-1.6.1, mkdocs-material-9.6.12" name="generator"/>
<title>Engine Simulator - Anoma specs</title>
<link href="../../../assets/stylesheets/main.2afb09e1.min.css" rel="stylesheet"/>
<link href="../../../assets/stylesheets/palette.06af60db.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Inter";--md-code-font:"JetBrains Mono"}</style>
<link href="../../../assets/css/juvix-material-style.css" rel="stylesheet"/>
<link href="../../../assets/css/juvix-highlighting.css" rel="stylesheet"/>
<link href="../../../assets/css/juvix_codeblock_footer.css" rel="stylesheet"/>
<link href="../../../assets/css/latte-light.css" rel="stylesheet"/>
<link href="../../../assets/css/extra.css" rel="stylesheet"/>
<script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
<link href="../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../../assets/javascripts/glightbox.min.js"></script></link></head>
<body data-md-color-accent="indigo" data-md-color-primary="white" data-md-color-scheme="default" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#engine-simulator">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
<aside class="md-banner">
<div class="md-banner__inner md-grid md-typeset">
<button aria-label="Don't show this again" class="md-banner__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
</button>
            
            
  For updates follow <strong>@anoma</strong> on
  <a href="https://x.com/anoma" rel="me">
<span class="twemoji x-twitter">
<svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8l164.9-188.5L26.8 48h145.6l100.5 132.9zm-24.8 373.8h39.1L151.1 88h-42z"></path></svg>
</span>
<strong></strong>
</a>
  and discuss on our
  <a href="https://research.anoma.net">
<span class="twemoji discourse">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M225.9 32C103.3 32 0 130.5 0 252.1 0 256 .1 480 .1 480l225.8-.2c122.7 0 222.1-102.3 222.1-223.9S348.6 32 225.9 32M224 384c-19.4 0-37.9-4.3-54.4-12.1L88.5 392l22.9-75c-9.8-18.1-15.4-38.9-15.4-61 0-70.7 57.3-128 128-128s128 57.3 128 128-57.3 128-128 128"></path></svg>
</span>
<strong>forum</strong>
</a>
</div>
<script>var el=document.querySelector("[data-md-component=announce]");if(el){var content=el.querySelector(".md-typeset");__md_hash(content.innerHTML)===__md_get("__announce")&&(el.hidden=!0)}</script>
</aside>
</div>
<header class="md-header md-header--shadow" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="Anoma specs" class="md-header__button md-logo" data-md-component="logo" href="../../../index.html" title="Anoma specs">
<img alt="logo" src="../../../assets/logo.svg"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
<span class="first-letter">A</span>noma 
              
                <span class="first-letter">s</span>pecs
              
              
                <span class="md-header__topic-version">(PR 355)</span>
</span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
              
                Engine Simulator
              
            </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Switch to light mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme)" data-md-color-primary="white" data-md-color-scheme="default" id="__palette_0" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to light mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"></path></svg>
</label>
<input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="red" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="white" data-md-color-scheme="default" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_2" hidden="" title="Switch to dark mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
</label>
<input aria-label="Switch to system preference" class="md-option" data-md-color-accent="red" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="black" data-md-color-scheme="slate" id="__palette_2" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_0" hidden="" title="Switch to system preference">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
</label>
</form>
<script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M10.68 11.74a6 6 0 0 1-7.922-8.982 6 6 0 0 1 8.982 7.922l3.04 3.04a.749.749 0 0 1-.326 1.275.75.75 0 0 1-.734-.215ZM11.5 7a4.499 4.499 0 1 0-8.997 0A4.499 4.499 0 0 0 11.5 7"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M10.68 11.74a6 6 0 0 1-7.922-8.982 6 6 0 0 1 8.982 7.922l3.04 3.04a.749.749 0 0 1-.326 1.275.75.75 0 0 1-.734-.215ZM11.5 7a4.499 4.499 0 1 0-8.997 0A4.499 4.499 0 0 0 11.5 7"></path></svg>
<svg viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M7.78 12.53a.75.75 0 0 1-1.06 0L2.47 8.28a.75.75 0 0 1 0-1.06l4.25-4.25a.75.75 0 0 1 1.042.018.75.75 0 0 1 .018 1.042L4.81 7h7.44a.75.75 0 0 1 0 1.5H4.81l2.97 2.97a.75.75 0 0 1 0 1.06"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
</button>
</nav>
<div class="md-search__suggest" data-md-component="search-suggest"></div>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="" tabindex="0">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/anoma/nspec" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg>
</div>
<div class="md-source__repository">
    anoma/nspec
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<!--
  This is a modified version of the original mkdocs-material theme.
  Copyright (c) 2016-2025 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->
<!-- Determine classes -->
<!-- Navigation -->
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<!-- Site title -->
<label class="md-nav__title" for="__drawer">
<a aria-label="Anoma specs" class="md-nav__button md-logo" data-md-component="logo" href="../../../index.html" title="Anoma specs">
<img alt="logo" src="../../../assets/logo.svg"/>
</a>
    Anoma specs
  </label>
<!-- List of Versions -->
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="https://specs.anoma.net/latest" target="_blank">
     Latest version ((PR 355))
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="https://specs.anoma.net/main">
        Development version
      </a>
</li>
</ul>
<!-- Navigation list -->
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../index.html">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"></path></svg>
<span class="md-ellipsis">
    Home
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../changelog.html">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 21.5c-1.35-.85-3.8-1.5-5.5-1.5-1.65 0-3.35.3-4.75 1.05-.1.05-.15.05-.25.05-.25 0-.5-.25-.5-.5V6c.6-.45 1.25-.75 2-1 1.11-.35 2.33-.5 3.5-.5 1.95 0 4.05.4 5.5 1.5 1.45-1.1 3.55-1.5 5.5-1.5 1.17 0 2.39.15 3.5.5.75.25 1.4.55 2 1v14.6c0 .25-.25.5-.5.5-.1 0-.15 0-.25-.05-1.4-.75-3.1-1.05-4.75-1.05-1.7 0-4.15.65-5.5 1.5M12 8v11.5c1.35-.85 3.8-1.5 5.5-1.5 1.2 0 2.4.15 3.5.5V7c-1.1-.35-2.3-.5-3.5-.5-1.7 0-4.15.65-5.5 1.5m1 3.5c1.11-.68 2.6-1 4.5-1 .91 0 1.76.09 2.5.28V9.23c-.87-.15-1.71-.23-2.5-.23q-2.655 0-4.5.84zm4.5.17c-1.71 0-3.21.26-4.5.79v1.69c1.11-.65 2.6-.99 4.5-.99 1.04 0 1.88.08 2.5.24v-1.5c-.87-.16-1.71-.23-2.5-.23m2.5 2.9c-.87-.16-1.71-.24-2.5-.24-1.83 0-3.33.27-4.5.8v1.69c1.11-.66 2.6-.99 4.5-.99 1.04 0 1.88.08 2.5.24z"></path></svg>
<span class="md-ellipsis">
    Changelog
    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
<span class="md-ellipsis">
    Indexes
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
            Indexes
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../indexes/tags.html">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M5.5 7A1.5 1.5 0 0 1 4 5.5 1.5 1.5 0 0 1 5.5 4 1.5 1.5 0 0 1 7 5.5 1.5 1.5 0 0 1 5.5 7m15.91 4.58-9-9C12.05 2.22 11.55 2 11 2H4c-1.11 0-2 .89-2 2v7c0 .55.22 1.05.59 1.41l8.99 9c.37.36.87.59 1.42.59s1.05-.23 1.41-.59l7-7c.37-.36.59-.86.59-1.41 0-.56-.23-1.06-.59-1.42"></path></svg>
<span class="md-ellipsis">
    List of tags
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../indexes/modules.html">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 10h-2V8h2m0 5h-2v-2h2m-3-1h-2V8h2m0 5h-2v-2h2m0 6H8v-2h8m-9-5H5V8h2m0 5H5v-2h2m1 0h2v2H8m0-5h2v2H8m3 1h2v2h-2m0-5h2v2h-2m9-5H4c-1.11 0-2 .89-2 2v10a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2"></path></svg>
<span class="md-ellipsis">
    List of modules
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../prelude.html">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M6 2a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6zm0 2h7v5h5v11H6zm2 8v2h8v-2zm0 4v2h5v-2z"></path></svg>
<span class="md-ellipsis">
    List of basic types
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
<span class="md-ellipsis">
    Introduction
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
            Introduction
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../anomian.html">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 3C6.5 3 2 6.6 2 11c0 2.1 1 4.1 2.8 5.5 0 .6-.4 2.2-2.8 4.5 0 0 3.5 0 6.5-2.5 1.1.3 2.3.5 3.5.5 5.5 0 10-3.6 10-8s-4.5-8-10-8m1 12h-2v-2h2zm1.8-5c-.3.4-.7.6-1.1.8-.3.2-.4.3-.5.5-.2.2-.2.4-.2.7h-2c0-.5.1-.8.3-1.1.2-.2.6-.5 1.1-.8.3-.1.5-.3.6-.5s.2-.5.2-.7c0-.3-.1-.5-.3-.7s-.5-.3-.8-.3-.5.1-.7.2q-.3.15-.3.6h-2c.1-.7.4-1.3.9-1.7s1.2-.5 2.1-.5 1.7.2 2.2.6.8 1 .8 1.7q.15.6-.3 1.2"></path></svg>
<span class="md-ellipsis">
    Anomian
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../overview.html">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M24 18.714v4.8c0 .288-.192.48-.48.48h-4.8c-.288 0-.48-.192-.48-.48v-4.8c0-.288.192-.48.48-.48h1.92v-1.92h-8.16v1.92h1.92c.288 0 .48.192.48.48v4.8c0 .288-.192.48-.48.48H9.6c-.288 0-.48-.192-.48-.48v-4.8c0-.288.192-.48.48-.48h1.92v-1.92H3.36v1.92h1.92c.288 0 .48.192.48.48v4.8c0 .288-.192.48-.48.48H.48c-.288 0-.48-.192-.48-.48v-4.8c0-.288.192-.48.48-.48H2.4v-2.4c0-.288.192-.48.48-.48h8.64v-1.44h.96v1.44h8.64c.288 0 .48.192.48.48v2.4h1.92c.288 0 .48.192.48.48m-13.92 4.32h3.84v-3.84h-3.84zm-9.12 0H4.8v-3.84H.96Zm18.24 0h3.84v-3.84H19.2ZM6.24 9.642V3.546c0-.192.096-.336.24-.432L11.76.042a.8.8 0 0 1 .48 0l5.28 3.072c.144.096.24.24.24.432v6.096c0 .144-.096.288-.24.384l-5.28 3.072q-.096.048-.24.048t-.24-.048l-5.28-3.072c-.144-.096-.24-.24-.24-.384m10.56-.288V4.362l-4.32 2.496v4.992zm-9.6 0 4.32 2.496V6.858L7.2 4.362Zm.48-5.808L12 5.994l4.32-2.448L12 1.05Z"></path></svg>
<span class="md-ellipsis">
    Anoma architecture
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
<span class="md-ellipsis">
    Node architecture
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_5_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_5">
<span class="md-nav__icon md-icon"></span>
            Node architecture
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../concepts/engine.html">
<span class="md-ellipsis">
    Concepts
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../types/anoma_message.html">
<span class="md-ellipsis">
    Types
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../subsystems/hardware.html">
<span class="md-ellipsis">
    Subsystems
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
<span class="md-ellipsis">
    System architecture
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_6_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_6">
<span class="md-nav__icon md-icon"></span>
            System architecture
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../system/identity/identity.html">
<span class="md-ellipsis">
    Identity Architecture
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../system/state/resource_machine/index.html">
<span class="md-ellipsis">
    State Architecture
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_7" type="checkbox"/>
<label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="">
<span class="md-ellipsis">
    Tutorials
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_7_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_7">
<span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../../tutorial/principles_and_guidelines.html">
<span class="md-ellipsis">
    Contributor guidelines
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<!--
  This is a modified version of the original mkdocs-material theme.
  Copyright (c) 2016-2025 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->
<!-- Tags -->
<nav class="md-tags">
<a class="md-tag" href="../../../indexes/tags.html#tag:engine">engine</a>
<a class="md-tag" href="../../../indexes/tags.html#tag:simulator">simulator</a>
<a class="md-tag" href="../../../indexes/tags.html#tag:work-in-progress">work-in-progress</a>
</nav>
<!-- Actions -->
<!--
  Copyright (c) 2016-2025 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->
<!-- Actions -->
<!-- Edit button -->
<a class="md-content__button md-icon" href="https://github.com/anoma/nspec/edit/main/docs/arch/node/integration/simulator.juvix.md" title="Edit this page">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M6 2c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-1.9l10-10V8l-6-6zm7 1.5L18.5 9H13zm7.1 9.5c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-2 1.8L12 20.9V23h2.1l6.1-6.1z"></path></svg>
</a>
<!-- View button -->
<a class="md-content__button md-icon" href="https://github.com/anoma/nspec/raw/main/docs/arch/node/integration/simulator.juvix.md" title="View source of this page">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20.56 18H3.44C2.65 18 2 17.37 2 16.59V7.41C2 6.63 2.65 6 3.44 6h17.12c.79 0 1.44.63 1.44 1.41v9.18c0 .78-.65 1.41-1.44 1.41M6.81 15.19v-3.66l1.92 2.35 1.92-2.35v3.66h1.93V8.81h-1.93l-1.92 2.35-1.92-2.35H4.89v6.38zM19.69 12h-1.92V8.81h-1.92V12h-1.93l2.89 3.28z"></path></svg>
</a>
<!-- If the page source ends with .juvix.md, we show a button to view the raw code -->
<a class="md-content__button md-icon" href="arch/node/integration/simulator-src.html" title="View Raw Juvix Code">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M8 3a2 2 0 0 0-2 2v4a2 2 0 0 1-2 2H3v2h1a2 2 0 0 1 2 2v4a2 2 0 0 0 2 2h2v-2H8v-5a2 2 0 0 0-2-2 2 2 0 0 0 2-2V5h2V3m6 0a2 2 0 0 1 2 2v4a2 2 0 0 0 2 2h1v2h-1a2 2 0 0 0-2 2v4a2 2 0 0 1-2 2h-2v-2h2v-5a2 2 0 0 1 2-2 2 2 0 0 1-2-2V5h-2V3z"></path></svg>
</a>
<!--
  Hack: check whether the content contains a h1 headline. If it doesn't, the
  page title (or respectively site name) is used as the main headline.
-->
<!-- Page content -->
<h1 id="engine-simulator">Engine Simulator<a class="headerlink" href="#engine-simulator" title="Anchor link to this section for reference">Â¶</a></h1>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-0-1">module arch.node.integration.simulator;
</span><span id="__ispan-0-2">
</span><span id="__ispan-0-3">import prelude open;
</span><span id="__ispan-0-4">open OMap;
</span><span id="__ispan-0-5">import arch.node.types.basics open public;
</span><span id="__ispan-0-6">import arch.node.types.messages open public;
</span><span id="__ispan-0-7">import arch.node.types.identities open;
</span><span id="__ispan-0-8">import arch.node.types.engine_config open public;
</span><span id="__ispan-0-9">import arch.node.types.engine_environment open;
</span><span id="__ispan-0-10">import arch.node.types.engine_behaviour open;
</span><span id="__ispan-0-11">import arch.node.types.engine open public;
</span><span id="__ispan-0-12">import arch.node.types.anoma_engines open;
</span><span id="__ispan-0-13">import arch.node.types.anoma_message open;
</span><span id="__ispan-0-14">import arch.node.types.anoma_config open;
</span><span id="__ispan-0-15">import arch.node.types.anoma_environment open;
</span><span id="__ispan-0-16">
</span><span id="__ispan-0-17">-- Type for message selection strategy
</span><span id="__ispan-0-18">MessageSelector : Type :=
</span><span id="__ispan-0-19">  (messages : List (EngineMsg Msg)) -&gt;
</span><span id="__ispan-0-20">  Option (Pair (EngineMsg Msg) (List (EngineMsg Msg)));
</span><span id="__ispan-0-21">
</span><span id="__ispan-0-22">-- Example selector that takes the first message in the list
</span><span id="__ispan-0-23">selectFirstMessage (messages : List (EngineMsg Msg)) : Option (Pair (EngineMsg Msg) (List (EngineMsg Msg))) :=
</span><span id="__ispan-0-24">  case messages of {
</span><span id="__ispan-0-25">    | [] := none
</span><span id="__ispan-0-26">    | msg :: rest := some (mkPair msg rest)
</span><span id="__ispan-0-27">  };
</span><span id="__ispan-0-28">
</span><span id="__ispan-0-29">-- Node type that contains a map from engine names to engines
</span><span id="__ispan-0-30">type Node := mkNode@{
</span><span id="__ispan-0-31">  engines : OMap EngineName Eng;
</span><span id="__ispan-0-32">};
</span><span id="__ispan-0-33">
</span><span id="__ispan-0-34">-- Network state contains all nodes, in-transit messages, and current time
</span><span id="__ispan-0-35">type NetworkState := mkNetworkState@{
</span><span id="__ispan-0-36">  nodes : OMap NodeID Node;
</span><span id="__ispan-0-37">  messages : List (EngineMsg Msg);
</span><span id="__ispan-0-38">  currentTime : Time;
</span><span id="__ispan-0-39">  incrementId : NodeID -&gt; NodeID;
</span><span id="__ispan-0-40">  nextId : NodeID;
</span><span id="__ispan-0-41">};
</span><span id="__ispan-0-42">
</span><span id="__ispan-0-43">-- Helper function to execute a guard output
</span><span id="__ispan-0-44">executeGuardOutput
</span><span id="__ispan-0-45">  {C S B H A AM AC AE : Type}
</span><span id="__ispan-0-46">  (output : GuardOutput C S B H A AM AC AE)
</span><span id="__ispan-0-47">  (eng : Engine C S B H A AM AC AE)
</span><span id="__ispan-0-48">  (trigger : TimestampedTrigger H AM)
</span><span id="__ispan-0-49">  : Option (ActionEffect S B H AM AC AE) :=
</span><span id="__ispan-0-50">  case output of {
</span><span id="__ispan-0-51">    | GuardOutput.mk@{action := ActionExec.Seq actions; args := args} :=
</span><span id="__ispan-0-52">      let
</span><span id="__ispan-0-53">        -- Execute each action in sequence
</span><span id="__ispan-0-54">        terminating
</span><span id="__ispan-0-55">        executeAction (acts : List (Action C S B H A AM AC AE)) (currentEnv : EngineEnv S B H AM) : Option (ActionEffect S B H AM AC AE) :=
</span><span id="__ispan-0-56">          case acts of {
</span><span id="__ispan-0-57">            | [] := none
</span><span id="__ispan-0-58">            | act :: rest :=
</span><span id="__ispan-0-59">              case act (ActionInput.mk@{
</span><span id="__ispan-0-60">                args := args;
</span><span id="__ispan-0-61">                cfg := Engine.cfg eng;
</span><span id="__ispan-0-62">                env := currentEnv;
</span><span id="__ispan-0-63">                trigger := trigger
</span><span id="__ispan-0-64">              }) of {
</span><span id="__ispan-0-65">                | none := executeAction rest currentEnv
</span><span id="__ispan-0-66">                | some effect :=
</span><span id="__ispan-0-67">                  case executeAction rest (ActionEffect.env effect) of {
</span><span id="__ispan-0-68">                    | none := some effect
</span><span id="__ispan-0-69">                    | some nextEffect := some ActionEffect.mk@{
</span><span id="__ispan-0-70">                        env := ActionEffect.env nextEffect;
</span><span id="__ispan-0-71">                        msgs := ActionEffect.msgs effect ++ ActionEffect.msgs nextEffect;
</span><span id="__ispan-0-72">                        timers := ActionEffect.timers effect ++ ActionEffect.timers nextEffect;
</span><span id="__ispan-0-73">                        engines := ActionEffect.engines effect ++ ActionEffect.engines nextEffect
</span><span id="__ispan-0-74">                      }
</span><span id="__ispan-0-75">                  }
</span><span id="__ispan-0-76">              }
</span><span id="__ispan-0-77">          };
</span><span id="__ispan-0-78">      in executeAction actions (Engine.env eng)
</span><span id="__ispan-0-79">  };
</span><span id="__ispan-0-80">
</span><span id="__ispan-0-81">-- Helper function to evaluate guards and execute actions for a specific engine type
</span><span id="__ispan-0-82">terminating
</span><span id="__ispan-0-83">evaluateAndExecute
</span><span id="__ispan-0-84">  {C S B H A AM AC AE : Type}
</span><span id="__ispan-0-85">  (eng : Engine C S B H A AM AC AE)
</span><span id="__ispan-0-86">  (msg : EngineMsg AM)
</span><span id="__ispan-0-87">  : Option (Pair (List (EngineMsg AM)) (Pair (List (Pair AC AE)) (Engine C S B H A AM AC AE))) :=
</span><span id="__ispan-0-88">  let
</span><span id="__ispan-0-89">    -- Create a trigger from the message
</span><span id="__ispan-0-90">    trigger := TimestampedTrigger.mkTimestampedTrigger@{
</span><span id="__ispan-0-91">      time := right 0;  -- Dummy time value for now
</span><span id="__ispan-0-92">      trigger := Trigger.MessageArrived@{msg := msg}
</span><span id="__ispan-0-93">    };
</span><span id="__ispan-0-94">    -- Get the engine's behaviour
</span><span id="__ispan-0-95">    behaviour := Engine.behaviour eng;
</span><span id="__ispan-0-96">    -- Evaluate guards based on strategy
</span><span id="__ispan-0-97">    guardResult := case EngineBehaviour.guards behaviour of {
</span><span id="__ispan-0-98">      | GuardEval.First guards :=
</span><span id="__ispan-0-99">        let
</span><span id="__ispan-0-100">          -- Try each guard until one matches
</span><span id="__ispan-0-101">          terminating
</span><span id="__ispan-0-102">          tryGuard (gs : List (Guard C S B H A AM AC AE)) : Option (GuardOutput C S B H A AM AC AE) :=
</span><span id="__ispan-0-103">            case gs of {
</span><span id="__ispan-0-104">              | [] := none
</span><span id="__ispan-0-105">              | g :: rest :=
</span><span id="__ispan-0-106">                case g trigger (Engine.cfg eng) (Engine.env eng) of {
</span><span id="__ispan-0-107">                  | none := tryGuard rest
</span><span id="__ispan-0-108">                  | some output := some output
</span><span id="__ispan-0-109">                }
</span><span id="__ispan-0-110">            };
</span><span id="__ispan-0-111">        in tryGuard guards
</span><span id="__ispan-0-112">      | GuardEval.Any guards := -- What's this actually supposed to do?
</span><span id="__ispan-0-113">        let
</span><span id="__ispan-0-114">          -- Try each guard until one matches
</span><span id="__ispan-0-115">          terminating
</span><span id="__ispan-0-116">          tryGuard (gs : List (Guard C S B H A AM AC AE)) : Option (GuardOutput C S B H A AM AC AE) :=
</span><span id="__ispan-0-117">            case gs of {
</span><span id="__ispan-0-118">              | [] := none
</span><span id="__ispan-0-119">              | g :: rest :=
</span><span id="__ispan-0-120">                case g trigger (Engine.cfg eng) (Engine.env eng) of {
</span><span id="__ispan-0-121">                  | none := tryGuard rest
</span><span id="__ispan-0-122">                  | some output := some output
</span><span id="__ispan-0-123">                }
</span><span id="__ispan-0-124">            };
</span><span id="__ispan-0-125">        in tryGuard guards
</span><span id="__ispan-0-126">    };
</span><span id="__ispan-0-127">    -- If a guard matched, execute its action
</span><span id="__ispan-0-128">    actionResult := case guardResult of {
</span><span id="__ispan-0-129">      | none := none
</span><span id="__ispan-0-130">      | some output := executeGuardOutput output eng trigger
</span><span id="__ispan-0-131">    };
</span><span id="__ispan-0-132">    -- If an action was executed, update the engine with the new environment
</span><span id="__ispan-0-133">    updatedEngine := case actionResult of {
</span><span id="__ispan-0-134">      | none := none
</span><span id="__ispan-0-135">      | some effect := some (eng@Engine{env := ActionEffect.env effect})
</span><span id="__ispan-0-136">    };
</span><span id="__ispan-0-137">  in case updatedEngine of {
</span><span id="__ispan-0-138">    | none := none
</span><span id="__ispan-0-139">    | some newEng := case actionResult of {
</span><span id="__ispan-0-140">      | none := none -- Should this be all or nothing, like it is?
</span><span id="__ispan-0-141">      | some effect := some (mkPair (ActionEffect.msgs effect) (mkPair (ActionEffect.engines effect) newEng))
</span><span id="__ispan-0-142">    }
</span><span id="__ispan-0-143">  };
</span><span id="__ispan-0-144">
</span><span id="__ispan-0-145">-- Helper function to evaluate and execute for any engine type
</span><span id="__ispan-0-146">evaluateAndExecuteEng (eng : Eng) (msg : EngineMsg Msg) : Option (Pair (List (EngineMsg Msg)) (Pair (List (Pair Cfg Env)) Eng)) :=
</span><span id="__ispan-0-147">  case eng of {
</span><span id="__ispan-0-148">    | Eng.IdentityManagement e := case evaluateAndExecute e msg of {
</span><span id="__ispan-0-149">      | none := none
</span><span id="__ispan-0-150">      | some (mkPair msgs (mkPair cfgEnvPairs newEng)) := some (mkPair msgs (mkPair cfgEnvPairs (Eng.IdentityManagement newEng)))
</span><span id="__ispan-0-151">    }
</span><span id="__ispan-0-152">    | Eng.Decryption e := case evaluateAndExecute e msg of {
</span><span id="__ispan-0-153">      | none := none
</span><span id="__ispan-0-154">      | some (mkPair msgs (mkPair cfgEnvPairs newEng)) := some (mkPair msgs (mkPair cfgEnvPairs (Eng.Decryption newEng)))
</span><span id="__ispan-0-155">    }
</span><span id="__ispan-0-156">    | Eng.Encryption e := case evaluateAndExecute e msg of {
</span><span id="__ispan-0-157">      | none := none
</span><span id="__ispan-0-158">      | some (mkPair msgs (mkPair cfgEnvPairs newEng)) := some (mkPair msgs (mkPair cfgEnvPairs (Eng.Encryption newEng)))
</span><span id="__ispan-0-159">    }
</span><span id="__ispan-0-160">    | Eng.Commitment e := case evaluateAndExecute e msg of {
</span><span id="__ispan-0-161">      | none := none
</span><span id="__ispan-0-162">      | some (mkPair msgs (mkPair cfgEnvPairs newEng)) := some (mkPair msgs (mkPair cfgEnvPairs (Eng.Commitment newEng)))
</span><span id="__ispan-0-163">    }
</span><span id="__ispan-0-164">    | Eng.Verification e := case evaluateAndExecute e msg of {
</span><span id="__ispan-0-165">      | none := none
</span><span id="__ispan-0-166">      | some (mkPair msgs (mkPair cfgEnvPairs newEng)) := some (mkPair msgs (mkPair cfgEnvPairs (Eng.Verification newEng)))
</span><span id="__ispan-0-167">    }
</span><span id="__ispan-0-168">    | Eng.ReadsFor e := case evaluateAndExecute e msg of {
</span><span id="__ispan-0-169">      | none := none
</span><span id="__ispan-0-170">      | some (mkPair msgs (mkPair cfgEnvPairs newEng)) := some (mkPair msgs (mkPair cfgEnvPairs (Eng.ReadsFor newEng)))
</span><span id="__ispan-0-171">    }
</span><span id="__ispan-0-172">    | Eng.SignsFor e := case evaluateAndExecute e msg of {
</span><span id="__ispan-0-173">      | none := none
</span><span id="__ispan-0-174">      | some (mkPair msgs (mkPair cfgEnvPairs newEng)) := some (mkPair msgs (mkPair cfgEnvPairs (Eng.SignsFor newEng)))
</span><span id="__ispan-0-175">    }
</span><span id="__ispan-0-176">    | Eng.Naming e := case evaluateAndExecute e msg of {
</span><span id="__ispan-0-177">      | none := none
</span><span id="__ispan-0-178">      | some (mkPair msgs (mkPair cfgEnvPairs newEng)) := some (mkPair msgs (mkPair cfgEnvPairs (Eng.Naming newEng)))
</span><span id="__ispan-0-179">    }
</span><span id="__ispan-0-180">    | Eng.LocalKeyValueStorage e := case evaluateAndExecute e msg of {
</span><span id="__ispan-0-181">      | none := none
</span><span id="__ispan-0-182">      | some (mkPair msgs (mkPair cfgEnvPairs newEng)) := some (mkPair msgs (mkPair cfgEnvPairs (Eng.LocalKeyValueStorage newEng)))
</span><span id="__ispan-0-183">    }
</span><span id="__ispan-0-184">    | Eng.Logging e := case evaluateAndExecute e msg of {
</span><span id="__ispan-0-185">      | none := none
</span><span id="__ispan-0-186">      | some (mkPair msgs (mkPair cfgEnvPairs newEng)) := some (mkPair msgs (mkPair cfgEnvPairs (Eng.Logging newEng)))
</span><span id="__ispan-0-187">    }
</span><span id="__ispan-0-188">    | Eng.WallClock e := case evaluateAndExecute e msg of {
</span><span id="__ispan-0-189">      | none := none
</span><span id="__ispan-0-190">      | some (mkPair msgs (mkPair cfgEnvPairs newEng)) := some (mkPair msgs (mkPair cfgEnvPairs (Eng.WallClock newEng)))
</span><span id="__ispan-0-191">    }
</span><span id="__ispan-0-192">    | Eng.LocalTSeries e := case evaluateAndExecute e msg of {
</span><span id="__ispan-0-193">      | none := none
</span><span id="__ispan-0-194">      | some (mkPair msgs (mkPair cfgEnvPairs newEng)) := some (mkPair msgs (mkPair cfgEnvPairs (Eng.LocalTSeries newEng)))
</span><span id="__ispan-0-195">    }
</span><span id="__ispan-0-196">    | Eng.Router e := case evaluateAndExecute e msg of {
</span><span id="__ispan-0-197">      | none := none
</span><span id="__ispan-0-198">      | some (mkPair msgs (mkPair cfgEnvPairs newEng)) := some (mkPair msgs (mkPair cfgEnvPairs (Eng.Router newEng)))
</span><span id="__ispan-0-199">    }
</span><span id="__ispan-0-200">    | Eng.TransportProtocol e := case evaluateAndExecute e msg of {
</span><span id="__ispan-0-201">      | none := none
</span><span id="__ispan-0-202">      | some (mkPair msgs (mkPair cfgEnvPairs newEng)) := some (mkPair msgs (mkPair cfgEnvPairs (Eng.TransportProtocol newEng)))
</span><span id="__ispan-0-203">    }
</span><span id="__ispan-0-204">    | Eng.TransportConnection e := case evaluateAndExecute e msg of {
</span><span id="__ispan-0-205">      | none := none
</span><span id="__ispan-0-206">      | some (mkPair msgs (mkPair cfgEnvPairs newEng)) := some (mkPair msgs (mkPair cfgEnvPairs (Eng.TransportConnection newEng)))
</span><span id="__ispan-0-207">    }
</span><span id="__ispan-0-208">    | Eng.PubSubTopic e := case evaluateAndExecute e msg of {
</span><span id="__ispan-0-209">      | none := none
</span><span id="__ispan-0-210">      | some (mkPair msgs (mkPair cfgEnvPairs newEng)) := some (mkPair msgs (mkPair cfgEnvPairs (Eng.PubSubTopic newEng)))
</span><span id="__ispan-0-211">    }
</span><span id="__ispan-0-212">    | Eng.Storage e := case evaluateAndExecute e msg of {
</span><span id="__ispan-0-213">      | none := none
</span><span id="__ispan-0-214">      | some (mkPair msgs (mkPair cfgEnvPairs newEng)) := some (mkPair msgs (mkPair cfgEnvPairs (Eng.Storage newEng)))
</span><span id="__ispan-0-215">    }
</span><span id="__ispan-0-216">    | Eng.MempoolWorker e := case evaluateAndExecute e msg of {
</span><span id="__ispan-0-217">      | none := none
</span><span id="__ispan-0-218">      | some (mkPair msgs (mkPair cfgEnvPairs newEng)) := some (mkPair msgs (mkPair cfgEnvPairs (Eng.MempoolWorker newEng)))
</span><span id="__ispan-0-219">    }
</span><span id="__ispan-0-220">    | Eng.Executor e := case evaluateAndExecute e msg of {
</span><span id="__ispan-0-221">      | none := none
</span><span id="__ispan-0-222">      | some (mkPair msgs (mkPair cfgEnvPairs newEng)) := some (mkPair msgs (mkPair cfgEnvPairs (Eng.Executor newEng)))
</span><span id="__ispan-0-223">    }
</span><span id="__ispan-0-224">    | Eng.Shard e := case evaluateAndExecute e msg of {
</span><span id="__ispan-0-225">      | none := none
</span><span id="__ispan-0-226">      | some (mkPair msgs (mkPair cfgEnvPairs newEng)) := some (mkPair msgs (mkPair cfgEnvPairs (Eng.Shard newEng)))
</span><span id="__ispan-0-227">    }
</span><span id="__ispan-0-228">    | Eng.Ticker e := case evaluateAndExecute e msg of {
</span><span id="__ispan-0-229">      | none := none
</span><span id="__ispan-0-230">      | some (mkPair msgs (mkPair cfgEnvPairs newEng)) := some (mkPair msgs (mkPair cfgEnvPairs (Eng.Ticker newEng)))
</span><span id="__ispan-0-231">    }
</span><span id="__ispan-0-232">    | Eng.Template e := case evaluateAndExecute e msg of {
</span><span id="__ispan-0-233">      | none := none
</span><span id="__ispan-0-234">      | some (mkPair msgs (mkPair cfgEnvPairs newEng)) := some (mkPair msgs (mkPair cfgEnvPairs (Eng.Template newEng)))
</span><span id="__ispan-0-235">    }
</span><span id="__ispan-0-236">    | Eng.TemplateMinimum e := case evaluateAndExecute e msg of {
</span><span id="__ispan-0-237">      | none := none
</span><span id="__ispan-0-238">      | some (mkPair msgs (mkPair cfgEnvPairs newEng)) := some (mkPair msgs (mkPair cfgEnvPairs (Eng.TemplateMinimum newEng)))
</span><span id="__ispan-0-239">    }
</span><span id="__ispan-0-240">  };
</span><span id="__ispan-0-241">
</span><span id="__ispan-0-242">-- Helper function to add a single new engine to a node
</span><span id="__ispan-0-243">addNewEngine (state : NetworkState) (nodeId : NodeID) (cfg : Cfg) (env : Env) : NetworkState :=
</span><span id="__ispan-0-244">  case OMap.lookup nodeId (NetworkState.nodes state) of {
</span><span id="__ispan-0-245">    | none := state
</span><span id="__ispan-0-246">    | some node :=
</span><span id="__ispan-0-247">      case mkEng nodeId (mkPair cfg env) of {
</span><span id="__ispan-0-248">        | none := state
</span><span id="__ispan-0-249">        | some (mkPair newEng newEngineId) :=
</span><span id="__ispan-0-250">          let
</span><span id="__ispan-0-251">            engineName := snd newEngineId;
</span><span id="__ispan-0-252">            updatedNode := node@Node{engines := OMap.insert engineName newEng (Node.engines node)};
</span><span id="__ispan-0-253">          in state@NetworkState{
</span><span id="__ispan-0-254">            nodes := OMap.insert nodeId updatedNode (NetworkState.nodes state)
</span><span id="__ispan-0-255">          }
</span><span id="__ispan-0-256">      }
</span><span id="__ispan-0-257">  };
</span><span id="__ispan-0-258">
</span><span id="__ispan-0-259">-- Helper function to update an engine's state, add new messages, and create new engines
</span><span id="__ispan-0-260">updateNetworkState (state : NetworkState) (target : EngineID) (eng : Eng) (msgs : List (EngineMsg Msg)) (cfgEnvPairs : List (Pair Cfg Env)) : NetworkState :=
</span><span id="__ispan-0-261">  let
</span><span id="__ispan-0-262">    -- Get the node ID from the target engine ID
</span><span id="__ispan-0-263">    nodeId := case target of {
</span><span id="__ispan-0-264">      | mkPair none _ := none
</span><span id="__ispan-0-265">      | mkPair (some nid) _ := some nid
</span><span id="__ispan-0-266">    };
</span><span id="__ispan-0-267">    -- Get the engine name from the target engine ID
</span><span id="__ispan-0-268">    engineName := snd target;
</span><span id="__ispan-0-269">    -- Look up the target node and update it
</span><span id="__ispan-0-270">    state' := case nodeId of {
</span><span id="__ispan-0-271">      | none := state
</span><span id="__ispan-0-272">      | some nid := case OMap.lookup nid (NetworkState.nodes state) of {
</span><span id="__ispan-0-273">        | none := state
</span><span id="__ispan-0-274">        | some n := state@NetworkState{
</span><span id="__ispan-0-275">            nodes := OMap.insert nid (n@Node{engines := OMap.insert engineName eng (Node.engines n)}) (NetworkState.nodes state)
</span><span id="__ispan-0-276">          }
</span><span id="__ispan-0-277">      }
</span><span id="__ispan-0-278">    };
</span><span id="__ispan-0-279">    -- Then fold over the config/env pairs to create new engines in the target node
</span><span id="__ispan-0-280">    stateWithMessages := state'@NetworkState{messages := NetworkState.messages state ++ msgs};
</span><span id="__ispan-0-281">    finalState := foldl
</span><span id="__ispan-0-282">      (\{s (mkPair cfg env) := case nodeId of {
</span><span id="__ispan-0-283">        | none := s
</span><span id="__ispan-0-284">        | some nid := addNewEngine s nid cfg env
</span><span id="__ispan-0-285">      }})
</span><span id="__ispan-0-286">      stateWithMessages
</span><span id="__ispan-0-287">      cfgEnvPairs
</span><span id="__ispan-0-288">  in finalState;
</span><span id="__ispan-0-289">
</span><span id="__ispan-0-290">-- Step function that processes one message and updates network state
</span><span id="__ispan-0-291">step (selector : MessageSelector) (state : NetworkState) : Pair NetworkState (Option (EngineMsg Msg)) :=
</span><span id="__ispan-0-292">  let
</span><span id="__ispan-0-293">    -- Try to select a message using the selector
</span><span id="__ispan-0-294">    selected := selector (NetworkState.messages state);
</span><span id="__ispan-0-295">  in case selected of {
</span><span id="__ispan-0-296">    | none := mkPair state none
</span><span id="__ispan-0-297">    | some (mkPair msg rest) :=
</span><span id="__ispan-0-298">      let
</span><span id="__ispan-0-299">        state' := state@NetworkState{messages := rest};
</span><span id="__ispan-0-300">        -- Get the target engine ID from the message
</span><span id="__ispan-0-301">        target := EngineMsg.target msg;
</span><span id="__ispan-0-302">        -- Get the node ID and engine name from the target engine ID
</span><span id="__ispan-0-303">        nodeId := case target of {
</span><span id="__ispan-0-304">          | mkPair none _ := none
</span><span id="__ispan-0-305">          | mkPair (some nid) _ := some nid
</span><span id="__ispan-0-306">        };
</span><span id="__ispan-0-307">        engineName := snd target;
</span><span id="__ispan-0-308">        -- Look up the target engine
</span><span id="__ispan-0-309">        engine := case nodeId of {
</span><span id="__ispan-0-310">          | none := none
</span><span id="__ispan-0-311">          | some nid := case OMap.lookup nid (NetworkState.nodes state) of {
</span><span id="__ispan-0-312">            | none := none
</span><span id="__ispan-0-313">            | some n := OMap.lookup engineName (Node.engines n)
</span><span id="__ispan-0-314">          }
</span><span id="__ispan-0-315">        };
</span><span id="__ispan-0-316">      in case engine of {
</span><span id="__ispan-0-317">        | none := mkPair state' none  -- Target engine not found, remove message and return state
</span><span id="__ispan-0-318">        | some eng :=
</span><span id="__ispan-0-319">          let
</span><span id="__ispan-0-320">            -- Try to evaluate and execute for the engine
</span><span id="__ispan-0-321">            result := evaluateAndExecuteEng eng msg;
</span><span id="__ispan-0-322">          in case result of {
</span><span id="__ispan-0-323">            | none := mkPair state' none  -- No action to execute, remove message and return state
</span><span id="__ispan-0-324">            | some (mkPair msgs (mkPair cfgEnvPairs newEng)) :=
</span><span id="__ispan-0-325">              mkPair (updateNetworkState state' target newEng msgs cfgEnvPairs) (some msg)
</span><span id="__ispan-0-326">          }
</span><span id="__ispan-0-327">      }
</span><span id="__ispan-0-328">  };
</span><span id="__ispan-0-329">
</span><span id="__ispan-0-330">-- Simulate function that runs for a specified number of steps and collects successfully delivered messages
</span><span id="__ispan-0-331">terminating
</span><span id="__ispan-0-332">simulate (selector : MessageSelector) (state : NetworkState) (steps : Nat) : List (EngineMsg Msg) :=
</span><span id="__ispan-0-333">  case steps of {
</span><span id="__ispan-0-334">    | zero := []
</span><span id="__ispan-0-335">    | suc n :=
</span><span id="__ispan-0-336">      let
</span><span id="__ispan-0-337">        -- Apply one step
</span><span id="__ispan-0-338">        nextPair := step selector state;
</span><span id="__ispan-0-339">        newState := fst nextPair;
</span><span id="__ispan-0-340">        processedMsgOpt := snd nextPair;
</span><span id="__ispan-0-341">        -- Recursively simulate remaining steps
</span><span id="__ispan-0-342">        restMsgs := simulate selector newState n;
</span><span id="__ispan-0-343">      in case processedMsgOpt of {
</span><span id="__ispan-0-344">        | none := restMsgs
</span><span id="__ispan-0-345">        | some processedMsg := processedMsg :: restMsgs
</span><span id="__ispan-0-346">      }
</span><span id="__ispan-0-347">  };
</span><span id="__ispan-0-348">
</span><span id="__ispan-0-349">-- Simulate function that runs for a specified number of steps and collects both
</span><span id="__ispan-0-350">-- successfully delivered and failed messages.
</span><span id="__ispan-0-351">terminating
</span><span id="__ispan-0-352">simulateWithFailures
</span><span id="__ispan-0-353">  (selector : MessageSelector)
</span><span id="__ispan-0-354">  (state : NetworkState)
</span><span id="__ispan-0-355">  (steps : Nat)
</span><span id="__ispan-0-356">  : Pair (List (EngineMsg Msg)) (List (EngineMsg Msg)) :=
</span><span id="__ispan-0-357">  case steps of {
</span><span id="__ispan-0-358">    | zero := mkPair [] []
</span><span id="__ispan-0-359">    | suc n :=
</span><span id="__ispan-0-360">      let
</span><span id="__ispan-0-361">        -- Try to select a message using the selector
</span><span id="__ispan-0-362">        selected := selector (NetworkState.messages state);
</span><span id="__ispan-0-363">      in case selected of {
</span><span id="__ispan-0-364">        | none := -- No message selected, continue simulation
</span><span id="__ispan-0-365">          let
</span><span id="__ispan-0-366">            -- Recursively simulate remaining steps
</span><span id="__ispan-0-367">            recursiveResult := simulateWithFailures selector state n;
</span><span id="__ispan-0-368">          in recursiveResult
</span><span id="__ispan-0-369">        | some (mkPair msg rest) := -- Message selected
</span><span id="__ispan-0-370">          let
</span><span id="__ispan-0-371">            state' := state@NetworkState{messages := rest};
</span><span id="__ispan-0-372">            -- Apply one step for the selected message
</span><span id="__ispan-0-373">            nextPair := step selector state; -- Need to use the original state here for step
</span><span id="__ispan-0-374">            newState := fst nextPair;
</span><span id="__ispan-0-375">            processedMsgOpt := snd nextPair;
</span><span id="__ispan-0-376">            -- Recursively simulate remaining steps with the new state
</span><span id="__ispan-0-377">            recursiveResult := simulateWithFailures selector newState n;
</span><span id="__ispan-0-378">            successMsgs := fst recursiveResult;
</span><span id="__ispan-0-379">            failedMsgs := snd recursiveResult;
</span><span id="__ispan-0-380">          in case processedMsgOpt of {
</span><span id="__ispan-0-381">            | none := -- Message failed to deliver
</span><span id="__ispan-0-382">              mkPair successMsgs (msg :: failedMsgs)
</span><span id="__ispan-0-383">            | some processedMsg := -- Message delivered successfully
</span><span id="__ispan-0-384">              mkPair (processedMsg :: successMsgs) failedMsgs
</span><span id="__ispan-0-385">          }
</span><span id="__ispan-0-386">      }
</span><span id="__ispan-0-387">  };
</span></code></pre></div>
<!-- list_wikilinks -->
<!-- Source file information -->
<!-- Was this page helpful? -->
<!-- Comment system -->
</article>
</div>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
<div class="md-copyright__highlight">
      Â© 2025 <a href="https://anoma.net">Anoma Foundation</a>
</div>
<strong>Version: (PR 355) - Updated: April 28,
    2025 at 04:22 PM UTC</strong>
<br/>
<strong>Latest version: <a href="https://specs.anoma.net/latest">
    https://specs.anoma.net/latest</a></strong>
<br/>
<strong>Development version: <a href="https://specs.anoma.net/main">
    https://specs.anoma.net/main</a></strong>
<br/>
<strong>Anoma Official Resources:</strong>
<small> <a href="https://anoma.net/" target="_blank">Website</a> | <a href="https://art.anoma.net" target="_blank">Research</a> | <a href="https://anoma.net/blog" target="_blank">Blog</a> | <a href="https://anoma.net/talks" target="_blank">Talks</a> </small>
<br/>
<strong>For Specification Authors:</strong>
<small>
<a href="https://specs.anoma.net/pr-355/indexes/tags.html">Tags</a>
    | <a href="https://specs.anoma.net/pr-355/indexes/links.html">Quick links</a>
    | <a href="https://specs.anoma.net/pr-355/indexes/juvix_modules.html">Juvix modules</a>
    | <a href="https://specs.anoma.net/pr-355/tutorial/index.html">Guides</a>
</small>
</div>
<div class="md-social">
<a class="md-social__link" href="https://x.com/anoma" rel="noopener" target="_blank" title="x.com">
<svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8l164.9-188.5L26.8 48h145.6l100.5 132.9zm-24.8 373.8h39.1L151.1 88h-42z"></path></svg>
</a>
<a class="md-social__link" href="https://github.com/anoma" rel="noopener" target="_blank" title="github.com">
<svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg>
</a>
<a class="md-social__link" href="https://anoma.net/blog" rel="noopener" target="_blank" title="anoma.net">
<svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M192 32c0 17.7 14.3 32 32 32 123.7 0 224 100.3 224 224 0 17.7 14.3 32 32 32s32-14.3 32-32C512 128.9 383.1 0 224 0c-17.7 0-32 14.3-32 32m0 96c0 17.7 14.3 32 32 32 70.7 0 128 57.3 128 128 0 17.7 14.3 32 32 32s32-14.3 32-32c0-106-86-192-192-192-17.7 0-32 14.3-32 32m-96 16c0-26.5-21.5-48-48-48S0 117.5 0 144v224c0 79.5 64.5 144 144 144s144-64.5 144-144-64.5-144-144-144h-16v96h16c26.5 0 48 21.5 48 48s-21.5 48-48 48-48-21.5-48-48z"></path></svg>
</a>
<a class="md-social__link" href="https://research.anoma.net" rel="noopener" target="_blank" title="research.anoma.net">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M225.9 32C103.3 32 0 130.5 0 252.1 0 256 .1 480 .1 480l225.8-.2c122.7 0 222.1-102.3 222.1-223.9S348.6 32 225.9 32M224 384c-19.4 0-37.9-4.3-54.4-12.1L88.5 392l22.9-75c-9.8-18.1-15.4-38.9-15.4-61 0-70.7 57.3-128 128-128s128 57.3 128 128-57.3 128-128 128"></path></svg>
</a>
<a class="md-social__link" href="https://youtube.com/anoma" rel="noopener" target="_blank" title="youtube.com">
<svg viewbox="0 0 576 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305m-317.51 213.508V175.185l142.739 81.205z"></path></svg>
</a>
<a class="md-social__link" href="mailto:arts@heliax.dev" rel="noopener" target="_blank" title="">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m20 8-8 5-8-5V6l8 5 8-5m0-2H4c-1.11 0-2 .89-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2"></path></svg>
</a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../../..", "features": ["announce.dismiss", "content.code.annotate", "content.code.copy", "content.tooltips", "content.action.edit", "content.action.view", "search.highlight", "search.suggest", "search.sharing", "navigation.instant.preview", "navigation.tracking", "navigation.prune", "navigation.indexes", "navigation.sections", "navigation.footer", "navigation.path", "toc.follow"], "search": "../../../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
<script src="../../../assets/javascripts/bundle.c8b220af.min.js"></script>
<script src="../../../assets/js/extra.js"></script>
<script src="../../../assets/js/highlight.js"></script>
<script src="../../../assets/js/mathjax.js"></script>
<script src="../../../assets/js/tex-svg-full.js"></script>
<script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>