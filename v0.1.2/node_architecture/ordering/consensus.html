
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="The Anoma Specification is a collection of documents that describe the
architecture, design, and implementation of the Anoma Network.
">
      
      
        <meta name="author" content="Anoma Foundation">
      
      
        <link rel="canonical" href="https://anoma.github.io/nspec/v2/node_architecture/ordering/consensus.html">
      
      
      
      
      <link rel="icon" href="../../assets/logo.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.36">
    
    
      
        <title>Consensus - Anoma Specification</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.06209087.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        
        <link rel="stylesheet" href="../../assets/external/fonts.googleapis.com/css.b658d0b2.css">
        <style>:root{--md-text-font:"Open Sans";--md-code-font:"Fira Code"}</style>
      
    
    
      <link rel="stylesheet" href="../../css/timeago.css">
    
      <link rel="stylesheet" href="../../assets/css/style.css">
    
      <link rel="stylesheet" href="../../assets/css/juvix-highlighting.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


    
    
      
        <meta  property="og:type"  content="website" >
      
        <meta  property="og:title"  content="Consensus - Anoma Specification" >
      
        <meta  property="og:description"  content="The Anoma Specification is a collection of documents that describe the
architecture, design, and implementation of the Anoma Network.
" >
      
        <meta  property="og:image"  content="https://anoma.github.io/nspec/v2/assets/images/social/node_architecture/ordering/consensus.png" >
      
        <meta  property="og:image:type"  content="image/png" >
      
        <meta  property="og:image:width"  content="1200" >
      
        <meta  property="og:image:height"  content="630" >
      
        <meta  property="og:url"  content="https://anoma.github.io/nspec/v2/node_architecture/ordering/consensus.html" >
      
        <meta  name="twitter:card"  content="summary_large_image" >
      
        <meta  name="twitter:title"  content="Consensus - Anoma Specification" >
      
        <meta  name="twitter:description"  content="The Anoma Specification is a collection of documents that describe the
architecture, design, and implementation of the Anoma Network.
" >
      
        <meta  name="twitter:image"  content="https://anoma.github.io/nspec/v2/assets/images/social/node_architecture/ordering/consensus.png" >
      
    
    
   <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#consensus" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
        <aside class="md-banner">
          <div class="md-banner__inner md-grid md-typeset">
            
              <button class="md-banner__button md-icon" aria-label="Don't show this again">
                
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
              </button>
            
            
  For updates follow <strong>@anoma</strong> on
  <a rel="me" href="https://x.com/anoma">
    <span class="twemoji x-twitter">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8l164.9-188.5L26.8 48h145.6l100.5 132.9zm-24.8 373.8h39.1L151.1 88h-42z"/></svg>
    </span>
    <strong></strong>
  </a>
  and discuss on our
  <a href="https://research.anoma.net">
    <span class="twemoji discourse">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M225.9 32C103.3 32 0 130.5 0 252.1 0 256 .1 480 .1 480l225.8-.2c122.7 0 222.1-102.3 222.1-223.9S348.6 32 225.9 32M224 384c-19.4 0-37.9-4.3-54.4-12.1L88.5 392l22.9-75c-9.8-18.1-15.4-38.9-15.4-61 0-70.7 57.3-128 128-128s128 57.3 128 128-57.3 128-128 128"/></svg>
    </span>
    <strong>forum</strong>
  </a>

          </div>
          
            <script>var el=document.querySelector("[data-md-component=announce]");if(el){var content=el.querySelector(".md-typeset");__md_hash(content.innerHTML)===__md_get("__announce")&&(el.hidden=!0)}</script>
          
        </aside>
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">
              
  You're not viewing the latest official version.
  <a href="../../..">
    <strong>Click here to go to latest.</strong>
  </a>

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),outdated=__md_get("__outdated",sessionStorage);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../index.html" title="Anoma Specification" class="md-header__button md-logo" aria-label="Anoma Specification" data-md-component="logo">
      
  <img src="../../assets/logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Anoma Specification
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Consensus
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="red"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="red"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            <!--
  Copyright (c) 2016-2024 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->



<!-- Navigation tabs -->
<nav
  class="md-tabs"
  aria-label="Tabs"
  data-md-component="tabs"
>
  <div class="md-grid">
    <ul class="md-tabs__list">
      
      
            
  
  
  
    <li class="md-tabs__item">
      <a href="../../index.html" class="md-tabs__link">
        
  
    
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/></svg>
    
  
  Home

      </a>
    </li>
  

        
      
      
            
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../scope/index.html" class="md-tabs__link">
          
  
    
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5 3c-1.11 0-2 .89-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2zm10.78 2H19v12.18c-.26-.8-1.31-1.39-2.2-1.39h-1v-3a1 1 0 0 0-1-1h-6v-2h2a1 1 0 0 0 1-1v-2h2c1.03 0 1.87-.79 1.98-1.79M5 10.29l4.8 4.5v1a2 2 0 0 0 2 2V19H5z"/></svg>
    
  
  Scope

        </a>
      </li>
    
  

        
      
      
            
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../basic_abstractions/index.html" class="md-tabs__link">
          
  
    
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M6 2a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6zm0 2h7v5h5v11H6zm2 8v2h8v-2zm0 4v2h5v-2z"/></svg>
    
  
  Basic Abstractions

        </a>
      </li>
    
  

        
      
      
            
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../architecture/index.html" class="md-tabs__link">
          
  
    
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M24 18.714v4.8c0 .288-.192.48-.48.48h-4.8c-.288 0-.48-.192-.48-.48v-4.8c0-.288.192-.48.48-.48h1.92v-1.92h-8.16v1.92h1.92c.288 0 .48.192.48.48v4.8c0 .288-.192.48-.48.48H9.6c-.288 0-.48-.192-.48-.48v-4.8c0-.288.192-.48.48-.48h1.92v-1.92H3.36v1.92h1.92c.288 0 .48.192.48.48v4.8c0 .288-.192.48-.48.48H.48c-.288 0-.48-.192-.48-.48v-4.8c0-.288.192-.48.48-.48H2.4v-2.4c0-.288.192-.48.48-.48h8.64v-1.44h.96v1.44h8.64c.288 0 .48.192.48.48v2.4h1.92c.288 0 .48.192.48.48m-13.92 4.32h3.84v-3.84h-3.84zm-9.12 0H4.8v-3.84H.96Zm18.24 0h3.84v-3.84H19.2ZM6.24 9.642V3.546c0-.192.096-.336.24-.432L11.76.042a.8.8 0 0 1 .48 0l5.28 3.072c.144.096.24.24.24.432v6.096c0 .144-.096.288-.24.384l-5.28 3.072q-.096.048-.24.048t-.24-.048l-5.28-3.072c-.144-.096-.24-.24-.24-.384m10.56-.288V4.362l-4.32 2.496v4.992zm-9.6 0 4.32 2.496V6.858L7.2 4.362Zm.48-5.808L12 5.994l4.32-2.448L12 1.05Z"/></svg>
    
  
  Protocol Architecture

        </a>
      </li>
    
  

        
      
      
            
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../application_architecture/index.html" class="md-tabs__link">
          
  
    
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16 20h4v-4h-4m0-2h4v-4h-4m-6-2h4V4h-4m6 4h4V4h-4m-6 10h4v-4h-4m-6 4h4v-4H4m0 10h4v-4H4m6 4h4v-4h-4M4 8h4V4H4z"/></svg>
    
  
  Application Architecture

        </a>
      </li>
    
  

        
      
      
            
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../implementation/index.html" class="md-tabs__link">
          
  
    
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19.793 16.575c0 3.752-2.927 7.426-7.743 7.426-5.249 0-7.843-3.71-7.843-8.29 0-5.21 3.892-12.952 8-15.647a.397.397 0 0 1 .61.371 9.72 9.72 0 0 0 1.694 6.518c.522.795 1.092 1.478 1.763 2.352.94 1.227 1.637 1.906 2.644 3.842l.015.028a7.1 7.1 0 0 1 .86 3.4"/></svg>
    
  
  Implementation

        </a>
      </li>
    
  

        
      
      
      
      
      
      
      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../index.html" title="Anoma Specification" class="md-nav__button md-logo" aria-label="Anoma Specification" data-md-component="logo">
      
  <img src="../../assets/logo.svg" alt="logo">

    </a>
    Anoma Specification
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/></svg>
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../scope/index.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Scope
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../basic_abstractions/index.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Basic Abstractions
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../architecture/index.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Protocol Architecture
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../application_architecture/index.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Application Architecture
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../implementation/index.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Implementation
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../indexes/links.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1M8 13h8v-2H8zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4a5 5 0 0 0 5-5 5 5 0 0 0-5-5"/></svg>
  
  <span class="md-ellipsis">
    Quick links
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../indexes/juvix_modules.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 10h-2V8h2m0 5h-2v-2h2m-3-1h-2V8h2m0 5h-2v-2h2m0 6H8v-2h8m-9-5H5V8h2m0 5H5v-2h2m1 0h2v2H8m0-5h2v2H8m3 1h2v2h-2m0-5h2v2h-2m9-5H4c-1.11 0-2 .89-2 2v10a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2"/></svg>
  
  <span class="md-ellipsis">
    Juvix modules
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
          
        
      
        
      
        
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
          
        
      
        
      
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../tutorial/index.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Tutorials for contributors
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Introduction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#purpose" class="md-nav__link">
    <span class="md-ellipsis">
      Purpose
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#background" class="md-nav__link">
    <span class="md-ellipsis">
      Background
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scope" class="md-nav__link">
    <span class="md-ellipsis">
      Scope
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#functionality" class="md-nav__link">
    <span class="md-ellipsis">
      Functionality
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functionality">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#informal-protocol-round-description" class="md-nav__link">
    <span class="md-ellipsis">
      Informal protocol round description
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Informal protocol round description">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#onea-message-proposing-a-value" class="md-nav__link">
    <span class="md-ellipsis">
      \(\onea\)-message: proposing a value
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#oneb-message-acknowledging-receiving-the-proposal" class="md-nav__link">
    <span class="md-ellipsis">
      \(\oneb\)-message: acknowledging receiving the proposal
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#twoa-message-establishing-consensus" class="md-nav__link">
    <span class="md-ellipsis">
      \(\twoa\)-message: establishing consensus
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#termination-finalizing-consensus-value" class="md-nav__link">
    <span class="md-ellipsis">
      Termination: finalizing consensus value
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#protocol-message-structure" class="md-nav__link">
    <span class="md-ellipsis">
      Protocol message structure
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pseudocode" class="md-nav__link">
    <span class="md-ellipsis">
      Pseudocode
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#efficient-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      Efficient Implementation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#communication-diagram" class="md-nav__link">
    <span class="md-ellipsis">
      Communication diagram
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#messages-received" class="md-nav__link">
    <span class="md-ellipsis">
      Messages Received
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Messages Received">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#potentialproposal" class="md-nav__link">
    <span class="md-ellipsis">
      PotentialProposal
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hpaxosproposal" class="md-nav__link">
    <span class="md-ellipsis">
      HPaxosProposal
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hpaxoscommitment" class="md-nav__link">
    <span class="md-ellipsis">
      HPaxosCommitment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hpaxosdecision" class="md-nav__link">
    <span class="md-ellipsis">
      HPaxosDecision
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#newquorums" class="md-nav__link">
    <span class="md-ellipsis">
      NewQuorums
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example-scenario" class="md-nav__link">
    <span class="md-ellipsis">
      Example scenario
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#further-reading" class="md-nav__link">
    <span class="md-ellipsis">
      Further reading
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="consensus">Consensus<a class="headerlink" href="#consensus" title="Permanent link">&para;</a></h1>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<h3 id="purpose">Purpose<a class="headerlink" href="#purpose" title="Permanent link">&para;</a></h3>
<p>Consensus component establishes a totally ordered sequence of headers received from the <a href="mempool/index.html">mempool</a> DAG.
This establishes a total order of transactions for the <a href="execution/index.html">execution engine</a> to execute.</p>
<h3 id="background">Background<a class="headerlink" href="#background" title="Permanent link">&para;</a></h3>
<p>The consensus algorithm is based on Heterogeneous Paxos<sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup></p>
<h3 id="scope">Scope<a class="headerlink" href="#scope" title="Permanent link">&para;</a></h3>
<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">&para;</a></h2>
<p>The protocol involves three kinds of agents: <em>proposers</em>, <em>acceptors</em> and <em>learners</em>.
Each validator may play the role of any combination of the three kinds of agents.</p>
<p><strong>Proposer</strong> initiate a round by a proposing a value to agree upon. We denote a set of possible consensus values <span class="arithmatex">\(\mathcal{V}\)</span>.</p>
<p><strong>Acceptors</strong> are agents who agree on the proposed blocks and an agent may be acceptor for more than one chain (network).
No correct acceptor acts on any invalid block. This requires checking the validation of blocks or state transition function.
Non-byzantine correct acceptors are also called <em>honest</em>, <em>safe</em>, or <em>real</em>.</p>
<p><strong>Learners</strong> are agents who are interested in values decided by consensus on particular chains.
The definition of learners is based on the quorums and defined by the protocol, meaning that the agents are not free not choose their own quorum setups.
For example, there might be three well-defined learners <span class="arithmatex">\(l_\alpha\)</span> and <span class="arithmatex">\(l_\beta\)</span>, and <span class="arithmatex">\(l_{\alpha\beta}\)</span> which are agents
who are interested in chain <span class="arithmatex">\(\alpha\)</span> alone, chain <span class="arithmatex">\(\beta\)</span> alone, and both chains <span class="arithmatex">\(\alpha\)</span> and <span class="arithmatex">\(\beta\)</span>, respectively.</p>
<h2 id="functionality">Functionality<a class="headerlink" href="#functionality" title="Permanent link">&para;</a></h2>
<p>Acceptors need to be aware of the different definitions of learners in order to be able to know which behaviour is defined as correct.
This set of the agents for learners might be empty or have overlaps, which must be respected by the acceptors regardless.</p>
<p>Values are agreed upon in rounds.</p>
<!-- Next, we describe how the communication for a consensus round works. -->
<h3 id="informal-protocol-round-description">Informal protocol round description<a class="headerlink" href="#informal-protocol-round-description" title="Permanent link">&para;</a></h3>
<p>The communication is carried out by sending and receiving messages in four (possibly overlapping) phases:</p>
<ol>
<li>proposing the consensus value <span class="arithmatex">\(v \in \Value\)</span></li>
<li>acknowledging receipt of proposals</li>
<li>establishing consensus</li>
<li>termination</li>
</ol>
<p>The first three phases correspond to three types of intra-component messages: <span class="arithmatex">\(\onea\)</span>, <span class="arithmatex">\(\oneb\)</span> and <span class="arithmatex">\(\twoa\)</span>, respectively.</p>
<p>Before processing a received message <span class="arithmatex">\(m\)</span>, acceptors and learners check if the message is <a href="consensus/hpaxos_formal.html#definition-wellformed"><em>wellformed</em></a>.
The formal definition of the wellformedness relation, denoted by <span class="arithmatex">\(\wellformed{m}\)</span>, is given <a href="consensus/hpaxos_formal.html">here</a>.
Non-wellformed messages are rejected.
The acceptors caught in sending non-wellformed messages might be punished by the protocol.</p>
<!-- Suppose we have two learners $l_\alpha$ and $l_\beta$ which refer to agents that are interested in blockchain $\alpha$ and blockchain $\beta$. -->

<h4 id="onea-message-proposing-a-value"><span class="arithmatex">\(\onea\)</span>-message: proposing a value<a class="headerlink" href="#onea-message-proposing-a-value" title="Permanent link">&para;</a></h4>
<p>Proposer proposes a next value by sending a <span class="arithmatex">\(1a\)</span>-message to the acceptors.
The message carries a <em>unique</em> ballot value, containing the proposed value to agree on and the round timestamp (round number).
We assume that the set of all possible ballot values is linearly ordered.</p>
<h4 id="oneb-message-acknowledging-receiving-the-proposal"><span class="arithmatex">\(\oneb\)</span>-message: acknowledging receiving the proposal<a class="headerlink" href="#oneb-message-acknowledging-receiving-the-proposal" title="Permanent link">&para;</a></h4>
<p>On receipt of a <span class="arithmatex">\(\onea\)</span>-message, an acceptor sends an acknowledgement of its receipt to all other acceptors and learners in the form of <span class="arithmatex">\(\oneb\)</span>-message.</p>
<h4 id="twoa-message-establishing-consensus"><span class="arithmatex">\(\twoa\)</span>-message: establishing consensus<a class="headerlink" href="#twoa-message-establishing-consensus" title="Permanent link">&para;</a></h4>
<p>When an acceptor receives <span class="arithmatex">\(1b\)</span> messages for the highest ballot number it has seen from a learner <span class="arithmatex">\(l_\alpha\)</span>’s <a href="consensus/hpaxos_formal.html#definition-quorums-in-messages">quorum</a> of acceptors,
it sends a <span class="arithmatex">\(\twoa\)</span>-message labeled with <span class="arithmatex">\(l_\alpha\)</span>.
However, there is one restriction: once a safe acceptor has sent a <span class="arithmatex">\(\twoa\)</span>-message <span class="arithmatex">\(m\)</span> for a learner <span class="arithmatex">\(l_\alpha\)</span>,
it never sends a <span class="arithmatex">\(\twoa\)</span>-message with a different value for a learner <span class="arithmatex">\(l_\beta\)</span>, unless one of the following is true:</p>
<ul>
<li>It knows that a quorum of acceptors has seen a quorum of <span class="arithmatex">\(\twoa\)</span>-messages with learner <span class="arithmatex">\(l_\alpha\)</span> and ballot number higher than <span class="arithmatex">\(m\)</span>.</li>
<li>It has seen Byzantine behaviour that proves <span class="arithmatex">\(l_\alpha\)</span> and <span class="arithmatex">\(l_\beta\)</span> do not have to agree.</li>
</ul>
<p>The acceptor who has received a <span class="arithmatex">\(\oneb\)</span> sends a <span class="arithmatex">\(\twoa\)</span> for every learner for which it can produce a wellformed <span class="arithmatex">\(\twoa\)</span>.</p>
<h4 id="termination-finalizing-consensus-value">Termination: finalizing consensus value<a class="headerlink" href="#termination-finalizing-consensus-value" title="Permanent link">&para;</a></h4>
<p>A learner <span class="arithmatex">\(\red{l_\alpha}\)</span> decides on a value <span class="arithmatex">\(v \in \Value\)</span> when it receives a set <span class="arithmatex">\(\red{q_\alpha}\)</span> of <span class="arithmatex">\(\twoa\)</span>-messages
labeled with <span class="arithmatex">\(l_\alpha\)</span> with the same proposed value <span class="arithmatex">\(v\)</span> and ballot <span class="arithmatex">\(b\)</span> from one of its quorums of acceptors.
We call such a set a <em>decision</em> and write <span class="arithmatex">\(\decision{\red \alpha}{b, \red{q_\alpha}}\)</span>.</p>
<p>If no decision can be reached within a certain time, proposers must begin a new round (with a higher timestamp, and thus a higher ballot).
Proposers can start a new round by proposing a new value or by trying to finalize the same value again (in case there was no consensus).</p>
<p>In general, acceptor relay all sent or received messages to all learners and other acceptors.
This ensures that any message received by a real acceptor is received by all real acceptors and learners.</p>
<h4 id="protocol-message-structure">Protocol message structure<a class="headerlink" href="#protocol-message-structure" title="Permanent link">&para;</a></h4>
<p>Any <span class="arithmatex">\(\oneb\)</span> and <span class="arithmatex">\(\twoa\)</span>-message <span class="arithmatex">\(m\)</span> signed by the acceptor <span class="arithmatex">\(A\)</span> has the following fields:</p>
<ul>
<li><code>prev</code> — a reference to the previous message sent by <span class="arithmatex">\(A\)</span>, if such exists.</li>
<li><code>refs</code> — a set of hashes of message referenced by <span class="arithmatex">\(m\)</span>. They are the messages that <span class="arithmatex">\(A\)</span> has received since between sending <span class="arithmatex">\(m\)</span> and the previous to <span class="arithmatex">\(m\)</span> message, including the previous message itself.</li>
<li><code>lrn</code> — a learner tag: an identifier of the relevant chain (for <span class="arithmatex">\(\twoa\)</span>-messages only).</li>
</ul>
<p>To ensure that acceptors and learners <em>fully understand</em> each message they receive, they delay doing any computation on it (sometimes called delivery) until they have received all the messages in <code>refs</code>. As a result, acceptors and learners will always process messages from any given sender in the order they were sent, but also from any messages that sender received, and recursively.</p>
<h3 id="pseudocode">Pseudocode<a class="headerlink" href="#pseudocode" title="Permanent link">&para;</a></h3>
<p>We assume that there is a way to assign to every wellformed message <span class="arithmatex">\(m\)</span> a unique ballot number that the message belongs to.
We shall denote the ballot number assigning function as <span class="arithmatex">\(\ba{m}\)</span>.
The formal definition of the function can be found <a href="consensus/hpaxos_formal.html#definition-ballot-numbers">here</a>.</p>
<p>We assume that every acceptor maintains an internal state with the following structures:</p>
<ul>
<li><code>known_messages</code> — a set of all processed messages, initially empty;</li>
<li><code>recent_messages</code> — a set of all messages the acceptor has sent or received since (and including) the last message it sent, initially empty;</li>
<li><code>previous_message</code> — the most recent message the acceptor has sent, is such exists, initially special non-message value.</li>
</ul>
<div class="language-python highlight"><pre><span></span><code><span id="__ispan-0-1"><span class="k">def</span> <span class="nf">init</span><span class="p">():</span>
</span><span id="__ispan-0-2">    <span class="n">known_messages</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="__ispan-0-3">    <span class="n">recent_messages</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="__ispan-0-4">    <span class="n">previous_message</span> <span class="o">=</span> <span class="n">NON_MESSAGE</span>
</span><span id="__ispan-0-5">
</span><span id="__ispan-0-6"><span class="k">def</span> <span class="nf">process_message</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
</span><span id="__ispan-0-7">    <span class="c1"># ignore messages that have been already processed</span>
</span><span id="__ispan-0-8">    <span class="k">if</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">known_messages</span><span class="p">:</span>
</span><span id="__ispan-0-9">        <span class="k">return</span>
</span><span id="__ispan-0-10">
</span><span id="__ispan-0-11">    <span class="c1"># forward message to all acceptors and learners</span>
</span><span id="__ispan-0-12">    <span class="n">broadcast</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</span><span id="__ispan-0-13">
</span><span id="__ispan-0-14">    <span class="n">known_messages</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</span><span id="__ispan-0-15">    <span class="n">recent_messages</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</span><span id="__ispan-0-16">
</span><span id="__ispan-0-17">    <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s2">&quot;1a&quot;</span><span class="p">:</span>
</span><span id="__ispan-0-18">        <span class="n">new_1b</span> <span class="o">=</span> <span class="mi">1</span><span class="n">b</span><span class="p">(</span><span class="n">prev</span> <span class="o">=</span> <span class="n">previous_message</span><span class="p">,</span> <span class="n">refs</span> <span class="o">=</span> <span class="n">recent_messages</span><span class="p">)</span>
</span><span id="__ispan-0-19">        <span class="n">recent_messages</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="__ispan-0-20">        <span class="n">previous_message</span> <span class="o">=</span> <span class="n">new_1b</span>
</span><span id="__ispan-0-21">        <span class="n">process_message</span><span class="p">(</span><span class="n">new_1b</span><span class="p">)</span>
</span><span id="__ispan-0-22">
</span><span id="__ispan-0-23">    <span class="k">else</span> <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s2">&quot;1b&quot;</span> <span class="ow">and</span> <span class="n">B</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="o">==</span> <span class="nb">max</span> <span class="p">([</span><span class="n">B</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">known_messages</span><span class="p">]):</span>
</span><span id="__ispan-0-24">        <span class="n">foreach</span> <span class="n">learner</span> <span class="ow">in</span> <span class="n">Learner</span><span class="p">:</span>
</span><span id="__ispan-0-25">            <span class="n">new_2a</span> <span class="o">=</span> <span class="mi">2</span><span class="n">a</span><span class="p">(</span><span class="n">prev</span> <span class="o">=</span> <span class="n">previous_message</span><span class="p">,</span> <span class="n">refs</span> <span class="o">=</span> <span class="n">recent_messages</span><span class="p">,</span> <span class="n">lrn</span> <span class="o">=</span> <span class="n">learner</span><span class="p">)</span>
</span><span id="__ispan-0-26">            <span class="k">if</span> <span class="n">WellFormed</span><span class="p">(</span><span class="n">new_2a</span><span class="p">):</span>
</span><span id="__ispan-0-27">                <span class="n">recent_messages</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="__ispan-0-28">                <span class="n">previous_message</span> <span class="o">=</span> <span class="n">new_2a</span>
</span><span id="__ispan-0-29">                <span class="n">process_message</span><span class="p">(</span><span class="n">new_2a</span><span class="p">)</span>
</span><span id="__ispan-0-30">
</span><span id="__ispan-0-31"><span class="k">def</span> <span class="nf">run</span><span class="p">():</span>
</span><span id="__ispan-0-32">    <span class="c1"># initialize state</span>
</span><span id="__ispan-0-33">    <span class="n">init</span><span class="p">()</span>
</span><span id="__ispan-0-34">
</span><span id="__ispan-0-35">    <span class="c1"># main loop</span>
</span><span id="__ispan-0-36">    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="__ispan-0-37">        <span class="n">m</span> <span class="o">=</span> <span class="n">deliver_next_wellformed_message</span><span class="p">()</span>
</span><span id="__ispan-0-38">        <span class="c1"># the function must guarantee that:</span>
</span><span id="__ispan-0-39">        <span class="c1"># 1) the messages are delivered in the order they were sent, i.e.,</span>
</span><span id="__ispan-0-40">        <span class="k">assert</span> <span class="n">foreach</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">refs</span><span class="p">:</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">known_messages</span>
</span><span id="__ispan-0-41">        <span class="c1"># holds, and</span>
</span><span id="__ispan-0-42">        <span class="c1"># 2) the delivered messages are wellformed</span>
</span><span id="__ispan-0-43">
</span><span id="__ispan-0-44">        <span class="n">process_message</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</span></code></pre></div>
<h3 id="efficient-implementation">Efficient Implementation<a class="headerlink" href="#efficient-implementation" title="Permanent link">&para;</a></h3>
<p>The efficient implementation of consensus is described <a href="consensus/hpaxos_eff.html">here</a>.</p>
<h2 id="communication-diagram">Communication diagram<a class="headerlink" href="#communication-diagram" title="Permanent link">&para;</a></h2>
<!-- Diagram illustrating message flows between engines -->

<h2 id="messages-received">Messages Received<a class="headerlink" href="#messages-received" title="Permanent link">&para;</a></h2>
<p>Below is the specification of the consensus component in terms of all the messages the component must be able to receive and react to.</p>
<h3 id="potentialproposal"><a href="consensus/potential_proposal.html">PotentialProposal</a><a class="headerlink" href="#potentialproposal" title="Permanent link">&para;</a></h3>
<p>from <a href="mempool/primary.html">Mempool Primary</a> may trigger:</p>
<ul>
<li><code>HPaxosProposal</code> → Consensus</li>
<li><em>from</em> <a href="https://anoma.github.io/nspec/v2/node_architecture/ordering/consensus.html">Consensus</a></li>
</ul>
<p>#### Purpose</p>
<p>Encodes a <span class="arithmatex">\(\onea\)</span>-message that proposes a next value to have consensus upon.</p>
<h3 id="hpaxosproposal"><a href="consensus/heterogeneous_paxos_proposal.html">HPaxosProposal</a><a class="headerlink" href="#hpaxosproposal" title="Permanent link">&para;</a></h3>
<p>from <a href="consensus.html">Consensus</a> may trigger:</p>
<ul>
<li><code>HPaxosCommitment</code> → Consensus</li>
<li><em>from</em> <a href="https://anoma.github.io/nspec/v2/node_architecture/ordering/consensus.html">Consensus</a></li>
</ul>
<p>#### Purpose</p>
<p>Encodes a <span class="arithmatex">\(\oneb\)</span> / <span class="arithmatex">\(\twoa\)</span> message used to communicate the acceptor's commitment to other acceptors.
- <code>CheckProposal</code> → Mempool Primary
  Requests that the Mempool check whether this Proposal is valid.</p>
<h3 id="hpaxoscommitment"><a href="consensus/heterogeneous_paxos_commitment.html">HPaxosCommitment</a><a class="headerlink" href="#hpaxoscommitment" title="Permanent link">&para;</a></h3>
<p>from <a href="consensus.html">Consensus</a> may trigger:</p>
<ul>
<li><code>HPaxosCommitment</code> → Consensus</li>
<li><em>from</em> <a href="https://anoma.github.io/nspec/v2/node_architecture/ordering/consensus.html">Consensus</a></li>
</ul>
<p>#### Purpose</p>
<p>Encodes a <span class="arithmatex">\(\oneb\)</span> / <span class="arithmatex">\(\twoa\)</span> message used to communicate the acceptor's commitment to other acceptors.
- <code>RequestProposal</code> → Mempool Primary
  Consensus is requesting the next anchor block to propose.
- <code>AnchorChosen</code> → Execution Shards
  Inform shards about the most recently decided value by the consensus.</p>
<h3 id="hpaxosdecision"><a href="consensus/heterogeneous_paxos_decision.html">HPaxosDecision</a><a class="headerlink" href="#hpaxosdecision" title="Permanent link">&para;</a></h3>
<p>from <a href="consensus.html">Consensus</a> may trigger:</p>
<ul>
<li><code>RequestProposal</code> → Mempool Primary
  Consensus is requesting the next anchor block to propose.</li>
<li><code>AnchorChosen</code> → Execution Shards
  Inform shards about the most recently decided value by the consensus.</li>
</ul>
<h3 id="newquorums"><a href="consensus/new_quorums.html">NewQuorums</a><a class="headerlink" href="#newquorums" title="Permanent link">&para;</a></h3>
<p>from <a href="execution/executor/index.html">Executor</a> may trigger: <em>none</em></p>
<h2 id="example-scenario">Example scenario<a class="headerlink" href="#example-scenario" title="Permanent link">&para;</a></h2>
<!-- Short message cascade from a typical common message sent to the machine  -->
<!-- E.g. an example of the common case "life of a transaction or whatever" flow from inputs to outputs -->

<h2 id="further-reading">Further reading<a class="headerlink" href="#further-reading" title="Permanent link">&para;</a></h2>
<!-- list_wikilinks -->

<!-- mermaid_wikilinks -->

<div class="footnote">
<hr />
<ol>
<li id="fn:1">
<p>Isaac Sheff, Xinwen Wang, Robbert van Renesse, and Andrew C. Myers. Heterogeneous paxos: technical report. 2020. <a href="https://arxiv.org/abs/2011.08253">arXiv:2011.08253</a>.&#160;<a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div>







  
    
  
  
    
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class="timeago" datetime="2024-08-06T20:14:36+02:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2024-08-06</span>
  </span>

    
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Created">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class="timeago" datetime="2024-03-24T00:41:13+01:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2024-03-24</span>
  </span>

    
    
    
  </aside>


  



  <form class="md-feedback" name="feedback" hidden>
    <fieldset>
      <legend class="md-feedback__title">
        Was this page helpful?
      </legend>
      <div class="md-feedback__inner">
        <div class="md-feedback__list">
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page was helpful" data-md-value="1">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12 21.35-1.45-1.32C5.4 15.36 2 12.27 2 8.5 2 5.41 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.08C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.41 22 8.5c0 3.77-3.4 6.86-8.55 11.53z"/></svg>
            </button>
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page could be improved" data-md-value="0">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12 21.35-1.45-1.32C5.4 15.36 2 12.27 2 8.5 2 5.41 4.42 3 7.5 3c.67 0 1.32.12 1.94.33L13 9.35l-4 5zM16.5 3C19.58 3 22 5.41 22 8.5c0 3.77-3.4 6.86-8.55 11.53L12 21.35l-1-7 4.5-5-2.65-5.08C13.87 3.47 15.17 3 16.5 3"/></svg>
            </button>
          
        </div>
        <div class="md-feedback__note">
          
            <div data-md-value="1" hidden>
              
              
                
              
              Thanks for your feedback!
            </div>
          
            <div data-md-value="0" hidden>
              
              
                
              
              Thanks for your feedback! We'll try to improve this page in the future.
            </div>
          
        </div>
      </div>
    </fieldset>
  </form>


                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  <div class="md-copyright__highlight">
    &copy; 2024 <a href="https://anoma.net">Anoma Foundation</a>
 - Last updated: September 25, 2024 at 07:09 PM UTC
  </div>
  

  <ul>
    <li><a href="https://anoma.net/" target="_blank">Anoma Official Website</a> </li>
    <li><a href="https://art.anoma.net" target="_blank">Anoma Research Topics (ART)</a></li>
    <li><a href="https://anoma.net/blog" target="_blank">Anoma Blog</a></li>
    <li><a href="https://anoma.net/talks" target="_blank">Anoma Talks</a></li>
  </ul>
  <ul>
    <span class="md-copyright__highlight">Extra resources for Anoma
      Specification collaborators</span>
      
      <li><a href="https://anoma.github.io/nspec/v2/indexes/links.html">Quick links</a></li>
      <li><a href="https://anoma.github.io/nspec/v2/indexes/juvix_modules.html">Juvix modules</a></li>
      <li><a href="https://anoma.github.io/nspec/v2/tutorial/index.html">Markdown tutorials for writing Anoma
          Specification</a></li>
      <li><a href="https://anoma.github.io/nspec/v2/tutorial/engines/index.html">On engines in Anoma</a></li>
  </ul>
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://x.com/anoma" target="_blank" rel="noopener" title="x.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8l164.9-188.5L26.8 48h145.6l100.5 132.9zm-24.8 373.8h39.1L151.1 88h-42z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://github.com/anoma" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://anoma.net/blog" target="_blank" rel="noopener" title="anoma.net" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M192 32c0 17.7 14.3 32 32 32 123.7 0 224 100.3 224 224 0 17.7 14.3 32 32 32s32-14.3 32-32C512 128.9 383.1 0 224 0c-17.7 0-32 14.3-32 32m0 96c0 17.7 14.3 32 32 32 70.7 0 128 57.3 128 128 0 17.7 14.3 32 32 32s32-14.3 32-32c0-106-86-192-192-192-17.7 0-32 14.3-32 32m-96 16c0-26.5-21.5-48-48-48S0 117.5 0 144v224c0 79.5 64.5 144 144 144s144-64.5 144-144-64.5-144-144-144h-16v96h16c26.5 0 48 21.5 48 48s-21.5 48-48 48-48-21.5-48-48z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://research.anoma.net" target="_blank" rel="noopener" title="research.anoma.net" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M225.9 32C103.3 32 0 130.5 0 252.1 0 256 .1 480 .1 480l225.8-.2c122.7 0 222.1-102.3 222.1-223.9S348.6 32 225.9 32M224 384c-19.4 0-37.9-4.3-54.4-12.1L88.5 392l22.9-75c-9.8-18.1-15.4-38.9-15.4-61 0-70.7 57.3-128 128-128s128 57.3 128 128-57.3 128-128 128"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://youtube.com/anoma" target="_blank" rel="noopener" title="youtube.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305m-317.51 213.508V175.185l142.739 81.205z"/></svg>
    </a>
  
    
    
    
    
    <a href="mailto:arts@heliax.dev" target="_blank" rel="noopener" title="" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m20 8-8 5-8-5V6l8 5 8-5m0-2H4c-1.11 0-2 .89-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["announce.dismiss", "content.code.annotate", "content.code.copy", "content.tooltips", "navigation.footer", "navigation.path", "navigation.prune", "navigation.tabs", "navigation.sections", "navigation.indexes", "search.highlight", "search.suggest", "search.sharing", "toc.follow"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.56dfad97.min.js"></script>
      
        <script src="../../js/timeago.min.js"></script>
      
        <script src="../../js/timeago_mkdocs_material.js"></script>
      
        <script src="../../assets/js/extra.js"></script>
      
        <script src="../../assets/js/highlight.js"></script>
      
        <script src="../../assets/js/mathjax.js"></script>
      
        <script src="../../https:/polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="../../assets/external/cdn.jsdelivr.net/npm/mathjax@3.0.0/es5/tex-svg.js"></script>
      
    
  <script id="init-glightbox">document.querySelectorAll('.glightbox').forEach(function(element) {
    try {
        var img = element.querySelector('img');
        if (img && img.src) {
            element.setAttribute('href', img.src);
        } else {
            console.log('No img element with src attribute found');
        }
    } catch (error) {
        console.log('Error:', error);
    }
});
const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>