<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml"><meta charset="UTF-8"><link href="https://specs.anoma.net/pr-347/assets/css/juvix-catppuchin.css" rel="stylesheet" type="text/css"><link href="https://specs.anoma.net/pr-347/assets/css/latte-light.css" rel="stylesheet" type="text/css"><link href="https://specs.anoma.net/pr-347/assets/css/juvix-source.css" rel="stylesheet" type="text/css"><script src="https://specs.anoma.net/pr-347/assets/js/highlight.js" type="text/javascript"></script><div id="package-header"><span class="caption"></span></div><pre id="src-content"><span class="ju-keyword">module</span> <span id="arch.system.state.resource_machine.notes.nockma"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma" class="ju-code-link ju-module"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma" class="ju-code-link ju-module"><span class="ju-module"><span class="ju-module">arch.system.state.resource_machine.notes.nockma</span></span></a></span></a></span></span><span class="ju-delimiter">;</span>

<span class="ju-keyword">import</span> <span id="prelude"><span class="annot"><a href="https://specs.anoma.net/pr-347/prelude-src.html#prelude" class="ju-code-link ju-module"><span class="annot"><a href="https://specs.anoma.net/pr-347/prelude-src.html#prelude" class="ju-code-link ju-module"><span class="ju-module"><span class="ju-module">prelude</span></span></a></span></a></span></span> <span class="ju-keyword">open</span><span class="ju-delimiter">;</span>
<span class="ju-keyword">import</span> <span id="Stdlib.Data.Nat"><span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Data/Nat-src.html#Stdlib.Data.Nat" class="ju-code-link ju-module"><span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Data/Nat-src.html#Stdlib.Data.Nat" class="ju-code-link ju-module"><span class="ju-module"><span class="ju-module">Stdlib.Data.Nat</span></span></a></span></a></span></span> <span class="ju-keyword">open</span><span class="ju-delimiter">;</span>
<span class="ju-keyword">import</span> <span id="Stdlib.Data.List"><span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Data/List-src.html#Stdlib.Data.List" class="ju-code-link ju-module"><span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Data/List-src.html#Stdlib.Data.List" class="ju-code-link ju-module"><span class="ju-module"><span class="ju-module">Stdlib.Data.List</span></span></a></span></a></span></span> <span class="ju-keyword">open</span><span class="ju-delimiter">;</span>
<span class="ju-keyword">import</span> <span id="Stdlib.Trait.Show"><span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Show-src.html#Stdlib.Trait.Show" class="ju-code-link ju-module"><span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Show-src.html#Stdlib.Trait.Show" class="ju-code-link ju-module"><span class="ju-module"><span class="ju-module">Stdlib.Trait.Show</span></span></a></span></a></span></span> <span class="ju-keyword">open</span><span class="ju-delimiter">;</span>

<span class="ju-comment">-- Basic Nock types</span>
<span class="ju-keyword">type</span> <span id="Noun"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun" class="ju-code-link ju-inductive"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun" class="ju-code-link ju-inductive"><span class="ju-inductive">Noun</span></a></span></a></span></span> <span class="ju-keyword">:=</span>
  <span class="ju-keyword">|</span> <span id="Noun.Atom"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Atom" class="ju-code-link ju-constructor"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Atom" class="ju-code-link ju-constructor"><span class="ju-constructor">Atom</span></a></span></a></span></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/Nat/Base-src.html#Nat" class="ju-code-link ju-inductive"><span class="ju-inductive">Nat</span></a></span> <span class="ju-keyword">-&gt;</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun" class="ju-code-link ju-inductive"><span class="ju-inductive">Noun</span></a></span>
  <span class="ju-keyword">|</span> <span id="Noun.Cell"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor">Cell</span></a></span></a></span></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun" class="ju-code-link ju-inductive"><span class="ju-inductive">Noun</span></a></span> <span class="ju-keyword">-&gt;</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun" class="ju-code-link ju-inductive"><span class="ju-inductive">Noun</span></a></span> <span class="ju-keyword">-&gt;</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun" class="ju-code-link ju-inductive"><span class="ju-inductive">Noun</span></a></span><span class="ju-delimiter">;</span>

<span class="ju-keyword">terminating</span>
<span id="nounEq"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#nounEq" class="ju-code-link ju-function"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#nounEq" class="ju-code-link ju-function"><span class="ju-function">nounEq</span></a></span></a></span></span> <span class="ju-delimiter">(</span><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:52" class="ju-code-link ju-var"><span class="ju-var">n1</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:53" class="ju-code-link ju-var"><span class="ju-var">n2</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun" class="ju-code-link ju-inductive"><span class="ju-inductive">Noun</span></a></span><span class="ju-delimiter">)</span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/Bool-src.html#Bool" class="ju-code-link ju-inductive"><span class="ju-inductive">Bool</span></a></span> <span class="ju-keyword">:=</span>
  <span class="ju-keyword">case</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/prelude-src.html#mkPair" class="ju-code-link ju-var"><span class="ju-constructor">mkPair</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:52" class="ju-code-link ju-var"><span class="ju-var">n1</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:53" class="ju-code-link ju-var"><span class="ju-var">n2</span></a></span> <span class="ju-keyword">of</span>
    <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/prelude-src.html#mkPair" class="ju-code-link ju-var"><span class="ju-constructor">mkPair</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Atom" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Atom</span></a></span> <span id="arch.system.state.resource_machine.notes.nockma:54"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:54" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:54" class="ju-code-link ju-var"><span class="ju-var">x</span></a></span></a></span></span><span class="ju-delimiter">)</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Atom" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Atom</span></a></span> <span id="arch.system.state.resource_machine.notes.nockma:55"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:55" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:55" class="ju-code-link ju-var"><span class="ju-var">y</span></a></span></a></span></span><span class="ju-delimiter">)</span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:54" class="ju-code-link ju-var"><span class="ju-var">x</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Eq-src.html#==" class="ju-code-link ju-function"><span class="ju-function">==</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:55" class="ju-code-link ju-var"><span class="ju-var">y</span></a></span>
    <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/prelude-src.html#mkPair" class="ju-code-link ju-var"><span class="ju-constructor">mkPair</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span id="arch.system.state.resource_machine.notes.nockma:56"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:56" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:56" class="ju-code-link ju-var"><span class="ju-var">a</span></a></span></a></span></span> <span id="arch.system.state.resource_machine.notes.nockma:57"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:57" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:57" class="ju-code-link ju-var"><span class="ju-var">b</span></a></span></a></span></span><span class="ju-delimiter">)</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span id="arch.system.state.resource_machine.notes.nockma:58"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:58" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:58" class="ju-code-link ju-var"><span class="ju-var">c</span></a></span></a></span></span> <span id="arch.system.state.resource_machine.notes.nockma:59"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:59" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:59" class="ju-code-link ju-var"><span class="ju-var">d</span></a></span></a></span></span><span class="ju-delimiter">)</span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#nounEq" class="ju-code-link ju-function"><span class="ju-function">nounEq</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:56" class="ju-code-link ju-var"><span class="ju-var">a</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:58" class="ju-code-link ju-var"><span class="ju-var">c</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Data/Bool/Base-src.html#&amp;&amp;" class="ju-code-link ju-function"><span class="ju-function">&amp;&amp;</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#nounEq" class="ju-code-link ju-function"><span class="ju-function">nounEq</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:57" class="ju-code-link ju-var"><span class="ju-var">b</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:59" class="ju-code-link ju-var"><span class="ju-var">d</span></a></span>
    <span class="ju-keyword">|</span> <span class="ju-keyword">_</span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/Bool-src.html#Bool.false" class="ju-code-link ju-constructor"><span class="ju-constructor">false</span></a></span><span class="ju-delimiter">;</span>

<span class="ju-keyword">instance</span>
<span id="EqNoun"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#EqNoun" class="ju-code-link ju-function"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#EqNoun" class="ju-code-link ju-function"><span class="ju-function">EqNoun</span></a></span></a></span></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Eq-src.html#Eq" class="ju-code-link ju-inductive"><span class="ju-inductive">Eq</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun" class="ju-code-link ju-inductive"><span class="ju-inductive">Noun</span></a></span> <span class="ju-keyword">:=</span>
  <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Eq-src.html#Eq.mk" class="ju-code-link ju-constructor"><span class="ju-constructor">Eq<span class="ju-delimiter">.</span>mk</span></a></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span>
    <span id="arch.system.state.resource_machine.notes.nockma:60"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:60" class="ju-code-link ju-function"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:60" class="ju-code-link ju-function"><span class="ju-function">isEqual</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#nounEq" class="ju-code-link ju-function"><span class="ju-function">nounEq</span></a></span><span class="ju-delimiter">;</span>
  <span class="ju-delimiter">}</span><span class="ju-delimiter">;</span>

<span class="ju-keyword">terminating</span>
<span id="showNoun"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#showNoun" class="ju-code-link ju-function"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#showNoun" class="ju-code-link ju-function"><span class="ju-function">showNoun</span></a></span></a></span></span> <span class="ju-delimiter">(</span><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:61" class="ju-code-link ju-var"><span class="ju-var">n</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun" class="ju-code-link ju-inductive"><span class="ju-inductive">Noun</span></a></span><span class="ju-delimiter">)</span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/String-src.html#String" class="ju-code-link ju-inductive"><span class="ju-axiom">String</span></a></span> <span class="ju-keyword">:=</span>
  <span class="ju-keyword">case</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:61" class="ju-code-link ju-var"><span class="ju-var">n</span></a></span> <span class="ju-keyword">of</span>
    <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Atom" class="ju-code-link ju-constructor"><span class="ju-constructor">Noun<span class="ju-delimiter">.</span>Atom</span></a></span> <span id="arch.system.state.resource_machine.notes.nockma:62"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:62" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:62" class="ju-code-link ju-var"><span class="ju-var">a</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Data/Nat-src.html#natToString" class="ju-code-link ju-function"><span class="ju-axiom">natToString</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:62" class="ju-code-link ju-var"><span class="ju-var">a</span></a></span>
    <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor">Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span id="arch.system.state.resource_machine.notes.nockma:63"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:63" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:63" class="ju-code-link ju-var"><span class="ju-var">l</span></a></span></a></span></span> <span id="arch.system.state.resource_machine.notes.nockma:64"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:64" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:64" class="ju-code-link ju-var"><span class="ju-var">r</span></a></span></a></span></span> <span class="ju-keyword">:=</span>
      <span class="ju-string">&quot;[&quot;</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/String-src.html#++str" class="ju-code-link ju-function"><span class="ju-axiom">++str</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#showNoun" class="ju-code-link ju-function"><span class="ju-function">showNoun</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:63" class="ju-code-link ju-var"><span class="ju-var">l</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/String-src.html#++str" class="ju-code-link ju-function"><span class="ju-axiom">++str</span></a></span> <span class="ju-string">&quot; &quot;</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/String-src.html#++str" class="ju-code-link ju-function"><span class="ju-axiom">++str</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#showNoun" class="ju-code-link ju-function"><span class="ju-function">showNoun</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:64" class="ju-code-link ju-var"><span class="ju-var">r</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/String-src.html#++str" class="ju-code-link ju-function"><span class="ju-axiom">++str</span></a></span> <span class="ju-string">&quot;]&quot;</span><span class="ju-delimiter">;</span>

<span class="ju-keyword">instance</span>
<span id="ShowNoun"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#ShowNoun" class="ju-code-link ju-function"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#ShowNoun" class="ju-code-link ju-function"><span class="ju-function">ShowNoun</span></a></span></a></span></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Show-src.html#Show" class="ju-code-link ju-inductive"><span class="ju-inductive">Show</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun" class="ju-code-link ju-inductive"><span class="ju-inductive">Noun</span></a></span> <span class="ju-keyword">:=</span>
  <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Show-src.html#Show.mk" class="ju-code-link ju-constructor"><span class="ju-constructor">Show<span class="ju-delimiter">.</span>mk</span></a></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span>
    <span id="arch.system.state.resource_machine.notes.nockma:65"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:65" class="ju-code-link ju-function"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:65" class="ju-code-link ju-function"><span class="ju-function">show</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#showNoun" class="ju-code-link ju-function"><span class="ju-function">showNoun</span></a></span><span class="ju-delimiter">;</span>
  <span class="ju-delimiter">}</span><span class="ju-delimiter">;</span>

<span class="ju-comment">-- Helper to convert storage values to Nouns</span>
<span class="ju-keyword">axiom</span> <span id="convertToNoun"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#convertToNoun" class="ju-code-link ju-axiom"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#convertToNoun" class="ju-code-link ju-axiom"><span class="ju-axiom">convertToNoun</span></a></span></a></span></span> <span class="ju-keyword">:</span> <span class="ju-delimiter">{</span><span id="arch.system.state.resource_machine.notes.nockma:66"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:66" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:66" class="ju-code-link ju-var"><span class="ju-var">val</span></a></span></a></span></span> <span class="ju-keyword">:</span> <span class="ju-keyword">Type</span><span class="ju-delimiter">}</span> <span class="ju-keyword">-&gt;</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:66" class="ju-code-link ju-var"><span class="ju-var">val</span></a></span> <span class="ju-keyword">-&gt;</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun" class="ju-code-link ju-inductive"><span class="ju-inductive">Noun</span></a></span><span class="ju-delimiter">;</span>

<span class="ju-comment">-- Helper to convert Nouns to storage values</span>
<span class="ju-keyword">axiom</span> <span id="convertFromNoun"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#convertFromNoun" class="ju-code-link ju-axiom"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#convertFromNoun" class="ju-code-link ju-axiom"><span class="ju-axiom">convertFromNoun</span></a></span></a></span></span> <span class="ju-keyword">:</span> <span class="ju-delimiter">{</span><span id="arch.system.state.resource_machine.notes.nockma:67"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:67" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:67" class="ju-code-link ju-var"><span class="ju-var">val</span></a></span></a></span></span> <span class="ju-keyword">:</span> <span class="ju-keyword">Type</span><span class="ju-delimiter">}</span> <span class="ju-keyword">-&gt;</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun" class="ju-code-link ju-inductive"><span class="ju-inductive">Noun</span></a></span> <span class="ju-keyword">-&gt;</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/prelude-src.html#Option" class="ju-code-link ju-var"><span class="ju-inductive">Option</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:67" class="ju-code-link ju-var"><span class="ju-var">val</span></a></span><span class="ju-delimiter">;</span>

<span class="ju-keyword">type</span> <span id="ScryOp"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#ScryOp" class="ju-code-link ju-inductive"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#ScryOp" class="ju-code-link ju-inductive"><span class="ju-inductive">ScryOp</span></a></span></a></span></span> <span class="ju-keyword">:=</span>
  <span class="ju-keyword">|</span> <span id="ScryOp.Direct"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#ScryOp.Direct" class="ju-code-link ju-constructor"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#ScryOp.Direct" class="ju-code-link ju-constructor"><span class="ju-constructor">Direct</span></a></span></a></span></span>
  <span class="ju-keyword">|</span> <span id="ScryOp.Index"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#ScryOp.Index" class="ju-code-link ju-constructor"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#ScryOp.Index" class="ju-code-link ju-constructor"><span class="ju-constructor">Index</span></a></span></a></span></span><span class="ju-delimiter">;</span>

<span class="ju-keyword">type</span> <span id="Storage"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Storage" class="ju-code-link ju-inductive"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Storage" class="ju-code-link ju-inductive"><span class="ju-inductive">Storage</span></a></span></a></span></span> <span id="arch.system.state.resource_machine.notes.nockma:68"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:68" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:68" class="ju-code-link ju-var"><span class="ju-var">addr</span></a></span></a></span></span> <span id="arch.system.state.resource_machine.notes.nockma:69"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:69" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:69" class="ju-code-link ju-var"><span class="ju-var">val</span></a></span></a></span></span> <span class="ju-keyword">:=</span>
  <span id="Storage.mkStorage"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Storage.mkStorage" class="ju-code-link ju-constructor"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Storage.mkStorage" class="ju-code-link ju-constructor"><span class="ju-constructor">mkStorage</span></a></span></a></span></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span>
    <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:72" class="ju-code-link ju-var"><span class="ju-var">readDirect</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:68" class="ju-code-link ju-var"><span class="ju-var">addr</span></a></span> <span class="ju-keyword">-&gt;</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/prelude-src.html#Option" class="ju-code-link ju-var"><span class="ju-inductive">Option</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:69" class="ju-code-link ju-var"><span class="ju-var">val</span></a></span><span class="ju-delimiter">;</span>
    <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:73" class="ju-code-link ju-var"><span class="ju-var">readIndex</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:69" class="ju-code-link ju-var"><span class="ju-var">val</span></a></span> <span class="ju-keyword">-&gt;</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/prelude-src.html#Option" class="ju-code-link ju-var"><span class="ju-inductive">Option</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:69" class="ju-code-link ju-var"><span class="ju-var">val</span></a></span><span class="ju-delimiter">;</span>
  <span class="ju-delimiter">}</span><span class="ju-delimiter">;</span>
<span id="emptyStorage"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#emptyStorage" class="ju-code-link ju-function"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#emptyStorage" class="ju-code-link ju-function"><span class="ju-function">
emptyStorage</span></a></span></a></span></span> <span class="ju-delimiter">{</span><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:80" class="ju-code-link ju-var"><span class="ju-var">addr</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:81" class="ju-code-link ju-var"><span class="ju-var">val</span></a></span> <span class="ju-keyword">:</span> <span class="ju-keyword">Type</span><span class="ju-delimiter">}</span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Storage" class="ju-code-link ju-inductive"><span class="ju-inductive">Storage</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:80" class="ju-code-link ju-var"><span class="ju-var">addr</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:81" class="ju-code-link ju-var"><span class="ju-var">val</span></a></span> <span class="ju-keyword">:=</span>
  <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Storage.mkStorage" class="ju-code-link ju-constructor"><span class="ju-constructor">Storage<span class="ju-delimiter">.</span>mkStorage</span></a></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span>
    <span id="arch.system.state.resource_machine.notes.nockma:82"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:82" class="ju-code-link ju-function"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:82" class="ju-code-link ju-function"><span class="ju-function">readDirect</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="ju-keyword">\</span><span class="ju-delimiter">{</span><span class="ju-keyword">_</span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/prelude-src.html#none" class="ju-code-link ju-var"><span class="ju-constructor">none</span></a></span><span class="ju-delimiter">}</span><span class="ju-delimiter">;</span>
    <span id="arch.system.state.resource_machine.notes.nockma:83"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:83" class="ju-code-link ju-function"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:83" class="ju-code-link ju-function"><span class="ju-function">readIndex</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="ju-keyword">\</span><span class="ju-delimiter">{</span><span class="ju-keyword">_</span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/prelude-src.html#none" class="ju-code-link ju-var"><span class="ju-constructor">none</span></a></span><span class="ju-delimiter">}</span><span class="ju-delimiter">;</span>
  <span class="ju-delimiter">}</span><span class="ju-delimiter">;</span>

<span class="ju-keyword">axiom</span> <span id="externalStorage"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#externalStorage" class="ju-code-link ju-axiom"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#externalStorage" class="ju-code-link ju-axiom"><span class="ju-axiom">externalStorage</span></a></span></a></span></span> <span class="ju-keyword">:</span> <span class="ju-delimiter">{</span><span id="arch.system.state.resource_machine.notes.nockma:84"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:84" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:84" class="ju-code-link ju-var"><span class="ju-var">addr</span></a></span></a></span></span> <span id="arch.system.state.resource_machine.notes.nockma:85"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:85" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:85" class="ju-code-link ju-var"><span class="ju-var">val</span></a></span></a></span></span> <span class="ju-keyword">:</span> <span class="ju-keyword">Type</span><span class="ju-delimiter">}</span> <span class="ju-keyword">-&gt;</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Storage" class="ju-code-link ju-inductive"><span class="ju-inductive">Storage</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:84" class="ju-code-link ju-var"><span class="ju-var">addr</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:85" class="ju-code-link ju-var"><span class="ju-var">val</span></a></span><span class="ju-delimiter">;</span>

<span class="ju-keyword">type</span> <span id="NockOp"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp" class="ju-code-link ju-inductive"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp" class="ju-code-link ju-inductive"><span class="ju-inductive">NockOp</span></a></span></a></span></span> <span class="ju-keyword">:=</span>
  <span class="ju-keyword">|</span> <span id="NockOp.Slash"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.Slash" class="ju-code-link ju-constructor"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.Slash" class="ju-code-link ju-constructor"><span class="ju-constructor">Slash</span></a></span></a></span></span>
  <span class="ju-comment">-- /</span>
  <span class="ju-keyword">|</span> <span id="NockOp.Constant"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.Constant" class="ju-code-link ju-constructor"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.Constant" class="ju-code-link ju-constructor"><span class="ju-constructor">Constant</span></a></span></a></span></span>
  <span class="ju-comment">-- Returns operand unchanged</span>
  <span class="ju-keyword">|</span> <span id="NockOp.Apply"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.Apply" class="ju-code-link ju-constructor"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.Apply" class="ju-code-link ju-constructor"><span class="ju-constructor">Apply</span></a></span></a></span></span>
  <span class="ju-keyword">|</span> <span id="NockOp.CellTest"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.CellTest" class="ju-code-link ju-constructor"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.CellTest" class="ju-code-link ju-constructor"><span class="ju-constructor">CellTest</span></a></span></a></span></span>
  <span class="ju-comment">-- ?</span>
  <span class="ju-keyword">|</span> <span id="NockOp.Increment"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.Increment" class="ju-code-link ju-constructor"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.Increment" class="ju-code-link ju-constructor"><span class="ju-constructor">Increment</span></a></span></a></span></span>
  <span class="ju-comment">-- +</span>
  <span class="ju-keyword">|</span> <span id="NockOp.EqualOp"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.EqualOp" class="ju-code-link ju-constructor"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.EqualOp" class="ju-code-link ju-constructor"><span class="ju-constructor">EqualOp</span></a></span></a></span></span>
  <span class="ju-comment">-- =</span>
  <span class="ju-keyword">|</span> <span id="NockOp.IfThenElse"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.IfThenElse" class="ju-code-link ju-constructor"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.IfThenElse" class="ju-code-link ju-constructor"><span class="ju-constructor">IfThenElse</span></a></span></a></span></span>
  <span class="ju-comment">-- 6</span>
  <span class="ju-keyword">|</span> <span id="NockOp.Compose"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.Compose" class="ju-code-link ju-constructor"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.Compose" class="ju-code-link ju-constructor"><span class="ju-constructor">Compose</span></a></span></a></span></span>
  <span class="ju-comment">-- 7</span>
  <span class="ju-keyword">|</span> <span id="NockOp.Extend"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.Extend" class="ju-code-link ju-constructor"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.Extend" class="ju-code-link ju-constructor"><span class="ju-constructor">Extend</span></a></span></a></span></span>
  <span class="ju-comment">-- 8</span>
  <span class="ju-keyword">|</span> <span id="NockOp.Invoke"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.Invoke" class="ju-code-link ju-constructor"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.Invoke" class="ju-code-link ju-constructor"><span class="ju-constructor">Invoke</span></a></span></a></span></span>
  <span class="ju-comment">-- 9</span>
  <span class="ju-keyword">|</span> <span id="NockOp.Pound"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.Pound" class="ju-code-link ju-constructor"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.Pound" class="ju-code-link ju-constructor"><span class="ju-constructor">Pound</span></a></span></a></span></span>
  <span class="ju-comment">-- #</span>
  <span class="ju-keyword">|</span> <span id="NockOp.Match"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.Match" class="ju-code-link ju-constructor"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.Match" class="ju-code-link ju-constructor"><span class="ju-constructor">Match</span></a></span></a></span></span>
  <span class="ju-comment">-- 11</span>
  <span class="ju-keyword">|</span> <span id="NockOp.Scry"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.Scry" class="ju-code-link ju-constructor"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.Scry" class="ju-code-link ju-constructor"><span class="ju-constructor">Scry</span></a></span></a></span></span><span class="ju-delimiter">;</span>
<span id="opOr"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#opOr" class="ju-code-link ju-function"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#opOr" class="ju-code-link ju-function"><span class="ju-function">
<span class="ju-comment">-- 12</span>
opOr</span></a></span></a></span></span> <span class="ju-delimiter">{</span><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:86" class="ju-code-link ju-var"><span class="ju-var">A</span></a></span> <span class="ju-keyword">:</span> <span class="ju-keyword">Type</span><span class="ju-delimiter">}</span> <span class="ju-delimiter">(</span><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:87" class="ju-code-link ju-var"><span class="ju-var">n</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:88" class="ju-code-link ju-var"><span class="ju-var">m</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/prelude-src.html#Option" class="ju-code-link ju-var"><span class="ju-inductive">Option</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:86" class="ju-code-link ju-var"><span class="ju-var">A</span></a></span><span class="ju-delimiter">)</span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/prelude-src.html#Option" class="ju-code-link ju-var"><span class="ju-inductive">Option</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:86" class="ju-code-link ju-var"><span class="ju-var">A</span></a></span> <span class="ju-keyword">:=</span>
  <span class="ju-keyword">case</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:87" class="ju-code-link ju-var"><span class="ju-var">n</span></a></span> <span class="ju-keyword">of</span>
    <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/prelude-src.html#none" class="ju-code-link ju-var"><span class="ju-constructor">none</span></a></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:88" class="ju-code-link ju-var"><span class="ju-var">m</span></a></span>
    <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/prelude-src.html#some" class="ju-code-link ju-var"><span class="ju-constructor">some</span></a></span> <span id="arch.system.state.resource_machine.notes.nockma:89"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:89" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:89" class="ju-code-link ju-var"><span class="ju-var">n</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/prelude-src.html#some" class="ju-code-link ju-var"><span class="ju-constructor">some</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:89" class="ju-code-link ju-var"><span class="ju-var">n</span></a></span><span class="ju-delimiter">;</span>
<span id="parseOp"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#parseOp" class="ju-code-link ju-function"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#parseOp" class="ju-code-link ju-function"><span class="ju-function">
parseOp</span></a></span></a></span></span> <span class="ju-delimiter">(</span><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:90" class="ju-code-link ju-var"><span class="ju-var">n</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/Nat/Base-src.html#Nat" class="ju-code-link ju-inductive"><span class="ju-inductive">Nat</span></a></span><span class="ju-delimiter">)</span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/prelude-src.html#Option" class="ju-code-link ju-var"><span class="ju-inductive">Option</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp" class="ju-code-link ju-inductive"><span class="ju-inductive">NockOp</span></a></span> <span class="ju-keyword">:=</span>
  <span class="ju-keyword">let</span>
    <span id="test"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#test" class="ju-code-link ju-function"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#test" class="ju-code-link ju-function"><span class="ju-function">test</span></a></span></a></span></span> <span class="ju-keyword">:=</span>
      <span class="ju-keyword">\</span><span class="ju-delimiter">{</span><span id="arch.system.state.resource_machine.notes.nockma:91"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:91" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:91" class="ju-code-link ju-var"><span class="ju-var">m</span></a></span></a></span></span> <span id="arch.system.state.resource_machine.notes.nockma:92"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:92" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:92" class="ju-code-link ju-var"><span class="ju-var">op</span></a></span></a></span></span> <span class="ju-keyword">:=</span>
        <span class="ju-keyword">case</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:90" class="ju-code-link ju-var"><span class="ju-var">n</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Eq-src.html#==" class="ju-code-link ju-function"><span class="ju-function">==</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:91" class="ju-code-link ju-var"><span class="ju-var">m</span></a></span> <span class="ju-keyword">of</span>
          <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/Bool-src.html#Bool.true" class="ju-code-link ju-constructor"><span class="ju-constructor">true</span></a></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/prelude-src.html#some" class="ju-code-link ju-var"><span class="ju-constructor">some</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:92" class="ju-code-link ju-var"><span class="ju-var">op</span></a></span>
          <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/Bool-src.html#Bool.false" class="ju-code-link ju-constructor"><span class="ju-constructor">false</span></a></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/prelude-src.html#none" class="ju-code-link ju-var"><span class="ju-constructor">none</span></a></span><span class="ju-delimiter">}</span><span class="ju-delimiter">;</span>
  <span class="ju-keyword">in</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Foldable/Monomorphic-src.html#foldr" class="ju-code-link ju-function"><span class="ju-function">foldr</span></a></span>
    <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#opOr" class="ju-code-link ju-function"><span class="ju-function">opOr</span></a></span>
    <span class="annot"><a href="https://specs.anoma.net/pr-347/prelude-src.html#none" class="ju-code-link ju-var"><span class="ju-constructor">none</span></a></span>
    <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Data/List/Base-src.html#zipWith" class="ju-code-link ju-function"><span class="ju-function"><span class="ju-delimiter">(</span>zipWith</span></a></span>
      <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#test" class="ju-code-link ju-function"><span class="ju-function">test</span></a></span>
      <span class="ju-delimiter">[</span><span class="ju-number">0</span><span class="ju-delimiter">;</span> <span class="ju-number">1</span><span class="ju-delimiter">;</span> <span class="ju-number">2</span><span class="ju-delimiter">;</span> <span class="ju-number">3</span><span class="ju-delimiter">;</span> <span class="ju-number">4</span><span class="ju-delimiter">;</span> <span class="ju-number">5</span><span class="ju-delimiter">;</span> <span class="ju-number">6</span><span class="ju-delimiter">;</span> <span class="ju-number">7</span><span class="ju-delimiter">;</span> <span class="ju-number">8</span><span class="ju-delimiter">;</span> <span class="ju-number">9</span><span class="ju-delimiter">;</span> <span class="ju-number">10</span><span class="ju-delimiter">;</span> <span class="ju-number">11</span><span class="ju-delimiter">;</span> <span class="ju-number">12</span><span class="ju-delimiter">]</span>
      <span class="ju-delimiter">[</span>
        <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.Slash" class="ju-code-link ju-constructor"><span class="ju-constructor">NockOp<span class="ju-delimiter">.</span>Slash</span></a></span><span class="ju-delimiter">;</span>
        <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.Constant" class="ju-code-link ju-constructor"><span class="ju-constructor">NockOp<span class="ju-delimiter">.</span>Constant</span></a></span><span class="ju-delimiter">;</span>
        <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.Apply" class="ju-code-link ju-constructor"><span class="ju-constructor">NockOp<span class="ju-delimiter">.</span>Apply</span></a></span><span class="ju-delimiter">;</span>
        <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.CellTest" class="ju-code-link ju-constructor"><span class="ju-constructor">NockOp<span class="ju-delimiter">.</span>CellTest</span></a></span><span class="ju-delimiter">;</span>
        <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.Increment" class="ju-code-link ju-constructor"><span class="ju-constructor">NockOp<span class="ju-delimiter">.</span>Increment</span></a></span><span class="ju-delimiter">;</span>
        <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.EqualOp" class="ju-code-link ju-constructor"><span class="ju-constructor">NockOp<span class="ju-delimiter">.</span>EqualOp</span></a></span><span class="ju-delimiter">;</span>
        <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.IfThenElse" class="ju-code-link ju-constructor"><span class="ju-constructor">NockOp<span class="ju-delimiter">.</span>IfThenElse</span></a></span><span class="ju-delimiter">;</span>
        <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.Compose" class="ju-code-link ju-constructor"><span class="ju-constructor">NockOp<span class="ju-delimiter">.</span>Compose</span></a></span><span class="ju-delimiter">;</span>
        <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.Extend" class="ju-code-link ju-constructor"><span class="ju-constructor">NockOp<span class="ju-delimiter">.</span>Extend</span></a></span><span class="ju-delimiter">;</span>
        <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.Invoke" class="ju-code-link ju-constructor"><span class="ju-constructor">NockOp<span class="ju-delimiter">.</span>Invoke</span></a></span><span class="ju-delimiter">;</span>
        <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.Pound" class="ju-code-link ju-constructor"><span class="ju-constructor">NockOp<span class="ju-delimiter">.</span>Pound</span></a></span><span class="ju-delimiter">;</span>
        <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.Match" class="ju-code-link ju-constructor"><span class="ju-constructor">NockOp<span class="ju-delimiter">.</span>Match</span></a></span><span class="ju-delimiter">;</span>
        <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.Scry" class="ju-code-link ju-constructor"><span class="ju-constructor">NockOp<span class="ju-delimiter">.</span>Scry</span></a></span><span class="ju-delimiter">;</span>
      <span class="ju-delimiter">]</span><span class="ju-delimiter">)</span><span class="ju-delimiter">;</span>

<span class="ju-comment">-- Monad to encompass gas consumption and error handling.</span>
<span class="ju-keyword">type</span> <span id="GasState"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#GasState" class="ju-code-link ju-inductive"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#GasState" class="ju-code-link ju-inductive"><span class="ju-inductive">GasState</span></a></span></a></span></span> <span id="arch.system.state.resource_machine.notes.nockma:94"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:94" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:94" class="ju-code-link ju-var"><span class="ju-var">A</span></a></span></a></span></span> <span class="ju-keyword">:=</span>
  <span id="GasState.mk"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#GasState.mk" class="ju-code-link ju-constructor"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#GasState.mk" class="ju-code-link ju-constructor"><span class="ju-constructor">mk</span></a></span></a></span></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span>
    <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:96" class="ju-code-link ju-var"><span class="ju-var">runGasState</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/Nat/Base-src.html#Nat" class="ju-code-link ju-inductive"><span class="ju-inductive">Nat</span></a></span> <span class="ju-keyword">-&gt;</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Data/Result/Base-src.html#Result" class="ju-code-link ju-inductive"><span class="ju-inductive">Result</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/String-src.html#String" class="ju-code-link ju-inductive"><span class="ju-axiom">String</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Data/Pair/Base-src.html#Pair" class="ju-code-link ju-inductive"><span class="ju-inductive"><span class="ju-delimiter">(</span>Pair</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:94" class="ju-code-link ju-var"><span class="ju-var">A</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/Nat/Base-src.html#Nat" class="ju-code-link ju-inductive"><span class="ju-inductive">Nat</span></a></span><span class="ju-delimiter">)</span><span class="ju-delimiter">;</span>
  <span class="ju-delimiter">}</span><span class="ju-delimiter">;</span>

<span class="ju-keyword">instance</span>
<span id="GasStateMonad"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#GasStateMonad" class="ju-code-link ju-function"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#GasStateMonad" class="ju-code-link ju-function"><span class="ju-function">GasStateMonad</span></a></span></a></span></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Monad-src.html#Monad" class="ju-code-link ju-inductive"><span class="ju-inductive">Monad</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#GasState" class="ju-code-link ju-inductive"><span class="ju-inductive">GasState</span></a></span> <span class="ju-keyword">:=</span>
  <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Monad-src.html#Monad.mk" class="ju-code-link ju-constructor"><span class="ju-constructor">Monad<span class="ju-delimiter">.</span>mk</span></a></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span>
    <span id="arch.system.state.resource_machine.notes.nockma:120"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:120" class="ju-code-link ju-function"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:120" class="ju-code-link ju-function"><span class="ju-function">applicative</span></a></span></a></span></span> <span class="ju-keyword">:=</span>
      <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Applicative-src.html#Applicative.mk" class="ju-code-link ju-constructor"><span class="ju-constructor">Applicative<span class="ju-delimiter">.</span>mk</span></a></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span>
        <span id="arch.system.state.resource_machine.notes.nockma:106"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:106" class="ju-code-link ju-function"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:106" class="ju-code-link ju-function"><span class="ju-function">functor</span></a></span></a></span></span> <span class="ju-keyword">:=</span>
          <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Functor/Polymorphic-src.html#Functor.mk" class="ju-code-link ju-constructor"><span class="ju-constructor">Functor<span class="ju-delimiter">.</span>mk</span></a></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span>
            <span id="arch.system.state.resource_machine.notes.nockma:105"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:105" class="ju-code-link ju-function"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:105" class="ju-code-link ju-function"><span class="ju-function">map</span></a></span></a></span></span> <span class="ju-keyword">:=</span>
              <span class="ju-keyword">\</span><span class="ju-delimiter">{</span><span id="arch.system.state.resource_machine.notes.nockma:99"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:99" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:99" class="ju-code-link ju-var"><span class="ju-var">f</span></a></span></a></span></span> <span id="arch.system.state.resource_machine.notes.nockma:100"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:100" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:100" class="ju-code-link ju-var"><span class="ju-var">s</span></a></span></a></span></span> <span class="ju-keyword">:=</span>
                <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#GasState.mk" class="ju-code-link ju-constructor"><span class="ju-constructor">GasState<span class="ju-delimiter">.</span>mk</span></a></span>
                  <span class="ju-keyword">\</span><span class="ju-delimiter">{</span><span id="arch.system.state.resource_machine.notes.nockma:101"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:101" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:101" class="ju-code-link ju-var"><span class="ju-var">gas</span></a></span></a></span></span> <span class="ju-keyword">:=</span>
                    <span class="ju-keyword">case</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#GasState.runGasState" class="ju-code-link ju-function"><span class="ju-function">GasState<span class="ju-delimiter">.</span>runGasState</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:100" class="ju-code-link ju-var"><span class="ju-var">s</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:101" class="ju-code-link ju-var"><span class="ju-var">gas</span></a></span> <span class="ju-keyword">of</span>
                      <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Data/Result/Base-src.html#Result.ok" class="ju-code-link ju-constructor"><span class="ju-constructor">ok</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/prelude-src.html#mkPair" class="ju-code-link ju-var"><span class="ju-constructor"><span class="ju-delimiter">(</span>mkPair</span></a></span> <span id="arch.system.state.resource_machine.notes.nockma:102"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:102" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:102" class="ju-code-link ju-var"><span class="ju-var">x</span></a></span></a></span></span> <span id="arch.system.state.resource_machine.notes.nockma:103"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:103" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:103" class="ju-code-link ju-var"><span class="ju-var">remaining</span></a></span></a></span></span><span class="ju-delimiter">)</span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Data/Result/Base-src.html#Result.ok" class="ju-code-link ju-constructor"><span class="ju-constructor">ok</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/prelude-src.html#mkPair" class="ju-code-link ju-var"><span class="ju-constructor"><span class="ju-delimiter">(</span>mkPair</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:99" class="ju-code-link ju-var"><span class="ju-var"><span class="ju-delimiter">(</span>f</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:102" class="ju-code-link ju-var"><span class="ju-var">x</span></a></span><span class="ju-delimiter">)</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:103" class="ju-code-link ju-var"><span class="ju-var">remaining</span></a></span><span class="ju-delimiter">)</span>
                      <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Data/Result/Base-src.html#Result.error" class="ju-code-link ju-constructor"><span class="ju-constructor">error</span></a></span> <span id="arch.system.state.resource_machine.notes.nockma:104"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:104" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:104" class="ju-code-link ju-var"><span class="ju-var">e</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Data/Result/Base-src.html#Result.error" class="ju-code-link ju-constructor"><span class="ju-constructor">error</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:104" class="ju-code-link ju-var"><span class="ju-var">e</span></a></span><span class="ju-delimiter">}</span><span class="ju-delimiter">}</span><span class="ju-delimiter">;</span>
          <span class="ju-delimiter">}</span><span class="ju-delimiter">;</span>
        <span id="arch.system.state.resource_machine.notes.nockma:109"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:109" class="ju-code-link ju-function"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:109" class="ju-code-link ju-function"><span class="ju-function">pure</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="ju-keyword">\</span><span class="ju-delimiter">{</span><span id="arch.system.state.resource_machine.notes.nockma:107"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:107" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:107" class="ju-code-link ju-var"><span class="ju-var">x</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#GasState.mk" class="ju-code-link ju-constructor"><span class="ju-constructor">GasState<span class="ju-delimiter">.</span>mk</span></a></span> <span class="ju-keyword">\</span><span class="ju-delimiter">{</span><span id="arch.system.state.resource_machine.notes.nockma:108"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:108" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:108" class="ju-code-link ju-var"><span class="ju-var">gas</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Data/Result/Base-src.html#Result.ok" class="ju-code-link ju-constructor"><span class="ju-constructor">ok</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/prelude-src.html#mkPair" class="ju-code-link ju-var"><span class="ju-constructor"><span class="ju-delimiter">(</span>mkPair</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:107" class="ju-code-link ju-var"><span class="ju-var">x</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:108" class="ju-code-link ju-var"><span class="ju-var">gas</span></a></span><span class="ju-delimiter">)</span><span class="ju-delimiter">}</span><span class="ju-delimiter">}</span><span class="ju-delimiter">;</span>
        <span id="arch.system.state.resource_machine.notes.nockma:119"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:119" class="ju-code-link ju-function"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:119" class="ju-code-link ju-function"><span class="ju-function">ap</span></a></span></a></span></span> <span class="ju-keyword">:=</span>
          <span class="ju-keyword">\</span><span class="ju-delimiter">{</span><span id="arch.system.state.resource_machine.notes.nockma:110"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:110" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:110" class="ju-code-link ju-var"><span class="ju-var">sf</span></a></span></a></span></span> <span id="arch.system.state.resource_machine.notes.nockma:111"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:111" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:111" class="ju-code-link ju-var"><span class="ju-var">sa</span></a></span></a></span></span> <span class="ju-keyword">:=</span>
            <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#GasState.mk" class="ju-code-link ju-constructor"><span class="ju-constructor">GasState<span class="ju-delimiter">.</span>mk</span></a></span>
              <span class="ju-keyword">\</span><span class="ju-delimiter">{</span><span id="arch.system.state.resource_machine.notes.nockma:112"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:112" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:112" class="ju-code-link ju-var"><span class="ju-var">gas</span></a></span></a></span></span> <span class="ju-keyword">:=</span>
                <span class="ju-keyword">case</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#GasState.runGasState" class="ju-code-link ju-function"><span class="ju-function">GasState<span class="ju-delimiter">.</span>runGasState</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:110" class="ju-code-link ju-var"><span class="ju-var">sf</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:112" class="ju-code-link ju-var"><span class="ju-var">gas</span></a></span> <span class="ju-keyword">of</span>
                  <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Data/Result/Base-src.html#Result.ok" class="ju-code-link ju-constructor"><span class="ju-constructor">ok</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/prelude-src.html#mkPair" class="ju-code-link ju-var"><span class="ju-constructor"><span class="ju-delimiter">(</span>mkPair</span></a></span> <span id="arch.system.state.resource_machine.notes.nockma:113"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:113" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:113" class="ju-code-link ju-var"><span class="ju-var">f</span></a></span></a></span></span> <span id="arch.system.state.resource_machine.notes.nockma:114"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:114" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:114" class="ju-code-link ju-var"><span class="ju-var">remaining</span></a></span></a></span></span><span class="ju-delimiter">)</span> <span class="ju-keyword">:=</span>
                    <span class="ju-keyword">case</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#GasState.runGasState" class="ju-code-link ju-function"><span class="ju-function">GasState<span class="ju-delimiter">.</span>runGasState</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:111" class="ju-code-link ju-var"><span class="ju-var">sa</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:114" class="ju-code-link ju-var"><span class="ju-var">remaining</span></a></span> <span class="ju-keyword">of</span> <span class="ju-delimiter">{</span>
                      <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Data/Result/Base-src.html#Result.ok" class="ju-code-link ju-constructor"><span class="ju-constructor">ok</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/prelude-src.html#mkPair" class="ju-code-link ju-var"><span class="ju-constructor"><span class="ju-delimiter">(</span>mkPair</span></a></span> <span id="arch.system.state.resource_machine.notes.nockma:115"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:115" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:115" class="ju-code-link ju-var"><span class="ju-var">x</span></a></span></a></span></span> <span id="arch.system.state.resource_machine.notes.nockma:116"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:116" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:116" class="ju-code-link ju-var"><span class="ju-var">final</span></a></span></a></span></span><span class="ju-delimiter">)</span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Data/Result/Base-src.html#Result.ok" class="ju-code-link ju-constructor"><span class="ju-constructor">ok</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/prelude-src.html#mkPair" class="ju-code-link ju-var"><span class="ju-constructor"><span class="ju-delimiter">(</span>mkPair</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:113" class="ju-code-link ju-var"><span class="ju-var"><span class="ju-delimiter">(</span>f</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:115" class="ju-code-link ju-var"><span class="ju-var">x</span></a></span><span class="ju-delimiter">)</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:116" class="ju-code-link ju-var"><span class="ju-var">final</span></a></span><span class="ju-delimiter">)</span>
                      <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Data/Result/Base-src.html#Result.error" class="ju-code-link ju-constructor"><span class="ju-constructor">error</span></a></span> <span id="arch.system.state.resource_machine.notes.nockma:117"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:117" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:117" class="ju-code-link ju-var"><span class="ju-var">e</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Data/Result/Base-src.html#Result.error" class="ju-code-link ju-constructor"><span class="ju-constructor">error</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:117" class="ju-code-link ju-var"><span class="ju-var">e</span></a></span>
                    <span class="ju-delimiter">}</span>
                  <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Data/Result/Base-src.html#Result.error" class="ju-code-link ju-constructor"><span class="ju-constructor">error</span></a></span> <span id="arch.system.state.resource_machine.notes.nockma:118"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:118" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:118" class="ju-code-link ju-var"><span class="ju-var">e</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Data/Result/Base-src.html#Result.error" class="ju-code-link ju-constructor"><span class="ju-constructor">error</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:118" class="ju-code-link ju-var"><span class="ju-var">e</span></a></span><span class="ju-delimiter">}</span><span class="ju-delimiter">}</span><span class="ju-delimiter">;</span>
      <span class="ju-delimiter">}</span><span class="ju-delimiter">;</span>
    <span id="arch.system.state.resource_machine.notes.nockma:127"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:127" class="ju-code-link ju-function"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:127" class="ju-code-link ju-function"><span class="ju-function">bind</span></a></span></a></span></span> <span class="ju-keyword">:=</span>
      <span class="ju-keyword">\</span><span class="ju-delimiter">{</span><span id="arch.system.state.resource_machine.notes.nockma:121"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:121" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:121" class="ju-code-link ju-var"><span class="ju-var">ma</span></a></span></a></span></span> <span id="arch.system.state.resource_machine.notes.nockma:122"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:122" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:122" class="ju-code-link ju-var"><span class="ju-var">f</span></a></span></a></span></span> <span class="ju-keyword">:=</span>
        <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#GasState.mk" class="ju-code-link ju-constructor"><span class="ju-constructor">GasState<span class="ju-delimiter">.</span>mk</span></a></span>
          <span class="ju-keyword">\</span><span class="ju-delimiter">{</span><span id="arch.system.state.resource_machine.notes.nockma:123"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:123" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:123" class="ju-code-link ju-var"><span class="ju-var">gas</span></a></span></a></span></span> <span class="ju-keyword">:=</span>
            <span class="ju-keyword">case</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#GasState.runGasState" class="ju-code-link ju-function"><span class="ju-function">GasState<span class="ju-delimiter">.</span>runGasState</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:121" class="ju-code-link ju-var"><span class="ju-var">ma</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:123" class="ju-code-link ju-var"><span class="ju-var">gas</span></a></span> <span class="ju-keyword">of</span>
              <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Data/Result/Base-src.html#Result.ok" class="ju-code-link ju-constructor"><span class="ju-constructor">ok</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/prelude-src.html#mkPair" class="ju-code-link ju-var"><span class="ju-constructor"><span class="ju-delimiter">(</span>mkPair</span></a></span> <span id="arch.system.state.resource_machine.notes.nockma:124"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:124" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:124" class="ju-code-link ju-var"><span class="ju-var">a</span></a></span></a></span></span> <span id="arch.system.state.resource_machine.notes.nockma:125"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:125" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:125" class="ju-code-link ju-var"><span class="ju-var">remaining</span></a></span></a></span></span><span class="ju-delimiter">)</span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#GasState.runGasState" class="ju-code-link ju-function"><span class="ju-function">GasState<span class="ju-delimiter">.</span>runGasState</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:122" class="ju-code-link ju-var"><span class="ju-var"><span class="ju-delimiter">(</span>f</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:124" class="ju-code-link ju-var"><span class="ju-var">a</span></a></span><span class="ju-delimiter">)</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:125" class="ju-code-link ju-var"><span class="ju-var">remaining</span></a></span>
              <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Data/Result/Base-src.html#Result.error" class="ju-code-link ju-constructor"><span class="ju-constructor">error</span></a></span> <span id="arch.system.state.resource_machine.notes.nockma:126"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:126" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:126" class="ju-code-link ju-var"><span class="ju-var">e</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Data/Result/Base-src.html#Result.error" class="ju-code-link ju-constructor"><span class="ju-constructor">error</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:126" class="ju-code-link ju-var"><span class="ju-var">e</span></a></span><span class="ju-delimiter">}</span><span class="ju-delimiter">}</span><span class="ju-delimiter">;</span>
  <span class="ju-delimiter">}</span><span class="ju-delimiter">;</span>
<span id="err"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#err" class="ju-code-link ju-function"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#err" class="ju-code-link ju-function"><span class="ju-function">
err</span></a></span></a></span></span> <span class="ju-delimiter">{</span><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:128" class="ju-code-link ju-var"><span class="ju-var">A</span></a></span> <span class="ju-keyword">:</span> <span class="ju-keyword">Type</span><span class="ju-delimiter">}</span> <span class="ju-delimiter">(</span><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:129" class="ju-code-link ju-var"><span class="ju-var">str</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/String-src.html#String" class="ju-code-link ju-inductive"><span class="ju-axiom">String</span></a></span><span class="ju-delimiter">)</span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#GasState" class="ju-code-link ju-inductive"><span class="ju-inductive">GasState</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:128" class="ju-code-link ju-var"><span class="ju-var">A</span></a></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#GasState.mk" class="ju-code-link ju-constructor"><span class="ju-constructor">GasState<span class="ju-delimiter">.</span>mk</span></a></span> <span class="ju-keyword">\</span><span class="ju-delimiter">{</span><span class="ju-keyword">_</span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Data/Result/Base-src.html#Result.error" class="ju-code-link ju-constructor"><span class="ju-constructor">error</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:129" class="ju-code-link ju-var"><span class="ju-var">str</span></a></span><span class="ju-delimiter">}</span><span class="ju-delimiter">;</span>
<span id="getGasCost"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#getGasCost" class="ju-code-link ju-function"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#getGasCost" class="ju-code-link ju-function"><span class="ju-function">
<span class="ju-comment">-- Gas cost values for each operation type</span>
<span class="ju-comment">-- These are made up for demo purposes</span>
getGasCost</span></a></span></a></span></span> <span class="ju-delimiter">(</span><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:130" class="ju-code-link ju-var"><span class="ju-var">cost</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp" class="ju-code-link ju-inductive"><span class="ju-inductive">NockOp</span></a></span><span class="ju-delimiter">)</span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/Nat/Base-src.html#Nat" class="ju-code-link ju-inductive"><span class="ju-inductive">Nat</span></a></span> <span class="ju-keyword">:=</span>
  <span class="ju-keyword">case</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:130" class="ju-code-link ju-var"><span class="ju-var">cost</span></a></span> <span class="ju-keyword">of</span>
    <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.Slash" class="ju-code-link ju-constructor"><span class="ju-constructor">NockOp<span class="ju-delimiter">.</span>Slash</span></a></span> <span class="ju-keyword">:=</span> <span class="ju-number">1</span>
    <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.CellTest" class="ju-code-link ju-constructor"><span class="ju-constructor">NockOp<span class="ju-delimiter">.</span>CellTest</span></a></span> <span class="ju-keyword">:=</span> <span class="ju-number">1</span>
    <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.Increment" class="ju-code-link ju-constructor"><span class="ju-constructor">NockOp<span class="ju-delimiter">.</span>Increment</span></a></span> <span class="ju-keyword">:=</span> <span class="ju-number">1</span>
    <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.EqualOp" class="ju-code-link ju-constructor"><span class="ju-constructor">NockOp<span class="ju-delimiter">.</span>EqualOp</span></a></span> <span class="ju-keyword">:=</span> <span class="ju-number">2</span>
    <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.IfThenElse" class="ju-code-link ju-constructor"><span class="ju-constructor">NockOp<span class="ju-delimiter">.</span>IfThenElse</span></a></span> <span class="ju-keyword">:=</span> <span class="ju-number">3</span>
    <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.Compose" class="ju-code-link ju-constructor"><span class="ju-constructor">NockOp<span class="ju-delimiter">.</span>Compose</span></a></span> <span class="ju-keyword">:=</span> <span class="ju-number">2</span>
    <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.Extend" class="ju-code-link ju-constructor"><span class="ju-constructor">NockOp<span class="ju-delimiter">.</span>Extend</span></a></span> <span class="ju-keyword">:=</span> <span class="ju-number">2</span>
    <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.Invoke" class="ju-code-link ju-constructor"><span class="ju-constructor">NockOp<span class="ju-delimiter">.</span>Invoke</span></a></span> <span class="ju-keyword">:=</span> <span class="ju-number">3</span>
    <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.Pound" class="ju-code-link ju-constructor"><span class="ju-constructor">NockOp<span class="ju-delimiter">.</span>Pound</span></a></span> <span class="ju-keyword">:=</span> <span class="ju-number">1</span>
    <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.Scry" class="ju-code-link ju-constructor"><span class="ju-constructor">NockOp<span class="ju-delimiter">.</span>Scry</span></a></span> <span class="ju-keyword">:=</span> <span class="ju-number">10</span>
    <span class="ju-keyword">|</span> <span class="ju-keyword">_</span> <span class="ju-keyword">:=</span> <span class="ju-number">0</span><span class="ju-delimiter">;</span>
<span id="consume"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#consume" class="ju-code-link ju-function"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#consume" class="ju-code-link ju-function"><span class="ju-function">
consume</span></a></span></a></span></span> <span class="ju-delimiter">(</span><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:131" class="ju-code-link ju-var"><span class="ju-var">op</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp" class="ju-code-link ju-inductive"><span class="ju-inductive">NockOp</span></a></span><span class="ju-delimiter">)</span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#GasState" class="ju-code-link ju-inductive"><span class="ju-inductive">GasState</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Data/Unit/Base-src.html#Unit" class="ju-code-link ju-inductive"><span class="ju-inductive">Unit</span></a></span> <span class="ju-keyword">:=</span>
  <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#GasState.mk" class="ju-code-link ju-constructor"><span class="ju-constructor">GasState<span class="ju-delimiter">.</span>mk</span></a></span>
    <span class="ju-keyword">\</span><span class="ju-delimiter">{</span><span id="arch.system.state.resource_machine.notes.nockma:132"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:132" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:132" class="ju-code-link ju-var"><span class="ju-var">gas</span></a></span></a></span></span> <span class="ju-keyword">:=</span>
      <span class="ju-keyword">let</span>
        <span id="cost"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#cost" class="ju-code-link ju-function"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#cost" class="ju-code-link ju-function"><span class="ju-function">cost</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#getGasCost" class="ju-code-link ju-function"><span class="ju-function">getGasCost</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:131" class="ju-code-link ju-var"><span class="ju-var">op</span></a></span><span class="ju-delimiter">;</span>
      <span class="ju-keyword">in</span> <span class="ju-keyword">case</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#cost" class="ju-code-link ju-function"><span class="ju-function">cost</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Ord-src.html#&gt;" class="ju-code-link ju-function"><span class="ju-function">&gt;</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:132" class="ju-code-link ju-var"><span class="ju-var">gas</span></a></span> <span class="ju-keyword">of</span>
           <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/Bool-src.html#Bool.true" class="ju-code-link ju-constructor"><span class="ju-constructor">true</span></a></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Data/Result/Base-src.html#Result.error" class="ju-code-link ju-constructor"><span class="ju-constructor">error</span></a></span> <span class="ju-string">&quot;Out of gas&quot;</span>
           <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/Bool-src.html#Bool.false" class="ju-code-link ju-constructor"><span class="ju-constructor">false</span></a></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Data/Result/Base-src.html#Result.ok" class="ju-code-link ju-constructor"><span class="ju-constructor">ok</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/prelude-src.html#mkPair" class="ju-code-link ju-var"><span class="ju-constructor"><span class="ju-delimiter">(</span>mkPair</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Data/Unit/Base-src.html#Unit.unit" class="ju-code-link ju-constructor"><span class="ju-constructor">unit</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/Nat/Base-src.html#sub" class="ju-code-link ju-function"><span class="ju-function"><span class="ju-delimiter">(</span>sub</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:132" class="ju-code-link ju-var"><span class="ju-var">gas</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#cost" class="ju-code-link ju-function"><span class="ju-function">cost</span></a></span><span class="ju-delimiter">)</span><span class="ju-delimiter">)</span><span class="ju-delimiter">}</span><span class="ju-delimiter">;</span>
<span id="scry"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#scry" class="ju-code-link ju-function"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#scry" class="ju-code-link ju-function"><span class="ju-function">
<span class="ju-comment">-- Implementation of storage read operations (scrying)</span>
scry</span></a></span></a></span></span>
  <span class="ju-delimiter">{</span><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:134" class="ju-code-link ju-var"><span class="ju-var">val</span></a></span> <span class="ju-keyword">:</span> <span class="ju-keyword">Type</span><span class="ju-delimiter">}</span>
  <span class="ju-delimiter">(</span><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:135" class="ju-code-link ju-var"><span class="ju-var">stor</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Storage" class="ju-code-link ju-inductive"><span class="ju-inductive">Storage</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/Nat/Base-src.html#Nat" class="ju-code-link ju-inductive"><span class="ju-inductive">Nat</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:134" class="ju-code-link ju-var"><span class="ju-var">val</span></a></span><span class="ju-delimiter">)</span>
  <span class="ju-delimiter">(</span><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:136" class="ju-code-link ju-var"><span class="ju-var">op</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#ScryOp" class="ju-code-link ju-inductive"><span class="ju-inductive">ScryOp</span></a></span><span class="ju-delimiter">)</span>
  <span class="ju-delimiter">(</span><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:137" class="ju-code-link ju-var"><span class="ju-var">addr</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/Nat/Base-src.html#Nat" class="ju-code-link ju-inductive"><span class="ju-inductive">Nat</span></a></span><span class="ju-delimiter">)</span>
  <span class="ju-keyword">:</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Data/Result/Base-src.html#Result" class="ju-code-link ju-inductive"><span class="ju-inductive">Result</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/String-src.html#String" class="ju-code-link ju-inductive"><span class="ju-axiom">String</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun" class="ju-code-link ju-inductive"><span class="ju-inductive">Noun</span></a></span> <span class="ju-keyword">:=</span>
  <span class="ju-keyword">case</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:136" class="ju-code-link ju-var"><span class="ju-var">op</span></a></span> <span class="ju-keyword">of</span>
    <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#ScryOp.Direct" class="ju-code-link ju-constructor"><span class="ju-constructor">ScryOp<span class="ju-delimiter">.</span>Direct</span></a></span> <span class="ju-keyword">:=</span>
      <span class="ju-keyword">case</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Storage.readDirect" class="ju-code-link ju-function"><span class="ju-function">Storage<span class="ju-delimiter">.</span>readDirect</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:135" class="ju-code-link ju-var"><span class="ju-var">stor</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:137" class="ju-code-link ju-var"><span class="ju-var">addr</span></a></span> <span class="ju-keyword">of</span> <span class="ju-delimiter">{</span>
        <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/prelude-src.html#some" class="ju-code-link ju-var"><span class="ju-constructor">some</span></a></span> <span id="arch.system.state.resource_machine.notes.nockma:138"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:138" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:138" class="ju-code-link ju-var"><span class="ju-var">val</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Data/Result/Base-src.html#Result.ok" class="ju-code-link ju-constructor"><span class="ju-constructor">ok</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#convertToNoun" class="ju-code-link ju-axiom"><span class="ju-axiom"><span class="ju-delimiter">(</span>convertToNoun</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:138" class="ju-code-link ju-var"><span class="ju-var">val</span></a></span><span class="ju-delimiter">)</span>
        <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/prelude-src.html#none" class="ju-code-link ju-var"><span class="ju-constructor">none</span></a></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Data/Result/Base-src.html#Result.error" class="ju-code-link ju-constructor"><span class="ju-constructor">error</span></a></span> <span class="ju-string">&quot;Direct storage read failed&quot;</span>
      <span class="ju-delimiter">}</span>
    <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#ScryOp.Index" class="ju-code-link ju-constructor"><span class="ju-constructor">ScryOp<span class="ju-delimiter">.</span>Index</span></a></span> <span class="ju-keyword">:=</span>
      <span class="ju-keyword">case</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Storage.readDirect" class="ju-code-link ju-function"><span class="ju-function">Storage<span class="ju-delimiter">.</span>readDirect</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:135" class="ju-code-link ju-var"><span class="ju-var">stor</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:137" class="ju-code-link ju-var"><span class="ju-var">addr</span></a></span> <span class="ju-keyword">of</span>
        <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/prelude-src.html#some" class="ju-code-link ju-var"><span class="ju-constructor">some</span></a></span> <span id="arch.system.state.resource_machine.notes.nockma:139"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:139" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:139" class="ju-code-link ju-var"><span class="ju-var">indexFn</span></a></span></a></span></span> <span class="ju-keyword">:=</span>
          <span class="ju-keyword">case</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Storage.readIndex" class="ju-code-link ju-function"><span class="ju-function">Storage<span class="ju-delimiter">.</span>readIndex</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:135" class="ju-code-link ju-var"><span class="ju-var">stor</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:139" class="ju-code-link ju-var"><span class="ju-var">indexFn</span></a></span> <span class="ju-keyword">of</span> <span class="ju-delimiter">{</span>
            <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/prelude-src.html#some" class="ju-code-link ju-var"><span class="ju-constructor">some</span></a></span> <span id="arch.system.state.resource_machine.notes.nockma:140"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:140" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:140" class="ju-code-link ju-var"><span class="ju-var">val</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Data/Result/Base-src.html#Result.ok" class="ju-code-link ju-constructor"><span class="ju-constructor">ok</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#convertToNoun" class="ju-code-link ju-axiom"><span class="ju-axiom"><span class="ju-delimiter">(</span>convertToNoun</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:140" class="ju-code-link ju-var"><span class="ju-var">val</span></a></span><span class="ju-delimiter">)</span>
            <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/prelude-src.html#none" class="ju-code-link ju-var"><span class="ju-constructor">none</span></a></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Data/Result/Base-src.html#Result.error" class="ju-code-link ju-constructor"><span class="ju-constructor">error</span></a></span> <span class="ju-string">&quot;Index computation failed&quot;</span>
          <span class="ju-delimiter">}</span>
        <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/prelude-src.html#none" class="ju-code-link ju-var"><span class="ju-constructor">none</span></a></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Data/Result/Base-src.html#Result.error" class="ju-code-link ju-constructor"><span class="ju-constructor">error</span></a></span> <span class="ju-string">&quot;Index function not found&quot;</span><span class="ju-delimiter">;</span>

<span class="ju-comment">-- Helper for slash (/) operations</span>
<span class="ju-keyword">terminating</span>
<span id="slash"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#slash" class="ju-code-link ju-function"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#slash" class="ju-code-link ju-function"><span class="ju-function">slash</span></a></span></a></span></span>
  <span class="ju-delimiter">{</span><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:141" class="ju-code-link ju-var"><span class="ju-var">val</span></a></span> <span class="ju-keyword">:</span> <span class="ju-keyword">Type</span><span class="ju-delimiter">}</span>
  <span class="ju-delimiter">(</span><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:142" class="ju-code-link ju-var"><span class="ju-var">stor</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Storage" class="ju-code-link ju-inductive"><span class="ju-inductive">Storage</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/Nat/Base-src.html#Nat" class="ju-code-link ju-inductive"><span class="ju-inductive">Nat</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:141" class="ju-code-link ju-var"><span class="ju-var">val</span></a></span><span class="ju-delimiter">)</span>
  <span class="ju-delimiter">(</span><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:143" class="ju-code-link ju-var"><span class="ju-var">n</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun" class="ju-code-link ju-inductive"><span class="ju-inductive">Noun</span></a></span><span class="ju-delimiter">)</span>
  <span class="ju-delimiter">(</span><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:144" class="ju-code-link ju-var"><span class="ju-var">subject</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun" class="ju-code-link ju-inductive"><span class="ju-inductive">Noun</span></a></span><span class="ju-delimiter">)</span>
  <span class="ju-keyword">:</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#GasState" class="ju-code-link ju-inductive"><span class="ju-inductive">GasState</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun" class="ju-code-link ju-inductive"><span class="ju-inductive">Noun</span></a></span> <span class="ju-keyword">:=</span>
  <span class="ju-keyword">case</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:143" class="ju-code-link ju-var"><span class="ju-var">n</span></a></span> <span class="ju-keyword">of</span>
    <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Atom" class="ju-code-link ju-constructor"><span class="ju-constructor">Noun<span class="ju-delimiter">.</span>Atom</span></a></span> <span id="arch.system.state.resource_machine.notes.nockma:145"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:145" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:145" class="ju-code-link ju-var"><span class="ju-var">x</span></a></span></a></span></span> <span class="ju-keyword">:=</span>
      <span class="ju-keyword">case</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:145" class="ju-code-link ju-var"><span class="ju-var">x</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Eq-src.html#==" class="ju-code-link ju-function"><span class="ju-function">==</span></a></span> <span class="ju-number">1</span> <span class="ju-keyword">of</span> <span class="ju-delimiter">{</span>
        <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/Bool-src.html#Bool.true" class="ju-code-link ju-constructor"><span class="ju-constructor">true</span></a></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Applicative-src.html#Applicative.pure" class="ju-code-link ju-function"><span class="ju-function">pure</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:144" class="ju-code-link ju-var"><span class="ju-var">subject</span></a></span>
        <span class="ju-comment">-- Rule: /[1 a] -&gt; a</span>
        <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/Bool-src.html#Bool.false" class="ju-code-link ju-constructor"><span class="ju-constructor">false</span></a></span> <span class="ju-keyword">:=</span>
          <span class="ju-keyword">case</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:145" class="ju-code-link ju-var"><span class="ju-var">x</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Eq-src.html#==" class="ju-code-link ju-function"><span class="ju-function">==</span></a></span> <span class="ju-number">2</span> <span class="ju-keyword">of</span> <span class="ju-delimiter">{</span>
            <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/Bool-src.html#Bool.true" class="ju-code-link ju-constructor"><span class="ju-constructor">true</span></a></span> <span class="ju-keyword">:=</span>
              <span class="ju-keyword">case</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:144" class="ju-code-link ju-var"><span class="ju-var">subject</span></a></span> <span class="ju-keyword">of</span> <span class="ju-delimiter">{</span>
                <span class="ju-comment">-- Rule: /[2 a b] -&gt; a</span>
                <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor">Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span id="arch.system.state.resource_machine.notes.nockma:146"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:146" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:146" class="ju-code-link ju-var"><span class="ju-var">a</span></a></span></a></span></span> <span class="ju-keyword">_</span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Applicative-src.html#Applicative.pure" class="ju-code-link ju-function"><span class="ju-function">pure</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:146" class="ju-code-link ju-var"><span class="ju-var">a</span></a></span>
                <span class="ju-keyword">|</span> <span class="ju-keyword">_</span> <span class="ju-keyword">:=</span>
                  <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#err" class="ju-code-link ju-function"><span class="ju-function">err</span></a></span>
                    <span class="ju-delimiter">(</span><span class="ju-string">&quot;Cannot take slash (/2) of atom: &quot;</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/String-src.html#++str" class="ju-code-link ju-function"><span class="ju-axiom">++str</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#showNoun" class="ju-code-link ju-function"><span class="ju-function">showNoun</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:144" class="ju-code-link ju-var"><span class="ju-var">subject</span></a></span><span class="ju-delimiter">)</span>
              <span class="ju-delimiter">}</span>
            <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/Bool-src.html#Bool.false" class="ju-code-link ju-constructor"><span class="ju-constructor">false</span></a></span> <span class="ju-keyword">:=</span>
              <span class="ju-keyword">case</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:145" class="ju-code-link ju-var"><span class="ju-var">x</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Eq-src.html#==" class="ju-code-link ju-function"><span class="ju-function">==</span></a></span> <span class="ju-number">3</span> <span class="ju-keyword">of</span> <span class="ju-delimiter">{</span>
                <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/Bool-src.html#Bool.true" class="ju-code-link ju-constructor"><span class="ju-constructor">true</span></a></span> <span class="ju-keyword">:=</span>
                  <span class="ju-keyword">case</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:144" class="ju-code-link ju-var"><span class="ju-var">subject</span></a></span> <span class="ju-keyword">of</span> <span class="ju-delimiter">{</span>
                    <span class="ju-comment">-- Rule: /[3 a b] -&gt; b</span>
                    <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor">Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span class="ju-keyword">_</span> <span id="arch.system.state.resource_machine.notes.nockma:147"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:147" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:147" class="ju-code-link ju-var"><span class="ju-var">b</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Applicative-src.html#Applicative.pure" class="ju-code-link ju-function"><span class="ju-function">pure</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:147" class="ju-code-link ju-var"><span class="ju-var">b</span></a></span>
                    <span class="ju-keyword">|</span> <span class="ju-keyword">_</span> <span class="ju-keyword">:=</span>
                      <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#err" class="ju-code-link ju-function"><span class="ju-function">err</span></a></span>
                        <span class="ju-delimiter">(</span><span class="ju-string">&quot;Cannot take slash (/3) of atom: &quot;</span>
                          <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/String-src.html#++str" class="ju-code-link ju-function"><span class="ju-axiom">++str</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#showNoun" class="ju-code-link ju-function"><span class="ju-function">showNoun</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:144" class="ju-code-link ju-var"><span class="ju-var">subject</span></a></span><span class="ju-delimiter">)</span>
                  <span class="ju-delimiter">}</span>
                <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/Bool-src.html#Bool.false" class="ju-code-link ju-constructor"><span class="ju-constructor">false</span></a></span> <span class="ju-keyword">:=</span>
                  <span class="ju-keyword">case</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/DivMod-src.html#DivMod.mod" class="ju-code-link ju-function"><span class="ju-function">mod</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:145" class="ju-code-link ju-var"><span class="ju-var">x</span></a></span> <span class="ju-number">2</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Eq-src.html#==" class="ju-code-link ju-function"><span class="ju-function">==</span></a></span> <span class="ju-number">0</span> <span class="ju-keyword">of</span> <span class="ju-delimiter">{</span>
                    <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/Bool-src.html#Bool.true" class="ju-code-link ju-constructor"><span class="ju-constructor">true</span></a></span> <span class="ju-keyword">:=</span>
                      <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#consume" class="ju-code-link ju-function"><span class="ju-function"><span class="ju-comment">-- Rule: /[(a + a) b] -&gt; /[2 /[a b]]</span>
                          consume</span></a></span>
                          <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.Slash" class="ju-code-link ju-constructor"><span class="ju-constructor">NockOp<span class="ju-delimiter">.</span>Slash</span></a></span>
                        <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Monad-src.html#&gt;&gt;=" class="ju-code-link ju-function"><span class="ju-function">&gt;&gt;=</span></a></span> <span class="ju-keyword">\</span><span class="ju-delimiter">{</span><span class="ju-keyword">_</span> <span class="ju-keyword">:=</span>
                          <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#slash" class="ju-code-link ju-function"><span class="ju-function">slash</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:142" class="ju-code-link ju-var"><span class="ju-var">stor</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Atom" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Atom</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/DivMod-src.html#DivMod.div" class="ju-code-link ju-function"><span class="ju-function"><span class="ju-delimiter">(</span>div</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:145" class="ju-code-link ju-var"><span class="ju-var">x</span></a></span> <span class="ju-number">2</span><span class="ju-delimiter">)</span><span class="ju-delimiter">)</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:144" class="ju-code-link ju-var"><span class="ju-var">subject</span></a></span>
                            <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Monad-src.html#&gt;&gt;=" class="ju-code-link ju-function"><span class="ju-function">&gt;&gt;=</span></a></span> <span class="ju-keyword">\</span><span class="ju-delimiter">{</span><span id="arch.system.state.resource_machine.notes.nockma:148"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:148" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:148" class="ju-code-link ju-var"><span class="ju-var">res</span></a></span></a></span></span> <span class="ju-keyword">:=</span>
                              <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#consume" class="ju-code-link ju-function"><span class="ju-function">consume</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.Slash" class="ju-code-link ju-constructor"><span class="ju-constructor">NockOp<span class="ju-delimiter">.</span>Slash</span></a></span>
                                <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Monad-src.html#&gt;&gt;=" class="ju-code-link ju-function"><span class="ju-function">&gt;&gt;=</span></a></span> <span class="ju-keyword">\</span><span class="ju-delimiter">{</span><span class="ju-keyword">_</span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#slash" class="ju-code-link ju-function"><span class="ju-function">slash</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:142" class="ju-code-link ju-var"><span class="ju-var">stor</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Atom" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Atom</span></a></span> <span class="ju-number">2</span><span class="ju-delimiter">)</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:148" class="ju-code-link ju-var"><span class="ju-var">res</span></a></span><span class="ju-delimiter">}</span><span class="ju-delimiter">}</span><span class="ju-delimiter">}</span>
                    <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/Bool-src.html#Bool.false" class="ju-code-link ju-constructor"><span class="ju-constructor">false</span></a></span> <span class="ju-keyword">:=</span>
                      <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#consume" class="ju-code-link ju-function"><span class="ju-function"><span class="ju-comment">-- Rule: /[(a + a + 1) b] -&gt; /[3 /[a b]]</span>
                          consume</span></a></span>
                          <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.Slash" class="ju-code-link ju-constructor"><span class="ju-constructor">NockOp<span class="ju-delimiter">.</span>Slash</span></a></span>
                        <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Monad-src.html#&gt;&gt;=" class="ju-code-link ju-function"><span class="ju-function">&gt;&gt;=</span></a></span> <span class="ju-keyword">\</span><span class="ju-delimiter">{</span><span class="ju-keyword">_</span> <span class="ju-keyword">:=</span>
                          <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#slash" class="ju-code-link ju-function"><span class="ju-function">slash</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:142" class="ju-code-link ju-var"><span class="ju-var">stor</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Atom" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Atom</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/DivMod-src.html#DivMod.div" class="ju-code-link ju-function"><span class="ju-function"><span class="ju-delimiter">(</span>div</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:145" class="ju-code-link ju-var"><span class="ju-var">x</span></a></span> <span class="ju-number">2</span><span class="ju-delimiter">)</span><span class="ju-delimiter">)</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:144" class="ju-code-link ju-var"><span class="ju-var">subject</span></a></span>
                            <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Monad-src.html#&gt;&gt;=" class="ju-code-link ju-function"><span class="ju-function">&gt;&gt;=</span></a></span> <span class="ju-keyword">\</span><span class="ju-delimiter">{</span><span id="arch.system.state.resource_machine.notes.nockma:149"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:149" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:149" class="ju-code-link ju-var"><span class="ju-var">res</span></a></span></a></span></span> <span class="ju-keyword">:=</span>
                              <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#consume" class="ju-code-link ju-function"><span class="ju-function">consume</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.Slash" class="ju-code-link ju-constructor"><span class="ju-constructor">NockOp<span class="ju-delimiter">.</span>Slash</span></a></span>
                                <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Monad-src.html#&gt;&gt;=" class="ju-code-link ju-function"><span class="ju-function">&gt;&gt;=</span></a></span> <span class="ju-keyword">\</span><span class="ju-delimiter">{</span><span class="ju-keyword">_</span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#slash" class="ju-code-link ju-function"><span class="ju-function">slash</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:142" class="ju-code-link ju-var"><span class="ju-var">stor</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Atom" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Atom</span></a></span> <span class="ju-number">3</span><span class="ju-delimiter">)</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:149" class="ju-code-link ju-var"><span class="ju-var">res</span></a></span><span class="ju-delimiter">}</span><span class="ju-delimiter">}</span><span class="ju-delimiter">}</span>
                  <span class="ju-delimiter">}</span>
              <span class="ju-delimiter">}</span>
          <span class="ju-delimiter">}</span>
      <span class="ju-delimiter">}</span>
    <span class="ju-keyword">|</span> <span class="ju-keyword">_</span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#err" class="ju-code-link ju-function"><span class="ju-function">err</span></a></span> <span class="ju-delimiter">(</span><span class="ju-string">&quot;Slash axis must be atom, got: &quot;</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/String-src.html#++str" class="ju-code-link ju-function"><span class="ju-axiom">++str</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#showNoun" class="ju-code-link ju-function"><span class="ju-function">showNoun</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:143" class="ju-code-link ju-var"><span class="ju-var">n</span></a></span><span class="ju-delimiter">)</span><span class="ju-delimiter">;</span>

<span class="ju-comment">-- Helper for pound (#) operations</span>
<span class="ju-keyword">terminating</span>
<span id="pound"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#pound" class="ju-code-link ju-function"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#pound" class="ju-code-link ju-function"><span class="ju-function">pound</span></a></span></a></span></span>
  <span class="ju-delimiter">{</span><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:150" class="ju-code-link ju-var"><span class="ju-var">val</span></a></span> <span class="ju-keyword">:</span> <span class="ju-keyword">Type</span><span class="ju-delimiter">}</span>
  <span class="ju-delimiter">(</span><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:151" class="ju-code-link ju-var"><span class="ju-var">stor</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Storage" class="ju-code-link ju-inductive"><span class="ju-inductive">Storage</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/Nat/Base-src.html#Nat" class="ju-code-link ju-inductive"><span class="ju-inductive">Nat</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:150" class="ju-code-link ju-var"><span class="ju-var">val</span></a></span><span class="ju-delimiter">)</span>
  <span class="ju-delimiter">(</span><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:152" class="ju-code-link ju-var"><span class="ju-var">n</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun" class="ju-code-link ju-inductive"><span class="ju-inductive">Noun</span></a></span><span class="ju-delimiter">)</span>
  <span class="ju-delimiter">(</span><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:153" class="ju-code-link ju-var"><span class="ju-var">b</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun" class="ju-code-link ju-inductive"><span class="ju-inductive">Noun</span></a></span><span class="ju-delimiter">)</span>
  <span class="ju-delimiter">(</span><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:154" class="ju-code-link ju-var"><span class="ju-var">c</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun" class="ju-code-link ju-inductive"><span class="ju-inductive">Noun</span></a></span><span class="ju-delimiter">)</span>
  <span class="ju-keyword">:</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#GasState" class="ju-code-link ju-inductive"><span class="ju-inductive">GasState</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun" class="ju-code-link ju-inductive"><span class="ju-inductive">Noun</span></a></span> <span class="ju-keyword">:=</span>
  <span class="ju-keyword">case</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:152" class="ju-code-link ju-var"><span class="ju-var">n</span></a></span> <span class="ju-keyword">of</span>
    <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Atom" class="ju-code-link ju-constructor"><span class="ju-constructor">Noun<span class="ju-delimiter">.</span>Atom</span></a></span> <span id="arch.system.state.resource_machine.notes.nockma:155"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:155" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:155" class="ju-code-link ju-var"><span class="ju-var">x</span></a></span></a></span></span> <span class="ju-keyword">:=</span>
      <span class="ju-keyword">case</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:155" class="ju-code-link ju-var"><span class="ju-var">x</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Eq-src.html#==" class="ju-code-link ju-function"><span class="ju-function">==</span></a></span> <span class="ju-number">1</span> <span class="ju-keyword">of</span> <span class="ju-delimiter">{</span>
        <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/Bool-src.html#Bool.true" class="ju-code-link ju-constructor"><span class="ju-constructor">true</span></a></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Applicative-src.html#Applicative.pure" class="ju-code-link ju-function"><span class="ju-function">pure</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:153" class="ju-code-link ju-var"><span class="ju-var">b</span></a></span>
        <span class="ju-comment">-- Rule: #[1 a b] -&gt; a</span>
        <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/Bool-src.html#Bool.false" class="ju-code-link ju-constructor"><span class="ju-constructor">false</span></a></span> <span class="ju-keyword">:=</span>
          <span class="ju-keyword">case</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/DivMod-src.html#DivMod.mod" class="ju-code-link ju-function"><span class="ju-function">mod</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:155" class="ju-code-link ju-var"><span class="ju-var">x</span></a></span> <span class="ju-number">2</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Eq-src.html#==" class="ju-code-link ju-function"><span class="ju-function">==</span></a></span> <span class="ju-number">0</span> <span class="ju-keyword">of</span> <span class="ju-delimiter">{</span>
            <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/Bool-src.html#Bool.true" class="ju-code-link ju-constructor"><span class="ju-constructor">true</span></a></span> <span class="ju-keyword">:=</span>
              <span class="ju-keyword">case</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:154" class="ju-code-link ju-var"><span class="ju-var">c</span></a></span> <span class="ju-keyword">of</span> <span class="ju-delimiter">{</span>
                <span class="ju-comment">-- Rule: #[(a + a) b c] -&gt; #[a [b /[(a + a + 1) c]] c]</span>
                <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor">Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span class="ju-keyword">_</span> <span class="ju-keyword">_</span> <span class="ju-keyword">:=</span>
                  <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#consume" class="ju-code-link ju-function"><span class="ju-function">consume</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.Slash" class="ju-code-link ju-constructor"><span class="ju-constructor">NockOp<span class="ju-delimiter">.</span>Slash</span></a></span>
                    <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Monad-src.html#&gt;&gt;=" class="ju-code-link ju-function"><span class="ju-function">&gt;&gt;=</span></a></span> <span class="ju-keyword">\</span><span class="ju-delimiter">{</span><span class="ju-keyword">_</span> <span class="ju-keyword">:=</span>
                      <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#slash" class="ju-code-link ju-function"><span class="ju-function">slash</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:151" class="ju-code-link ju-var"><span class="ju-var">stor</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Atom" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Atom</span></a></span> <span class="ju-delimiter">(</span><span class="ju-number">2</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/Trait/Natural-src.html#Natural.*" class="ju-code-link ju-function"><span class="ju-function">*</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/DivMod-src.html#DivMod.div" class="ju-code-link ju-function"><span class="ju-function">div</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:155" class="ju-code-link ju-var"><span class="ju-var">x</span></a></span> <span class="ju-number">2</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/Trait/Natural-src.html#Natural.+" class="ju-code-link ju-function"><span class="ju-function">+</span></a></span> <span class="ju-number">1</span><span class="ju-delimiter">)</span><span class="ju-delimiter">)</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:154" class="ju-code-link ju-var"><span class="ju-var">c</span></a></span>
                        <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Monad-src.html#&gt;&gt;=" class="ju-code-link ju-function"><span class="ju-function">&gt;&gt;=</span></a></span> <span class="ju-keyword">\</span><span class="ju-delimiter">{</span><span id="arch.system.state.resource_machine.notes.nockma:156"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:156" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:156" class="ju-code-link ju-var"><span class="ju-var">slashResult</span></a></span></a></span></span> <span class="ju-keyword">:=</span>
                          <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#consume" class="ju-code-link ju-function"><span class="ju-function">consume</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.Pound" class="ju-code-link ju-constructor"><span class="ju-constructor">NockOp<span class="ju-delimiter">.</span>Pound</span></a></span>
                            <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Monad-src.html#&gt;&gt;=" class="ju-code-link ju-function"><span class="ju-function">&gt;&gt;=</span></a></span> <span class="ju-keyword">\</span><span class="ju-delimiter">{</span><span class="ju-keyword">_</span> <span class="ju-keyword">:=</span>
                              <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#pound" class="ju-code-link ju-function"><span class="ju-function">pound</span></a></span>
                                <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:151" class="ju-code-link ju-var"><span class="ju-var">stor</span></a></span>
                                <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Atom" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Atom</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/DivMod-src.html#DivMod.div" class="ju-code-link ju-function"><span class="ju-function"><span class="ju-delimiter">(</span>div</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:155" class="ju-code-link ju-var"><span class="ju-var">x</span></a></span> <span class="ju-number">2</span><span class="ju-delimiter">)</span><span class="ju-delimiter">)</span>
                                <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:153" class="ju-code-link ju-var"><span class="ju-var">b</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:156" class="ju-code-link ju-var"><span class="ju-var">slashResult</span></a></span><span class="ju-delimiter">)</span>
                                <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:154" class="ju-code-link ju-var"><span class="ju-var">c</span></a></span><span class="ju-delimiter">}</span><span class="ju-delimiter">}</span><span class="ju-delimiter">}</span>
                <span class="ju-keyword">|</span> <span class="ju-keyword">_</span> <span class="ju-keyword">:=</span>
                  <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#err" class="ju-code-link ju-function"><span class="ju-function">err</span></a></span> <span class="ju-delimiter">(</span><span class="ju-string">&quot;Invalid pound target (must be cell): &quot;</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/String-src.html#++str" class="ju-code-link ju-function"><span class="ju-axiom">++str</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#showNoun" class="ju-code-link ju-function"><span class="ju-function">showNoun</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:154" class="ju-code-link ju-var"><span class="ju-var">c</span></a></span><span class="ju-delimiter">)</span>
              <span class="ju-delimiter">}</span>
            <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/Bool-src.html#Bool.false" class="ju-code-link ju-constructor"><span class="ju-constructor">false</span></a></span> <span class="ju-keyword">:=</span>
              <span class="ju-keyword">case</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:154" class="ju-code-link ju-var"><span class="ju-var">c</span></a></span> <span class="ju-keyword">of</span> <span class="ju-delimiter">{</span>
                <span class="ju-comment">-- Rule: #[(a + a + 1) b c] -&gt; #[a [/[(a + a) c] b] c]</span>
                <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor">Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span class="ju-keyword">_</span> <span class="ju-keyword">_</span> <span class="ju-keyword">:=</span>
                  <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#consume" class="ju-code-link ju-function"><span class="ju-function">consume</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.Slash" class="ju-code-link ju-constructor"><span class="ju-constructor">NockOp<span class="ju-delimiter">.</span>Slash</span></a></span>
                    <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Monad-src.html#&gt;&gt;=" class="ju-code-link ju-function"><span class="ju-function">&gt;&gt;=</span></a></span> <span class="ju-keyword">\</span><span class="ju-delimiter">{</span><span class="ju-keyword">_</span> <span class="ju-keyword">:=</span>
                      <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#slash" class="ju-code-link ju-function"><span class="ju-function">slash</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:151" class="ju-code-link ju-var"><span class="ju-var">stor</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Atom" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Atom</span></a></span> <span class="ju-delimiter">(</span><span class="ju-number">2</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/Trait/Natural-src.html#Natural.*" class="ju-code-link ju-function"><span class="ju-function">*</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/DivMod-src.html#DivMod.div" class="ju-code-link ju-function"><span class="ju-function">div</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:155" class="ju-code-link ju-var"><span class="ju-var">x</span></a></span> <span class="ju-number">2</span><span class="ju-delimiter">)</span><span class="ju-delimiter">)</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:154" class="ju-code-link ju-var"><span class="ju-var">c</span></a></span>
                        <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Monad-src.html#&gt;&gt;=" class="ju-code-link ju-function"><span class="ju-function">&gt;&gt;=</span></a></span> <span class="ju-keyword">\</span><span class="ju-delimiter">{</span><span id="arch.system.state.resource_machine.notes.nockma:157"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:157" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:157" class="ju-code-link ju-var"><span class="ju-var">slashResult</span></a></span></a></span></span> <span class="ju-keyword">:=</span>
                          <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#consume" class="ju-code-link ju-function"><span class="ju-function">consume</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.Pound" class="ju-code-link ju-constructor"><span class="ju-constructor">NockOp<span class="ju-delimiter">.</span>Pound</span></a></span>
                            <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Monad-src.html#&gt;&gt;=" class="ju-code-link ju-function"><span class="ju-function">&gt;&gt;=</span></a></span> <span class="ju-keyword">\</span><span class="ju-delimiter">{</span><span class="ju-keyword">_</span> <span class="ju-keyword">:=</span>
                              <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#pound" class="ju-code-link ju-function"><span class="ju-function">pound</span></a></span>
                                <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:151" class="ju-code-link ju-var"><span class="ju-var">stor</span></a></span>
                                <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Atom" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Atom</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/DivMod-src.html#DivMod.div" class="ju-code-link ju-function"><span class="ju-function"><span class="ju-delimiter">(</span>div</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:155" class="ju-code-link ju-var"><span class="ju-var">x</span></a></span> <span class="ju-number">2</span><span class="ju-delimiter">)</span><span class="ju-delimiter">)</span>
                                <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:157" class="ju-code-link ju-var"><span class="ju-var">slashResult</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:153" class="ju-code-link ju-var"><span class="ju-var">b</span></a></span><span class="ju-delimiter">)</span>
                                <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:154" class="ju-code-link ju-var"><span class="ju-var">c</span></a></span><span class="ju-delimiter">}</span><span class="ju-delimiter">}</span><span class="ju-delimiter">}</span>
                <span class="ju-keyword">|</span> <span class="ju-keyword">_</span> <span class="ju-keyword">:=</span>
                  <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#err" class="ju-code-link ju-function"><span class="ju-function">err</span></a></span> <span class="ju-delimiter">(</span><span class="ju-string">&quot;Invalid pound target (must be cell): &quot;</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/String-src.html#++str" class="ju-code-link ju-function"><span class="ju-axiom">++str</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#showNoun" class="ju-code-link ju-function"><span class="ju-function">showNoun</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:154" class="ju-code-link ju-var"><span class="ju-var">c</span></a></span><span class="ju-delimiter">)</span>
              <span class="ju-delimiter">}</span>
          <span class="ju-delimiter">}</span>
      <span class="ju-delimiter">}</span>
    <span class="ju-keyword">|</span> <span class="ju-keyword">_</span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#err" class="ju-code-link ju-function"><span class="ju-function">err</span></a></span> <span class="ju-delimiter">(</span><span class="ju-string">&quot;Pound axis must be atom, got: &quot;</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/String-src.html#++str" class="ju-code-link ju-function"><span class="ju-axiom">++str</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#showNoun" class="ju-code-link ju-function"><span class="ju-function">showNoun</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:152" class="ju-code-link ju-var"><span class="ju-var">n</span></a></span><span class="ju-delimiter">)</span><span class="ju-delimiter">;</span>

<span class="ju-keyword">terminating</span>
<span id="evalOp"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#evalOp" class="ju-code-link ju-function"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#evalOp" class="ju-code-link ju-function"><span class="ju-function">evalOp</span></a></span></a></span></span>
  <span class="ju-delimiter">{</span><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:158" class="ju-code-link ju-var"><span class="ju-var">val</span></a></span> <span class="ju-keyword">:</span> <span class="ju-keyword">Type</span><span class="ju-delimiter">}</span>
  <span class="ju-delimiter">(</span><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:159" class="ju-code-link ju-var"><span class="ju-var">stor</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Storage" class="ju-code-link ju-inductive"><span class="ju-inductive">Storage</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/Nat/Base-src.html#Nat" class="ju-code-link ju-inductive"><span class="ju-inductive">Nat</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:158" class="ju-code-link ju-var"><span class="ju-var">val</span></a></span><span class="ju-delimiter">)</span>
  <span class="ju-delimiter">(</span><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:160" class="ju-code-link ju-var"><span class="ju-var">op</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp" class="ju-code-link ju-inductive"><span class="ju-inductive">NockOp</span></a></span><span class="ju-delimiter">)</span>
  <span class="ju-delimiter">(</span><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:161" class="ju-code-link ju-var"><span class="ju-var">a</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun" class="ju-code-link ju-inductive"><span class="ju-inductive">Noun</span></a></span><span class="ju-delimiter">)</span>
  <span class="ju-delimiter">(</span><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:162" class="ju-code-link ju-var"><span class="ju-var">args</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun" class="ju-code-link ju-inductive"><span class="ju-inductive">Noun</span></a></span><span class="ju-delimiter">)</span>
  <span class="ju-keyword">:</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#GasState" class="ju-code-link ju-inductive"><span class="ju-inductive">GasState</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun" class="ju-code-link ju-inductive"><span class="ju-inductive">Noun</span></a></span> <span class="ju-keyword">:=</span>
  <span class="ju-keyword">case</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:160" class="ju-code-link ju-var"><span class="ju-var">op</span></a></span> <span class="ju-keyword">of</span>
    <span class="ju-comment">-- *[a 0 b] -&gt; /[b a]</span>
    <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.Slash" class="ju-code-link ju-constructor"><span class="ju-constructor">NockOp<span class="ju-delimiter">.</span>Slash</span></a></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#slash" class="ju-code-link ju-function"><span class="ju-function">slash</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:159" class="ju-code-link ju-var"><span class="ju-var">stor</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:162" class="ju-code-link ju-var"><span class="ju-var">args</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:161" class="ju-code-link ju-var"><span class="ju-var">a</span></a></span>

    <span class="ju-comment">-- *[a 1 b] -&gt; b</span>
    <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.Constant" class="ju-code-link ju-constructor"><span class="ju-constructor">NockOp<span class="ju-delimiter">.</span>Constant</span></a></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Applicative-src.html#Applicative.pure" class="ju-code-link ju-function"><span class="ju-function">pure</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:162" class="ju-code-link ju-var"><span class="ju-var">args</span></a></span>

    <span class="ju-comment">-- *[a 2 b c] -&gt; *[*[a b] *[a c]]</span>
    <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.Apply" class="ju-code-link ju-constructor"><span class="ju-constructor">NockOp<span class="ju-delimiter">.</span>Apply</span></a></span> <span class="ju-keyword">:=</span>
      <span class="ju-keyword">case</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:162" class="ju-code-link ju-var"><span class="ju-var">args</span></a></span> <span class="ju-keyword">of</span> <span class="ju-delimiter">{</span>
        <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor">Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span id="arch.system.state.resource_machine.notes.nockma:163"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:163" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:163" class="ju-code-link ju-var"><span class="ju-var">b</span></a></span></a></span></span> <span id="arch.system.state.resource_machine.notes.nockma:164"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:164" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:164" class="ju-code-link ju-var"><span class="ju-var">c</span></a></span></a></span></span> <span class="ju-keyword">:=</span>
          <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#nock" class="ju-code-link ju-function"><span class="ju-function">nock</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:159" class="ju-code-link ju-var"><span class="ju-var">stor</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:161" class="ju-code-link ju-var"><span class="ju-var">a</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:163" class="ju-code-link ju-var"><span class="ju-var">b</span></a></span><span class="ju-delimiter">)</span>
            <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Monad-src.html#&gt;&gt;=" class="ju-code-link ju-function"><span class="ju-function">&gt;&gt;=</span></a></span> <span class="ju-keyword">\</span><span class="ju-delimiter">{</span><span id="arch.system.state.resource_machine.notes.nockma:165"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:165" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:165" class="ju-code-link ju-var"><span class="ju-var">r1</span></a></span></a></span></span> <span class="ju-keyword">:=</span>
              <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#nock" class="ju-code-link ju-function"><span class="ju-function">nock</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:159" class="ju-code-link ju-var"><span class="ju-var">stor</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:161" class="ju-code-link ju-var"><span class="ju-var">a</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:164" class="ju-code-link ju-var"><span class="ju-var">c</span></a></span><span class="ju-delimiter">)</span>
                <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Monad-src.html#&gt;&gt;=" class="ju-code-link ju-function"><span class="ju-function">&gt;&gt;=</span></a></span> <span class="ju-keyword">\</span><span class="ju-delimiter">{</span><span id="arch.system.state.resource_machine.notes.nockma:166"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:166" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:166" class="ju-code-link ju-var"><span class="ju-var">r2</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#nock" class="ju-code-link ju-function"><span class="ju-function">nock</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:159" class="ju-code-link ju-var"><span class="ju-var">stor</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:165" class="ju-code-link ju-var"><span class="ju-var">r1</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:166" class="ju-code-link ju-var"><span class="ju-var">r2</span></a></span><span class="ju-delimiter">)</span><span class="ju-delimiter">}</span><span class="ju-delimiter">}</span>
        <span class="ju-keyword">|</span> <span class="ju-keyword">_</span> <span class="ju-keyword">:=</span>
          <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#err" class="ju-code-link ju-function"><span class="ju-function">err</span></a></span> <span class="ju-delimiter">(</span><span class="ju-string">&quot;Invalid apply (2) args (must be cell): &quot;</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/String-src.html#++str" class="ju-code-link ju-function"><span class="ju-axiom">++str</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#showNoun" class="ju-code-link ju-function"><span class="ju-function">showNoun</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:162" class="ju-code-link ju-var"><span class="ju-var">args</span></a></span><span class="ju-delimiter">)</span>
      <span class="ju-delimiter">}</span>

    <span class="ju-comment">-- *[a 3 b] -&gt; ?*[a b]</span>
    <span class="ju-comment">-- ?[a b] -&gt; 0</span>
    <span class="ju-comment">-- ?a -&gt; 1</span>
    <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.CellTest" class="ju-code-link ju-constructor"><span class="ju-constructor">NockOp<span class="ju-delimiter">.</span>CellTest</span></a></span> <span class="ju-keyword">:=</span>
      <span class="ju-keyword">case</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:162" class="ju-code-link ju-var"><span class="ju-var">args</span></a></span> <span class="ju-keyword">of</span> <span class="ju-delimiter">{</span>
        <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor">Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span id="arch.system.state.resource_machine.notes.nockma:167"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:167" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:167" class="ju-code-link ju-var"><span class="ju-var">b</span></a></span></a></span></span> <span class="ju-keyword">_</span> <span class="ju-keyword">:=</span>
          <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#nock" class="ju-code-link ju-function"><span class="ju-function">nock</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:159" class="ju-code-link ju-var"><span class="ju-var">stor</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:161" class="ju-code-link ju-var"><span class="ju-var">a</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:167" class="ju-code-link ju-var"><span class="ju-var">b</span></a></span><span class="ju-delimiter">)</span>
            <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Monad-src.html#&gt;&gt;=" class="ju-code-link ju-function"><span class="ju-function">&gt;&gt;=</span></a></span> <span class="ju-keyword">\</span><span class="ju-delimiter">{</span><span id="arch.system.state.resource_machine.notes.nockma:168"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:168" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:168" class="ju-code-link ju-var"><span class="ju-var">res</span></a></span></a></span></span> <span class="ju-keyword">:=</span>
              <span class="ju-keyword">case</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:168" class="ju-code-link ju-var"><span class="ju-var">res</span></a></span> <span class="ju-keyword">of</span>
                <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor">Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span class="ju-keyword">_</span> <span class="ju-keyword">_</span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Applicative-src.html#Applicative.pure" class="ju-code-link ju-function"><span class="ju-function">pure</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Atom" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Atom</span></a></span> <span class="ju-number">0</span><span class="ju-delimiter">)</span>
                <span class="ju-keyword">|</span> <span class="ju-keyword">_</span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Applicative-src.html#Applicative.pure" class="ju-code-link ju-function"><span class="ju-function">pure</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Atom" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Atom</span></a></span> <span class="ju-number">1</span><span class="ju-delimiter">)</span><span class="ju-delimiter">}</span>
        <span class="ju-keyword">|</span> <span class="ju-keyword">_</span> <span class="ju-keyword">:=</span>
          <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#err" class="ju-code-link ju-function"><span class="ju-function">err</span></a></span>
            <span class="ju-delimiter">(</span><span class="ju-string">&quot;Invalid cell test (3) args (must be cell): &quot;</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/String-src.html#++str" class="ju-code-link ju-function"><span class="ju-axiom">++str</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#showNoun" class="ju-code-link ju-function"><span class="ju-function">showNoun</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:162" class="ju-code-link ju-var"><span class="ju-var">args</span></a></span><span class="ju-delimiter">)</span>
      <span class="ju-delimiter">}</span>

    <span class="ju-comment">-- *[a 4 b] -&gt; +*[a b]</span>
    <span class="ju-comment">-- +[a b] -&gt; error (specs say this should loop infinitely?)</span>
    <span class="ju-comment">-- +a -&gt; 1 + a</span>
    <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.Increment" class="ju-code-link ju-constructor"><span class="ju-constructor">NockOp<span class="ju-delimiter">.</span>Increment</span></a></span> <span class="ju-keyword">:=</span>
      <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#nock" class="ju-code-link ju-function"><span class="ju-function"><span class="ju-comment">-- First, evaluate the argument expression *[subject args]</span>
          nock</span></a></span>
          <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:159" class="ju-code-link ju-var"><span class="ju-var">stor</span></a></span>
          <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:161" class="ju-code-link ju-var"><span class="ju-var">a</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:162" class="ju-code-link ju-var"><span class="ju-var">args</span></a></span><span class="ju-delimiter">)</span>
        <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Monad-src.html#&gt;&gt;=" class="ju-code-link ju-function"><span class="ju-function">&gt;&gt;=</span></a></span> <span class="ju-keyword">\</span><span class="ju-delimiter">{</span><span id="arch.system.state.resource_machine.notes.nockma:169"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:169" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:169" class="ju-code-link ju-var"><span class="ju-var">res</span></a></span></a></span></span> <span class="ju-keyword">:=</span>
          <span class="ju-comment">-- Then, check if the result is an atom and increment it</span>
          <span class="ju-keyword">case</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:169" class="ju-code-link ju-var"><span class="ju-var">res</span></a></span> <span class="ju-keyword">of</span>
            <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Atom" class="ju-code-link ju-constructor"><span class="ju-constructor">Noun<span class="ju-delimiter">.</span>Atom</span></a></span> <span id="arch.system.state.resource_machine.notes.nockma:170"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:170" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:170" class="ju-code-link ju-var"><span class="ju-var">n</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Applicative-src.html#Applicative.pure" class="ju-code-link ju-function"><span class="ju-function">pure</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Atom" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Atom</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/Nat/Base-src.html#Nat.suc" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>suc</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:170" class="ju-code-link ju-var"><span class="ju-var">n</span></a></span><span class="ju-delimiter">)</span><span class="ju-delimiter">)</span>
            <span class="ju-keyword">|</span> <span id="arch.system.state.resource_machine.notes.nockma:171"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:171" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:171" class="ju-code-link ju-var"><span class="ju-var">x</span></a></span></a></span></span> <span class="ju-keyword">:=</span>
              <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#err" class="ju-code-link ju-function"><span class="ju-function">err</span></a></span> <span class="ju-delimiter">(</span><span class="ju-string">&quot;Increment (4) target must be atom, got: &quot;</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/String-src.html#++str" class="ju-code-link ju-function"><span class="ju-axiom">++str</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#showNoun" class="ju-code-link ju-function"><span class="ju-function">showNoun</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:171" class="ju-code-link ju-var"><span class="ju-var">x</span></a></span><span class="ju-delimiter">)</span><span class="ju-delimiter">}</span>

    <span class="ju-comment">-- *[a 5 b c] -&gt; =*[a b] *[a c]</span>
    <span class="ju-comment">-- =[a a] -&gt; 0</span>
    <span class="ju-comment">-- =[a b] -&gt; 1</span>
    <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.EqualOp" class="ju-code-link ju-constructor"><span class="ju-constructor">NockOp<span class="ju-delimiter">.</span>EqualOp</span></a></span> <span class="ju-keyword">:=</span>
      <span class="ju-keyword">case</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:162" class="ju-code-link ju-var"><span class="ju-var">args</span></a></span> <span class="ju-keyword">of</span> <span class="ju-delimiter">{</span>
        <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor">Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span id="arch.system.state.resource_machine.notes.nockma:172"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:172" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:172" class="ju-code-link ju-var"><span class="ju-var">b</span></a></span></a></span></span> <span id="arch.system.state.resource_machine.notes.nockma:173"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:173" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:173" class="ju-code-link ju-var"><span class="ju-var">c</span></a></span></a></span></span> <span class="ju-keyword">:=</span>
          <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#nock" class="ju-code-link ju-function"><span class="ju-function">nock</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:159" class="ju-code-link ju-var"><span class="ju-var">stor</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:161" class="ju-code-link ju-var"><span class="ju-var">a</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:172" class="ju-code-link ju-var"><span class="ju-var">b</span></a></span><span class="ju-delimiter">)</span>
            <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Monad-src.html#&gt;&gt;=" class="ju-code-link ju-function"><span class="ju-function">&gt;&gt;=</span></a></span> <span class="ju-keyword">\</span><span class="ju-delimiter">{</span><span id="arch.system.state.resource_machine.notes.nockma:174"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:174" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:174" class="ju-code-link ju-var"><span class="ju-var">r1</span></a></span></a></span></span> <span class="ju-keyword">:=</span>
              <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#nock" class="ju-code-link ju-function"><span class="ju-function">nock</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:159" class="ju-code-link ju-var"><span class="ju-var">stor</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:161" class="ju-code-link ju-var"><span class="ju-var">a</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:173" class="ju-code-link ju-var"><span class="ju-var">c</span></a></span><span class="ju-delimiter">)</span>
                <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Monad-src.html#&gt;&gt;=" class="ju-code-link ju-function"><span class="ju-function">&gt;&gt;=</span></a></span> <span class="ju-keyword">\</span><span class="ju-delimiter">{</span><span id="arch.system.state.resource_machine.notes.nockma:175"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:175" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:175" class="ju-code-link ju-var"><span class="ju-var">r2</span></a></span></a></span></span> <span class="ju-keyword">:=</span>
                  <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Applicative-src.html#Applicative.pure" class="ju-code-link ju-function"><span class="ju-function">pure</span></a></span>
                    <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Atom" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Atom</span></a></span>
                      <span class="ju-keyword">case</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#nounEq" class="ju-code-link ju-function"><span class="ju-function">nounEq</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:174" class="ju-code-link ju-var"><span class="ju-var">r1</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:175" class="ju-code-link ju-var"><span class="ju-var">r2</span></a></span> <span class="ju-keyword">of</span> <span class="ju-delimiter">{</span>
                        <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/Bool-src.html#Bool.true" class="ju-code-link ju-constructor"><span class="ju-constructor">true</span></a></span> <span class="ju-keyword">:=</span> <span class="ju-number">0</span>
                        <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/Bool-src.html#Bool.false" class="ju-code-link ju-constructor"><span class="ju-constructor">false</span></a></span> <span class="ju-keyword">:=</span> <span class="ju-number">1</span>
                      <span class="ju-delimiter">}</span><span class="ju-delimiter">)</span><span class="ju-delimiter">}</span><span class="ju-delimiter">}</span>
        <span class="ju-keyword">|</span> <span class="ju-keyword">_</span> <span class="ju-keyword">:=</span>
          <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#err" class="ju-code-link ju-function"><span class="ju-function">err</span></a></span> <span class="ju-delimiter">(</span><span class="ju-string">&quot;Invalid equality (5) args (must be cell): &quot;</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/String-src.html#++str" class="ju-code-link ju-function"><span class="ju-axiom">++str</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#showNoun" class="ju-code-link ju-function"><span class="ju-function">showNoun</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:162" class="ju-code-link ju-var"><span class="ju-var">args</span></a></span><span class="ju-delimiter">)</span>
      <span class="ju-delimiter">}</span>

    <span class="ju-comment">-- *[a 6 b c d] -&gt; *[a *[[c d] 0 *[[2 3] 0 *[a 4 4 b]]]]</span>
    <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.IfThenElse" class="ju-code-link ju-constructor"><span class="ju-constructor">NockOp<span class="ju-delimiter">.</span>IfThenElse</span></a></span> <span class="ju-keyword">:=</span>
      <span class="ju-keyword">case</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:162" class="ju-code-link ju-var"><span class="ju-var">args</span></a></span> <span class="ju-keyword">of</span> <span class="ju-delimiter">{</span>
        <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor">Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span id="arch.system.state.resource_machine.notes.nockma:176"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:176" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:176" class="ju-code-link ju-var"><span class="ju-var">b</span></a></span></a></span></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span id="arch.system.state.resource_machine.notes.nockma:177"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:177" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:177" class="ju-code-link ju-var"><span class="ju-var">c</span></a></span></a></span></span> <span id="arch.system.state.resource_machine.notes.nockma:178"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:178" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:178" class="ju-code-link ju-var"><span class="ju-var">d</span></a></span></a></span></span><span class="ju-delimiter">)</span> <span class="ju-keyword">:=</span>
          <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#nock" class="ju-code-link ju-function"><span class="ju-function">nock</span></a></span>
              <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:159" class="ju-code-link ju-var"><span class="ju-var">stor</span></a></span>
              <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Cell</span></a></span>
                <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:161" class="ju-code-link ju-var"><span class="ju-var">a</span></a></span>
                <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Atom" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Atom</span></a></span> <span class="ju-number">4</span><span class="ju-delimiter">)</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Atom" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Atom</span></a></span> <span class="ju-number">4</span><span class="ju-delimiter">)</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:176" class="ju-code-link ju-var"><span class="ju-var">b</span></a></span><span class="ju-delimiter">)</span><span class="ju-delimiter">)</span><span class="ju-delimiter">)</span>
            <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Monad-src.html#&gt;&gt;=" class="ju-code-link ju-function"><span class="ju-function">&gt;&gt;=</span></a></span> <span class="ju-keyword">\</span><span class="ju-delimiter">{</span><span id="arch.system.state.resource_machine.notes.nockma:179"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:179" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:179" class="ju-code-link ju-var"><span class="ju-var">r1</span></a></span></a></span></span> <span class="ju-keyword">:=</span>
              <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#nock" class="ju-code-link ju-function"><span class="ju-function">nock</span></a></span>
                  <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:159" class="ju-code-link ju-var"><span class="ju-var">stor</span></a></span>
                  <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Cell</span></a></span>
                    <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Atom" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Atom</span></a></span> <span class="ju-number">2</span><span class="ju-delimiter">)</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Atom" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Atom</span></a></span> <span class="ju-number">3</span><span class="ju-delimiter">)</span><span class="ju-delimiter">)</span>
                    <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Atom" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Atom</span></a></span> <span class="ju-number">0</span><span class="ju-delimiter">)</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:179" class="ju-code-link ju-var"><span class="ju-var">r1</span></a></span><span class="ju-delimiter">)</span><span class="ju-delimiter">)</span>
                <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Monad-src.html#&gt;&gt;=" class="ju-code-link ju-function"><span class="ju-function">&gt;&gt;=</span></a></span> <span class="ju-keyword">\</span><span class="ju-delimiter">{</span><span id="arch.system.state.resource_machine.notes.nockma:180"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:180" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:180" class="ju-code-link ju-var"><span class="ju-var">r2</span></a></span></a></span></span> <span class="ju-keyword">:=</span>
                  <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#nock" class="ju-code-link ju-function"><span class="ju-function">nock</span></a></span>
                      <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:159" class="ju-code-link ju-var"><span class="ju-var">stor</span></a></span>
                      <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:177" class="ju-code-link ju-var"><span class="ju-var">c</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:178" class="ju-code-link ju-var"><span class="ju-var">d</span></a></span><span class="ju-delimiter">)</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Atom" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Atom</span></a></span> <span class="ju-number">0</span><span class="ju-delimiter">)</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:180" class="ju-code-link ju-var"><span class="ju-var">r2</span></a></span><span class="ju-delimiter">)</span><span class="ju-delimiter">)</span>
                    <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Monad-src.html#&gt;&gt;=" class="ju-code-link ju-function"><span class="ju-function">&gt;&gt;=</span></a></span> <span class="ju-keyword">\</span><span class="ju-delimiter">{</span><span id="arch.system.state.resource_machine.notes.nockma:181"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:181" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:181" class="ju-code-link ju-var"><span class="ju-var">r3</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#nock" class="ju-code-link ju-function"><span class="ju-function">nock</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:159" class="ju-code-link ju-var"><span class="ju-var">stor</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:161" class="ju-code-link ju-var"><span class="ju-var">a</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:181" class="ju-code-link ju-var"><span class="ju-var">r3</span></a></span><span class="ju-delimiter">)</span><span class="ju-delimiter">}</span><span class="ju-delimiter">}</span><span class="ju-delimiter">}</span>
        <span class="ju-keyword">|</span> <span class="ju-keyword">_</span> <span class="ju-keyword">:=</span>
          <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#err" class="ju-code-link ju-function"><span class="ju-function">err</span></a></span>
            <span class="ju-delimiter">(</span><span class="ju-string">&quot;Invalid if-then-else (6) args (must be [b [c d]]): &quot;</span>
              <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/String-src.html#++str" class="ju-code-link ju-function"><span class="ju-axiom">++str</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#showNoun" class="ju-code-link ju-function"><span class="ju-function">showNoun</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:162" class="ju-code-link ju-var"><span class="ju-var">args</span></a></span><span class="ju-delimiter">)</span>
      <span class="ju-delimiter">}</span>

    <span class="ju-comment">-- *[a 7 b c] -&gt; *[*[a b] c]</span>
    <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.Compose" class="ju-code-link ju-constructor"><span class="ju-constructor">NockOp<span class="ju-delimiter">.</span>Compose</span></a></span> <span class="ju-keyword">:=</span>
      <span class="ju-keyword">case</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:162" class="ju-code-link ju-var"><span class="ju-var">args</span></a></span> <span class="ju-keyword">of</span> <span class="ju-delimiter">{</span>
        <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor">Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span id="arch.system.state.resource_machine.notes.nockma:182"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:182" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:182" class="ju-code-link ju-var"><span class="ju-var">b</span></a></span></a></span></span> <span id="arch.system.state.resource_machine.notes.nockma:183"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:183" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:183" class="ju-code-link ju-var"><span class="ju-var">c</span></a></span></a></span></span> <span class="ju-keyword">:=</span>
          <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#nock" class="ju-code-link ju-function"><span class="ju-function">nock</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:159" class="ju-code-link ju-var"><span class="ju-var">stor</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:161" class="ju-code-link ju-var"><span class="ju-var">a</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:182" class="ju-code-link ju-var"><span class="ju-var">b</span></a></span><span class="ju-delimiter">)</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Monad-src.html#&gt;&gt;=" class="ju-code-link ju-function"><span class="ju-function">&gt;&gt;=</span></a></span> <span class="ju-keyword">\</span><span class="ju-delimiter">{</span><span id="arch.system.state.resource_machine.notes.nockma:184"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:184" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:184" class="ju-code-link ju-var"><span class="ju-var">r</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#nock" class="ju-code-link ju-function"><span class="ju-function">nock</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:159" class="ju-code-link ju-var"><span class="ju-var">stor</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:184" class="ju-code-link ju-var"><span class="ju-var">r</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:183" class="ju-code-link ju-var"><span class="ju-var">c</span></a></span><span class="ju-delimiter">)</span><span class="ju-delimiter">}</span>
        <span class="ju-keyword">|</span> <span class="ju-keyword">_</span> <span class="ju-keyword">:=</span>
          <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#err" class="ju-code-link ju-function"><span class="ju-function">err</span></a></span> <span class="ju-delimiter">(</span><span class="ju-string">&quot;Invalid compose (7) args (must be cell): &quot;</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/String-src.html#++str" class="ju-code-link ju-function"><span class="ju-axiom">++str</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#showNoun" class="ju-code-link ju-function"><span class="ju-function">showNoun</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:162" class="ju-code-link ju-var"><span class="ju-var">args</span></a></span><span class="ju-delimiter">)</span>
      <span class="ju-delimiter">}</span>

    <span class="ju-comment">-- *[a 8 b c] -&gt; *[[*[a b] a] c]</span>
    <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.Extend" class="ju-code-link ju-constructor"><span class="ju-constructor">NockOp<span class="ju-delimiter">.</span>Extend</span></a></span> <span class="ju-keyword">:=</span>
      <span class="ju-keyword">case</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:162" class="ju-code-link ju-var"><span class="ju-var">args</span></a></span> <span class="ju-keyword">of</span> <span class="ju-delimiter">{</span>
        <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor">Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span id="arch.system.state.resource_machine.notes.nockma:185"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:185" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:185" class="ju-code-link ju-var"><span class="ju-var">b</span></a></span></a></span></span> <span id="arch.system.state.resource_machine.notes.nockma:186"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:186" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:186" class="ju-code-link ju-var"><span class="ju-var">c</span></a></span></a></span></span> <span class="ju-keyword">:=</span>
          <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#nock" class="ju-code-link ju-function"><span class="ju-function">nock</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:159" class="ju-code-link ju-var"><span class="ju-var">stor</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:161" class="ju-code-link ju-var"><span class="ju-var">a</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:185" class="ju-code-link ju-var"><span class="ju-var">b</span></a></span><span class="ju-delimiter">)</span>
            <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Monad-src.html#&gt;&gt;=" class="ju-code-link ju-function"><span class="ju-function">&gt;&gt;=</span></a></span> <span class="ju-keyword">\</span><span class="ju-delimiter">{</span><span id="arch.system.state.resource_machine.notes.nockma:187"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:187" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:187" class="ju-code-link ju-var"><span class="ju-var">r</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#nock" class="ju-code-link ju-function"><span class="ju-function">nock</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:159" class="ju-code-link ju-var"><span class="ju-var">stor</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:187" class="ju-code-link ju-var"><span class="ju-var">r</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:161" class="ju-code-link ju-var"><span class="ju-var">a</span></a></span><span class="ju-delimiter">)</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:186" class="ju-code-link ju-var"><span class="ju-var">c</span></a></span><span class="ju-delimiter">)</span><span class="ju-delimiter">}</span>
        <span class="ju-keyword">|</span> <span class="ju-keyword">_</span> <span class="ju-keyword">:=</span>
          <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#err" class="ju-code-link ju-function"><span class="ju-function">err</span></a></span> <span class="ju-delimiter">(</span><span class="ju-string">&quot;Invalid extend (8) args (must be cell): &quot;</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/String-src.html#++str" class="ju-code-link ju-function"><span class="ju-axiom">++str</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#showNoun" class="ju-code-link ju-function"><span class="ju-function">showNoun</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:162" class="ju-code-link ju-var"><span class="ju-var">args</span></a></span><span class="ju-delimiter">)</span>
      <span class="ju-delimiter">}</span>

    <span class="ju-comment">-- *[a 9 b c] -&gt; *[*[a c] 2 [0 1] 0 b]</span>
    <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.Invoke" class="ju-code-link ju-constructor"><span class="ju-constructor">NockOp<span class="ju-delimiter">.</span>Invoke</span></a></span> <span class="ju-keyword">:=</span>
      <span class="ju-keyword">case</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:162" class="ju-code-link ju-var"><span class="ju-var">args</span></a></span> <span class="ju-keyword">of</span> <span class="ju-delimiter">{</span>
        <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor">Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span id="arch.system.state.resource_machine.notes.nockma:188"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:188" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:188" class="ju-code-link ju-var"><span class="ju-var">b</span></a></span></a></span></span> <span id="arch.system.state.resource_machine.notes.nockma:189"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:189" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:189" class="ju-code-link ju-var"><span class="ju-var">c</span></a></span></a></span></span> <span class="ju-keyword">:=</span>
          <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#nock" class="ju-code-link ju-function"><span class="ju-function">nock</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:159" class="ju-code-link ju-var"><span class="ju-var">stor</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:161" class="ju-code-link ju-var"><span class="ju-var">a</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:189" class="ju-code-link ju-var"><span class="ju-var">c</span></a></span><span class="ju-delimiter">)</span>
            <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Monad-src.html#&gt;&gt;=" class="ju-code-link ju-function"><span class="ju-function">&gt;&gt;=</span></a></span> <span class="ju-keyword">\</span><span class="ju-delimiter">{</span><span id="arch.system.state.resource_machine.notes.nockma:190"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:190" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:190" class="ju-code-link ju-var"><span class="ju-var">core</span></a></span></a></span></span> <span class="ju-keyword">:=</span>
              <span class="ju-keyword">let</span>
                <span id="formula"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#formula" class="ju-code-link ju-function"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#formula" class="ju-code-link ju-function"><span class="ju-function">formula</span></a></span></a></span></span> <span class="ju-keyword">:=</span>
                  <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor">Noun<span class="ju-delimiter">.</span>Cell</span></a></span>
                    <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Atom" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Atom</span></a></span> <span class="ju-number">2</span><span class="ju-delimiter">)</span>
                    <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Cell</span></a></span>
                      <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Atom" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Atom</span></a></span> <span class="ju-number">0</span><span class="ju-delimiter">)</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Atom" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Atom</span></a></span> <span class="ju-number">1</span><span class="ju-delimiter">)</span><span class="ju-delimiter">)</span>
                      <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Atom" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Atom</span></a></span> <span class="ju-number">0</span><span class="ju-delimiter">)</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:188" class="ju-code-link ju-var"><span class="ju-var">b</span></a></span><span class="ju-delimiter">)</span><span class="ju-delimiter">)</span><span class="ju-delimiter">;</span>
              <span class="ju-keyword">in</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#nock" class="ju-code-link ju-function"><span class="ju-function">nock</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:159" class="ju-code-link ju-var"><span class="ju-var">stor</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:190" class="ju-code-link ju-var"><span class="ju-var">core</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#formula" class="ju-code-link ju-function"><span class="ju-function">formula</span></a></span><span class="ju-delimiter">)</span><span class="ju-delimiter">}</span>
        <span class="ju-keyword">|</span> <span class="ju-keyword">_</span> <span class="ju-keyword">:=</span>
          <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#err" class="ju-code-link ju-function"><span class="ju-function">err</span></a></span> <span class="ju-delimiter">(</span><span class="ju-string">&quot;Invalid invoke (9) args (must be cell): &quot;</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/String-src.html#++str" class="ju-code-link ju-function"><span class="ju-axiom">++str</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#showNoun" class="ju-code-link ju-function"><span class="ju-function">showNoun</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:162" class="ju-code-link ju-var"><span class="ju-var">args</span></a></span><span class="ju-delimiter">)</span>
      <span class="ju-delimiter">}</span>

    <span class="ju-comment">-- *[a 10 [b c] d] -&gt; #[b *[a c] *[a d]]</span>
    <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.Pound" class="ju-code-link ju-constructor"><span class="ju-constructor">NockOp<span class="ju-delimiter">.</span>Pound</span></a></span> <span class="ju-keyword">:=</span>
      <span class="ju-keyword">case</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:162" class="ju-code-link ju-var"><span class="ju-var">args</span></a></span> <span class="ju-keyword">of</span> <span class="ju-delimiter">{</span>
        <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor">Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span id="arch.system.state.resource_machine.notes.nockma:192"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:192" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:192" class="ju-code-link ju-var"><span class="ju-var">b</span></a></span></a></span></span> <span id="arch.system.state.resource_machine.notes.nockma:193"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:193" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:193" class="ju-code-link ju-var"><span class="ju-var">c</span></a></span></a></span></span><span class="ju-delimiter">)</span> <span id="arch.system.state.resource_machine.notes.nockma:194"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:194" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:194" class="ju-code-link ju-var"><span class="ju-var">d</span></a></span></a></span></span> <span class="ju-keyword">:=</span>
          <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#nock" class="ju-code-link ju-function"><span class="ju-function">nock</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:159" class="ju-code-link ju-var"><span class="ju-var">stor</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:161" class="ju-code-link ju-var"><span class="ju-var">a</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:193" class="ju-code-link ju-var"><span class="ju-var">c</span></a></span><span class="ju-delimiter">)</span>
            <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Monad-src.html#&gt;&gt;=" class="ju-code-link ju-function"><span class="ju-function">&gt;&gt;=</span></a></span> <span class="ju-keyword">\</span><span class="ju-delimiter">{</span><span id="arch.system.state.resource_machine.notes.nockma:195"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:195" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:195" class="ju-code-link ju-var"><span class="ju-var">r1</span></a></span></a></span></span> <span class="ju-keyword">:=</span>
              <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#nock" class="ju-code-link ju-function"><span class="ju-function">nock</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:159" class="ju-code-link ju-var"><span class="ju-var">stor</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:161" class="ju-code-link ju-var"><span class="ju-var">a</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:194" class="ju-code-link ju-var"><span class="ju-var">d</span></a></span><span class="ju-delimiter">)</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Monad-src.html#&gt;&gt;=" class="ju-code-link ju-function"><span class="ju-function">&gt;&gt;=</span></a></span> <span class="ju-keyword">\</span><span class="ju-delimiter">{</span><span id="arch.system.state.resource_machine.notes.nockma:196"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:196" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:196" class="ju-code-link ju-var"><span class="ju-var">r2</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#pound" class="ju-code-link ju-function"><span class="ju-function">pound</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:159" class="ju-code-link ju-var"><span class="ju-var">stor</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:192" class="ju-code-link ju-var"><span class="ju-var">b</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:195" class="ju-code-link ju-var"><span class="ju-var">r1</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:196" class="ju-code-link ju-var"><span class="ju-var">r2</span></a></span><span class="ju-delimiter">}</span><span class="ju-delimiter">}</span>
        <span class="ju-keyword">|</span> <span class="ju-keyword">_</span> <span class="ju-keyword">:=</span>
          <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#err" class="ju-code-link ju-function"><span class="ju-function">err</span></a></span>
            <span class="ju-delimiter">(</span><span class="ju-string">&quot;Invalid pound (10) args (must be [[b c] d]): &quot;</span>
              <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/String-src.html#++str" class="ju-code-link ju-function"><span class="ju-axiom">++str</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#showNoun" class="ju-code-link ju-function"><span class="ju-function">showNoun</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:162" class="ju-code-link ju-var"><span class="ju-var">args</span></a></span><span class="ju-delimiter">)</span>
      <span class="ju-delimiter">}</span>

    <span class="ju-comment">-- *[a 11 [b c] d] -&gt; *[[*[a c] *[a d]] 0 3]</span>
    <span class="ju-comment">-- *[a 11 b c] -&gt; *[a c]</span>
    <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#NockOp.Match" class="ju-code-link ju-constructor"><span class="ju-constructor">NockOp<span class="ju-delimiter">.</span>Match</span></a></span> <span class="ju-keyword">:=</span>
      <span class="ju-keyword">case</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:162" class="ju-code-link ju-var"><span class="ju-var">args</span></a></span> <span class="ju-keyword">of</span> <span class="ju-delimiter">{</span>
        <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor">Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span id="arch.system.state.resource_machine.notes.nockma:197"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:197" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:197" class="ju-code-link ju-var"><span class="ju-var">b</span></a></span></a></span></span> <span id="arch.system.state.resource_machine.notes.nockma:198"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:198" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:198" class="ju-code-link ju-var"><span class="ju-var">c</span></a></span></a></span></span><span class="ju-delimiter">)</span> <span id="arch.system.state.resource_machine.notes.nockma:199"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:199" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:199" class="ju-code-link ju-var"><span class="ju-var">d</span></a></span></a></span></span> <span class="ju-keyword">:=</span>
          <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#nock" class="ju-code-link ju-function"><span class="ju-function">nock</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:159" class="ju-code-link ju-var"><span class="ju-var">stor</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:161" class="ju-code-link ju-var"><span class="ju-var">a</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:198" class="ju-code-link ju-var"><span class="ju-var">c</span></a></span><span class="ju-delimiter">)</span>
            <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Monad-src.html#&gt;&gt;=" class="ju-code-link ju-function"><span class="ju-function">&gt;&gt;=</span></a></span> <span class="ju-keyword">\</span><span class="ju-delimiter">{</span><span id="arch.system.state.resource_machine.notes.nockma:200"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:200" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:200" class="ju-code-link ju-var"><span class="ju-var">r1</span></a></span></a></span></span> <span class="ju-keyword">:=</span>
              <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#nock" class="ju-code-link ju-function"><span class="ju-function">nock</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:159" class="ju-code-link ju-var"><span class="ju-var">stor</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:161" class="ju-code-link ju-var"><span class="ju-var">a</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:199" class="ju-code-link ju-var"><span class="ju-var">d</span></a></span><span class="ju-delimiter">)</span>
                <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Monad-src.html#&gt;&gt;=" class="ju-code-link ju-function"><span class="ju-function">&gt;&gt;=</span></a></span> <span class="ju-keyword">\</span><span class="ju-delimiter">{</span><span id="arch.system.state.resource_machine.notes.nockma:201"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:201" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:201" class="ju-code-link ju-var"><span class="ju-var">r2</span></a></span></a></span></span> <span class="ju-keyword">:=</span>
                  <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#nock" class="ju-code-link ju-function"><span class="ju-function">nock</span></a></span>
                    <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:159" class="ju-code-link ju-var"><span class="ju-var">stor</span></a></span>
                    <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Cell</span></a></span>
                      <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:200" class="ju-code-link ju-var"><span class="ju-var">r1</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:201" class="ju-code-link ju-var"><span class="ju-var">r2</span></a></span><span class="ju-delimiter">)</span>
                      <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Atom" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Atom</span></a></span> <span class="ju-number">0</span><span class="ju-delimiter">)</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Atom" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Atom</span></a></span> <span class="ju-number">3</span><span class="ju-delimiter">)</span><span class="ju-delimiter">)</span><span class="ju-delimiter">)</span><span class="ju-delimiter">}</span><span class="ju-delimiter">}</span>
        <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor">Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span id="arch.system.state.resource_machine.notes.nockma:202"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:202" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:202" class="ju-code-link ju-var"><span class="ju-var">b</span></a></span></a></span></span> <span id="arch.system.state.resource_machine.notes.nockma:203"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:203" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:203" class="ju-code-link ju-var"><span class="ju-var">c</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#nock" class="ju-code-link ju-function"><span class="ju-function">nock</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:159" class="ju-code-link ju-var"><span class="ju-var">stor</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:161" class="ju-code-link ju-var"><span class="ju-var">a</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:203" class="ju-code-link ju-var"><span class="ju-var">c</span></a></span><span class="ju-delimiter">)</span>
        <span class="ju-comment">-- Corrected to take &#39;a&#39; as subject</span>
        <span class="ju-keyword">|</span> <span class="ju-keyword">_</span> <span class="ju-keyword">:=</span>
          <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#err" class="ju-code-link ju-function"><span class="ju-function">err</span></a></span> <span class="ju-delimiter">(</span><span class="ju-string">&quot;Invalid match (11) args (must be cell): &quot;</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/String-src.html#++str" class="ju-code-link ju-function"><span class="ju-axiom">++str</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#showNoun" class="ju-code-link ju-function"><span class="ju-function">showNoun</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:162" class="ju-code-link ju-var"><span class="ju-var">args</span></a></span><span class="ju-delimiter">)</span>
      <span class="ju-delimiter">}</span>

    <span class="ju-comment">-- *[a 12 b c d] -&gt; result &lt;- SCRY b c; *[a result d]</span>
    <span class="ju-keyword">|</span> <span id="arch.system.state.resource_machine.notes.nockma:204"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:204" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:204" class="ju-code-link ju-var"><span class="ju-var">Scry</span></a></span></a></span></span> <span class="ju-keyword">:=</span>
      <span class="ju-keyword">case</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:162" class="ju-code-link ju-var"><span class="ju-var">args</span></a></span> <span class="ju-keyword">of</span>
        <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor">Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span id="arch.system.state.resource_machine.notes.nockma:205"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:205" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:205" class="ju-code-link ju-var"><span class="ju-var">b</span></a></span></a></span></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span id="arch.system.state.resource_machine.notes.nockma:206"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:206" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:206" class="ju-code-link ju-var"><span class="ju-var">c</span></a></span></a></span></span> <span id="arch.system.state.resource_machine.notes.nockma:207"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:207" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:207" class="ju-code-link ju-var"><span class="ju-var">d</span></a></span></a></span></span><span class="ju-delimiter">)</span> <span class="ju-keyword">:=</span>
          <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#nock" class="ju-code-link ju-function"><span class="ju-function"><span class="ju-comment">-- First evaluate b to get the opcode</span>
              nock</span></a></span>
              <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:159" class="ju-code-link ju-var"><span class="ju-var">stor</span></a></span>
              <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:205" class="ju-code-link ju-var"><span class="ju-var">b</span></a></span>
            <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Monad-src.html#&gt;&gt;=" class="ju-code-link ju-function"><span class="ju-function">&gt;&gt;=</span></a></span> <span class="ju-keyword">\</span><span class="ju-delimiter">{</span><span id="arch.system.state.resource_machine.notes.nockma:208"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:208" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:208" class="ju-code-link ju-var"><span class="ju-var">opcode</span></a></span></a></span></span> <span class="ju-keyword">:=</span>
              <span class="ju-keyword">case</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:208" class="ju-code-link ju-var"><span class="ju-var">opcode</span></a></span> <span class="ju-keyword">of</span>
                <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Atom" class="ju-code-link ju-constructor"><span class="ju-constructor">Noun<span class="ju-delimiter">.</span>Atom</span></a></span> <span id="arch.system.state.resource_machine.notes.nockma:209"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:209" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:209" class="ju-code-link ju-var"><span class="ju-var">opval</span></a></span></a></span></span> <span class="ju-keyword">:=</span>
                  <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#nock" class="ju-code-link ju-function"><span class="ju-function"><span class="ju-comment">-- Then evaluate c to get the address</span>
                      nock</span></a></span>
                      <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:159" class="ju-code-link ju-var"><span class="ju-var">stor</span></a></span>
                      <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:206" class="ju-code-link ju-var"><span class="ju-var">c</span></a></span>
                    <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Monad-src.html#&gt;&gt;=" class="ju-code-link ju-function"><span class="ju-function">&gt;&gt;=</span></a></span> <span class="ju-keyword">\</span><span class="ju-delimiter">{</span><span id="arch.system.state.resource_machine.notes.nockma:210"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:210" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:210" class="ju-code-link ju-var"><span class="ju-var">addr</span></a></span></a></span></span> <span class="ju-keyword">:=</span>
                      <span class="ju-keyword">case</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:210" class="ju-code-link ju-var"><span class="ju-var">addr</span></a></span> <span class="ju-keyword">of</span>
                        <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Atom" class="ju-code-link ju-constructor"><span class="ju-constructor">Noun<span class="ju-delimiter">.</span>Atom</span></a></span> <span id="arch.system.state.resource_machine.notes.nockma:211"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:211" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:211" class="ju-code-link ju-var"><span class="ju-var">addrVal</span></a></span></a></span></span> <span class="ju-keyword">:=</span>
                          <span class="ju-comment">-- Convert opcode to ScryOp</span>
                          <span class="ju-keyword">let</span>
                            <span id="scryType"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#scryType" class="ju-code-link ju-function"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#scryType" class="ju-code-link ju-function"><span class="ju-function">scryType</span></a></span></a></span></span> <span class="ju-keyword">:=</span>
                              <span class="ju-keyword">case</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:209" class="ju-code-link ju-var"><span class="ju-var">opval</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Eq-src.html#==" class="ju-code-link ju-function"><span class="ju-function">==</span></a></span> <span class="ju-number">0</span> <span class="ju-keyword">of</span>
                                <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/Bool-src.html#Bool.true" class="ju-code-link ju-constructor"><span class="ju-constructor">true</span></a></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#ScryOp.Direct" class="ju-code-link ju-constructor"><span class="ju-constructor">ScryOp<span class="ju-delimiter">.</span>Direct</span></a></span>
                                <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/Bool-src.html#Bool.false" class="ju-code-link ju-constructor"><span class="ju-constructor">false</span></a></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#ScryOp.Index" class="ju-code-link ju-constructor"><span class="ju-constructor">ScryOp<span class="ju-delimiter">.</span>Index</span></a></span><span class="ju-delimiter">;</span>
                          <span class="ju-keyword">in</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#GasState.mk" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-comment">-- Perform the scry operation and wrap result in GasState</span>
                            GasState<span class="ju-delimiter">.</span>mk</span></a></span>
                            <span class="ju-keyword">\</span><span class="ju-delimiter">{</span><span id="arch.system.state.resource_machine.notes.nockma:213"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:213" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:213" class="ju-code-link ju-var"><span class="ju-var">gas</span></a></span></a></span></span> <span class="ju-keyword">:=</span>
                              <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#scry" class="ju-code-link ju-function"><span class="ju-function">scry</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:159" class="ju-code-link ju-var"><span class="ju-var">stor</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#scryType" class="ju-code-link ju-function"><span class="ju-function">scryType</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:211" class="ju-code-link ju-var"><span class="ju-var">addrVal</span></a></span>
                                <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Monad-src.html#&gt;&gt;=" class="ju-code-link ju-function"><span class="ju-function">&gt;&gt;=</span></a></span> <span class="ju-keyword">\</span><span class="ju-delimiter">{</span><span id="arch.system.state.resource_machine.notes.nockma:214"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:214" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:214" class="ju-code-link ju-var"><span class="ju-var">scryResult</span></a></span></a></span></span> <span class="ju-keyword">:=</span>
                                  <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#GasState.runGasState" class="ju-code-link ju-function"><span class="ju-function"><span class="ju-comment">-- Continue evaluation with the scry result</span>
                                    GasState<span class="ju-delimiter">.</span>runGasState</span></a></span>
                                    <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#nock" class="ju-code-link ju-function"><span class="ju-function"><span class="ju-delimiter">(</span>nock</span></a></span>
                                      <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:159" class="ju-code-link ju-var"><span class="ju-var">stor</span></a></span>
                                      <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:161" class="ju-code-link ju-var"><span class="ju-var">a</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:214" class="ju-code-link ju-var"><span class="ju-var">scryResult</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:207" class="ju-code-link ju-var"><span class="ju-var">d</span></a></span><span class="ju-delimiter">)</span><span class="ju-delimiter">)</span><span class="ju-delimiter">)</span>
                                    <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:213" class="ju-code-link ju-var"><span class="ju-var">gas</span></a></span><span class="ju-delimiter">}</span><span class="ju-delimiter">}</span>
                        <span class="ju-keyword">|</span> <span class="ju-keyword">_</span> <span class="ju-keyword">:=</span>
                          <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#err" class="ju-code-link ju-function"><span class="ju-function">err</span></a></span>
                            <span class="ju-delimiter">(</span><span class="ju-string">&quot;Scry address must be atom, got: &quot;</span>
                              <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/String-src.html#++str" class="ju-code-link ju-function"><span class="ju-axiom">++str</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#showNoun" class="ju-code-link ju-function"><span class="ju-function">showNoun</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:210" class="ju-code-link ju-var"><span class="ju-var">addr</span></a></span><span class="ju-delimiter">)</span><span class="ju-delimiter">}</span>
                <span class="ju-keyword">|</span> <span class="ju-keyword">_</span> <span class="ju-keyword">:=</span>
                  <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#err" class="ju-code-link ju-function"><span class="ju-function">err</span></a></span> <span class="ju-delimiter">(</span><span class="ju-string">&quot;Scry type must be atom, got: &quot;</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/String-src.html#++str" class="ju-code-link ju-function"><span class="ju-axiom">++str</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#showNoun" class="ju-code-link ju-function"><span class="ju-function">showNoun</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:208" class="ju-code-link ju-var"><span class="ju-var">opcode</span></a></span><span class="ju-delimiter">)</span><span class="ju-delimiter">}</span>
        <span class="ju-keyword">|</span> <span class="ju-keyword">_</span> <span class="ju-keyword">:=</span>
          <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#err" class="ju-code-link ju-function"><span class="ju-function">err</span></a></span>
            <span class="ju-delimiter">(</span><span class="ju-string">&quot;Invalid scry (12) args (must be [b [c d]]): &quot;</span>
              <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/String-src.html#++str" class="ju-code-link ju-function"><span class="ju-axiom">++str</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#showNoun" class="ju-code-link ju-function"><span class="ju-function">showNoun</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:162" class="ju-code-link ju-var"><span class="ju-var">args</span></a></span><span class="ju-delimiter">)</span><span class="ju-delimiter">;</span>

<span class="ju-comment">-- Core Nockma evaluator</span>
<span class="ju-keyword">terminating</span>
<span id="nock"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#nock" class="ju-code-link ju-function"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#nock" class="ju-code-link ju-function"><span class="ju-function">nock</span></a></span></a></span></span> <span class="ju-delimiter">{</span><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:215" class="ju-code-link ju-var"><span class="ju-var">val</span></a></span> <span class="ju-keyword">:</span> <span class="ju-keyword">Type</span><span class="ju-delimiter">}</span> <span class="ju-delimiter">(</span><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:216" class="ju-code-link ju-var"><span class="ju-var">stor</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Storage" class="ju-code-link ju-inductive"><span class="ju-inductive">Storage</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/Nat/Base-src.html#Nat" class="ju-code-link ju-inductive"><span class="ju-inductive">Nat</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:215" class="ju-code-link ju-var"><span class="ju-var">val</span></a></span><span class="ju-delimiter">)</span> <span class="ju-delimiter">(</span><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:217" class="ju-code-link ju-var"><span class="ju-var">input</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun" class="ju-code-link ju-inductive"><span class="ju-inductive">Noun</span></a></span><span class="ju-delimiter">)</span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#GasState" class="ju-code-link ju-inductive"><span class="ju-inductive">GasState</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun" class="ju-code-link ju-inductive"><span class="ju-inductive">Noun</span></a></span> <span class="ju-keyword">:=</span>
  <span class="ju-keyword">case</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:217" class="ju-code-link ju-var"><span class="ju-var">input</span></a></span> <span class="ju-keyword">of</span>
    <span class="ju-comment">-- Rule: *a -&gt; *a</span>
    <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Atom" class="ju-code-link ju-constructor"><span class="ju-constructor">Noun<span class="ju-delimiter">.</span>Atom</span></a></span> <span id="arch.system.state.resource_machine.notes.nockma:218"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:218" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:218" class="ju-code-link ju-var"><span class="ju-var">n</span></a></span></a></span></span> <span class="ju-keyword">:=</span>
      <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#err" class="ju-code-link ju-function"><span class="ju-function">err</span></a></span> <span class="ju-delimiter">(</span><span class="ju-string">&quot;Cannot evaluate atom as program: &quot;</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/String-src.html#++str" class="ju-code-link ju-function"><span class="ju-axiom">++str</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#showNoun" class="ju-code-link ju-function"><span class="ju-function">showNoun</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Atom" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Atom</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:218" class="ju-code-link ju-var"><span class="ju-var">n</span></a></span><span class="ju-delimiter">)</span><span class="ju-delimiter">)</span>

    <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor">Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span id="arch.system.state.resource_machine.notes.nockma:219"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:219" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:219" class="ju-code-link ju-var"><span class="ju-var">a</span></a></span></a></span></span> <span id="arch.system.state.resource_machine.notes.nockma:220"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:220" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:220" class="ju-code-link ju-var"><span class="ju-var">b</span></a></span></a></span></span> <span class="ju-keyword">:=</span>
      <span class="ju-keyword">case</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:220" class="ju-code-link ju-var"><span class="ju-var">b</span></a></span> <span class="ju-keyword">of</span>
        
        <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor">Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span id="arch.system.state.resource_machine.notes.nockma:221"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:221" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:221" class="ju-code-link ju-var"><span class="ju-var">first</span></a></span></a></span></span> <span id="arch.system.state.resource_machine.notes.nockma:222"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:222" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:222" class="ju-code-link ju-var"><span class="ju-var">rest</span></a></span></a></span></span> <span class="ju-keyword">:=</span>
          <span class="ju-keyword">case</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:221" class="ju-code-link ju-var"><span class="ju-var">first</span></a></span> <span class="ju-keyword">of</span> <span class="ju-delimiter">{</span>
            <span class="ju-comment">-- Rule: *[a [b c] d] -&gt; [*[a b c] *[a d]]</span>
            <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor">Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span id="arch.system.state.resource_machine.notes.nockma:223"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:223" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:223" class="ju-code-link ju-var"><span class="ju-var">b</span></a></span></a></span></span> <span id="arch.system.state.resource_machine.notes.nockma:224"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:224" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:224" class="ju-code-link ju-var"><span class="ju-var">c</span></a></span></a></span></span> <span class="ju-keyword">:=</span>
              <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#nock" class="ju-code-link ju-function"><span class="ju-function">nock</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:216" class="ju-code-link ju-var"><span class="ju-var">stor</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:219" class="ju-code-link ju-var"><span class="ju-var">a</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:223" class="ju-code-link ju-var"><span class="ju-var">b</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:224" class="ju-code-link ju-var"><span class="ju-var">c</span></a></span><span class="ju-delimiter">)</span><span class="ju-delimiter">)</span>
                <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Monad-src.html#&gt;&gt;=" class="ju-code-link ju-function"><span class="ju-function">&gt;&gt;=</span></a></span> <span class="ju-keyword">\</span><span class="ju-delimiter">{</span><span id="arch.system.state.resource_machine.notes.nockma:225"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:225" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:225" class="ju-code-link ju-var"><span class="ju-var">r1</span></a></span></a></span></span> <span class="ju-keyword">:=</span>
                  <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#nock" class="ju-code-link ju-function"><span class="ju-function">nock</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:216" class="ju-code-link ju-var"><span class="ju-var">stor</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:219" class="ju-code-link ju-var"><span class="ju-var">a</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:222" class="ju-code-link ju-var"><span class="ju-var">rest</span></a></span><span class="ju-delimiter">)</span>
                    <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Monad-src.html#&gt;&gt;=" class="ju-code-link ju-function"><span class="ju-function">&gt;&gt;=</span></a></span> <span class="ju-keyword">\</span><span class="ju-delimiter">{</span><span id="arch.system.state.resource_machine.notes.nockma:226"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:226" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:226" class="ju-code-link ju-var"><span class="ju-var">r2</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Applicative-src.html#Applicative.pure" class="ju-code-link ju-function"><span class="ju-function">pure</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Cell" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Cell</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:225" class="ju-code-link ju-var"><span class="ju-var">r1</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:226" class="ju-code-link ju-var"><span class="ju-var">r2</span></a></span><span class="ju-delimiter">)</span><span class="ju-delimiter">}</span><span class="ju-delimiter">}</span>

            <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Atom" class="ju-code-link ju-constructor"><span class="ju-constructor">Noun<span class="ju-delimiter">.</span>Atom</span></a></span> <span id="arch.system.state.resource_machine.notes.nockma:227"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:227" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:227" class="ju-code-link ju-var"><span class="ju-var">n</span></a></span></a></span></span> <span class="ju-keyword">:=</span>
              <span class="ju-keyword">case</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#parseOp" class="ju-code-link ju-function"><span class="ju-function">parseOp</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:227" class="ju-code-link ju-var"><span class="ju-var">n</span></a></span> <span class="ju-keyword">of</span> <span class="ju-delimiter">{</span>
                <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/prelude-src.html#some" class="ju-code-link ju-var"><span class="ju-constructor">some</span></a></span> <span id="arch.system.state.resource_machine.notes.nockma:228"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:228" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:228" class="ju-code-link ju-var"><span class="ju-var">opcode</span></a></span></a></span></span> <span class="ju-keyword">:=</span>
                  <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#consume" class="ju-code-link ju-function"><span class="ju-function">consume</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:228" class="ju-code-link ju-var"><span class="ju-var">opcode</span></a></span>
                    <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Trait/Monad-src.html#&gt;&gt;=" class="ju-code-link ju-function"><span class="ju-function">&gt;&gt;=</span></a></span> <span class="ju-keyword">\</span><span class="ju-delimiter">{</span><span class="ju-keyword">_</span> <span class="ju-keyword">:=</span>
                      <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#evalOp" class="ju-code-link ju-function"><span class="ju-function">evalOp</span></a></span>
                        <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:216" class="ju-code-link ju-var"><span class="ju-var">stor</span></a></span>
                        <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:228" class="ju-code-link ju-var"><span class="ju-var">opcode</span></a></span>
                        <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:219" class="ju-code-link ju-var"><span class="ju-var">a</span></a></span>
                        <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:222" class="ju-code-link ju-var"><span class="ju-var">rest</span></a></span><span class="ju-comment">-- Evaluate [subject rest] with opcode n</span>
                    <span class="ju-delimiter">}</span>
                <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/prelude-src.html#none" class="ju-code-link ju-var"><span class="ju-constructor">none</span></a></span> <span class="ju-keyword">:=</span>
                  <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#err" class="ju-code-link ju-function"><span class="ju-function">err</span></a></span>
                    <span class="ju-delimiter">(</span><span class="ju-string">&quot;Invalid operation code: &quot;</span>
                      <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/String-src.html#++str" class="ju-code-link ju-function"><span class="ju-axiom">++str</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/Stdlib/Data/Nat-src.html#natToString" class="ju-code-link ju-function"><span class="ju-axiom">natToString</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:227" class="ju-code-link ju-var"><span class="ju-var">n</span></a></span>
                      <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/String-src.html#++str" class="ju-code-link ju-function"><span class="ju-axiom">++str</span></a></span> <span class="ju-string">&quot; in formula: &quot;</span>
                      <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/String-src.html#++str" class="ju-code-link ju-function"><span class="ju-axiom">++str</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#showNoun" class="ju-code-link ju-function"><span class="ju-function">showNoun</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:220" class="ju-code-link ju-var"><span class="ju-var">b</span></a></span><span class="ju-delimiter">)</span>
              <span class="ju-delimiter">}</span>
          <span class="ju-delimiter">}</span>
        <span class="ju-comment">-- Rule: *[a b] where b is an atom is an error</span>
        <span class="ju-keyword">|</span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Atom" class="ju-code-link ju-constructor"><span class="ju-constructor">Noun<span class="ju-delimiter">.</span>Atom</span></a></span> <span id="arch.system.state.resource_machine.notes.nockma:229"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:229" class="ju-code-link ju-var"><span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:229" class="ju-code-link ju-var"><span class="ju-var">bn</span></a></span></a></span></span> <span class="ju-keyword">:=</span>
          <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#err" class="ju-code-link ju-function"><span class="ju-function">err</span></a></span>
            <span class="ju-delimiter">(</span><span class="ju-string">&quot;Formula cannot be an atom: &quot;</span>
              <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/String-src.html#++str" class="ju-code-link ju-function"><span class="ju-axiom">++str</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#showNoun" class="ju-code-link ju-function"><span class="ju-function">showNoun</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#Noun.Atom" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>Noun<span class="ju-delimiter">.</span>Atom</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:229" class="ju-code-link ju-var"><span class="ju-var">bn</span></a></span><span class="ju-delimiter">)</span>
              <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/String-src.html#++str" class="ju-code-link ju-function"><span class="ju-axiom">++str</span></a></span> <span class="ju-string">&quot; in input: &quot;</span>
              <span class="annot"><a href="https://specs.anoma.net/pr-347/Juvix/Builtin/V1/String-src.html#++str" class="ju-code-link ju-function"><span class="ju-axiom">++str</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#showNoun" class="ju-code-link ju-function"><span class="ju-function">showNoun</span></a></span> <span class="annot"><a href="https://specs.anoma.net/pr-347/arch/system/state/resource_machine/notes/nockma-src.html#arch.system.state.resource_machine.notes.nockma:217" class="ju-code-link ju-var"><span class="ju-var">input</span></a></span><span class="ju-delimiter">)</span><span class="ju-delimiter">;</span>
</pre><footer><pre>Powered by <a href="https://juvix.org">Juvix </a><a href="https://github.com/anoma/juvix/commit/b935467">0.6.10-b935467</a></pre></footer><footer><pre>Last modified on 2025-06-03 6:33 UTC</pre></footer></html>