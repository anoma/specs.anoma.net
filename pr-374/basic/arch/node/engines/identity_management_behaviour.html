
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="The Anoma specs is a collection of documents that describe the architecture, design, and implementation of the Anoma Network." name="description"/>
<meta content="Anoma Foundation" name="author"/>
<link href="https://specs.anoma.net/pr-374/arch/node/engines/identity_management_behaviour.juvix.html" rel="canonical"/>
<link href="identity_management_environment.html" rel="prev"/>
<link href="encryption.html" rel="next"/>
<link href="../../../assets/logo.svg" rel="icon"/>
<meta content="mkdocs-1.6.1, mkdocs-material-9.6.12" name="generator"/>
<title>Identity Management Behaviour - Anoma specs</title>
<link href="../../../assets/stylesheets/main.2afb09e1.min.css" rel="stylesheet"/>
<link href="../../../assets/stylesheets/palette.06af60db.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Inter";--md-code-font:"JetBrains Mono"}</style>
<link href="../../../assets/css/juvix-material-style.css" rel="stylesheet"/>
<link href="../../../assets/css/juvix-highlighting.css" rel="stylesheet"/>
<link href="../../../assets/css/juvix_codeblock_footer.css" rel="stylesheet"/>
<link href="../../../assets/css/latte-light.css" rel="stylesheet"/>
<link href="../../../assets/css/extra.css" rel="stylesheet"/>
<script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
<link href="../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../../assets/javascripts/glightbox.min.js"></script></link></head>
<body data-md-color-accent="indigo" data-md-color-primary="white" data-md-color-scheme="default" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#identity-management-behaviour">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
<aside class="md-banner">
<div class="md-banner__inner md-grid md-typeset">
<button aria-label="Don't show this again" class="md-banner__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
</button>
            
            
  For updates follow <strong>@anoma</strong> on
  <a href="https://x.com/anoma" rel="me">
<span class="twemoji x-twitter">
<svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8l164.9-188.5L26.8 48h145.6l100.5 132.9zm-24.8 373.8h39.1L151.1 88h-42z"></path></svg>
</span>
<strong></strong>
</a>
  and discuss on our
  <a href="https://research.anoma.net">
<span class="twemoji discourse">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M225.9 32C103.3 32 0 130.5 0 252.1 0 256 .1 480 .1 480l225.8-.2c122.7 0 222.1-102.3 222.1-223.9S348.6 32 225.9 32M224 384c-19.4 0-37.9-4.3-54.4-12.1L88.5 392l22.9-75c-9.8-18.1-15.4-38.9-15.4-61 0-70.7 57.3-128 128-128s128 57.3 128 128-57.3 128-128 128"></path></svg>
</span>
<strong>forum</strong>
</a>
</div>
<script>var el=document.querySelector("[data-md-component=announce]");if(el){var content=el.querySelector(".md-typeset");__md_hash(content.innerHTML)===__md_get("__announce")&&(el.hidden=!0)}</script>
</aside>
</div>
<header class="md-header md-header--shadow" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="Anoma specs" class="md-header__button md-logo" data-md-component="logo" href="../../../index.html" title="Anoma specs">
<img alt="logo" src="../../../assets/logo.svg"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
<span class="first-letter">A</span>noma 
              
                <span class="first-letter">s</span>pecs
              
              
                <span class="md-header__topic-version">(PR 374)</span>
</span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
              
                Identity Management Behaviour
              
            </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Switch to light mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme)" data-md-color-primary="white" data-md-color-scheme="default" id="__palette_0" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to light mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"></path></svg>
</label>
<input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="red" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="white" data-md-color-scheme="default" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_2" hidden="" title="Switch to dark mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
</label>
<input aria-label="Switch to system preference" class="md-option" data-md-color-accent="red" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="black" data-md-color-scheme="slate" id="__palette_2" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_0" hidden="" title="Switch to system preference">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
</label>
</form>
<script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M10.68 11.74a6 6 0 0 1-7.922-8.982 6 6 0 0 1 8.982 7.922l3.04 3.04a.749.749 0 0 1-.326 1.275.75.75 0 0 1-.734-.215ZM11.5 7a4.499 4.499 0 1 0-8.997 0A4.499 4.499 0 0 0 11.5 7"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M10.68 11.74a6 6 0 0 1-7.922-8.982 6 6 0 0 1 8.982 7.922l3.04 3.04a.749.749 0 0 1-.326 1.275.75.75 0 0 1-.734-.215ZM11.5 7a4.499 4.499 0 1 0-8.997 0A4.499 4.499 0 0 0 11.5 7"></path></svg>
<svg viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M7.78 12.53a.75.75 0 0 1-1.06 0L2.47 8.28a.75.75 0 0 1 0-1.06l4.25-4.25a.75.75 0 0 1 1.042.018.75.75 0 0 1 .018 1.042L4.81 7h7.44a.75.75 0 0 1 0 1.5H4.81l2.97 2.97a.75.75 0 0 1 0 1.06"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
</button>
</nav>
<div class="md-search__suggest" data-md-component="search-suggest"></div>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="" tabindex="0">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/anoma/nspec" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg>
</div>
<div class="md-source__repository">
    anoma/nspec
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<!--
  This is a modified version of the original mkdocs-material theme.
  Copyright (c) 2016-2025 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->
<!-- Determine classes -->
<!-- Navigation -->
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<!-- Site title -->
<label class="md-nav__title" for="__drawer">
<a aria-label="Anoma specs" class="md-nav__button md-logo" data-md-component="logo" href="../../../index.html" title="Anoma specs">
<img alt="logo" src="../../../assets/logo.svg"/>
</a>
    Anoma specs
  </label>
<!-- List of Versions -->
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="https://specs.anoma.net/latest" target="_blank">
     Latest version ((PR 374))
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="https://specs.anoma.net/main">
        Development version
      </a>
</li>
</ul>
<!-- Navigation list -->
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../index.html">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"></path></svg>
<span class="md-ellipsis">
    Home
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../overview.html">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M24 18.714v4.8c0 .288-.192.48-.48.48h-4.8c-.288 0-.48-.192-.48-.48v-4.8c0-.288.192-.48.48-.48h1.92v-1.92h-8.16v1.92h1.92c.288 0 .48.192.48.48v4.8c0 .288-.192.48-.48.48H9.6c-.288 0-.48-.192-.48-.48v-4.8c0-.288.192-.48.48-.48h1.92v-1.92H3.36v1.92h1.92c.288 0 .48.192.48.48v4.8c0 .288-.192.48-.48.48H.48c-.288 0-.48-.192-.48-.48v-4.8c0-.288.192-.48.48-.48H2.4v-2.4c0-.288.192-.48.48-.48h8.64v-1.44h.96v1.44h8.64c.288 0 .48.192.48.48v2.4h1.92c.288 0 .48.192.48.48m-13.92 4.32h3.84v-3.84h-3.84zm-9.12 0H4.8v-3.84H.96Zm18.24 0h3.84v-3.84H19.2ZM6.24 9.642V3.546c0-.192.096-.336.24-.432L11.76.042a.8.8 0 0 1 .48 0l5.28 3.072c.144.096.24.24.24.432v6.096c0 .144-.096.288-.24.384l-5.28 3.072q-.096.048-.24.048t-.24-.048l-5.28-3.072c-.144-.096-.24-.24-.24-.384m10.56-.288V4.362l-4.32 2.496v4.992zm-9.6 0 4.32 2.496V6.858L7.2 4.362Zm.48-5.808L12 5.994l4.32-2.448L12 1.05Z"></path></svg>
<span class="md-ellipsis">
    Anoma architecture
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../changelog.html">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 21.5c-1.35-.85-3.8-1.5-5.5-1.5-1.65 0-3.35.3-4.75 1.05-.1.05-.15.05-.25.05-.25 0-.5-.25-.5-.5V6c.6-.45 1.25-.75 2-1 1.11-.35 2.33-.5 3.5-.5 1.95 0 4.05.4 5.5 1.5 1.45-1.1 3.55-1.5 5.5-1.5 1.17 0 2.39.15 3.5.5.75.25 1.4.55 2 1v14.6c0 .25-.25.5-.5.5-.1 0-.15 0-.25-.05-1.4-.75-3.1-1.05-4.75-1.05-1.7 0-4.15.65-5.5 1.5M12 8v11.5c1.35-.85 3.8-1.5 5.5-1.5 1.2 0 2.4.15 3.5.5V7c-1.1-.35-2.3-.5-3.5-.5-1.7 0-4.15.65-5.5 1.5m1 3.5c1.11-.68 2.6-1 4.5-1 .91 0 1.76.09 2.5.28V9.23c-.87-.15-1.71-.23-2.5-.23q-2.655 0-4.5.84zm4.5.17c-1.71 0-3.21.26-4.5.79v1.69c1.11-.65 2.6-.99 4.5-.99 1.04 0 1.88.08 2.5.24v-1.5c-.87-.16-1.71-.23-2.5-.23m2.5 2.9c-.87-.16-1.71-.24-2.5-.24-1.83 0-3.33.27-4.5.8v1.69c1.11-.66 2.6-.99 4.5-.99 1.04 0 1.88.08 2.5.24z"></path></svg>
<span class="md-ellipsis">
    Changelog
    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
<span class="md-ellipsis">
    Indexes
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
            Indexes
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../indexes/tags.html">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M5.5 7A1.5 1.5 0 0 1 4 5.5 1.5 1.5 0 0 1 5.5 4 1.5 1.5 0 0 1 7 5.5 1.5 1.5 0 0 1 5.5 7m15.91 4.58-9-9C12.05 2.22 11.55 2 11 2H4c-1.11 0-2 .89-2 2v7c0 .55.22 1.05.59 1.41l8.99 9c.37.36.87.59 1.42.59s1.05-.23 1.41-.59l7-7c.37-.36.59-.86.59-1.41 0-.56-.23-1.06-.59-1.42"></path></svg>
<span class="md-ellipsis">
    List of tags
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../indexes/modules.html">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 10h-2V8h2m0 5h-2v-2h2m-3-1h-2V8h2m0 5h-2v-2h2m0 6H8v-2h8m-9-5H5V8h2m0 5H5v-2h2m1 0h2v2H8m0-5h2v2H8m3 1h2v2h-2m0-5h2v2h-2m9-5H4c-1.11 0-2 .89-2 2v10a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2"></path></svg>
<span class="md-ellipsis">
    List of modules
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../prelude.html">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M6 2a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6zm0 2h7v5h5v11H6zm2 8v2h8v-2zm0 4v2h5v-2z"></path></svg>
<span class="md-ellipsis">
    List of basic types
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
<span class="md-ellipsis">
    Node architecture
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_5_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_5">
<span class="md-nav__icon md-icon"></span>
            Node architecture
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../concepts/engine.html">
<span class="md-ellipsis">
    Concepts
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../types/anoma_message.html">
<span class="md-ellipsis">
    Types
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_5_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="0">
<span class="md-ellipsis">
    Subsystems
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_5_3_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_3">
<span class="md-nav__icon md-icon"></span>
            Subsystems
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../subsystems/hardware.html">
<span class="md-ellipsis">
    Hardware subsystem
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_5_3_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_5_3_2" id="__nav_5_3_2_label" tabindex="0">
<span class="md-ellipsis">
    Identity subsystem
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_5_3_2_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_5_3_2">
<span class="md-nav__icon md-icon"></span>
            Identity subsystem
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../subsystems/identity.html">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 19.2c-2.5 0-4.71-1.28-6-3.2.03-2 4-3.1 6-3.1s5.97 1.1 6 3.1a7.23 7.23 0 0 1-6 3.2M12 5a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3m0-3A10 10 0 0 0 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10c0-5.53-4.5-10-10-10"></path></svg>
<span class="md-ellipsis">
    Identity subsystem overview
    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_5_3_2_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_5_3_2_2" id="__nav_5_3_2_2_label" tabindex="0">
<span class="md-ellipsis">
    Identity subsystem engines
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_5_3_2_2_label" class="md-nav" data-md-level="4">
<label class="md-nav__title" for="__nav_5_3_2_2">
<span class="md-nav__icon md-icon"></span>
            Identity subsystem engines
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_5_3_2_2_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_5_3_2_2_1" id="__nav_5_3_2_2_1_label" tabindex="0">
<span class="md-ellipsis">
    Identity Management Engine
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_5_3_2_2_1_label" class="md-nav" data-md-level="5">
<label class="md-nav__title" for="__nav_5_3_2_2_1">
<span class="md-nav__icon md-icon"></span>
            Identity Management Engine
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="identity_management.html">
<svg viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M8 0a8 8 0 0 1 .701.031C9.444.095 9.99.645 10.16 1.29l.288 1.107c.018.066.079.158.212.224q.347.171.668.386c.123.082.233.09.299.071l1.103-.303c.644-.176 1.392.021 1.82.63q.406.578.704 1.218c.315.675.111 1.422-.364 1.891l-.814.806c-.049.048-.098.147-.088.294q.024.386 0 .772c-.01.147.038.246.088.294l.814.806c.475.469.679 1.216.364 1.891a8 8 0 0 1-.704 1.217c-.428.61-1.176.807-1.82.63l-1.102-.302c-.067-.019-.177-.011-.3.071a6 6 0 0 1-.668.386c-.133.066-.194.158-.211.224l-.29 1.106c-.168.646-.715 1.196-1.458 1.26a8 8 0 0 1-1.402 0c-.743-.064-1.289-.614-1.458-1.26l-.289-1.106c-.018-.066-.079-.158-.212-.224a6 6 0 0 1-.668-.386c-.123-.082-.233-.09-.299-.071l-1.103.303c-.644.176-1.392-.021-1.82-.63a8 8 0 0 1-.704-1.218c-.315-.675-.111-1.422.363-1.891l.815-.806c.05-.048.098-.147.088-.294a6 6 0 0 1 0-.772c.01-.147-.038-.246-.088-.294l-.815-.806C.635 6.045.431 5.298.746 4.623a8 8 0 0 1 .704-1.217c.428-.61 1.176-.807 1.82-.63l1.102.302c.067.019.177.011.3-.071q.321-.215.668-.386c.133-.066.194-.158.211-.224l.29-1.106C6.009.645 6.556.095 7.299.03Q7.646 0 8 0m-.571 1.525c-.036.003-.108.036-.137.146l-.289 1.105c-.147.561-.549.967-.998 1.189q-.26.13-.5.29c-.417.278-.97.423-1.529.27l-1.103-.303c-.109-.03-.175.016-.195.045q-.33.47-.573.99c-.014.031-.021.11.059.19l.815.806c.411.406.562.957.53 1.456a5 5 0 0 0 0 .582c.032.499-.119 1.05-.53 1.456l-.815.806c-.081.08-.073.159-.059.19q.243.52.573.989c.02.03.085.076.195.046l1.102-.303c.56-.153 1.113-.008 1.53.27q.242.16.501.29c.447.222.85.629.997 1.189l.289 1.105c.029.109.101.143.137.146a6.6 6.6 0 0 0 1.142 0c.036-.003.108-.036.137-.146l.289-1.105c.147-.561.549-.967.998-1.189q.26-.13.5-.29c.417-.278.97-.423 1.529-.27l1.103.303c.109.029.175-.016.195-.045q.33-.47.573-.99c.014-.031.021-.11-.059-.19l-.815-.806c-.411-.406-.562-.957-.53-1.456a5 5 0 0 0 0-.582c-.032-.499.119-1.05.53-1.456l.815-.806c.081-.08.073-.159.059-.19a6.5 6.5 0 0 0-.573-.989c-.02-.03-.085-.076-.195-.046l-1.102.303c-.56.153-1.113.008-1.53-.27a4.4 4.4 0 0 0-.501-.29c-.447-.222-.85-.629-.997-1.189l-.289-1.105c-.029-.11-.101-.143-.137-.146a6.6 6.6 0 0 0-1.142 0M11 8a3 3 0 1 1-6 0 3 3 0 0 1 6 0M9.5 8a1.5 1.5 0 1 0-3.001.001A1.5 1.5 0 0 0 9.5 8"></path></svg>
<span class="md-ellipsis">
    Identity Management Engine
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="identity_management_messages.html">
<svg viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M8 0a8 8 0 0 1 .701.031C9.444.095 9.99.645 10.16 1.29l.288 1.107c.018.066.079.158.212.224q.347.171.668.386c.123.082.233.09.299.071l1.103-.303c.644-.176 1.392.021 1.82.63q.406.578.704 1.218c.315.675.111 1.422-.364 1.891l-.814.806c-.049.048-.098.147-.088.294q.024.386 0 .772c-.01.147.038.246.088.294l.814.806c.475.469.679 1.216.364 1.891a8 8 0 0 1-.704 1.217c-.428.61-1.176.807-1.82.63l-1.102-.302c-.067-.019-.177-.011-.3.071a6 6 0 0 1-.668.386c-.133.066-.194.158-.211.224l-.29 1.106c-.168.646-.715 1.196-1.458 1.26a8 8 0 0 1-1.402 0c-.743-.064-1.289-.614-1.458-1.26l-.289-1.106c-.018-.066-.079-.158-.212-.224a6 6 0 0 1-.668-.386c-.123-.082-.233-.09-.299-.071l-1.103.303c-.644.176-1.392-.021-1.82-.63a8 8 0 0 1-.704-1.218c-.315-.675-.111-1.422.363-1.891l.815-.806c.05-.048.098-.147.088-.294a6 6 0 0 1 0-.772c.01-.147-.038-.246-.088-.294l-.815-.806C.635 6.045.431 5.298.746 4.623a8 8 0 0 1 .704-1.217c.428-.61 1.176-.807 1.82-.63l1.102.302c.067.019.177.011.3-.071q.321-.215.668-.386c.133-.066.194-.158.211-.224l.29-1.106C6.009.645 6.556.095 7.299.03Q7.646 0 8 0m-.571 1.525c-.036.003-.108.036-.137.146l-.289 1.105c-.147.561-.549.967-.998 1.189q-.26.13-.5.29c-.417.278-.97.423-1.529.27l-1.103-.303c-.109-.03-.175.016-.195.045q-.33.47-.573.99c-.014.031-.021.11.059.19l.815.806c.411.406.562.957.53 1.456a5 5 0 0 0 0 .582c.032.499-.119 1.05-.53 1.456l-.815.806c-.081.08-.073.159-.059.19q.243.52.573.989c.02.03.085.076.195.046l1.102-.303c.56-.153 1.113-.008 1.53.27q.242.16.501.29c.447.222.85.629.997 1.189l.289 1.105c.029.109.101.143.137.146a6.6 6.6 0 0 0 1.142 0c.036-.003.108-.036.137-.146l.289-1.105c.147-.561.549-.967.998-1.189q.26-.13.5-.29c.417-.278.97-.423 1.529-.27l1.103.303c.109.029.175-.016.195-.045q.33-.47.573-.99c.014-.031.021-.11-.059-.19l-.815-.806c-.411-.406-.562-.957-.53-1.456a5 5 0 0 0 0-.582c-.032-.499.119-1.05.53-1.456l.815-.806c.081-.08.073-.159.059-.19a6.5 6.5 0 0 0-.573-.989c-.02-.03-.085-.076-.195-.046l-1.102.303c-.56.153-1.113.008-1.53-.27a4.4 4.4 0 0 0-.501-.29c-.447-.222-.85-.629-.997-1.189l-.289-1.105c-.029-.11-.101-.143-.137-.146a6.6 6.6 0 0 0-1.142 0M11 8a3 3 0 1 1-6 0 3 3 0 0 1 6 0M9.5 8a1.5 1.5 0 1 0-3.001.001A1.5 1.5 0 0 0 9.5 8"></path></svg>
<span class="md-ellipsis">
    Identity Management Messages
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="identity_management_config.html">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13.152.682a2.25 2.25 0 0 1 2.269 0l.007.004 6.957 4.276a2.28 2.28 0 0 1 1.126 1.964v7.516c0 .81-.432 1.56-1.133 1.968l-.002.001-11.964 7.037-.004.003c-.706.41-1.578.41-2.284 0l-.026-.015-6.503-4.502a2.27 2.27 0 0 1-1.096-1.943V9.438c0-.392.1-.77.284-1.1l.003-.006.014-.026c.197-.342.48-.627.82-.827h.002L13.152.681Zm.757 1.295h-.001L2.648 8.616l6.248 4.247a.78.78 0 0 0 .758-.01h.001l11.633-6.804-6.629-4.074a.75.75 0 0 0-.75.003ZM8.517 14.33a2.3 2.3 0 0 1-.393-.18l-.023-.014-6.102-4.147v7.003c0 .275.145.528.379.664l.025.014 6.114 4.232zM18 9.709l-3.25 1.9v7.548L18 17.245Zm-7.59 4.438-.002.002a2.3 2.3 0 0 1-.391.18v7.612l3.233-1.902v-7.552Zm9.09-5.316v7.532l2.124-1.25a.78.78 0 0 0 .387-.671V7.363Z"></path></svg>
<span class="md-ellipsis">
    Identity Management Configuration
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="identity_management_environment.html">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13.152.682a2.25 2.25 0 0 1 2.269 0l.007.004 6.957 4.276a2.28 2.28 0 0 1 1.126 1.964v7.516c0 .81-.432 1.56-1.133 1.968l-.002.001-11.964 7.037-.004.003c-.706.41-1.578.41-2.284 0l-.026-.015-6.503-4.502a2.27 2.27 0 0 1-1.096-1.943V9.438c0-.392.1-.77.284-1.1l.003-.006.014-.026c.197-.342.48-.627.82-.827h.002L13.152.681Zm.757 1.295h-.001L2.648 8.616l6.248 4.247a.78.78 0 0 0 .758-.01h.001l11.633-6.804-6.629-4.074a.75.75 0 0 0-.75.003ZM8.517 14.33a2.3 2.3 0 0 1-.393-.18l-.023-.014-6.102-4.147v7.003c0 .275.145.528.379.664l.025.014 6.114 4.232zM18 9.709l-3.25 1.9v7.548L18 17.245Zm-7.59 4.438-.002.002a2.3 2.3 0 0 1-.391.18v7.612l3.233-1.902v-7.552Zm9.09-5.316v7.532l2.124-1.25a.78.78 0 0 0 .387-.671V7.363Z"></path></svg>
<span class="md-ellipsis">
    Identity Management Environment
    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<svg viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M8 0a8 8 0 0 1 .701.031C9.444.095 9.99.645 10.16 1.29l.288 1.107c.018.066.079.158.212.224q.347.171.668.386c.123.082.233.09.299.071l1.103-.303c.644-.176 1.392.021 1.82.63q.406.578.704 1.218c.315.675.111 1.422-.364 1.891l-.814.806c-.049.048-.098.147-.088.294q.024.386 0 .772c-.01.147.038.246.088.294l.814.806c.475.469.679 1.216.364 1.891a8 8 0 0 1-.704 1.217c-.428.61-1.176.807-1.82.63l-1.102-.302c-.067-.019-.177-.011-.3.071a6 6 0 0 1-.668.386c-.133.066-.194.158-.211.224l-.29 1.106c-.168.646-.715 1.196-1.458 1.26a8 8 0 0 1-1.402 0c-.743-.064-1.289-.614-1.458-1.26l-.289-1.106c-.018-.066-.079-.158-.212-.224a6 6 0 0 1-.668-.386c-.123-.082-.233-.09-.299-.071l-1.103.303c-.644.176-1.392-.021-1.82-.63a8 8 0 0 1-.704-1.218c-.315-.675-.111-1.422.363-1.891l.815-.806c.05-.048.098-.147.088-.294a6 6 0 0 1 0-.772c.01-.147-.038-.246-.088-.294l-.815-.806C.635 6.045.431 5.298.746 4.623a8 8 0 0 1 .704-1.217c.428-.61 1.176-.807 1.82-.63l1.102.302c.067.019.177.011.3-.071q.321-.215.668-.386c.133-.066.194-.158.211-.224l.29-1.106C6.009.645 6.556.095 7.299.03Q7.646 0 8 0m-.571 1.525c-.036.003-.108.036-.137.146l-.289 1.105c-.147.561-.549.967-.998 1.189q-.26.13-.5.29c-.417.278-.97.423-1.529.27l-1.103-.303c-.109-.03-.175.016-.195.045q-.33.47-.573.99c-.014.031-.021.11.059.19l.815.806c.411.406.562.957.53 1.456a5 5 0 0 0 0 .582c.032.499-.119 1.05-.53 1.456l-.815.806c-.081.08-.073.159-.059.19q.243.52.573.989c.02.03.085.076.195.046l1.102-.303c.56-.153 1.113-.008 1.53.27q.242.16.501.29c.447.222.85.629.997 1.189l.289 1.105c.029.109.101.143.137.146a6.6 6.6 0 0 0 1.142 0c.036-.003.108-.036.137-.146l.289-1.105c.147-.561.549-.967.998-1.189q.26-.13.5-.29c.417-.278.97-.423 1.529-.27l1.103.303c.109.029.175-.016.195-.045q.33-.47.573-.99c.014-.031.021-.11-.059-.19l-.815-.806c-.411-.406-.562-.957-.53-1.456a5 5 0 0 0 0-.582c-.032-.499.119-1.05.53-1.456l.815-.806c.081-.08.073-.159.059-.19a6.5 6.5 0 0 0-.573-.989c-.02-.03-.085-.076-.195-.046l-1.102.303c-.56.153-1.113.008-1.53-.27a4.4 4.4 0 0 0-.501-.29c-.447-.222-.85-.629-.997-1.189l-.289-1.105c-.029-.11-.101-.143-.137-.146a6.6 6.6 0 0 0-1.142 0M11 8a3 3 0 1 1-6 0 3 3 0 0 1 6 0M9.5 8a1.5 1.5 0 1 0-3.001.001A1.5 1.5 0 0 0 9.5 8"></path></svg>
<span class="md-ellipsis">
    Identity Management Behaviour
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="identity_management_behaviour.html">
<svg viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M8 0a8 8 0 0 1 .701.031C9.444.095 9.99.645 10.16 1.29l.288 1.107c.018.066.079.158.212.224q.347.171.668.386c.123.082.233.09.299.071l1.103-.303c.644-.176 1.392.021 1.82.63q.406.578.704 1.218c.315.675.111 1.422-.364 1.891l-.814.806c-.049.048-.098.147-.088.294q.024.386 0 .772c-.01.147.038.246.088.294l.814.806c.475.469.679 1.216.364 1.891a8 8 0 0 1-.704 1.217c-.428.61-1.176.807-1.82.63l-1.102-.302c-.067-.019-.177-.011-.3.071a6 6 0 0 1-.668.386c-.133.066-.194.158-.211.224l-.29 1.106c-.168.646-.715 1.196-1.458 1.26a8 8 0 0 1-1.402 0c-.743-.064-1.289-.614-1.458-1.26l-.289-1.106c-.018-.066-.079-.158-.212-.224a6 6 0 0 1-.668-.386c-.123-.082-.233-.09-.299-.071l-1.103.303c-.644.176-1.392-.021-1.82-.63a8 8 0 0 1-.704-1.218c-.315-.675-.111-1.422.363-1.891l.815-.806c.05-.048.098-.147.088-.294a6 6 0 0 1 0-.772c.01-.147-.038-.246-.088-.294l-.815-.806C.635 6.045.431 5.298.746 4.623a8 8 0 0 1 .704-1.217c.428-.61 1.176-.807 1.82-.63l1.102.302c.067.019.177.011.3-.071q.321-.215.668-.386c.133-.066.194-.158.211-.224l.29-1.106C6.009.645 6.556.095 7.299.03Q7.646 0 8 0m-.571 1.525c-.036.003-.108.036-.137.146l-.289 1.105c-.147.561-.549.967-.998 1.189q-.26.13-.5.29c-.417.278-.97.423-1.529.27l-1.103-.303c-.109-.03-.175.016-.195.045q-.33.47-.573.99c-.014.031-.021.11.059.19l.815.806c.411.406.562.957.53 1.456a5 5 0 0 0 0 .582c.032.499-.119 1.05-.53 1.456l-.815.806c-.081.08-.073.159-.059.19q.243.52.573.989c.02.03.085.076.195.046l1.102-.303c.56-.153 1.113-.008 1.53.27q.242.16.501.29c.447.222.85.629.997 1.189l.289 1.105c.029.109.101.143.137.146a6.6 6.6 0 0 0 1.142 0c.036-.003.108-.036.137-.146l.289-1.105c.147-.561.549-.967.998-1.189q.26-.13.5-.29c.417-.278.97-.423 1.529-.27l1.103.303c.109.029.175-.016.195-.045q.33-.47.573-.99c.014-.031.021-.11-.059-.19l-.815-.806c-.411-.406-.562-.957-.53-1.456a5 5 0 0 0 0-.582c-.032-.499.119-1.05.53-1.456l.815-.806c.081-.08.073-.159.059-.19a6.5 6.5 0 0 0-.573-.989c-.02-.03-.085-.076-.195-.046l-1.102.303c-.56.153-1.113.008-1.53-.27a4.4 4.4 0 0 0-.501-.29c-.447-.222-.85-.629-.997-1.189l-.289-1.105c-.029-.11-.101-.143-.137-.146a6.6 6.6 0 0 0-1.142 0M11 8a3 3 0 1 1-6 0 3 3 0 0 1 6 0M9.5 8a1.5 1.5 0 1 0-3.001.001A1.5 1.5 0 0 0 9.5 8"></path></svg>
<span class="md-ellipsis">
    Identity Management Behaviour
    
  </span>
</a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#overview">
<span class="md-ellipsis">
      Overview
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#identity-management-action-flowcharts">
<span class="md-ellipsis">
      Identity Management Action Flowcharts
    </span>
</a>
<nav aria-label="Identity Management Action Flowcharts" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#generateidentityaction-flowchart">
<span class="md-ellipsis">
      generateIdentityAction flowchart
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#connectidentityaction-flowchart">
<span class="md-ellipsis">
      connectIdentityAction flowchart
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#deleteidentityaction-flowchart">
<span class="md-ellipsis">
      deleteIdentityAction flowchart
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#action-arguments">
<span class="md-ellipsis">
      Action arguments
    </span>
</a>
<nav aria-label="Action arguments" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#messagefrom">
<span class="md-ellipsis">
      MessageFrom
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#identitymanagementactionargument">
<span class="md-ellipsis">
      IdentityManagementActionArgument
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#identitymanagementactionarguments">
<span class="md-ellipsis">
      IdentityManagementActionArguments
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#actions">
<span class="md-ellipsis">
      Actions
    </span>
</a>
<nav aria-label="Actions" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#identitymanagementaction">
<span class="md-ellipsis">
      IdentityManagementAction
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#identitymanagementactioninput">
<span class="md-ellipsis">
      IdentityManagementActionInput
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#identitymanagementactioneffect">
<span class="md-ellipsis">
      IdentityManagementActionEffect
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#identitymanagementactionexec">
<span class="md-ellipsis">
      IdentityManagementActionExec
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#hascommitcapability">
<span class="md-ellipsis">
      hasCommitCapability
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#hasdecryptcapability">
<span class="md-ellipsis">
      hasDecryptCapability
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#issubsetcapabilities">
<span class="md-ellipsis">
      isSubsetCapabilities
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#updateidentityandspawnengines">
<span class="md-ellipsis">
      updateIdentityAndSpawnEngines
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#copyenginesforcapabilities">
<span class="md-ellipsis">
      copyEnginesForCapabilities
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#generateidentityaction">
<span class="md-ellipsis">
      generateIdentityAction
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#connectidentityaction">
<span class="md-ellipsis">
      connectIdentityAction
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#deleteidentityaction">
<span class="md-ellipsis">
      deleteIdentityAction
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#action-labels">
<span class="md-ellipsis">
      Action Labels
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#guards">
<span class="md-ellipsis">
      Guards
    </span>
</a>
<nav aria-label="Guards" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#identitymanagementguard">
<span class="md-ellipsis">
      IdentityManagementGuard
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#identitymanagementguardoutput">
<span class="md-ellipsis">
      IdentityManagementGuardOutput
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#identitymanagementguardeval">
<span class="md-ellipsis">
      IdentityManagementGuardEval
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#generateidentityguard">
<span class="md-ellipsis">
      generateIdentityGuard
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#connectidentityguard">
<span class="md-ellipsis">
      connectIdentityGuard
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="encryption.html">
<span class="md-ellipsis">
    Encryption Engine
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="decryption.html">
<span class="md-ellipsis">
    Decryption Engine
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="commitment.html">
<span class="md-ellipsis">
    Commitment Engine
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="verification.html">
<span class="md-ellipsis">
    Verification Engine
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="reads_for.html">
<span class="md-ellipsis">
    ReadsFor Engine
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="signs_for.html">
<span class="md-ellipsis">
    SignsFor Engine
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="naming.html">
<span class="md-ellipsis">
    Naming Engine
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../subsystems/ordering.html">
<span class="md-ellipsis">
    Ordering subsystem
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../subsystems/net.html">
<span class="md-ellipsis">
    Network subsystem
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../integration/simulator.html">
<span class="md-ellipsis">
    Integration
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
<span class="md-ellipsis">
    System architecture
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_6_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_6">
<span class="md-nav__icon md-icon"></span>
            System architecture
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../system/identity/identity.html">
<span class="md-ellipsis">
    Identity Architecture
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../system/state/resource_machine/index.html">
<span class="md-ellipsis">
    State Architecture
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_7" type="checkbox"/>
<label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="">
<span class="md-ellipsis">
    Integrations
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_7_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_7">
<span class="md-nav__icon md-icon"></span>
            Integrations
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../integrations/adapters/index.html">
<span class="md-ellipsis">
    Protocol Adapters
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_8" type="checkbox"/>
<label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="">
<span class="md-ellipsis">
    Tutorials
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_8_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_8">
<span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../../tutorial/principles_and_guidelines.html">
<span class="md-ellipsis">
    Contributor guidelines
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#overview">
<span class="md-ellipsis">
      Overview
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#identity-management-action-flowcharts">
<span class="md-ellipsis">
      Identity Management Action Flowcharts
    </span>
</a>
<nav aria-label="Identity Management Action Flowcharts" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#generateidentityaction-flowchart">
<span class="md-ellipsis">
      generateIdentityAction flowchart
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#connectidentityaction-flowchart">
<span class="md-ellipsis">
      connectIdentityAction flowchart
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#deleteidentityaction-flowchart">
<span class="md-ellipsis">
      deleteIdentityAction flowchart
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#action-arguments">
<span class="md-ellipsis">
      Action arguments
    </span>
</a>
<nav aria-label="Action arguments" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#messagefrom">
<span class="md-ellipsis">
      MessageFrom
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#identitymanagementactionargument">
<span class="md-ellipsis">
      IdentityManagementActionArgument
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#identitymanagementactionarguments">
<span class="md-ellipsis">
      IdentityManagementActionArguments
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#actions">
<span class="md-ellipsis">
      Actions
    </span>
</a>
<nav aria-label="Actions" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#identitymanagementaction">
<span class="md-ellipsis">
      IdentityManagementAction
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#identitymanagementactioninput">
<span class="md-ellipsis">
      IdentityManagementActionInput
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#identitymanagementactioneffect">
<span class="md-ellipsis">
      IdentityManagementActionEffect
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#identitymanagementactionexec">
<span class="md-ellipsis">
      IdentityManagementActionExec
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#hascommitcapability">
<span class="md-ellipsis">
      hasCommitCapability
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#hasdecryptcapability">
<span class="md-ellipsis">
      hasDecryptCapability
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#issubsetcapabilities">
<span class="md-ellipsis">
      isSubsetCapabilities
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#updateidentityandspawnengines">
<span class="md-ellipsis">
      updateIdentityAndSpawnEngines
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#copyenginesforcapabilities">
<span class="md-ellipsis">
      copyEnginesForCapabilities
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#generateidentityaction">
<span class="md-ellipsis">
      generateIdentityAction
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#connectidentityaction">
<span class="md-ellipsis">
      connectIdentityAction
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#deleteidentityaction">
<span class="md-ellipsis">
      deleteIdentityAction
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#action-labels">
<span class="md-ellipsis">
      Action Labels
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#guards">
<span class="md-ellipsis">
      Guards
    </span>
</a>
<nav aria-label="Guards" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#identitymanagementguard">
<span class="md-ellipsis">
      IdentityManagementGuard
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#identitymanagementguardoutput">
<span class="md-ellipsis">
      IdentityManagementGuardOutput
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#identitymanagementguardeval">
<span class="md-ellipsis">
      IdentityManagementGuardEval
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#generateidentityguard">
<span class="md-ellipsis">
      generateIdentityGuard
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#connectidentityguard">
<span class="md-ellipsis">
      connectIdentityGuard
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<!--
  This is a modified version of the original mkdocs-material theme.
  Copyright (c) 2016-2025 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->
<!-- Tags -->
<nav class="md-tags">
<a class="md-tag" href="../../../indexes/tags.html#tag:behaviour">behaviour</a>
<a class="md-tag" href="../../../indexes/tags.html#tag:engine">engine</a>
<a class="md-tag" href="../../../indexes/tags.html#tag:identity-management">identity-management</a>
<a class="md-tag" href="../../../indexes/tags.html#tag:identity-subsystem">identity-subsystem</a>
<a class="md-tag" href="../../../indexes/tags.html#tag:node-architecture">node-architecture</a>
</nav>
<!-- Actions -->
<!--
  Copyright (c) 2016-2025 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->
<!-- Actions -->
<!-- Edit button -->
<a class="md-content__button md-icon" href="https://github.com/anoma/nspec/edit/main/docs/arch/node/engines/identity_management_behaviour.juvix.md" title="Edit this page">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M6 2c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-1.9l10-10V8l-6-6zm7 1.5L18.5 9H13zm7.1 9.5c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-2 1.8L12 20.9V23h2.1l6.1-6.1z"></path></svg>
</a>
<!-- View button -->
<a class="md-content__button md-icon" href="https://github.com/anoma/nspec/raw/main/docs/arch/node/engines/identity_management_behaviour.juvix.md" title="View source of this page">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20.56 18H3.44C2.65 18 2 17.37 2 16.59V7.41C2 6.63 2.65 6 3.44 6h17.12c.79 0 1.44.63 1.44 1.41v9.18c0 .78-.65 1.41-1.44 1.41M6.81 15.19v-3.66l1.92 2.35 1.92-2.35v3.66h1.93V8.81h-1.93l-1.92 2.35-1.92-2.35H4.89v6.38zM19.69 12h-1.92V8.81h-1.92V12h-1.93l2.89 3.28z"></path></svg>
</a>
<!-- If the page source ends with .juvix.md, we show a button to view the raw code -->
<a class="md-content__button md-icon" href="arch/node/engines/identity_management_behaviour-src.html" title="View Raw Juvix Code">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M8 3a2 2 0 0 0-2 2v4a2 2 0 0 1-2 2H3v2h1a2 2 0 0 1 2 2v4a2 2 0 0 0 2 2h2v-2H8v-5a2 2 0 0 0-2-2 2 2 0 0 0 2-2V5h2V3m6 0a2 2 0 0 1 2 2v4a2 2 0 0 0 2 2h1v2h-1a2 2 0 0 0-2 2v4a2 2 0 0 1-2 2h-2v-2h2v-5a2 2 0 0 1 2-2 2 2 0 0 1-2-2V5h-2V3z"></path></svg>
</a>
<!--
  Hack: check whether the content contains a h1 headline. If it doesn't, the
  page title (or respectively site name) is used as the main headline.
-->
<!-- Page content -->
<details class="code">
<summary>Juvix imports</summary>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-0-1">module arch.node.engines.identity_management_behaviour;
</span><span id="__ispan-0-2">
</span><span id="__ispan-0-3">import prelude open;
</span><span id="__ispan-0-4">import arch.node.engines.commitment_config open;
</span><span id="__ispan-0-5">import arch.node.engines.decryption_config open;
</span><span id="__ispan-0-6">import arch.node.engines.commitment_environment open;
</span><span id="__ispan-0-7">import arch.node.engines.decryption_environment open;
</span><span id="__ispan-0-8">import arch.node.engines.identity_management_environment open;
</span><span id="__ispan-0-9">import arch.node.engines.identity_management_messages open;
</span><span id="__ispan-0-10">import arch.node.engines.identity_management_config open;
</span><span id="__ispan-0-11">import arch.node.types.anoma as Anoma open;
</span><span id="__ispan-0-12">import arch.node.types.engine open;
</span><span id="__ispan-0-13">import arch.node.types.engine_environment open;
</span><span id="__ispan-0-14">import arch.node.types.identities open;
</span><span id="__ispan-0-15">import arch.node.types.messages open;
</span><span id="__ispan-0-16">import arch.system.identity.identity open hiding {ExternalIdentity};
</span></code></pre></div>
</details>
<hr/>
<h1 id="identity-management-behaviour">Identity Management Behaviour<a class="headerlink" href="#identity-management-behaviour" title="Anchor link to this section for reference">¶</a></h1>
<hr/>
<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Anchor link to this section for reference">¶</a></h2>
<p>The behaviour of the Identity Management Engine defines how it coordinates
committing/signing and decrypting operations through the spawning of engines for
these functions along with maintaining a database which may be modified through
the creation, connection, and deletion of identities associated with specific
capabilities.</p>
<h2 id="identity-management-action-flowcharts">Identity Management Action Flowcharts<a class="headerlink" href="#identity-management-action-flowcharts" title="Anchor link to this section for reference">¶</a></h2>
<h3 id="generateidentityaction-flowchart"><code>generateIdentityAction</code> flowchart<a class="headerlink" href="#generateidentityaction-flowchart" title="Anchor link to this section for reference">¶</a></h3>
<figure>
<pre class="mermaid"><code>flowchart TD
    Start([Generate Request]) --&gt; MsgReq[MsgIdentityManagementGenerateIdentityRequest&lt;br/&gt;backend: Backend&lt;br/&gt;params: IDParams&lt;br/&gt;capabilities: Capabilities]

    subgraph Guard["generateIdentityGuard"]
        MsgReq --&gt; ValidType{Is message type&lt;br/&gt;GenerateIdentityRequest?}
        ValidType --&gt;|No| Reject([Reject Request])
        ValidType --&gt;|Yes| ActionEntry[Enter Action Phase]
    end

    ActionEntry --&gt; Action

    subgraph Action["generateIdentityAction"]
        direction TB
        Check{Identity already&lt;br/&gt;exists?}
        Check --&gt;|Yes| ErrExists[Create Error Reply]
        Check --&gt;|No| Create[Create new identity info]
        Create --&gt; SpawnEngines{Which capabilities?}
        SpawnEngines --&gt;|Commit| SpawnCommit[Spawn Commitment Engine]
        SpawnEngines --&gt;|Decrypt| SpawnDecrypt[Spawn Decryption Engine]
        SpawnEngines --&gt;|Both| SpawnBoth[Spawn Both Engines]
        SpawnCommit &amp; SpawnDecrypt &amp; SpawnBoth --&gt; UpdateState[Update registry]
    end

    UpdateState --&gt; Reply[Success Reply&lt;br/&gt;with engine IDs]
    ErrExists --&gt; ErrReply[Error Reply]
    Reply &amp; ErrReply --&gt; Client([Return to Client])</code></pre>
<figcaption>
<code>generateIdentityAction</code> flowchart

</figcaption>
</figure>
<h4 id="explanation">Explanation<a class="headerlink" href="#explanation" title="Anchor link to this section for reference">¶</a></h4>
<ol>
<li>
<p><strong>Initial Request</strong></p>
<ul>
<li>A client sends a <code>MsgIdentityManagementGenerateIdentityRequest</code> containing:<ul>
<li><code>backend</code>: Specifies backend to be used</li>
<li><code>params</code>: Cryptographic parameters</li>
<li><code>capabilities</code>: Which capabilities are needed (commit, decrypt, or both)</li>
</ul>
</li>
<li>The requesting identity must not already exist in the system</li>
</ul>
</li>
<li>
<p><strong>Guard Phase</strong> (<code>generateIdentityGuard</code>)</p>
<ul>
<li>Validates incoming message structure and type</li>
<li>Validation steps:<ul>
<li>Verifies message type is <code>MsgIdentityManagementGenerateIdentityRequest</code></li>
<li>If validation fails, request is rejected immediately</li>
<li>On success, passes control to <code>generateIdentityActionLabel</code></li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Action Phase</strong> (<code>generateIdentityAction</code>)</p>
<ul>
<li>Processes valid generation requests through these steps:<ul>
<li>Checks if requesting identity already exists in registry</li>
<li>Creates new identity info with specified backend and capabilities</li>
<li>Spawns appropriate engine(s) based on requested capabilities</li>
<li>Updates identity registry with new identity and engine references</li>
<li>Constructs appropriate response based on result</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Reply Generation</strong></p>
<ul>
<li><strong>Successful Case</strong><ul>
<li>Creates <code>MsgIdentityManagementGenerateIdentityReply</code> with:<ul>
<li><code>commitmentEngine</code>: Engine ID if commit capability requested, None otherwise</li>
<li><code>decryptionEngine</code>: Engine ID if decrypt capability requested, None otherwise</li>
<li><code>externalIdentity</code>: ID of the newly created identity</li>
<li><code>err</code>: None</li>
</ul>
</li>
</ul>
</li>
<li><strong>Error Case</strong><ul>
<li>Creates <code>MsgIdentityManagementGenerateIdentityReply</code> with:<ul>
<li><code>commitmentEngine</code>: None</li>
<li><code>decryptionEngine</code>: None</li>
<li><code>externalIdentity</code>: Requester's ID</li>
<li><code>err</code>: Some "Identity already exists"</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Reply Delivery</strong></p>
<ul>
<li>Reply is sent back to the original requester</li>
<li>Uses mailbox 0 (default mailbox for responses)</li>
</ul>
</li>
</ol>
<h3 id="connectidentityaction-flowchart"><code>connectIdentityAction</code> flowchart<a class="headerlink" href="#connectidentityaction-flowchart" title="Anchor link to this section for reference">¶</a></h3>
<figure>
<pre class="mermaid"><code>flowchart TD
    Start([Connect Request]) --&gt; MsgReq[MsgIdentityManagementConnectIdentityRequest&lt;br/&gt;externalIdentity: EngineID&lt;br/&gt;backend: Backend&lt;br/&gt;capabilities: Capabilities]

    subgraph Guard["connectIdentityGuard"]
        MsgReq --&gt; ValidType{Is message type&lt;br/&gt;ConnectIdentityRequest?}
        ValidType --&gt;|No| Reject([Reject Request])
        ValidType --&gt;|Yes| ActionEntry[Enter Action Phase]
    end

    ActionEntry --&gt; Action

    subgraph Action["connectIdentityAction"]
        direction TB
        Check{Requesting Identity&lt;br/&gt;exists?}
        Check --&gt;|Yes| ErrExists[Create Error Reply]
        Check --&gt;|No| FindExternal{External Identity&lt;br/&gt;exists?}
        FindExternal --&gt;|No| ErrNotFound[Error: Not Found]
        FindExternal --&gt;|Yes| CheckCaps{Requested capabilities&lt;br/&gt;subset of original?}
        CheckCaps --&gt;|No| ErrCaps[Error: Invalid Capabilities]
        CheckCaps --&gt;|Yes| CopyEngines[Copy Engine References]
        CopyEngines --&gt; UpdateState[Update registry]
    end

    UpdateState --&gt; Reply[Success Reply&lt;br/&gt;with engine IDs]
    ErrExists &amp; ErrNotFound &amp; ErrCaps --&gt; ErrReply[Error Reply]
    Reply &amp; ErrReply --&gt; Client([Return to Client])</code></pre>
<figcaption>
<code>connectIdentityAction</code> flowchart

</figcaption>
</figure>
<h4 id="explanation_1">Explanation<a class="headerlink" href="#explanation_1" title="Anchor link to this section for reference">¶</a></h4>
<ol>
<li>
<p><strong>Initial Request</strong></p>
<ul>
<li>A client sends a <code>MsgIdentityManagementConnectIdentityRequest</code> containing:<ul>
<li><code>externalIdentity</code>: ID of the existing identity to connect to</li>
<li><code>backend</code>: Backend to use</li>
<li><code>capabilities</code>: Which subset of the original identity's capabilities are requested</li>
</ul>
</li>
<li>The requesting identity must not already exist in the system</li>
<li>The external identity must exist and have at least the requested capabilities</li>
</ul>
</li>
<li>
<p><strong>Guard Phase</strong> (<code>connectIdentityGuard</code>)</p>
<ul>
<li>Validates incoming message structure and type</li>
<li>Validation steps:<ul>
<li>Verifies message type is <code>MsgIdentityManagementConnectIdentityRequest</code></li>
<li>If validation fails, request is rejected immediately</li>
<li>On success, passes control to <code>connectIdentityActionLabel</code></li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Action Phase</strong> (<code>connectIdentityAction</code>)</p>
<ul>
<li>Processes valid connection requests through these steps:<ul>
<li>Verifies requesting identity doesn't already exist</li>
<li>Checks if external identity exists in registry</li>
<li>Validates requested capabilities are subset of original</li>
<li>Copies relevant engine references based on capabilities</li>
<li>Updates identity registry with new connected identity</li>
<li>Constructs appropriate response based on result</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Reply Generation</strong></p>
<ul>
<li><strong>Successful Case</strong><ul>
<li>Creates <code>MsgIdentityManagementConnectIdentityReply</code> with:<ul>
<li><code>commitmentEngine</code>: Copied engine ID if commit capability requested, None otherwise</li>
<li><code>decryptionEngine</code>: Copied engine ID if decrypt capability requested, None otherwise</li>
<li><code>err</code>: None</li>
</ul>
</li>
</ul>
</li>
<li><strong>Error Cases</strong><ul>
<li>Creates <code>MsgIdentityManagementConnectIdentityReply</code> with:<ul>
<li><code>commitmentEngine</code>: None</li>
<li><code>decryptionEngine</code>: None</li>
<li><code>err</code>: Some error message:<ul>
<li>"Identity already exists" if requesting identity exists</li>
<li>"External identity not found" if target doesn't exist</li>
<li>"Capabilities not available" if capability subset invalid</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Reply Delivery</strong></p>
<ul>
<li>Reply is sent back to the original requester</li>
<li>Uses mailbox 0 (default mailbox for responses)</li>
</ul>
</li>
</ol>
<h3 id="deleteidentityaction-flowchart"><code>deleteIdentityAction</code> flowchart<a class="headerlink" href="#deleteidentityaction-flowchart" title="Anchor link to this section for reference">¶</a></h3>
<figure>
<pre class="mermaid"><code>flowchart TD
    Start([Delete Request]) --&gt; MsgReq[MsgIdentityManagementDeleteIdentityRequest&lt;br/&gt;externalIdentity: EngineID&lt;br/&gt;backend: Backend]

    subgraph Guard["deleteIdentityGuard"]
        MsgReq --&gt; ValidType{Is message type&lt;br/&gt;DeleteIdentityRequest?}
        ValidType --&gt;|No| Reject([Reject Request])
        ValidType --&gt;|Yes| ActionEntry[Enter Action Phase]
    end

    ActionEntry --&gt; Action

    subgraph Action["deleteIdentityAction"]
        direction TB
        Check{Identity exists?}
        Check --&gt;|No| ErrNoExist[Create Error Reply]
        Check --&gt;|Yes| Delete[Remove from registry]
    end

    Delete --&gt; Reply[Success Reply]
    ErrNoExist --&gt; ErrReply[Error Reply]
    Reply &amp; ErrReply --&gt; Client([Return to Client])

    style Guard fill:#f0f7ff,stroke:#333,stroke-width:2px
    style Action fill:#fff7f0,stroke:#333,stroke-width:2px</code></pre>
<figcaption>
<code>deleteIdentityAction</code> flowchart

</figcaption>
</figure>
<h4 id="explanation_2">Explanation<a class="headerlink" href="#explanation_2" title="Anchor link to this section for reference">¶</a></h4>
<ol>
<li>
<p><strong>Initial Request</strong></p>
<ul>
<li>A client sends a <code>MsgIdentityManagementDeleteIdentityRequest</code> containing:<ul>
<li><code>externalIdentity</code>: ID of the identity to delete</li>
<li><code>backend</code>: Backend system where the identity exists</li>
</ul>
</li>
<li>The identity to be deleted must exist in the system</li>
</ul>
</li>
<li>
<p><strong>Guard Phase</strong> (<code>deleteIdentityGuard</code>)</p>
<ul>
<li>Validates incoming message structure and type</li>
<li>Validation steps:<ul>
<li>Verifies message type is <code>MsgIdentityManagementDeleteIdentityRequest</code></li>
<li>If validation fails, request is rejected immediately</li>
<li>On success, passes control to <code>deleteIdentityActionLabel</code></li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Action Phase</strong> (<code>deleteIdentityAction</code>)</p>
<ul>
<li>Processes valid deletion requests through these steps:<ul>
<li>Verifies identity exists in registry</li>
<li>Removes identity and associated engine references from registry</li>
<li>Constructs appropriate response based on result</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Reply Generation</strong></p>
<ul>
<li><strong>Successful Case</strong><ul>
<li>Creates <code>MsgIdentityManagementDeleteIdentityReply</code> with:<ul>
<li><code>err</code>: None</li>
</ul>
</li>
</ul>
</li>
<li><strong>Error Case</strong><ul>
<li>Creates <code>MsgIdentityManagementDeleteIdentityReply</code> with:<ul>
<li><code>err</code>: Some "Identity does not exist"</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Reply Delivery</strong></p>
<ul>
<li>Reply is sent back to the original requester</li>
<li>Uses mailbox 0 (default mailbox for responses)</li>
</ul>
</li>
</ol>
<div class="admonition warning">
<p class="admonition-title">Important Notes</p>
<ul>
<li>All spawned engines inherit the backend from the generation request</li>
<li>Engine references are managed through the identity management engine's state</li>
<li>Capabilities can only be restricted when connecting, never expanded</li>
<li>The system maintains a mapping between identities and their associated engine references</li>
<li>Each identity maintains its own separate set of engines</li>
<li>State updates are atomic - either all parts succeed or none do</li>
</ul>
</div>
<h2 id="action-arguments">Action arguments<a class="headerlink" href="#action-arguments" title="Anchor link to this section for reference">¶</a></h2>
<h3 id="messagefrom"><code>MessageFrom</code><a class="headerlink" href="#messagefrom" title="Anchor link to this section for reference">¶</a></h3>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-1-1">type MessageFrom := mkMessageFrom {
</span><span id="__ispan-1-2">  whoAsked : Option EngineID;
</span><span id="__ispan-1-3">  mailbox : Option MailboxID
</span><span id="__ispan-1-4">};
</span></code></pre></div>
<h3 id="identitymanagementactionargument"><code>IdentityManagementActionArgument</code><a class="headerlink" href="#identitymanagementactionargument" title="Anchor link to this section for reference">¶</a></h3>
<!-- --8<-- [start:IdentityManagementActionArgument] -->
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-2-1">type IdentityManagementActionArgument :=
</span><span id="__ispan-2-2">  | IdentityManagementActionArgumentMessageFrom MessageFrom;
</span></code></pre></div>
<!-- --8<-- [end:IdentityManagementActionArgument] -->
<h3 id="identitymanagementactionarguments"><code>IdentityManagementActionArguments</code><a class="headerlink" href="#identitymanagementactionarguments" title="Anchor link to this section for reference">¶</a></h3>
<!-- --8<-- [start:identity-management-action-arguments] -->
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-3-1">IdentityManagementActionArguments : Type := List IdentityManagementActionArgument;
</span></code></pre></div>
<!-- --8<-- [end:identity-management-action-arguments] -->
<h2 id="actions">Actions<a class="headerlink" href="#actions" title="Anchor link to this section for reference">¶</a></h2>
<details class="code">
<summary>Auxiliary Juvix code</summary>
<h3 id="identitymanagementaction"><code>IdentityManagementAction</code><a class="headerlink" href="#identitymanagementaction" title="Anchor link to this section for reference">¶</a></h3>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-4-1">IdentityManagementAction : Type :=
</span><span id="__ispan-4-2">  Action
</span><span id="__ispan-4-3">    IdentityManagementLocalCfg
</span><span id="__ispan-4-4">    IdentityManagementLocalState
</span><span id="__ispan-4-5">    IdentityManagementMailboxState
</span><span id="__ispan-4-6">    IdentityManagementTimerHandle
</span><span id="__ispan-4-7">    IdentityManagementActionArguments
</span><span id="__ispan-4-8">    Anoma.Msg
</span><span id="__ispan-4-9">    Anoma.Cfg
</span><span id="__ispan-4-10">    Anoma.Env;
</span></code></pre></div>
<h3 id="identitymanagementactioninput"><code>IdentityManagementActionInput</code><a class="headerlink" href="#identitymanagementactioninput" title="Anchor link to this section for reference">¶</a></h3>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-5-1">IdentityManagementActionInput : Type :=
</span><span id="__ispan-5-2">  ActionInput
</span><span id="__ispan-5-3">    IdentityManagementLocalCfg
</span><span id="__ispan-5-4">    IdentityManagementLocalState
</span><span id="__ispan-5-5">    IdentityManagementMailboxState
</span><span id="__ispan-5-6">    IdentityManagementTimerHandle
</span><span id="__ispan-5-7">    IdentityManagementActionArguments
</span><span id="__ispan-5-8">    Anoma.Msg;
</span></code></pre></div>
<h3 id="identitymanagementactioneffect"><code>IdentityManagementActionEffect</code><a class="headerlink" href="#identitymanagementactioneffect" title="Anchor link to this section for reference">¶</a></h3>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-6-1">IdentityManagementActionEffect : Type :=
</span><span id="__ispan-6-2">  ActionEffect
</span><span id="__ispan-6-3">    IdentityManagementLocalState
</span><span id="__ispan-6-4">    IdentityManagementMailboxState
</span><span id="__ispan-6-5">    IdentityManagementTimerHandle
</span><span id="__ispan-6-6">    Anoma.Msg
</span><span id="__ispan-6-7">    Anoma.Cfg
</span><span id="__ispan-6-8">    Anoma.Env;
</span></code></pre></div>
<h3 id="identitymanagementactionexec">IdentityManagementActionExec<a class="headerlink" href="#identitymanagementactionexec" title="Anchor link to this section for reference">¶</a></h3>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-7-1">IdentityManagementActionExec : Type :=
</span><span id="__ispan-7-2">  ActionExec
</span><span id="__ispan-7-3">    IdentityManagementLocalCfg
</span><span id="__ispan-7-4">    IdentityManagementLocalState
</span><span id="__ispan-7-5">    IdentityManagementMailboxState
</span><span id="__ispan-7-6">    IdentityManagementTimerHandle
</span><span id="__ispan-7-7">    IdentityManagementActionArguments
</span><span id="__ispan-7-8">    Anoma.Msg
</span><span id="__ispan-7-9">    Anoma.Cfg
</span><span id="__ispan-7-10">    Anoma.Env;
</span></code></pre></div>
<h3 id="hascommitcapability"><code>hasCommitCapability</code><a class="headerlink" href="#hascommitcapability" title="Anchor link to this section for reference">¶</a></h3>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-8-1">hasCommitCapability (capabilities : Capabilities) : Bool :=
</span><span id="__ispan-8-2">  case capabilities of {
</span><span id="__ispan-8-3">    | Capabilities.Commit := true
</span><span id="__ispan-8-4">    | Capabilities.CommitAndDecrypt := true
</span><span id="__ispan-8-5">    | _ := false
</span><span id="__ispan-8-6">  };
</span></code></pre></div>
<h3 id="hasdecryptcapability"><code>hasDecryptCapability</code><a class="headerlink" href="#hasdecryptcapability" title="Anchor link to this section for reference">¶</a></h3>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-9-1">hasDecryptCapability (capabilities : Capabilities) : Bool :=
</span><span id="__ispan-9-2">  case capabilities of {
</span><span id="__ispan-9-3">    | Capabilities.Decrypt := true
</span><span id="__ispan-9-4">    | Capabilities.CommitAndDecrypt := true
</span><span id="__ispan-9-5">    | _ := false
</span><span id="__ispan-9-6">  };
</span></code></pre></div>
<h3 id="issubsetcapabilities"><code>isSubsetCapabilities</code><a class="headerlink" href="#issubsetcapabilities" title="Anchor link to this section for reference">¶</a></h3>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-10-1">isSubsetCapabilities
</span><span id="__ispan-10-2">  (requested : Capabilities)
</span><span id="__ispan-10-3">  (available : Capabilities)
</span><span id="__ispan-10-4">  : Bool :=
</span><span id="__ispan-10-5">  (not (hasCommitCapability requested) || hasCommitCapability available)
</span><span id="__ispan-10-6">  &amp;&amp; (not (hasDecryptCapability requested) || hasDecryptCapability available);
</span></code></pre></div>
<h3 id="updateidentityandspawnengines"><code>updateIdentityAndSpawnEngines</code><a class="headerlink" href="#updateidentityandspawnengines" title="Anchor link to this section for reference">¶</a></h3>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-11-1">updateIdentityAndSpawnEngines
</span><span id="__ispan-11-2">  (env : IdentityManagementEnv)
</span><span id="__ispan-11-3">  (cfg : IdentityManagementCfg)
</span><span id="__ispan-11-4">  (backend' : Backend)
</span><span id="__ispan-11-5">  (whoAsked : EngineID)
</span><span id="__ispan-11-6">  (identityInfo : IdentityInfo)
</span><span id="__ispan-11-7">  (capabilities' : Capabilities)
</span><span id="__ispan-11-8">  : Pair IdentityInfo (List (Pair Cfg Env)) :=
</span><span id="__ispan-11-9">  let decryptionConfig : DecryptionCfg :=
</span><span id="__ispan-11-10">        EngineCfg.mk@{
</span><span id="__ispan-11-11">          node := EngineCfg.node cfg;
</span><span id="__ispan-11-12">          name := nameGen "decryptor" (snd whoAsked) whoAsked;
</span><span id="__ispan-11-13">          cfg := DecryptionLocalCfg.mk@{
</span><span id="__ispan-11-14">            decryptor := genDecryptor backend';
</span><span id="__ispan-11-15">            backend := backend';
</span><span id="__ispan-11-16">          }
</span><span id="__ispan-11-17">        };
</span><span id="__ispan-11-18">      decryptionEnv : DecryptionEnv :=
</span><span id="__ispan-11-19">        EngineEnv.mk@{
</span><span id="__ispan-11-20">          localState := unit;
</span><span id="__ispan-11-21">          mailboxCluster := Map.empty;
</span><span id="__ispan-11-22">          acquaintances := Set.empty;
</span><span id="__ispan-11-23">          timers := []
</span><span id="__ispan-11-24">        };
</span><span id="__ispan-11-25">      decryptionEng : Pair Cfg Env :=
</span><span id="__ispan-11-26">        mkPair (Cfg.CfgDecryption decryptionConfig) (Env.EnvDecryption decryptionEnv);
</span><span id="__ispan-11-27">      commitmentConfig : CommitmentCfg :=
</span><span id="__ispan-11-28">        EngineCfg.mk@{
</span><span id="__ispan-11-29">          node := EngineCfg.node cfg;
</span><span id="__ispan-11-30">          name := nameGen "committer" (snd whoAsked) whoAsked;
</span><span id="__ispan-11-31">          cfg := CommitmentLocalCfg.mk@{
</span><span id="__ispan-11-32">            signer := genSigner backend';
</span><span id="__ispan-11-33">            backend := backend';
</span><span id="__ispan-11-34">          }
</span><span id="__ispan-11-35">        };
</span><span id="__ispan-11-36">      commitmentEnv : CommitmentEnv :=
</span><span id="__ispan-11-37">        EngineEnv.mk@{
</span><span id="__ispan-11-38">          localState := unit;
</span><span id="__ispan-11-39">          mailboxCluster := Map.empty;
</span><span id="__ispan-11-40">          acquaintances := Set.empty;
</span><span id="__ispan-11-41">          timers := []
</span><span id="__ispan-11-42">        };
</span><span id="__ispan-11-43">      commitmentEng : Pair Cfg Env :=
</span><span id="__ispan-11-44">        mkPair (Cfg.CfgCommitment commitmentConfig) (Env.EnvCommitment commitmentEnv);
</span><span id="__ispan-11-45">  in case capabilities' of {
</span><span id="__ispan-11-46">    | Capabilities.CommitAndDecrypt :=
</span><span id="__ispan-11-47">        let spawnedEngines := [decryptionEng; commitmentEng];
</span><span id="__ispan-11-48">            commitmentEngineName := nameGen "committer" (snd whoAsked) whoAsked;
</span><span id="__ispan-11-49">            decryptionEngineName := nameGen "decryptor" (snd whoAsked) whoAsked;
</span><span id="__ispan-11-50">            updatedIdentityInfo1 := identityInfo@IdentityInfo{
</span><span id="__ispan-11-51">              commitmentEngine := some (mkPair none commitmentEngineName);
</span><span id="__ispan-11-52">              decryptionEngine := some (mkPair none decryptionEngineName)
</span><span id="__ispan-11-53">            };
</span><span id="__ispan-11-54">        in mkPair updatedIdentityInfo1 spawnedEngines
</span><span id="__ispan-11-55">    | Capabilities.Commit :=
</span><span id="__ispan-11-56">        let spawnedEngines := [commitmentEng];
</span><span id="__ispan-11-57">            commitmentEngineName := nameGen "committer" (snd whoAsked) whoAsked;
</span><span id="__ispan-11-58">            updatedIdentityInfo1 := identityInfo@IdentityInfo{
</span><span id="__ispan-11-59">              commitmentEngine := some (mkPair none commitmentEngineName)
</span><span id="__ispan-11-60">            };
</span><span id="__ispan-11-61">        in mkPair updatedIdentityInfo1 spawnedEngines
</span><span id="__ispan-11-62">    | Capabilities.Decrypt :=
</span><span id="__ispan-11-63">        let spawnedEngines := [decryptionEng];
</span><span id="__ispan-11-64">            decryptionEngineName := nameGen "decryptor" (snd whoAsked) whoAsked;
</span><span id="__ispan-11-65">            updatedIdentityInfo1 := identityInfo@IdentityInfo{
</span><span id="__ispan-11-66">              decryptionEngine := some (mkPair none decryptionEngineName)
</span><span id="__ispan-11-67">            };
</span><span id="__ispan-11-68">        in mkPair updatedIdentityInfo1 spawnedEngines
</span><span id="__ispan-11-69">  };
</span></code></pre></div>
<h3 id="copyenginesforcapabilities"><code>copyEnginesForCapabilities</code><a class="headerlink" href="#copyenginesforcapabilities" title="Anchor link to this section for reference">¶</a></h3>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-12-1">copyEnginesForCapabilities
</span><span id="__ispan-12-2">  (env : IdentityManagementEnv)
</span><span id="__ispan-12-3">  (whoAsked : EngineID)
</span><span id="__ispan-12-4">  (externalIdentityInfo : IdentityInfo)
</span><span id="__ispan-12-5">  (requestedCapabilities : Capabilities)
</span><span id="__ispan-12-6">  : IdentityInfo :=
</span><span id="__ispan-12-7">  let newIdentityInfo := IdentityInfo.mkIdentityInfo@{
</span><span id="__ispan-12-8">        backend := IdentityInfo.backend externalIdentityInfo;
</span><span id="__ispan-12-9">        capabilities := requestedCapabilities;
</span><span id="__ispan-12-10">        commitmentEngine :=
</span><span id="__ispan-12-11">          case hasCommitCapability requestedCapabilities of {
</span><span id="__ispan-12-12">            | true := IdentityInfo.commitmentEngine externalIdentityInfo
</span><span id="__ispan-12-13">            | false := none
</span><span id="__ispan-12-14">          };
</span><span id="__ispan-12-15">        decryptionEngine :=
</span><span id="__ispan-12-16">          case hasDecryptCapability requestedCapabilities of {
</span><span id="__ispan-12-17">            | true := IdentityInfo.decryptionEngine externalIdentityInfo
</span><span id="__ispan-12-18">            | false := none
</span><span id="__ispan-12-19">          }
</span><span id="__ispan-12-20">      };
</span><span id="__ispan-12-21">  in newIdentityInfo;
</span></code></pre></div>
</details>
<h3 id="generateidentityaction"><code>generateIdentityAction</code><a class="headerlink" href="#generateidentityaction" title="Anchor link to this section for reference">¶</a></h3>
<dl>
<dt>State update</dt>
<dd>A new identity is created and added to the identities map if it doesn't exist.</dd>
<dt>Messages to be sent</dt>
<dd>A GenerateIdentityReply message containing the new identity info or error.</dd>
<dt>Engines to be spawned</dt>
<dd>Commitment and/or Decryption engines based on capabilities.</dd>
<dt>Timer updates</dt>
<dd>No timers are set or cancelled.</dd>
</dl>
<!-- --8<-- [start:generateIdentityAction] -->
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-13-1">generateIdentityAction
</span><span id="__ispan-13-2">  (input : IdentityManagementActionInput)
</span><span id="__ispan-13-3">  : Option IdentityManagementActionEffect :=
</span><span id="__ispan-13-4">  let
</span><span id="__ispan-13-5">    env := ActionInput.env input;
</span><span id="__ispan-13-6">    local := EngineEnv.localState env;
</span><span id="__ispan-13-7">    identities := IdentityManagementLocalState.identities local;
</span><span id="__ispan-13-8">    trigger := ActionInput.trigger input;
</span><span id="__ispan-13-9">  in case getEngineMsgFromTimestampedTrigger trigger of {
</span><span id="__ispan-13-10">    | some emsg :=
</span><span id="__ispan-13-11">      let whoAsked := EngineMsg.sender emsg;
</span><span id="__ispan-13-12">      in case Map.lookup whoAsked identities of {
</span><span id="__ispan-13-13">        | some _ :=
</span><span id="__ispan-13-14">          some ActionEffect.mk@{
</span><span id="__ispan-13-15">            env := env;
</span><span id="__ispan-13-16">            msgs := [EngineMsg.mk@{
</span><span id="__ispan-13-17">              sender := getEngineIDFromEngineCfg (ActionInput.cfg input);
</span><span id="__ispan-13-18">              target := whoAsked;
</span><span id="__ispan-13-19">              mailbox := some 0;
</span><span id="__ispan-13-20">              msg := Msg.IdentityManagement (IdentityManagementMsg.GenerateIdentityReply
</span><span id="__ispan-13-21">                (ReplyGenerateIdentity.mkReplyGenerateIdentity@{
</span><span id="__ispan-13-22">                  commitmentEngine := none;
</span><span id="__ispan-13-23">                  decryptionEngine := none;
</span><span id="__ispan-13-24">                  externalIdentity := whoAsked;
</span><span id="__ispan-13-25">                  err := some "Identity already exists"
</span><span id="__ispan-13-26">                }))
</span><span id="__ispan-13-27">            }];
</span><span id="__ispan-13-28">            timers := [];
</span><span id="__ispan-13-29">            engines := []
</span><span id="__ispan-13-30">          }
</span><span id="__ispan-13-31">        | none :=
</span><span id="__ispan-13-32">          case emsg of {
</span><span id="__ispan-13-33">            | EngineMsg.mk@{msg := Anoma.Msg.IdentityManagement (IdentityManagementMsg.GenerateIdentityRequest (RequestGenerateIdentity.mkRequestGenerateIdentity backend' params' capabilities'))} :=
</span><span id="__ispan-13-34">              let identityInfo := IdentityInfo.mkIdentityInfo@{
</span><span id="__ispan-13-35">                    backend := backend';
</span><span id="__ispan-13-36">                    capabilities := capabilities';
</span><span id="__ispan-13-37">                    commitmentEngine := none;
</span><span id="__ispan-13-38">                    decryptionEngine := none
</span><span id="__ispan-13-39">                  };
</span><span id="__ispan-13-40">                  pair' := updateIdentityAndSpawnEngines env (ActionInput.cfg input) backend' whoAsked identityInfo capabilities';
</span><span id="__ispan-13-41">                  updatedIdentityInfo := fst pair';
</span><span id="__ispan-13-42">                  spawnedEnginesFinal := snd pair';
</span><span id="__ispan-13-43">                  updatedIdentities := Map.insert whoAsked updatedIdentityInfo identities;
</span><span id="__ispan-13-44">                  newLocalState := local@IdentityManagementLocalState{
</span><span id="__ispan-13-45">                    identities := updatedIdentities
</span><span id="__ispan-13-46">                  };
</span><span id="__ispan-13-47">                  newEnv' := env@EngineEnv{
</span><span id="__ispan-13-48">                    localState := newLocalState
</span><span id="__ispan-13-49">                  };
</span><span id="__ispan-13-50">              in some ActionEffect.mk@{
</span><span id="__ispan-13-51">                env := newEnv';
</span><span id="__ispan-13-52">                msgs := [EngineMsg.mk@{
</span><span id="__ispan-13-53">                  sender := getEngineIDFromEngineCfg (ActionInput.cfg input);
</span><span id="__ispan-13-54">                  target := whoAsked;
</span><span id="__ispan-13-55">                  mailbox := some 0;
</span><span id="__ispan-13-56">                  msg := Msg.IdentityManagement (IdentityManagementMsg.GenerateIdentityReply
</span><span id="__ispan-13-57">                    (ReplyGenerateIdentity.mkReplyGenerateIdentity@{
</span><span id="__ispan-13-58">                      commitmentEngine := IdentityInfo.commitmentEngine updatedIdentityInfo;
</span><span id="__ispan-13-59">                      decryptionEngine := IdentityInfo.decryptionEngine updatedIdentityInfo;
</span><span id="__ispan-13-60">                      externalIdentity := whoAsked;
</span><span id="__ispan-13-61">                      err := none
</span><span id="__ispan-13-62">                    }))
</span><span id="__ispan-13-63">                }];
</span><span id="__ispan-13-64">                timers := [];
</span><span id="__ispan-13-65">                engines := spawnedEnginesFinal
</span><span id="__ispan-13-66">              }
</span><span id="__ispan-13-67">            | _ := none
</span><span id="__ispan-13-68">          }
</span><span id="__ispan-13-69">      }
</span><span id="__ispan-13-70">    | _ := none
</span><span id="__ispan-13-71">  };
</span></code></pre></div>
<!-- --8<-- [end:generateIdentityAction] -->
<h3 id="connectidentityaction"><code>connectIdentityAction</code><a class="headerlink" href="#connectidentityaction" title="Anchor link to this section for reference">¶</a></h3>
<dl>
<dt>State update</dt>
<dd>A new identity is created with copied capabilities if valid.</dd>
<dt>Messages to be sent</dt>
<dd>A <code>ConnectIdentityReply</code> message with confirmation or error.</dd>
<dt>Engines to be spawned</dt>
<dd>No new engines are spawned.</dd>
<dt>Timer updates</dt>
<dd>No timers are set or cancelled.</dd>
</dl>
<!-- --8<-- [start:connectIdentityAction] -->
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-14-1">connectIdentityAction
</span><span id="__ispan-14-2">  (input : IdentityManagementActionInput)
</span><span id="__ispan-14-3">  : Option IdentityManagementActionEffect :=
</span><span id="__ispan-14-4">  let
</span><span id="__ispan-14-5">    env := ActionInput.env input;
</span><span id="__ispan-14-6">    local := EngineEnv.localState env;
</span><span id="__ispan-14-7">    identities := IdentityManagementLocalState.identities local;
</span><span id="__ispan-14-8">    trigger := ActionInput.trigger input;
</span><span id="__ispan-14-9">  in case getEngineMsgFromTimestampedTrigger trigger of {
</span><span id="__ispan-14-10">    | some emsg :=
</span><span id="__ispan-14-11">      let whoAsked := EngineMsg.sender emsg;
</span><span id="__ispan-14-12">      in case Map.lookup whoAsked identities of {
</span><span id="__ispan-14-13">        | some _ :=
</span><span id="__ispan-14-14">          some ActionEffect.mk@{
</span><span id="__ispan-14-15">            env := env;
</span><span id="__ispan-14-16">            msgs := [EngineMsg.mk@{
</span><span id="__ispan-14-17">              sender := getEngineIDFromEngineCfg (ActionInput.cfg input);
</span><span id="__ispan-14-18">              target := whoAsked;
</span><span id="__ispan-14-19">              mailbox := some 0;
</span><span id="__ispan-14-20">              msg := Msg.IdentityManagement (IdentityManagementMsg.ConnectIdentityReply
</span><span id="__ispan-14-21">                (ReplyConnectIdentity.mkReplyConnectIdentity@{
</span><span id="__ispan-14-22">                  commitmentEngine := none;
</span><span id="__ispan-14-23">                  decryptionEngine := none;
</span><span id="__ispan-14-24">                  err := some "Identity already exists"
</span><span id="__ispan-14-25">                }))
</span><span id="__ispan-14-26">            }];
</span><span id="__ispan-14-27">            timers := [];
</span><span id="__ispan-14-28">            engines := []
</span><span id="__ispan-14-29">          }
</span><span id="__ispan-14-30">        | none :=
</span><span id="__ispan-14-31">          case emsg of {
</span><span id="__ispan-14-32">            | EngineMsg.mk@{msg := Anoma.Msg.IdentityManagement (IdentityManagementMsg.ConnectIdentityRequest (RequestConnectIdentity.mkRequestConnectIdentity externalIdentity' backend' capabilities'))} :=
</span><span id="__ispan-14-33">              case Map.lookup externalIdentity' identities of {
</span><span id="__ispan-14-34">                | none :=
</span><span id="__ispan-14-35">                  some ActionEffect.mk@{
</span><span id="__ispan-14-36">                    env := env;
</span><span id="__ispan-14-37">                    msgs := [EngineMsg.mk@{
</span><span id="__ispan-14-38">                      sender := getEngineIDFromEngineCfg (ActionInput.cfg input);
</span><span id="__ispan-14-39">                      target := whoAsked;
</span><span id="__ispan-14-40">                      mailbox := some 0;
</span><span id="__ispan-14-41">                      msg := Msg.IdentityManagement (IdentityManagementMsg.ConnectIdentityReply
</span><span id="__ispan-14-42">                        (ReplyConnectIdentity.mkReplyConnectIdentity@{
</span><span id="__ispan-14-43">                          commitmentEngine := none;
</span><span id="__ispan-14-44">                          decryptionEngine := none;
</span><span id="__ispan-14-45">                          err := some "External identity not found"
</span><span id="__ispan-14-46">                        }))
</span><span id="__ispan-14-47">                    }];
</span><span id="__ispan-14-48">                    timers := [];
</span><span id="__ispan-14-49">                    engines := []
</span><span id="__ispan-14-50">                  }
</span><span id="__ispan-14-51">                | some externalIdentityInfo :=
</span><span id="__ispan-14-52">                  if
</span><span id="__ispan-14-53">                    | isSubsetCapabilities capabilities' (IdentityInfo.capabilities externalIdentityInfo) :=
</span><span id="__ispan-14-54">                      let newIdentityInfo := copyEnginesForCapabilities env whoAsked externalIdentityInfo capabilities';
</span><span id="__ispan-14-55">                          updatedIdentities := Map.insert whoAsked newIdentityInfo identities;
</span><span id="__ispan-14-56">                          newLocalState := local@IdentityManagementLocalState{
</span><span id="__ispan-14-57">                            identities := updatedIdentities
</span><span id="__ispan-14-58">                          };
</span><span id="__ispan-14-59">                          newEnv' := env@EngineEnv{
</span><span id="__ispan-14-60">                            localState := newLocalState
</span><span id="__ispan-14-61">                          };
</span><span id="__ispan-14-62">                      in some ActionEffect.mk@{
</span><span id="__ispan-14-63">                        env := newEnv';
</span><span id="__ispan-14-64">                        msgs := [EngineMsg.mk@{
</span><span id="__ispan-14-65">                          sender := getEngineIDFromEngineCfg (ActionInput.cfg input);
</span><span id="__ispan-14-66">                          target := whoAsked;
</span><span id="__ispan-14-67">                          mailbox := some 0;
</span><span id="__ispan-14-68">                          msg := Msg.IdentityManagement (IdentityManagementMsg.ConnectIdentityReply
</span><span id="__ispan-14-69">                            (ReplyConnectIdentity.mkReplyConnectIdentity@{
</span><span id="__ispan-14-70">                              commitmentEngine := IdentityInfo.commitmentEngine newIdentityInfo;
</span><span id="__ispan-14-71">                              decryptionEngine := IdentityInfo.decryptionEngine newIdentityInfo;
</span><span id="__ispan-14-72">                              err := none
</span><span id="__ispan-14-73">                            }))
</span><span id="__ispan-14-74">                        }];
</span><span id="__ispan-14-75">                        timers := [];
</span><span id="__ispan-14-76">                        engines := []
</span><span id="__ispan-14-77">                      }
</span><span id="__ispan-14-78">                    | else :=
</span><span id="__ispan-14-79">                      some ActionEffect.mk@{
</span><span id="__ispan-14-80">                        env := env;
</span><span id="__ispan-14-81">                        msgs := [EngineMsg.mk@{
</span><span id="__ispan-14-82">                          sender := getEngineIDFromEngineCfg (ActionInput.cfg input);
</span><span id="__ispan-14-83">                          target := whoAsked;
</span><span id="__ispan-14-84">                          mailbox := some 0;
</span><span id="__ispan-14-85">                          msg := Msg.IdentityManagement (IdentityManagementMsg.ConnectIdentityReply
</span><span id="__ispan-14-86">                            (ReplyConnectIdentity.mkReplyConnectIdentity@{
</span><span id="__ispan-14-87">                              commitmentEngine := none;
</span><span id="__ispan-14-88">                              decryptionEngine := none;
</span><span id="__ispan-14-89">                              err := some "Capabilities not available"
</span><span id="__ispan-14-90">                            }))
</span><span id="__ispan-14-91">                        }];
</span><span id="__ispan-14-92">                        timers := [];
</span><span id="__ispan-14-93">                        engines := []
</span><span id="__ispan-14-94">                  }
</span><span id="__ispan-14-95">              }
</span><span id="__ispan-14-96">            | _ := none
</span><span id="__ispan-14-97">          }
</span><span id="__ispan-14-98">      }
</span><span id="__ispan-14-99">    | _ := none
</span><span id="__ispan-14-100">  };
</span></code></pre></div>
<!-- --8<-- [end:connectIdentityAction] -->
<h3 id="deleteidentityaction"><code>deleteIdentityAction</code><a class="headerlink" href="#deleteidentityaction" title="Anchor link to this section for reference">¶</a></h3>
<dl>
<dt>State update</dt>
<dd>Removes the specified identity if it exists.</dd>
<dt>Messages to be sent</dt>
<dd>A DeleteIdentityReply message with confirmation or error.</dd>
<dt>Engines to be spawned</dt>
<dd>No engines are spawned.</dd>
<dt>Timer updates</dt>
<dd>No timers are set or cancelled.</dd>
</dl>
<!-- --8<-- [start:deleteIdentityAction] -->
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-15-1">deleteIdentityAction
</span><span id="__ispan-15-2">  (input : IdentityManagementActionInput)
</span><span id="__ispan-15-3">  : Option IdentityManagementActionEffect :=
</span><span id="__ispan-15-4">  let
</span><span id="__ispan-15-5">    env := ActionInput.env input;
</span><span id="__ispan-15-6">    local := EngineEnv.localState env;
</span><span id="__ispan-15-7">    identities := IdentityManagementLocalState.identities local;
</span><span id="__ispan-15-8">    trigger := ActionInput.trigger input;
</span><span id="__ispan-15-9">  in case getEngineMsgFromTimestampedTrigger trigger of {
</span><span id="__ispan-15-10">    | some emsg :=
</span><span id="__ispan-15-11">      let whoAsked := EngineMsg.sender emsg;
</span><span id="__ispan-15-12">      in case emsg of {
</span><span id="__ispan-15-13">        | EngineMsg.mk@{msg := Anoma.Msg.IdentityManagement (IdentityManagementMsg.DeleteIdentityRequest (RequestDeleteIdentity.mkRequestDeleteIdentity externalIdentity backend'))} :=
</span><span id="__ispan-15-14">          case Map.lookup externalIdentity identities of {
</span><span id="__ispan-15-15">            | none :=
</span><span id="__ispan-15-16">              some ActionEffect.mk@{
</span><span id="__ispan-15-17">                env := env;
</span><span id="__ispan-15-18">                msgs := [EngineMsg.mk@{
</span><span id="__ispan-15-19">                  sender := getEngineIDFromEngineCfg (ActionInput.cfg input);
</span><span id="__ispan-15-20">                  target := whoAsked;
</span><span id="__ispan-15-21">                  mailbox := some 0;
</span><span id="__ispan-15-22">                  msg := Msg.IdentityManagement (IdentityManagementMsg.DeleteIdentityReply
</span><span id="__ispan-15-23">                    (ReplyDeleteIdentity.mkReplyDeleteIdentity@{
</span><span id="__ispan-15-24">                      err := some "Identity does not exist"
</span><span id="__ispan-15-25">                    }))
</span><span id="__ispan-15-26">                }];
</span><span id="__ispan-15-27">                timers := [];
</span><span id="__ispan-15-28">                engines := []
</span><span id="__ispan-15-29">              }
</span><span id="__ispan-15-30">            | some _ :=
</span><span id="__ispan-15-31">              let updatedIdentities := Map.delete externalIdentity identities;
</span><span id="__ispan-15-32">                  newLocalState := local@IdentityManagementLocalState{
</span><span id="__ispan-15-33">                    identities := updatedIdentities
</span><span id="__ispan-15-34">                  };
</span><span id="__ispan-15-35">                  newEnv' := env@EngineEnv{
</span><span id="__ispan-15-36">                    localState := newLocalState
</span><span id="__ispan-15-37">                  };
</span><span id="__ispan-15-38">              in some ActionEffect.mk@{
</span><span id="__ispan-15-39">                env := newEnv';
</span><span id="__ispan-15-40">                msgs := [EngineMsg.mk@{
</span><span id="__ispan-15-41">                  sender := getEngineIDFromEngineCfg (ActionInput.cfg input);
</span><span id="__ispan-15-42">                  target := whoAsked;
</span><span id="__ispan-15-43">                  mailbox := some 0;
</span><span id="__ispan-15-44">                  msg := Msg.IdentityManagement (IdentityManagementMsg.DeleteIdentityReply
</span><span id="__ispan-15-45">                    (ReplyDeleteIdentity.mkReplyDeleteIdentity@{
</span><span id="__ispan-15-46">                      err := none
</span><span id="__ispan-15-47">                    }))
</span><span id="__ispan-15-48">                }];
</span><span id="__ispan-15-49">                timers := [];
</span><span id="__ispan-15-50">                engines := []
</span><span id="__ispan-15-51">              }
</span><span id="__ispan-15-52">          }
</span><span id="__ispan-15-53">        | _ := none
</span><span id="__ispan-15-54">      }
</span><span id="__ispan-15-55">    | _ := none
</span><span id="__ispan-15-56">  };
</span></code></pre></div>
<!-- --8<-- [end:deleteIdentityAction] -->
<h3 id="action-labels">Action Labels<a class="headerlink" href="#action-labels" title="Anchor link to this section for reference">¶</a></h3>
<h4 id="generateidentityactionlabel"><code>generateIdentityActionLabel</code><a class="headerlink" href="#generateidentityactionlabel" title="Anchor link to this section for reference">¶</a></h4>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-16-1">generateIdentityActionLabel : IdentityManagementActionExec := ActionExec.Seq [ generateIdentityAction ];
</span></code></pre></div>
<h4 id="connectidentityactionlabel"><code>connectIdentityActionLabel</code><a class="headerlink" href="#connectidentityactionlabel" title="Anchor link to this section for reference">¶</a></h4>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-17-1">connectIdentityActionLabel : IdentityManagementActionExec := ActionExec.Seq [ connectIdentityAction ];
</span></code></pre></div>
<h4 id="deleteidentityactionlabel"><code>deleteIdentityActionLabel</code><a class="headerlink" href="#deleteidentityactionlabel" title="Anchor link to this section for reference">¶</a></h4>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-18-1">deleteIdentityActionLabel : IdentityManagementActionExec := ActionExec.Seq [ deleteIdentityAction ];
</span></code></pre></div>
<h2 id="guards">Guards<a class="headerlink" href="#guards" title="Anchor link to this section for reference">¶</a></h2>
<details class="code">
<summary>Auxiliary Juvix code</summary>
<h3 id="identitymanagementguard"><code>IdentityManagementGuard</code><a class="headerlink" href="#identitymanagementguard" title="Anchor link to this section for reference">¶</a></h3>
<p><!-- --8<-- [start:IdentityManagementGuard] -->
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-19-1">IdentityManagementGuard : Type :=
</span><span id="__ispan-19-2">  Guard
</span><span id="__ispan-19-3">    IdentityManagementLocalCfg
</span><span id="__ispan-19-4">    IdentityManagementLocalState
</span><span id="__ispan-19-5">    IdentityManagementMailboxState
</span><span id="__ispan-19-6">    IdentityManagementTimerHandle
</span><span id="__ispan-19-7">    IdentityManagementActionArguments
</span><span id="__ispan-19-8">    Anoma.Msg
</span><span id="__ispan-19-9">    Anoma.Cfg
</span><span id="__ispan-19-10">    Anoma.Env;
</span></code></pre></div>
<!-- --8<-- [end:IdentityManagementGuard] --></p>
<h3 id="identitymanagementguardoutput"><code>IdentityManagementGuardOutput</code><a class="headerlink" href="#identitymanagementguardoutput" title="Anchor link to this section for reference">¶</a></h3>
<p><!-- --8<-- [start:IdentityManagementGuardOutput] -->
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-20-1">IdentityManagementGuardOutput : Type :=
</span><span id="__ispan-20-2">  GuardOutput
</span><span id="__ispan-20-3">    IdentityManagementLocalCfg
</span><span id="__ispan-20-4">    IdentityManagementLocalState
</span><span id="__ispan-20-5">    IdentityManagementMailboxState
</span><span id="__ispan-20-6">    IdentityManagementTimerHandle
</span><span id="__ispan-20-7">    IdentityManagementActionArguments
</span><span id="__ispan-20-8">    Anoma.Msg
</span><span id="__ispan-20-9">    Anoma.Cfg
</span><span id="__ispan-20-10">    Anoma.Env;
</span></code></pre></div>
<!-- --8<-- [end:IdentityManagementGuardOutput] --></p>
<h3 id="identitymanagementguardeval"><code>IdentityManagementGuardEval</code><a class="headerlink" href="#identitymanagementguardeval" title="Anchor link to this section for reference">¶</a></h3>
<p><!-- --8<-- [start:IdentityManagementGuardEval] -->
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-21-1">IdentityManagementGuardEval : Type :=
</span><span id="__ispan-21-2">  GuardEval
</span><span id="__ispan-21-3">    IdentityManagementLocalCfg
</span><span id="__ispan-21-4">    IdentityManagementLocalState
</span><span id="__ispan-21-5">    IdentityManagementMailboxState
</span><span id="__ispan-21-6">    IdentityManagementTimerHandle
</span><span id="__ispan-21-7">    IdentityManagementActionArguments
</span><span id="__ispan-21-8">    Anoma.Msg
</span><span id="__ispan-21-9">    Anoma.Cfg
</span><span id="__ispan-21-10">    Anoma.Env;
</span></code></pre></div>
<!-- --8<-- [end:IdentityManagementGuardEval] --></p>
</details>
<h3 id="generateidentityguard"><code>generateIdentityGuard</code><a class="headerlink" href="#generateidentityguard" title="Anchor link to this section for reference">¶</a></h3>
<dl>
<dt>Condition</dt>
<dd>Message type is MsgIdentityManagementGenerateIdentityRequest.</dd>
</dl>
<!-- --8<-- [start:generateIdentityGuard] -->
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-22-1">generateIdentityGuard
</span><span id="__ispan-22-2">  (trigger : TimestampedTrigger IdentityManagementTimerHandle Anoma.Msg)
</span><span id="__ispan-22-3">  (cfg : IdentityManagementCfg)
</span><span id="__ispan-22-4">  (env : IdentityManagementEnv)
</span><span id="__ispan-22-5">  : Option IdentityManagementGuardOutput :=
</span><span id="__ispan-22-6">  case getEngineMsgFromTimestampedTrigger trigger of {
</span><span id="__ispan-22-7">    | some EngineMsg.mk@{
</span><span id="__ispan-22-8">        msg := Anoma.Msg.IdentityManagement (IdentityManagementMsg.GenerateIdentityRequest _)
</span><span id="__ispan-22-9">      } :=
</span><span id="__ispan-22-10">      some GuardOutput.mk@{
</span><span id="__ispan-22-11">        action := generateIdentityActionLabel;
</span><span id="__ispan-22-12">        args := []
</span><span id="__ispan-22-13">      }
</span><span id="__ispan-22-14">    | _ := none
</span><span id="__ispan-22-15">  };
</span></code></pre></div>
<!-- --8<-- [end:generateIdentityGuard] -->
<h3 id="connectidentityguard"><code>connectIdentityGuard</code><a class="headerlink" href="#connectidentityguard" title="Anchor link to this section for reference">¶</a></h3>
<dl>
<dt>Condition</dt>
<dd>Message type is <code>MsgIdentityManagementConnectIdentityRequest</code>.</dd>
</dl>
<!-- --8<-- [start:connectIdentityGuard] -->
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-23-1">connectIdentityGuard
</span><span id="__ispan-23-2">  (trigger : TimestampedTrigger IdentityManagementTimerHandle Anoma.Msg)
</span><span id="__ispan-23-3">  (cfg : IdentityManagementCfg)
</span><span id="__ispan-23-4">  (env : IdentityManagementEnv)
</span><span id="__ispan-23-5">  : Option IdentityManagementGuardOutput :=
</span><span id="__ispan-23-6">  case getEngineMsgFromTimestampedTrigger trigger of {
</span><span id="__ispan-23-7">    | some EngineMsg.mk@{
</span><span id="__ispan-23-8">        msg := Anoma.Msg.IdentityManagement (IdentityManagementMsg.ConnectIdentityRequest _)
</span><span id="__ispan-23-9">      } :=
</span><span id="__ispan-23-10">      some GuardOutput.mk@{
</span><span id="__ispan-23-11">        action := connectIdentityActionLabel;
</span><span id="__ispan-23-12">        args := []
</span><span id="__ispan-23-13">      }
</span><span id="__ispan-23-14">    | _ := none
</span><span id="__ispan-23-15">  };
</span><span id="__ispan-23-16">```&lt;!-- --8&lt;-- [end:connectIdentityGuard] --&gt;
</span><span id="__ispan-23-17">---
</span><span id="__ispan-23-18">
</span><span id="__ispan-23-19">### `deleteIdentityGuard`
</span><span id="__ispan-23-20">
</span><span id="__ispan-23-21">Condition
</span><span id="__ispan-23-22">: Message type is `MsgIdentityManagementDeleteIdentityRequest`.
</span><span id="__ispan-23-23">
</span><span id="__ispan-23-24">&lt;!-- --8&lt;-- [start:deleteIdentityGuard] --&gt;
</span><span id="__ispan-23-25">```juvix
</span><span id="__ispan-23-26">deleteIdentityGuard
</span><span id="__ispan-23-27">  (trigger : TimestampedTrigger IdentityManagementTimerHandle Anoma.Msg)
</span><span id="__ispan-23-28">  (cfg : IdentityManagementCfg)
</span><span id="__ispan-23-29">  (env : IdentityManagementEnv)
</span><span id="__ispan-23-30">  : Option IdentityManagementGuardOutput :=
</span><span id="__ispan-23-31">  case getEngineMsgFromTimestampedTrigger trigger of {
</span><span id="__ispan-23-32">    | some EngineMsg.mk@{
</span><span id="__ispan-23-33">        msg := Anoma.Msg.IdentityManagement (IdentityManagementMsg.DeleteIdentityRequest _)
</span><span id="__ispan-23-34">      } :=
</span><span id="__ispan-23-35">      some GuardOutput.mk@{
</span><span id="__ispan-23-36">        action := deleteIdentityActionLabel;
</span><span id="__ispan-23-37">        args := []
</span><span id="__ispan-23-38">      }
</span><span id="__ispan-23-39">    | _ := none
</span><span id="__ispan-23-40">  };
</span><span id="__ispan-23-41">```&lt;!-- --8&lt;-- [end:deleteIdentityGuard] --&gt;
</span><span id="__ispan-23-42">---
</span><span id="__ispan-23-43">
</span><span id="__ispan-23-44">## The Identity Management Behaviour
</span><span id="__ispan-23-45">
</span><span id="__ispan-23-46">### `IdentityManagementBehaviour`
</span><span id="__ispan-23-47">
</span><span id="__ispan-23-48">&lt;!-- --8&lt;-- [start:IdentityManagementBehaviour] --&gt;
</span><span id="__ispan-23-49">```juvix
</span><span id="__ispan-23-50">IdentityManagementBehaviour : Type :=
</span><span id="__ispan-23-51">  EngineBehaviour
</span><span id="__ispan-23-52">    IdentityManagementLocalCfg
</span><span id="__ispan-23-53">    IdentityManagementLocalState
</span><span id="__ispan-23-54">    IdentityManagementMailboxState
</span><span id="__ispan-23-55">    IdentityManagementTimerHandle
</span><span id="__ispan-23-56">    IdentityManagementActionArguments
</span><span id="__ispan-23-57">    Anoma.Msg
</span><span id="__ispan-23-58">    Anoma.Cfg
</span><span id="__ispan-23-59">    Anoma.Env;
</span><span id="__ispan-23-60">```&lt;!-- --8&lt;-- [end:IdentityManagementBehaviour] --&gt;
</span><span id="__ispan-23-61">
</span><span id="__ispan-23-62">### Instantiation
</span><span id="__ispan-23-63">
</span><span id="__ispan-23-64">&lt;!-- --8&lt;-- [start:identityManagementBehaviour] --&gt;
</span><span id="__ispan-23-65">```juvix
</span><span id="__ispan-23-66">identityManagementBehaviour : IdentityManagementBehaviour :=
</span><span id="__ispan-23-67">  EngineBehaviour.mk@{
</span><span id="__ispan-23-68">    guards := GuardEval.First [
</span><span id="__ispan-23-69">      generateIdentityGuard;
</span><span id="__ispan-23-70">      connectIdentityGuard;
</span><span id="__ispan-23-71">      deleteIdentityGuard
</span><span id="__ispan-23-72">    ]
</span><span id="__ispan-23-73">  };
</span></code></pre></div>
<!-- --8<-- [end:identityManagementBehaviour] -->
<!-- list_wikilinks -->
<!-- Source file information -->
<!-- Was this page helpful? -->
<!-- Comment system -->
</article>
</div>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
</main>
<footer class="md-footer">
<nav aria-label="Footer" class="md-footer__inner md-grid">
<a aria-label="Previous: Identity Management Environment" class="md-footer__link md-footer__link--prev" href="identity_management_environment.html">
<div class="md-footer__button md-icon">
<svg viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M7.78 12.53a.75.75 0 0 1-1.06 0L2.47 8.28a.75.75 0 0 1 0-1.06l4.25-4.25a.75.75 0 0 1 1.042.018.75.75 0 0 1 .018 1.042L4.81 7h7.44a.75.75 0 0 1 0 1.5H4.81l2.97 2.97a.75.75 0 0 1 0 1.06"></path></svg>
</div>
<div class="md-footer__title">
<span class="md-footer__direction">
                Previous
              </span>
<div class="md-ellipsis">
                Identity Management Environment
              </div>
</div>
</a>
<a aria-label="Next: Encryption Engine" class="md-footer__link md-footer__link--next" href="encryption.html">
<div class="md-footer__title">
<span class="md-footer__direction">
                Next
              </span>
<div class="md-ellipsis">
                Encryption Engine
              </div>
</div>
<div class="md-footer__button md-icon">
<svg viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M8.22 2.97a.75.75 0 0 1 1.06 0l4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.75.75 0 0 1-1.042-.018.75.75 0 0 1-.018-1.042l2.97-2.97H3.75a.75.75 0 0 1 0-1.5h7.44L8.22 4.03a.75.75 0 0 1 0-1.06"></path></svg>
</div>
</a>
</nav>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
<div class="md-copyright__highlight">
      © 2025 <a href="https://anoma.net">Anoma Foundation</a>
</div>
<strong>Version: (PR 374) - Updated: June 03,
    2025 at 06:17 AM UTC</strong>
<br/>
<strong>Latest version: <a href="https://specs.anoma.net/latest">
    https://specs.anoma.net/latest</a></strong>
<br/>
<strong>Development version: <a href="https://specs.anoma.net/main">
    https://specs.anoma.net/main</a></strong>
<br/>
<strong>Anoma Official Resources:</strong>
<small> <a href="https://anoma.net/" target="_blank">Website</a> | <a href="https://art.anoma.net" target="_blank">Research</a> | <a href="https://anoma.net/blog" target="_blank">Blog</a> | <a href="https://anoma.net/talks" target="_blank">Talks</a> </small>
<br/>
<strong>For Specification Authors:</strong>
<small>
<a href="https://specs.anoma.net/pr-374/indexes/tags.html">Tags</a>
    | <a href="https://specs.anoma.net/pr-374/indexes/links.html">Quick links</a>
    | <a href="https://specs.anoma.net/pr-374/indexes/juvix_modules.html">Juvix modules</a>
    | <a href="https://specs.anoma.net/pr-374/tutorial/index.html">Guides</a>
</small>
</div>
<div class="md-social">
<a class="md-social__link" href="https://x.com/anoma" rel="noopener" target="_blank" title="x.com">
<svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8l164.9-188.5L26.8 48h145.6l100.5 132.9zm-24.8 373.8h39.1L151.1 88h-42z"></path></svg>
</a>
<a class="md-social__link" href="https://github.com/anoma" rel="noopener" target="_blank" title="github.com">
<svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg>
</a>
<a class="md-social__link" href="https://anoma.net/blog" rel="noopener" target="_blank" title="anoma.net">
<svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M192 32c0 17.7 14.3 32 32 32 123.7 0 224 100.3 224 224 0 17.7 14.3 32 32 32s32-14.3 32-32C512 128.9 383.1 0 224 0c-17.7 0-32 14.3-32 32m0 96c0 17.7 14.3 32 32 32 70.7 0 128 57.3 128 128 0 17.7 14.3 32 32 32s32-14.3 32-32c0-106-86-192-192-192-17.7 0-32 14.3-32 32m-96 16c0-26.5-21.5-48-48-48S0 117.5 0 144v224c0 79.5 64.5 144 144 144s144-64.5 144-144-64.5-144-144-144h-16v96h16c26.5 0 48 21.5 48 48s-21.5 48-48 48-48-21.5-48-48z"></path></svg>
</a>
<a class="md-social__link" href="https://research.anoma.net" rel="noopener" target="_blank" title="research.anoma.net">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M225.9 32C103.3 32 0 130.5 0 252.1 0 256 .1 480 .1 480l225.8-.2c122.7 0 222.1-102.3 222.1-223.9S348.6 32 225.9 32M224 384c-19.4 0-37.9-4.3-54.4-12.1L88.5 392l22.9-75c-9.8-18.1-15.4-38.9-15.4-61 0-70.7 57.3-128 128-128s128 57.3 128 128-57.3 128-128 128"></path></svg>
</a>
<a class="md-social__link" href="https://youtube.com/anoma" rel="noopener" target="_blank" title="youtube.com">
<svg viewbox="0 0 576 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305m-317.51 213.508V175.185l142.739 81.205z"></path></svg>
</a>
<a class="md-social__link" href="mailto:arts@heliax.dev" rel="noopener" target="_blank" title="">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m20 8-8 5-8-5V6l8 5 8-5m0-2H4c-1.11 0-2 .89-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2"></path></svg>
</a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../../..", "features": ["announce.dismiss", "content.code.annotate", "content.code.copy", "content.tooltips", "content.action.edit", "content.action.view", "search.highlight", "search.suggest", "search.sharing", "navigation.instant.preview", "navigation.tracking", "navigation.prune", "navigation.indexes", "navigation.sections", "navigation.footer", "navigation.path", "toc.follow"], "search": "../../../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
<script src="../../../assets/javascripts/bundle.c8b220af.min.js"></script>
<script src="../../../assets/js/extra.js"></script>
<script src="../../../assets/js/highlight.js"></script>
<script src="../../../assets/js/mathjax.js"></script>
<script src="../../../assets/js/tex-svg-full.js"></script>
<script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>