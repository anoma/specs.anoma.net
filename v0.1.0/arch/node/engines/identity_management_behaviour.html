
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="The Anoma Specification is a collection of documents that describe the architecture, design, and implementation of the Anoma Network.">
      
      
        <meta name="author" content="Anoma Foundation">
      
      
        <link rel="canonical" href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.juvix.html">
      
      
      
      
      <link rel="icon" href="../../../assets/logo.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.37">
    
    
      
        <title>Identity management behaviour - Anoma Specification</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.8c3ca2c6.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,700,700i%7CFira+Code:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Open Sans";--md-code-font:"Fira Code"}</style>
      
    
    
      <link rel="stylesheet" href="../../../css/timeago.css">
    
      <link rel="stylesheet" href="../../../assets/css/style.css">
    
      <link rel="stylesheet" href="../../../assets/css/juvix-highlighting.css">
    
      <link rel="stylesheet" href="../../../assets/css/juvix_codeblock_footer.css">
    
      <link rel="stylesheet" href="../../../assets/css/juvix_codeblock_footer.css">
    
      <link rel="stylesheet" href="../../../assets/css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


    
    
      
        <meta  property="og:type"  content="website" >
      
        <meta  property="og:title"  content="Identity management behaviour.juvix - Anoma Specification" >
      
        <meta  property="og:description"  content="The Anoma Specification is a collection of documents that describe the architecture, design, and implementation of the Anoma Network." >
      
        <meta  property="og:image"  content="https://anoma.github.io/nspec/v2/assets/images/social/arch/node/engines/identity_management_behaviour.juvix.png" >
      
        <meta  property="og:image:type"  content="image/png" >
      
        <meta  property="og:image:width"  content="1200" >
      
        <meta  property="og:image:height"  content="630" >
      
        <meta  property="og:url"  content="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.juvix.html" >
      
        <meta  name="twitter:card"  content="summary_large_image" >
      
        <meta  name="twitter:title"  content="Identity management behaviour.juvix - Anoma Specification" >
      
        <meta  name="twitter:description"  content="The Anoma Specification is a collection of documents that describe the architecture, design, and implementation of the Anoma Network." >
      
        <meta  name="twitter:image"  content="https://anoma.github.io/nspec/v2/assets/images/social/arch/node/engines/identity_management_behaviour.juvix.png" >
      
    
    
   <link href="../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#identity-management-dynamics" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
        <aside class="md-banner">
          <div class="md-banner__inner md-grid md-typeset">
            
              <button class="md-banner__button md-icon" aria-label="Don't show this again">
                
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
              </button>
            
            
  For updates follow <strong>@anoma</strong> on
  <a rel="me" href="https://x.com/anoma">
    <span class="twemoji x-twitter">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8l164.9-188.5L26.8 48h145.6l100.5 132.9zm-24.8 373.8h39.1L151.1 88h-42z"/></svg>
    </span>
    <strong></strong>
  </a>
  and discuss on our
  <a href="https://research.anoma.net">
    <span class="twemoji discourse">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M225.9 32C103.3 32 0 130.5 0 252.1 0 256 .1 480 .1 480l225.8-.2c122.7 0 222.1-102.3 222.1-223.9S348.6 32 225.9 32M224 384c-19.4 0-37.9-4.3-54.4-12.1L88.5 392l22.9-75c-9.8-18.1-15.4-38.9-15.4-61 0-70.7 57.3-128 128-128s128 57.3 128 128-57.3 128-128 128"/></svg>
    </span>
    <strong>forum</strong>
  </a>

          </div>
          
            <script>var el=document.querySelector("[data-md-component=announce]");if(el){var content=el.querySelector(".md-typeset");__md_hash(content.innerHTML)===__md_get("__announce")&&(el.hidden=!0)}</script>
          
        </aside>
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">
              
  You're not viewing the latest official version.
  <a href="../../../..">
    <strong>Click here to go to latest.</strong>
  </a>

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),outdated=__md_get("__outdated",sessionStorage);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>
        
      </div>
    
    
        
  
    
  
  <header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
    <nav class="md-header__inner md-grid" aria-label="Header">
      <a href="../../../index.html" title="Anoma Specification" class="md-header__button md-logo" aria-label="Anoma Specification" data-md-component="logo">
        
  <img src="../../../assets/logo.svg" alt="logo">

      </a>
      <label class="md-header__button md-icon" for="__drawer">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
      </label>
      <div class="md-header__title" data-md-component="header-title">
        <div class="md-header__ellipsis">
          <div class="md-header__topic">
            <span class="md-ellipsis">
                
                <span class="first-letter">A</span>noma 
              
                <span class="first-letter">S</span>pecification
              
              
                <span class="md-header__topic-version">v0.1.0</span>
              
            </span>
          </div>
          <div class="md-header__topic" data-md-component="header-topic">
            <span class="md-ellipsis">
              
                Identity management behaviour
              
            </span>
          </div>
        </div>
      </div>
      
        
          <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="red"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="red"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
        
      
      
        <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
      
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
      
    </nav>
    
      
        <!--
  Copyright (c) 2016-2024 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->



<!-- Navigation tabs -->
<nav
  class="md-tabs"
  aria-label="Tabs"
  data-md-component="tabs"
>
  <div class="md-grid">
    <ul class="md-tabs__list">
      
      
            
  
  
  
    <li class="md-tabs__item">
      <a href="../../../index.html" class="md-tabs__link">
        
  
    
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/></svg>
    
  
  Home

      </a>
    </li>
  

        
      
      
            
  
  
  
    <li class="md-tabs__item">
      <a href="../../../changelog.html" class="md-tabs__link">
        
  
    
  
  Changelog

      </a>
    </li>
  

        
      
      
            
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../scope/index.html" class="md-tabs__link">
          
  
    
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5 3c-1.11 0-2 .89-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2zm10.78 2H19v12.18c-.26-.8-1.31-1.39-2.2-1.39h-1v-3a1 1 0 0 0-1-1h-6v-2h2a1 1 0 0 0 1-1v-2h2c1.03 0 1.87-.79 1.98-1.79M5 10.29l4.8 4.5v1a2 2 0 0 0 2 2V19H5z"/></svg>
    
  
  Scope

        </a>
      </li>
    
  

        
      
      
            
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../basic_abstractions/index.html" class="md-tabs__link">
          
  
    
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M6 2a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6zm0 2h7v5h5v11H6zm2 8v2h8v-2zm0 4v2h5v-2z"/></svg>
    
  
  Basic Abstractions

        </a>
      </li>
    
  

        
      
      
            
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../index.html" class="md-tabs__link">
          
  
    
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M24 18.714v4.8c0 .288-.192.48-.48.48h-4.8c-.288 0-.48-.192-.48-.48v-4.8c0-.288.192-.48.48-.48h1.92v-1.92h-8.16v1.92h1.92c.288 0 .48.192.48.48v4.8c0 .288-.192.48-.48.48H9.6c-.288 0-.48-.192-.48-.48v-4.8c0-.288.192-.48.48-.48h1.92v-1.92H3.36v1.92h1.92c.288 0 .48.192.48.48v4.8c0 .288-.192.48-.48.48H.48c-.288 0-.48-.192-.48-.48v-4.8c0-.288.192-.48.48-.48H2.4v-2.4c0-.288.192-.48.48-.48h8.64v-1.44h.96v1.44h8.64c.288 0 .48.192.48.48v2.4h1.92c.288 0 .48.192.48.48m-13.92 4.32h3.84v-3.84h-3.84zm-9.12 0H4.8v-3.84H.96Zm18.24 0h3.84v-3.84H19.2ZM6.24 9.642V3.546c0-.192.096-.336.24-.432L11.76.042a.8.8 0 0 1 .48 0l5.28 3.072c.144.096.24.24.24.432v6.096c0 .144-.096.288-.24.384l-5.28 3.072q-.096.048-.24.048t-.24-.048l-5.28-3.072c-.144-.096-.24-.24-.24-.384m10.56-.288V4.362l-4.32 2.496v4.992zm-9.6 0 4.32 2.496V6.858L7.2 4.362Zm.48-5.808L12 5.994l4.32-2.448L12 1.05Z"/></svg>
    
  
  Protocol Architecture

        </a>
      </li>
    
  

        
      
      
            
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../application_architecture/index.html" class="md-tabs__link">
          
  
    
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16 20h4v-4h-4m0-2h4v-4h-4m-6-2h4V4h-4m6 4h4V4h-4m-6 10h4v-4h-4m-6 4h4v-4H4m0 10h4v-4H4m6 4h4v-4h-4M4 8h4V4H4z"/></svg>
    
  
  Application Architecture

        </a>
      </li>
    
  

        
      
      
            
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../implementation/index.html" class="md-tabs__link">
          
  
    
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19.793 16.575c0 3.752-2.927 7.426-7.743 7.426-5.249 0-7.843-3.71-7.843-8.29 0-5.21 3.892-12.952 8-15.647a.397.397 0 0 1 .61.371 9.72 9.72 0 0 0 1.694 6.518c.522.795 1.092 1.478 1.763 2.352.94 1.227 1.637 1.906 2.644 3.842l.015.028a7.1 7.1 0 0 1 .86 3.4"/></svg>
    
  
  Implementation

        </a>
      </li>
    
  

        
      
      
      
      
      
      
      
    </ul>
  </div>
</nav>
      
    
  </header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../index.html" title="Anoma Specification" class="md-nav__button md-logo" aria-label="Anoma Specification" data-md-component="logo">
      
  <img src="../../../assets/logo.svg" alt="logo">

    </a>
    Anoma Specification
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../index.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/></svg>
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../changelog.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Changelog
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../../scope/index.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Scope
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../../basic_abstractions/index.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Basic Abstractions
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../index.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Protocol Architecture
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../../application_architecture/index.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Application Architecture
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../../implementation/index.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Implementation
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../indexes/links.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1M8 13h8v-2H8zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4a5 5 0 0 0 5-5 5 5 0 0 0-5-5"/></svg>
  
  <span class="md-ellipsis">
    Quick links
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../../prelude.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Juvix modules
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
          
        
      
        
      
        
      
        
      
        
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
          
        
      
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../../tutorial/index.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Tutorials for contributors
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  
  
<nav class="md-tags" >
  
    
    
    
      <span class="md-tag">identity_management</span>
    
  
    
    
    
      <span class="md-tag">engine-behavior</span>
    
  
</nav>



<details class="quote">
<summary>Juvix imports</summary>
<p><pre class="highlight"><code class="juvix"><pre class="src-content"><span class="ju-keyword">module</span> <span id="arch.node.engines.identity_management_behaviour:0"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:0" class="ju-code-link ju-module"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:0" class="ju-code-link ju-module"><span class="ju-module"><span class="ju-module">arch.node.engines.identity_management_behaviour</span></span></a></span></a></span></span><span class="ju-delimiter">;</span><br/><br/><span class="ju-keyword">import</span> <span id="prelude:0"><span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:0" class="ju-code-link ju-module"><span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:0" class="ju-code-link ju-module"><span class="ju-module"><span class="ju-module">prelude</span></span></a></span></a></span></span> <span class="ju-keyword">open</span><span class="ju-delimiter">;</span><br/><span class="ju-keyword">import</span> <span id="Stdlib.Data.Bool:0"><span class="annot"><a href="https://anoma.github.io/nspec/v2/Stdlib/Data/Bool.html#Stdlib.Data.Bool:0" class="ju-code-link ju-module"><span class="annot"><a href="https://anoma.github.io/nspec/v2/Stdlib/Data/Bool.html#Stdlib.Data.Bool:0" class="ju-code-link ju-module"><span class="ju-module"><span class="ju-module">Stdlib.Data.Bool</span></span></a></span></a></span></span> <span class="ju-keyword">open</span><span class="ju-delimiter">;</span><br/><span class="ju-keyword">import</span> <span id="Data.Map:0"><span class="annot"><a href="https://anoma.github.io/nspec/v2/Data/Map.html#Data.Map:0" class="ju-code-link ju-module"><span class="annot"><a href="https://anoma.github.io/nspec/v2/Data/Map.html#Data.Map:0" class="ju-code-link ju-module"><span class="ju-module"><span class="ju-module">Data.Map</span></span></a></span></a></span></span> <span class="ju-keyword">open</span><span class="ju-delimiter">;</span><br/><span class="ju-keyword">import</span> <span id="arch.node.engines.commitment_environment:0"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/commitment_environment.html#arch.node.engines.commitment_environment:0" class="ju-code-link ju-module"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/commitment_environment.html#arch.node.engines.commitment_environment:0" class="ju-code-link ju-module"><span class="ju-module"><span class="ju-module">arch.node.engines.commitment_environment</span></span></a></span></a></span></span> <span class="ju-keyword">open</span><span class="ju-delimiter">;</span><br/><span class="ju-keyword">import</span> <span id="arch.node.engines.decryption_environment:0"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/decryption_environment.html#arch.node.engines.decryption_environment:0" class="ju-code-link ju-module"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/decryption_environment.html#arch.node.engines.decryption_environment:0" class="ju-code-link ju-module"><span class="ju-module"><span class="ju-module">arch.node.engines.decryption_environment</span></span></a></span></a></span></span> <span class="ju-keyword">open</span><span class="ju-delimiter">;</span><br/><span class="ju-keyword">import</span> <span id="arch.node.engines.identity_management_environment:0"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_environment.html#arch.node.engines.identity_management_environment:0" class="ju-code-link ju-module"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_environment.html#arch.node.engines.identity_management_environment:0" class="ju-code-link ju-module"><span class="ju-module"><span class="ju-module">arch.node.engines.identity_management_environment</span></span></a></span></a></span></span> <span class="ju-keyword">open</span><span class="ju-delimiter">;</span><br/><span class="ju-keyword">import</span> <span id="arch.node.engines.identity_management_messages:0"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_messages.html#arch.node.engines.identity_management_messages:0" class="ju-code-link ju-module"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_messages.html#arch.node.engines.identity_management_messages:0" class="ju-code-link ju-module"><span class="ju-module"><span class="ju-module">arch.node.engines.identity_management_messages</span></span></a></span></a></span></span> <span class="ju-keyword">open</span><span class="ju-delimiter">;</span><br/><span class="ju-keyword">import</span> <span id="arch.node.types.anoma_environment:0"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/anoma_environment.html#arch.node.types.anoma_environment:0" class="ju-code-link ju-module"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/anoma_environment.html#arch.node.types.anoma_environment:0" class="ju-code-link ju-module"><span class="ju-module"><span class="ju-module">arch.node.types.anoma_environment</span></span></a></span></a></span></span> <span class="ju-keyword">open</span><span class="ju-delimiter">;</span><br/><span class="ju-keyword">import</span> <span id="arch.node.types.anoma_message:0"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/anoma_message.html#arch.node.types.anoma_message:0" class="ju-code-link ju-module"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/anoma_message.html#arch.node.types.anoma_message:0" class="ju-code-link ju-module"><span class="ju-module"><span class="ju-module">arch.node.types.anoma_message</span></span></a></span></a></span></span> <span class="ju-keyword">open</span><span class="ju-delimiter">;</span><br/><span class="ju-keyword">import</span> <span id="arch.node.types.engine_behaviour:0"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/engine_behaviour.html#arch.node.types.engine_behaviour:0" class="ju-code-link ju-module"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/engine_behaviour.html#arch.node.types.engine_behaviour:0" class="ju-code-link ju-module"><span class="ju-module"><span class="ju-module">arch.node.types.engine_behaviour</span></span></a></span></a></span></span> <span class="ju-keyword">open</span><span class="ju-delimiter">;</span><br/><span class="ju-keyword">import</span> <span id="arch.node.types.engine_environment:0"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/engine_environment.html#arch.node.types.engine_environment:0" class="ju-code-link ju-module"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/engine_environment.html#arch.node.types.engine_environment:0" class="ju-code-link ju-module"><span class="ju-module"><span class="ju-module">arch.node.types.engine_environment</span></span></a></span></a></span></span> <span class="ju-keyword">open</span><span class="ju-delimiter">;</span><br/><span class="ju-keyword">import</span> <span id="arch.node.types.identities:0"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/identities.html#arch.node.types.identities:0" class="ju-code-link ju-module"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/identities.html#arch.node.types.identities:0" class="ju-code-link ju-module"><span class="ju-module"><span class="ju-module">arch.node.types.identities</span></span></a></span></a></span></span> <span class="ju-keyword">open</span><span class="ju-delimiter">;</span><br/><span class="ju-keyword">import</span> <span id="arch.node.types.messages:0"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/messages.html#arch.node.types.messages:0" class="ju-code-link ju-module"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/messages.html#arch.node.types.messages:0" class="ju-code-link ju-module"><span class="ju-module"><span class="ju-module">arch.node.types.messages</span></span></a></span></a></span></span> <span class="ju-keyword">open</span><span class="ju-delimiter">;</span><br/><span class="ju-keyword">import</span> <span id="arch.system.identity.identity:0"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/system/identity/identity.html#arch.system.identity.identity:0" class="ju-code-link ju-module"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/system/identity/identity.html#arch.system.identity.identity:0" class="ju-code-link ju-module"><span class="ju-module"><span class="ju-module">arch.system.identity.identity</span></span></a></span></a></span></span> <span class="ju-keyword">open</span> <span class="ju-keyword">hiding</span> <span class="ju-delimiter">{</span><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/system/identity/identity.html#arch.system.identity.identity:17" class="ju-code-link ju-inductive"><span class="ju-inductive">ExternalIdentity</span></a></span><span class="ju-delimiter">}</span><span class="ju-delimiter">;</span><br/></pre></code></pre></p>
</details>
<h1 id="identity-management-dynamics"><code>Identity Management</code> Dynamics<a class="headerlink" href="#identity-management-dynamics" title="Permanent link">&para;</a></h1>
<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">&para;</a></h2>
<p>The behavior of the <code>Identity Management</code> Engine define how it processes
incoming messages (requests) and produces the corresponding responses and
actions.</p>
<h2 id="action-labels">Action labels<a class="headerlink" href="#action-labels" title="Permanent link">&para;</a></h2>
<!-- --8<-- [start:identity-management-action-label] -->
<pre class="highlight"><code class="juvix"><pre class="src-content"><span class="ju-keyword">type</span> <span id="arch.node.engines.identity_management_behaviour:1"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:1" class="ju-code-link ju-inductive"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:1" class="ju-code-link ju-inductive"><span class="ju-inductive">IdentityManagementActionLabel</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>  <span class="ju-keyword">|</span> <span id="arch.node.engines.identity_management_behaviour:2"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:2" class="ju-code-link ju-constructor"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:2" class="ju-code-link ju-constructor"><span class="ju-constructor">DoGenerateIdentity</span></a></span></a></span></span> <span class="ju-delimiter">{</span><br/>      <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:8" class="ju-code-link ju-var"><span class="ju-var">backend</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/identities.html#arch.node.types.identities:30" class="ju-code-link ju-inductive"><span class="ju-inductive">Backend</span></a></span><span class="ju-delimiter">;</span><br/>      <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:9" class="ju-code-link ju-var"><span class="ju-var">params</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/identities.html#arch.node.types.identities:26" class="ju-code-link ju-inductive"><span class="ju-inductive">IDParams</span></a></span><span class="ju-delimiter">;</span><br/>      <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:10" class="ju-code-link ju-var"><span class="ju-var">capabilities</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/identities.html#arch.node.types.identities:34" class="ju-code-link ju-inductive"><span class="ju-inductive">Capabilities</span></a></span><br/>    <span class="ju-delimiter">}</span><br/>  <span class="ju-keyword">|</span> <span id="arch.node.engines.identity_management_behaviour:3"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:3" class="ju-code-link ju-constructor"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:3" class="ju-code-link ju-constructor"><span class="ju-constructor">DoConnectIdentity</span></a></span></a></span></span> <span class="ju-delimiter">{</span><br/>      <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:11" class="ju-code-link ju-var"><span class="ju-var">externalIdentity</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/identities.html#arch.node.types.identities:18" class="ju-code-link ju-function"><span class="ju-function">EngineID</span></a></span><span class="ju-delimiter">;</span><br/>      <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:12" class="ju-code-link ju-var"><span class="ju-var">backend</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/identities.html#arch.node.types.identities:30" class="ju-code-link ju-inductive"><span class="ju-inductive">Backend</span></a></span><span class="ju-delimiter">;</span><br/>      <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:13" class="ju-code-link ju-var"><span class="ju-var">capabilities</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/identities.html#arch.node.types.identities:34" class="ju-code-link ju-inductive"><span class="ju-inductive">Capabilities</span></a></span><br/>    <span class="ju-delimiter">}</span><br/>  <span class="ju-keyword">|</span> <span id="arch.node.engines.identity_management_behaviour:4"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:4" class="ju-code-link ju-constructor"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:4" class="ju-code-link ju-constructor"><span class="ju-constructor">DoDeleteIdentity</span></a></span></a></span></span> <span class="ju-delimiter">{</span><br/>      <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:14" class="ju-code-link ju-var"><span class="ju-var">externalIdentity</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/identities.html#arch.node.types.identities:18" class="ju-code-link ju-function"><span class="ju-function">EngineID</span></a></span><span class="ju-delimiter">;</span><br/>      <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:15" class="ju-code-link ju-var"><span class="ju-var">backend</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/identities.html#arch.node.types.identities:30" class="ju-code-link ju-inductive"><span class="ju-inductive">Backend</span></a></span><br/>    <span class="ju-delimiter">}</span><span class="ju-delimiter">;</span></pre></code></pre>
<!-- --8<-- [end:identity-management-action-label] -->

<h3 id="dogenerateidentity"><code>DoGenerateIdentity</code><a class="headerlink" href="#dogenerateidentity" title="Permanent link">&para;</a></h3>
<div class="admonition quote">
<p>DoGenerateIdentity {
  backend : Backend;
  params : IDParams;
  capabilities : Capabilities
}</p>
</div>
<p>This action label corresponds to generating a new identity.</p>
<details class="quote">
<summary><code>DoGenerateIdentity</code> action effect</summary>
<p>This action does the following:</p>
<table>
<thead>
<tr>
<th>Aspect</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>State update</td>
<td>A new identity is created and added to the <code>identities</code> map in the local state. The identity includes information about backend, capabilities, and potentially spawned engine references.</td>
</tr>
<tr>
<td>Messages to be sent</td>
<td>A <code>GenerateIdentityResponse</code> message is sent to the requester, containing the new identity information including references to spawned engines (if any) or an error message if the identity already exists.</td>
</tr>
<tr>
<td>Engines to be spawned</td>
<td>Depending on the requested capabilities, Commitment and/or Decryption engines may be spawned.</td>
</tr>
<tr>
<td>Timer updates</td>
<td>No timers are set or cancelled.</td>
</tr>
</tbody>
</table>
</details>
<h3 id="doconnectidentity"><code>DoConnectIdentity</code><a class="headerlink" href="#doconnectidentity" title="Permanent link">&para;</a></h3>
<div class="admonition quote">
<p>DoConnectIdentity {
  externalIdentity : EngineID;
  backend : Backend;
  capabilities : Capabilities
}</p>
</div>
<p>This action label corresponds to connecting to an existing identity.</p>
<details class="quote">
<summary><code>DoConnectIdentity</code> action effect</summary>
<p>This action does the following:</p>
<table>
<thead>
<tr>
<th>Aspect</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>State update</td>
<td>If successful, a new entry is added to the <code>identities</code> map in the local state, copying the the external identity's information to the requesting identity, filtered by the requested capabilities.</td>
</tr>
<tr>
<td>Messages to be sent</td>
<td>A <code>ConnectIdentityResponse</code> message is sent to the requester, confirming the connection and providing references to relevant engines, or an error message if the connection fails (e.g., identity already exists, external identity not found, or requested capabilities not available).</td>
</tr>
<tr>
<td>Engines to be spawned</td>
<td>No new engines are spawned. The action reuses existing engine references from the external identity.</td>
</tr>
<tr>
<td>Timer updates</td>
<td>No timers are set or cancelled.</td>
</tr>
</tbody>
</table>
</details>
<h3 id="dodeleteidentity"><code>DoDeleteIdentity</code><a class="headerlink" href="#dodeleteidentity" title="Permanent link">&para;</a></h3>
<div class="admonition quote">
<p>DoDeleteIdentity {
  externalIdentity : EngineID;
  backend : Backend
}</p>
</div>
<p>This action label corresponds to deleting an existing identity.</p>
<details class="quote">
<summary><code>DoDeleteIdentity</code> action effect</summary>
<p>This action does the following:</p>
<table>
<thead>
<tr>
<th>Aspect</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>State update</td>
<td>The specified identity is removed from the <code>identities</code> map in the local state if it exists.</td>
</tr>
<tr>
<td>Messages to be sent</td>
<td>A <code>DeleteIdentityResponse</code> message is sent to the requester, confirming the deletion or providing an error message if the identity doesn't exist.</td>
</tr>
<tr>
<td>Engines to be spawned</td>
<td>No engines are spawned by this action.</td>
</tr>
<tr>
<td>Timer updates</td>
<td>No timers are set or cancelled.</td>
</tr>
</tbody>
</table>
</details>
<h2 id="matchable-arguments">Matchable arguments<a class="headerlink" href="#matchable-arguments" title="Permanent link">&para;</a></h2>
<!-- --8<-- [start:identity-management-matchable-argument] -->

<pre class="highlight"><code class="juvix"><pre class="src-content"><span class="ju-keyword">type</span> <span id="arch.node.engines.identity_management_behaviour:5"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:5" class="ju-code-link ju-inductive"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:5" class="ju-code-link ju-inductive"><span class="ju-inductive">IdentityManagementMatchableArgument</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>  <span id="arch.node.engines.identity_management_behaviour:6"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:6" class="ju-code-link ju-constructor"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:6" class="ju-code-link ju-constructor"><span class="ju-constructor">MessageFrom</span></a></span></a></span></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:22" class="ju-code-link ju-var"><span class="ju-inductive"><span class="ju-delimiter">(</span>Option</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/identities.html#arch.node.types.identities:18" class="ju-code-link ju-function"><span class="ju-function">EngineID</span></a></span><span class="ju-delimiter">)</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:22" class="ju-code-link ju-var"><span class="ju-inductive"><span class="ju-delimiter">(</span>Option</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/messages.html#arch.node.types.messages:1" class="ju-code-link ju-var"><span class="ju-inductive">MailboxID</span></a></span><span class="ju-delimiter">)</span><span class="ju-delimiter">;</span></pre></code></pre>
<!-- --8<-- [end:identity-management-matchable-argument] -->

<h3 id="messagefrom"><code>MessageFrom</code><a class="headerlink" href="#messagefrom" title="Permanent link">&para;</a></h3>
<div class="admonition quote">
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-0-1">MessageFrom (Option EngineID) (Option MailboxID)
</span></code></pre></div>
</div>
<p>This matchable argument contains the address and mailbox ID of where the response message should be sent.</p>
<h2 id="precomputation-results">Precomputation results<a class="headerlink" href="#precomputation-results" title="Permanent link">&para;</a></h2>
<p>The Identity Management Engine does not require any non-trivial pre-computations.</p>
<!-- --8<-- [start:identity-management-precomputation-entry] -->
<pre class="highlight"><code class="juvix"><pre class="src-content"><span class="ju-keyword">syntax</span> <span class="ju-keyword">alias</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:7" class="ju-code-link ju-var"><span class="ju-var">IdentityManagementPrecomputation</span></a></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/Stdlib/Data/Unit.html#Stdlib.Data.Unit:1" class="ju-code-link ju-inductive"><span class="ju-inductive">Unit</span></a></span><span class="ju-delimiter">;</span></pre></code></pre>
<!-- --8<-- [end:identity-management-precomputation-entry] -->

<h2 id="guards">Guards<a class="headerlink" href="#guards" title="Permanent link">&para;</a></h2>
<details class="quote">
<summary>Auxiliary Juvix code</summary>
<p>Type alias for the guard.</p>
<p><pre class="highlight"><code class="juvix"><pre class="src-content"><span id="arch.node.engines.identity_management_behaviour:18"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:18" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:18" class="ju-code-link ju-function"><span class="ju-function">IdentityManagementGuard</span></a></span></a></span></span> <span class="ju-keyword">:</span> <span class="ju-keyword">Type</span> <span class="ju-keyword">:=</span><br/>  <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/engine_behaviour.html#arch.node.types.engine_behaviour:13" class="ju-code-link ju-function"><span class="ju-function">Guard</span></a></span><br/>    <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_environment.html#arch.node.engines.identity_management_environment:4" class="ju-code-link ju-inductive"><span class="ju-inductive">IdentityManagementLocalState</span></a></span><br/>    <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_environment.html#arch.node.engines.identity_management_environment:1" class="ju-code-link ju-var"><span class="ju-inductive">IdentityManagementMailboxState</span></a></span><br/>    <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_environment.html#arch.node.engines.identity_management_environment:6" class="ju-code-link ju-var"><span class="ju-inductive">IdentityManagementTimerHandle</span></a></span><br/>    <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:5" class="ju-code-link ju-inductive"><span class="ju-inductive">IdentityManagementMatchableArgument</span></a></span><br/>    <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:1" class="ju-code-link ju-inductive"><span class="ju-inductive">IdentityManagementActionLabel</span></a></span><br/>    <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:7" class="ju-code-link ju-var"><span class="ju-inductive">IdentityManagementPrecomputation</span></a></span><span class="ju-delimiter">;</span><br/><br/><span id="arch.node.engines.identity_management_behaviour:19"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:19" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:19" class="ju-code-link ju-function"><span class="ju-function">IdentityManagementGuardOutput</span></a></span></a></span></span> <span class="ju-keyword">:</span> <span class="ju-keyword">Type</span> <span class="ju-keyword">:=</span><br/>  <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/engine_behaviour.html#arch.node.types.engine_behaviour:1" class="ju-code-link ju-inductive"><span class="ju-inductive">GuardOutput</span></a></span><br/>    <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:5" class="ju-code-link ju-inductive"><span class="ju-inductive">IdentityManagementMatchableArgument</span></a></span><br/>    <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:1" class="ju-code-link ju-inductive"><span class="ju-inductive">IdentityManagementActionLabel</span></a></span><br/>    <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:7" class="ju-code-link ju-var"><span class="ju-inductive">IdentityManagementPrecomputation</span></a></span><span class="ju-delimiter">;</span></pre></code></pre></p>
</details>
<h3 id="generateidentityguard"><code>generateIdentityGuard</code><a class="headerlink" href="#generateidentityguard" title="Permanent link">&para;</a></h3>
<figure>
<pre class="mermaid"><code>flowchart TD
    C{GenerateIdentityRequest&lt;br&gt;received?}
    C --&gt;|Yes| D[enabled]
    C --&gt;|No| E[not enabled]
    D --&gt; F([DoGenerateIdentity])</code></pre>
<figcaption>generateIdentityGuard flowchart</figcaption>
</figure>
<!-- --8<-- [start:generate-identity-guard] -->
<pre class="highlight"><code class="juvix"><pre class="src-content"><span id="arch.node.engines.identity_management_behaviour:20"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:20" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:20" class="ju-code-link ju-function"><span class="ju-function">generateIdentityGuard</span></a></span></a></span></span><br/>  <span class="ju-delimiter">(</span><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:36" class="ju-code-link ju-var"><span class="ju-var">t</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/messages.html#arch.node.types.messages:40" class="ju-code-link ju-inductive"><span class="ju-inductive">TimestampedTrigger</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_environment.html#arch.node.engines.identity_management_environment:6" class="ju-code-link ju-var"><span class="ju-inductive">IdentityManagementTimerHandle</span></a></span><span class="ju-delimiter">)</span><br/>  <span class="ju-delimiter">(</span><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:37" class="ju-code-link ju-var"><span class="ju-var">env</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_environment.html#arch.node.engines.identity_management_environment:23" class="ju-code-link ju-function"><span class="ju-function">IdentityManagementEnvironment</span></a></span><span class="ju-delimiter">)</span><br/>  <span class="ju-keyword">:</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:22" class="ju-code-link ju-var"><span class="ju-inductive">Option</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:19" class="ju-code-link ju-function"><span class="ju-function">IdentityManagementGuardOutput</span></a></span> <span class="ju-keyword">:=</span><br/>  <span class="ju-keyword">case</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/messages.html#arch.node.types.messages:54" class="ju-code-link ju-function"><span class="ju-function">getMessageFromTimestampedTrigger</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:36" class="ju-code-link ju-var"><span class="ju-var">t</span></a></span> <span class="ju-keyword">of</span><br/>    <span class="ju-keyword">|</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:23" class="ju-code-link ju-var"><span class="ju-constructor">some</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/anoma_message.html#arch.node.types.anoma_message:3" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>MsgIdentityManagement</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_messages.html#arch.node.engines.identity_management_messages:2" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>GenerateIdentityRequest</span></a></span> <span id="arch.node.engines.identity_management_behaviour:38"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:38" class="ju-code-link ju-var"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:38" class="ju-code-link ju-var"><span class="ju-var">x</span></a></span></a></span></span> <span id="arch.node.engines.identity_management_behaviour:39"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:39" class="ju-code-link ju-var"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:39" class="ju-code-link ju-var"><span class="ju-var">y</span></a></span></a></span></span> <span id="arch.node.engines.identity_management_behaviour:40"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:40" class="ju-code-link ju-var"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:40" class="ju-code-link ju-var"><span class="ju-var">z</span></a></span></a></span></span><span class="ju-delimiter">)</span><span class="ju-delimiter">)</span> <span class="ju-keyword">:=</span><br/>      <span class="ju-keyword">do</span> <span class="ju-delimiter">{</span><br/>        <span id="arch.node.engines.identity_management_behaviour:41"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:41" class="ju-code-link ju-var"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:41" class="ju-code-link ju-var"><span class="ju-var">sender</span></a></span></a></span></span> <span class="ju-keyword">&lt;-</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/messages.html#arch.node.types.messages:55" class="ju-code-link ju-function"><span class="ju-function">getSenderFromTimestampedTrigger</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:36" class="ju-code-link ju-var"><span class="ju-var">t</span></a></span><span class="ju-delimiter">;</span><br/>        <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:53" class="ju-code-link ju-function"><span class="ju-function">pure</span></a></span><br/>          <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/engine_behaviour.html#arch.node.types.engine_behaviour:2" class="ju-code-link ju-constructor"><span class="ju-constructor">mkGuardOutput</span></a></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span><br/>            <span id="arch.node.engines.identity_management_behaviour:42"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:42" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:42" class="ju-code-link ju-function"><span class="ju-function">matchedArgs</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="ju-keyword">[</span><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:6" class="ju-code-link ju-constructor"><span class="ju-constructor">MessageFrom</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:23" class="ju-code-link ju-var"><span class="ju-constructor"><span class="ju-delimiter">(</span>some</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:41" class="ju-code-link ju-var"><span class="ju-var">sender</span></a></span><span class="ju-delimiter">)</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:24" class="ju-code-link ju-var"><span class="ju-constructor">none</span></a></span><span class="ju-keyword">]</span><span class="ju-delimiter">;</span><br/>            <span id="arch.node.engines.identity_management_behaviour:43"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:43" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:43" class="ju-code-link ju-function"><span class="ju-function">actionLabel</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:2" class="ju-code-link ju-constructor"><span class="ju-constructor">DoGenerateIdentity</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:38" class="ju-code-link ju-var"><span class="ju-var">x</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:39" class="ju-code-link ju-var"><span class="ju-var">y</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:40" class="ju-code-link ju-var"><span class="ju-var">z</span></a></span><span class="ju-delimiter">;</span><br/>            <span id="arch.node.engines.identity_management_behaviour:44"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:44" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:44" class="ju-code-link ju-function"><span class="ju-function">precomputationTasks</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/Stdlib/Data/Unit.html#Stdlib.Data.Unit:2" class="ju-code-link ju-constructor"><span class="ju-constructor">unit</span></a></span><br/>          <span class="ju-delimiter">}</span><span class="ju-delimiter">;</span><br/>      <span class="ju-delimiter">}</span><br/>    <span class="ju-keyword">|</span> <span class="ju-keyword">_</span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:24" class="ju-code-link ju-var"><span class="ju-constructor">none</span></a></span><span class="ju-delimiter">;</span></pre></code></pre>
<!-- --8<-- [end:generate-identity-guard] -->

<h3 id="connectidentityguard"><code>connectIdentityGuard</code><a class="headerlink" href="#connectidentityguard" title="Permanent link">&para;</a></h3>
<figure>
<pre class="mermaid"><code>flowchart TD
    C{ConnectIdentityRequest&lt;br&gt;received?}
    C --&gt;|Yes| D[enabled]
    C --&gt;|No| E[not enabled]
    D --&gt; F([DoConnectIdentity])</code></pre>
<figcaption>connectIdentityGuard flowchart</figcaption>
</figure>
<!-- --8<-- [start:connect-identity-guard] -->
<pre class="highlight"><code class="juvix"><pre class="src-content"><span id="arch.node.engines.identity_management_behaviour:21"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:21" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:21" class="ju-code-link ju-function"><span class="ju-function">connectIdentityGuard</span></a></span></a></span></span><br/>  <span class="ju-delimiter">(</span><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:45" class="ju-code-link ju-var"><span class="ju-var">t</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/messages.html#arch.node.types.messages:40" class="ju-code-link ju-inductive"><span class="ju-inductive">TimestampedTrigger</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_environment.html#arch.node.engines.identity_management_environment:6" class="ju-code-link ju-var"><span class="ju-inductive">IdentityManagementTimerHandle</span></a></span><span class="ju-delimiter">)</span><br/>  <span class="ju-delimiter">(</span><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:46" class="ju-code-link ju-var"><span class="ju-var">env</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_environment.html#arch.node.engines.identity_management_environment:23" class="ju-code-link ju-function"><span class="ju-function">IdentityManagementEnvironment</span></a></span><span class="ju-delimiter">)</span><br/>  <span class="ju-keyword">:</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:22" class="ju-code-link ju-var"><span class="ju-inductive">Option</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:19" class="ju-code-link ju-function"><span class="ju-function">IdentityManagementGuardOutput</span></a></span> <span class="ju-keyword">:=</span><br/>  <span class="ju-keyword">case</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/messages.html#arch.node.types.messages:54" class="ju-code-link ju-function"><span class="ju-function">getMessageFromTimestampedTrigger</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:45" class="ju-code-link ju-var"><span class="ju-var">t</span></a></span> <span class="ju-keyword">of</span><br/>    <span class="ju-keyword">|</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:23" class="ju-code-link ju-var"><span class="ju-constructor">some</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/anoma_message.html#arch.node.types.anoma_message:3" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>MsgIdentityManagement</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_messages.html#arch.node.engines.identity_management_messages:4" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>ConnectIdentityRequest</span></a></span> <span id="arch.node.engines.identity_management_behaviour:47"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:47" class="ju-code-link ju-var"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:47" class="ju-code-link ju-var"><span class="ju-var">x</span></a></span></a></span></span> <span id="arch.node.engines.identity_management_behaviour:48"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:48" class="ju-code-link ju-var"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:48" class="ju-code-link ju-var"><span class="ju-var">y</span></a></span></a></span></span> <span id="arch.node.engines.identity_management_behaviour:49"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:49" class="ju-code-link ju-var"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:49" class="ju-code-link ju-var"><span class="ju-var">z</span></a></span></a></span></span><span class="ju-delimiter">)</span><span class="ju-delimiter">)</span> <span class="ju-keyword">:=</span><br/>      <span class="ju-keyword">do</span> <span class="ju-delimiter">{</span><br/>        <span id="arch.node.engines.identity_management_behaviour:50"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:50" class="ju-code-link ju-var"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:50" class="ju-code-link ju-var"><span class="ju-var">sender</span></a></span></a></span></span> <span class="ju-keyword">&lt;-</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/messages.html#arch.node.types.messages:55" class="ju-code-link ju-function"><span class="ju-function">getSenderFromTimestampedTrigger</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:45" class="ju-code-link ju-var"><span class="ju-var">t</span></a></span><span class="ju-delimiter">;</span><br/>        <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:53" class="ju-code-link ju-function"><span class="ju-function">pure</span></a></span><br/>          <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/engine_behaviour.html#arch.node.types.engine_behaviour:2" class="ju-code-link ju-constructor"><span class="ju-constructor">mkGuardOutput</span></a></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span><br/>            <span id="arch.node.engines.identity_management_behaviour:51"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:51" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:51" class="ju-code-link ju-function"><span class="ju-function">matchedArgs</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="ju-keyword">[</span><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:6" class="ju-code-link ju-constructor"><span class="ju-constructor">MessageFrom</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:23" class="ju-code-link ju-var"><span class="ju-constructor"><span class="ju-delimiter">(</span>some</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:50" class="ju-code-link ju-var"><span class="ju-var">sender</span></a></span><span class="ju-delimiter">)</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:24" class="ju-code-link ju-var"><span class="ju-constructor">none</span></a></span><span class="ju-keyword">]</span><span class="ju-delimiter">;</span><br/>            <span id="arch.node.engines.identity_management_behaviour:52"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:52" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:52" class="ju-code-link ju-function"><span class="ju-function">actionLabel</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:3" class="ju-code-link ju-constructor"><span class="ju-constructor">DoConnectIdentity</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:47" class="ju-code-link ju-var"><span class="ju-var">x</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:48" class="ju-code-link ju-var"><span class="ju-var">y</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:49" class="ju-code-link ju-var"><span class="ju-var">z</span></a></span><span class="ju-delimiter">;</span><br/>            <span id="arch.node.engines.identity_management_behaviour:53"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:53" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:53" class="ju-code-link ju-function"><span class="ju-function">precomputationTasks</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/Stdlib/Data/Unit.html#Stdlib.Data.Unit:2" class="ju-code-link ju-constructor"><span class="ju-constructor">unit</span></a></span><br/>          <span class="ju-delimiter">}</span><span class="ju-delimiter">;</span><br/>      <span class="ju-delimiter">}</span><br/>    <span class="ju-keyword">|</span> <span class="ju-keyword">_</span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:24" class="ju-code-link ju-var"><span class="ju-constructor">none</span></a></span><span class="ju-delimiter">;</span></pre></code></pre>
<!-- --8<-- [end:connect-identity-guard] -->

<h3 id="deleteidentityguard"><code>deleteIdentityGuard</code><a class="headerlink" href="#deleteidentityguard" title="Permanent link">&para;</a></h3>
<figure>
<pre class="mermaid"><code>flowchart TD
    C{DeleteIdentityRequest&lt;br&gt;received?}
    C --&gt;|Yes| D[enabled]
    C --&gt;|No| E[not enabled]
    D --&gt; F([DoDeleteIdentity])</code></pre>
<figcaption>deleteIdentityGuard flowchart</figcaption>
</figure>
<!-- --8<-- [start:delete-identity-guard] -->
<pre class="highlight"><code class="juvix"><pre class="src-content"><span id="arch.node.engines.identity_management_behaviour:22"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:22" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:22" class="ju-code-link ju-function"><span class="ju-function">deleteIdentityGuard</span></a></span></a></span></span><br/>  <span class="ju-delimiter">(</span><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:54" class="ju-code-link ju-var"><span class="ju-var">t</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/messages.html#arch.node.types.messages:40" class="ju-code-link ju-inductive"><span class="ju-inductive">TimestampedTrigger</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_environment.html#arch.node.engines.identity_management_environment:6" class="ju-code-link ju-var"><span class="ju-inductive">IdentityManagementTimerHandle</span></a></span><span class="ju-delimiter">)</span><br/>  <span class="ju-delimiter">(</span><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:55" class="ju-code-link ju-var"><span class="ju-var">env</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_environment.html#arch.node.engines.identity_management_environment:23" class="ju-code-link ju-function"><span class="ju-function">IdentityManagementEnvironment</span></a></span><span class="ju-delimiter">)</span><br/>  <span class="ju-keyword">:</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:22" class="ju-code-link ju-var"><span class="ju-inductive">Option</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:19" class="ju-code-link ju-function"><span class="ju-function">IdentityManagementGuardOutput</span></a></span> <span class="ju-keyword">:=</span><br/>  <span class="ju-keyword">case</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/messages.html#arch.node.types.messages:54" class="ju-code-link ju-function"><span class="ju-function">getMessageFromTimestampedTrigger</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:54" class="ju-code-link ju-var"><span class="ju-var">t</span></a></span> <span class="ju-keyword">of</span><br/>    <span class="ju-keyword">|</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:23" class="ju-code-link ju-var"><span class="ju-constructor">some</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/anoma_message.html#arch.node.types.anoma_message:3" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>MsgIdentityManagement</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_messages.html#arch.node.engines.identity_management_messages:6" class="ju-code-link ju-constructor"><span class="ju-constructor"><span class="ju-delimiter">(</span>DeleteIdentityRequest</span></a></span> <span id="arch.node.engines.identity_management_behaviour:56"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:56" class="ju-code-link ju-var"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:56" class="ju-code-link ju-var"><span class="ju-var">x</span></a></span></a></span></span> <span id="arch.node.engines.identity_management_behaviour:57"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:57" class="ju-code-link ju-var"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:57" class="ju-code-link ju-var"><span class="ju-var">y</span></a></span></a></span></span><span class="ju-delimiter">)</span><span class="ju-delimiter">)</span> <span class="ju-keyword">:=</span><br/>      <span class="ju-keyword">do</span> <span class="ju-delimiter">{</span><br/>        <span id="arch.node.engines.identity_management_behaviour:58"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:58" class="ju-code-link ju-var"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:58" class="ju-code-link ju-var"><span class="ju-var">sender</span></a></span></a></span></span> <span class="ju-keyword">&lt;-</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/messages.html#arch.node.types.messages:55" class="ju-code-link ju-function"><span class="ju-function">getSenderFromTimestampedTrigger</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:54" class="ju-code-link ju-var"><span class="ju-var">t</span></a></span><span class="ju-delimiter">;</span><br/>        <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:53" class="ju-code-link ju-function"><span class="ju-function">pure</span></a></span><br/>          <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/engine_behaviour.html#arch.node.types.engine_behaviour:2" class="ju-code-link ju-constructor"><span class="ju-constructor">mkGuardOutput</span></a></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span><br/>            <span id="arch.node.engines.identity_management_behaviour:59"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:59" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:59" class="ju-code-link ju-function"><span class="ju-function">matchedArgs</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="ju-keyword">[</span><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:6" class="ju-code-link ju-constructor"><span class="ju-constructor">MessageFrom</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:23" class="ju-code-link ju-var"><span class="ju-constructor"><span class="ju-delimiter">(</span>some</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:58" class="ju-code-link ju-var"><span class="ju-var">sender</span></a></span><span class="ju-delimiter">)</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:24" class="ju-code-link ju-var"><span class="ju-constructor">none</span></a></span><span class="ju-keyword">]</span><span class="ju-delimiter">;</span><br/>            <span id="arch.node.engines.identity_management_behaviour:60"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:60" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:60" class="ju-code-link ju-function"><span class="ju-function">actionLabel</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:4" class="ju-code-link ju-constructor"><span class="ju-constructor">DoDeleteIdentity</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:56" class="ju-code-link ju-var"><span class="ju-var">x</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:57" class="ju-code-link ju-var"><span class="ju-var">y</span></a></span><span class="ju-delimiter">;</span><br/>            <span id="arch.node.engines.identity_management_behaviour:61"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:61" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:61" class="ju-code-link ju-function"><span class="ju-function">precomputationTasks</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/Stdlib/Data/Unit.html#Stdlib.Data.Unit:2" class="ju-code-link ju-constructor"><span class="ju-constructor">unit</span></a></span><br/>          <span class="ju-delimiter">}</span><span class="ju-delimiter">;</span><br/>      <span class="ju-delimiter">}</span><br/>    <span class="ju-keyword">|</span> <span class="ju-keyword">_</span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:24" class="ju-code-link ju-var"><span class="ju-constructor">none</span></a></span><span class="ju-delimiter">;</span></pre></code></pre>
<!-- --8<-- [end:delete-identity-guard] -->

<h2 id="action-function">Action function<a class="headerlink" href="#action-function" title="Permanent link">&para;</a></h2>
<details class="quote">
<summary>Auxiliary Juvix code</summary>
<p>Type alias for the action function.</p>
<p><pre class="highlight"><code class="juvix"><pre class="src-content"><span id="arch.node.engines.identity_management_behaviour:23"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:23" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:23" class="ju-code-link ju-function"><span class="ju-function">IdentityManagementActionInput</span></a></span></a></span></span> <span class="ju-keyword">:</span> <span class="ju-keyword">Type</span> <span class="ju-keyword">:=</span><br/>  <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/engine_behaviour.html#arch.node.types.engine_behaviour:14" class="ju-code-link ju-inductive"><span class="ju-inductive">ActionInput</span></a></span><br/>    <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_environment.html#arch.node.engines.identity_management_environment:4" class="ju-code-link ju-inductive"><span class="ju-inductive">IdentityManagementLocalState</span></a></span><br/>    <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_environment.html#arch.node.engines.identity_management_environment:1" class="ju-code-link ju-var"><span class="ju-inductive">IdentityManagementMailboxState</span></a></span><br/>    <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_environment.html#arch.node.engines.identity_management_environment:6" class="ju-code-link ju-var"><span class="ju-inductive">IdentityManagementTimerHandle</span></a></span><br/>    <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:5" class="ju-code-link ju-inductive"><span class="ju-inductive">IdentityManagementMatchableArgument</span></a></span><br/>    <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:1" class="ju-code-link ju-inductive"><span class="ju-inductive">IdentityManagementActionLabel</span></a></span><br/>    <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:7" class="ju-code-link ju-var"><span class="ju-inductive">IdentityManagementPrecomputation</span></a></span><span class="ju-delimiter">;</span><br/><br/><span id="arch.node.engines.identity_management_behaviour:24"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:24" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:24" class="ju-code-link ju-function"><span class="ju-function">IdentityManagementActionEffect</span></a></span></a></span></span> <span class="ju-keyword">:</span> <span class="ju-keyword">Type</span> <span class="ju-keyword">:=</span><br/>  <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/engine_behaviour.html#arch.node.types.engine_behaviour:40" class="ju-code-link ju-inductive"><span class="ju-inductive">ActionEffect</span></a></span><br/>    <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_environment.html#arch.node.engines.identity_management_environment:4" class="ju-code-link ju-inductive"><span class="ju-inductive">IdentityManagementLocalState</span></a></span><br/>    <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_environment.html#arch.node.engines.identity_management_environment:1" class="ju-code-link ju-var"><span class="ju-inductive">IdentityManagementMailboxState</span></a></span><br/>    <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_environment.html#arch.node.engines.identity_management_environment:6" class="ju-code-link ju-var"><span class="ju-inductive">IdentityManagementTimerHandle</span></a></span><br/>    <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:5" class="ju-code-link ju-inductive"><span class="ju-inductive">IdentityManagementMatchableArgument</span></a></span><br/>    <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:1" class="ju-code-link ju-inductive"><span class="ju-inductive">IdentityManagementActionLabel</span></a></span><br/>    <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:7" class="ju-code-link ju-var"><span class="ju-inductive">IdentityManagementPrecomputation</span></a></span><span class="ju-delimiter">;</span></pre></code></pre></p>
</details>
<!-- --8<-- [start:action-function] -->
<pre class="highlight"><code class="juvix"><pre class="src-content"><span id="arch.node.engines.identity_management_behaviour:25"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:25" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:25" class="ju-code-link ju-function"><span class="ju-function">makeDecryptEnv</span></a></span></a></span></span><br/>  <span class="ju-delimiter">(</span><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:62" class="ju-code-link ju-var"><span class="ju-var">env</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_environment.html#arch.node.engines.identity_management_environment:23" class="ju-code-link ju-function"><span class="ju-function">IdentityManagementEnvironment</span></a></span><span class="ju-delimiter">)</span><br/>  <span class="ju-delimiter">(</span><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:63" class="ju-code-link ju-var"><span class="ju-var">backend&#39;</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/identities.html#arch.node.types.identities:30" class="ju-code-link ju-inductive"><span class="ju-inductive">Backend</span></a></span><span class="ju-delimiter">)</span><br/>  <span class="ju-delimiter">(</span><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:64" class="ju-code-link ju-var"><span class="ju-var">addr</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/identities.html#arch.node.types.identities:18" class="ju-code-link ju-function"><span class="ju-function">EngineID</span></a></span><span class="ju-delimiter">)</span><br/>  <span class="ju-keyword">:</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/decryption_environment.html#arch.node.engines.decryption_environment:10" class="ju-code-link ju-function"><span class="ju-function">DecryptionEnvironment</span></a></span> <span class="ju-keyword">:=</span><br/>  <span class="ju-keyword">let</span><br/>    <span id="arch.node.engines.identity_management_behaviour:65"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:65" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:65" class="ju-code-link ju-function"><span class="ju-function">local</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/engine_environment.html#arch.node.types.engine_environment:12" class="ju-code-link ju-function"><span class="ju-function">EngineEnvironment<span class="ju-delimiter">.</span>localState</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:62" class="ju-code-link ju-var"><span class="ju-var">env</span></a></span><span class="ju-delimiter">;</span><br/>  <span class="ju-keyword">in</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/engine_environment.html#arch.node.types.engine_environment:2" class="ju-code-link ju-constructor"><span class="ju-constructor">mkEngineEnvironment</span></a></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span><br/>    <span id="arch.node.engines.identity_management_behaviour:66"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:66" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:66" class="ju-code-link ju-function"><span class="ju-function">name</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/identities.html#arch.node.types.identities:23" class="ju-code-link ju-function"><span class="ju-function">nameGen</span></a></span> <span class="ju-string">&quot;decryptor&quot;</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/engine_environment.html#arch.node.types.engine_environment:11" class="ju-code-link ju-function"><span class="ju-function"><span class="ju-delimiter">(</span>EngineEnvironment<span class="ju-delimiter">.</span>name</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:62" class="ju-code-link ju-var"><span class="ju-var">env</span></a></span><span class="ju-delimiter">)</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:64" class="ju-code-link ju-var"><span class="ju-var">addr</span></a></span><span class="ju-delimiter">;</span><br/>    <span id="arch.node.engines.identity_management_behaviour:67"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:67" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:67" class="ju-code-link ju-function"><span class="ju-function">localState</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>      <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/decryption_environment.html#arch.node.engines.decryption_environment:3" class="ju-code-link ju-constructor"><span class="ju-constructor">mkDecryptionLocalState</span></a></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span><br/>        <span id="arch.node.engines.identity_management_behaviour:71"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:71" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:71" class="ju-code-link ju-function"><span class="ju-function">decryptor</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_environment.html#arch.node.engines.identity_management_environment:20" class="ju-code-link ju-function"><span class="ju-function">IdentityManagementLocalState<span class="ju-delimiter">.</span>genDecryptor</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:65" class="ju-code-link ju-function"><span class="ju-function">local</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:63" class="ju-code-link ju-var"><span class="ju-var">backend&#39;</span></a></span><span class="ju-delimiter">;</span><br/>        <span id="arch.node.engines.identity_management_behaviour:72"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:72" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:72" class="ju-code-link ju-function"><span class="ju-function">backend</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:63" class="ju-code-link ju-var"><span class="ju-var">backend&#39;</span></a></span><br/>      <span class="ju-delimiter">}</span><span class="ju-delimiter">;</span><br/>    <span id="arch.node.engines.identity_management_behaviour:68"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:68" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:68" class="ju-code-link ju-function"><span class="ju-function">mailboxCluster</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>      <span class="annot"><a href="https://anoma.github.io/nspec/v2/Data/Map.html#Data.Map:34" class="ju-code-link ju-function"><span class="ju-function">fromList</span></a></span><br/>        <span class="ju-keyword">[</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:5" class="ju-code-link ju-var"><span class="ju-constructor">mkPair</span></a></span><br/>          <span class="ju-number">0</span><br/>          <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/messages.html#arch.node.types.messages:6" class="ju-code-link ju-constructor"><span class="ju-constructor">mkMailbox</span></a></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span><br/>            <span id="arch.node.engines.identity_management_behaviour:73"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:73" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:73" class="ju-code-link ju-function"><span class="ju-function">messages</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="ju-keyword">[</span><span class="ju-keyword">]</span><span class="ju-delimiter">;</span><br/>            <span id="arch.node.engines.identity_management_behaviour:74"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:74" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:74" class="ju-code-link ju-function"><span class="ju-function">mailboxState</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:24" class="ju-code-link ju-var"><span class="ju-constructor">none</span></a></span><br/>          <span class="ju-delimiter">}</span><br/>        <span class="ju-keyword">]</span><span class="ju-delimiter">;</span><br/>    <span id="arch.node.engines.identity_management_behaviour:69"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:69" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:69" class="ju-code-link ju-function"><span class="ju-function">acquaintances</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/Data/Set/AVL.html#Data.Set.AVL:31" class="ju-code-link ju-function"><span class="ju-function">Set<span class="ju-delimiter">.</span>fromList</span></a></span> <span class="ju-keyword">[</span><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/identities.html#arch.node.types.identities:22" class="ju-code-link ju-function"><span class="ju-function">nameStr</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:64" class="ju-code-link ju-var"><span class="ju-var">addr</span></a></span><span class="ju-keyword">]</span><span class="ju-delimiter">;</span><br/>    <span id="arch.node.engines.identity_management_behaviour:70"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:70" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:70" class="ju-code-link ju-function"><span class="ju-function">timers</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="ju-keyword">[</span><span class="ju-keyword">]</span><br/>  <span class="ju-delimiter">}</span><span class="ju-delimiter">;</span></pre></code></pre>

<pre class="highlight"><code class="juvix"><pre class="src-content"><span id="arch.node.engines.identity_management_behaviour:26"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:26" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:26" class="ju-code-link ju-function"><span class="ju-function">makeCommitmentEnv</span></a></span></a></span></span><br/>  <span class="ju-delimiter">(</span><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:75" class="ju-code-link ju-var"><span class="ju-var">env</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_environment.html#arch.node.engines.identity_management_environment:23" class="ju-code-link ju-function"><span class="ju-function">IdentityManagementEnvironment</span></a></span><span class="ju-delimiter">)</span><br/>  <span class="ju-delimiter">(</span><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:76" class="ju-code-link ju-var"><span class="ju-var">backend&#39;</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/identities.html#arch.node.types.identities:30" class="ju-code-link ju-inductive"><span class="ju-inductive">Backend</span></a></span><span class="ju-delimiter">)</span><br/>  <span class="ju-delimiter">(</span><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:77" class="ju-code-link ju-var"><span class="ju-var">addr</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/identities.html#arch.node.types.identities:18" class="ju-code-link ju-function"><span class="ju-function">EngineID</span></a></span><span class="ju-delimiter">)</span><br/>  <span class="ju-keyword">:</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/commitment_environment.html#arch.node.engines.commitment_environment:10" class="ju-code-link ju-function"><span class="ju-function">CommitmentEnvironment</span></a></span> <span class="ju-keyword">:=</span><br/>  <span class="ju-keyword">let</span><br/>    <span id="arch.node.engines.identity_management_behaviour:78"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:78" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:78" class="ju-code-link ju-function"><span class="ju-function">local</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/engine_environment.html#arch.node.types.engine_environment:12" class="ju-code-link ju-function"><span class="ju-function">EngineEnvironment<span class="ju-delimiter">.</span>localState</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:75" class="ju-code-link ju-var"><span class="ju-var">env</span></a></span><span class="ju-delimiter">;</span><br/>  <span class="ju-keyword">in</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/engine_environment.html#arch.node.types.engine_environment:2" class="ju-code-link ju-constructor"><span class="ju-constructor">mkEngineEnvironment</span></a></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span><br/>    <span id="arch.node.engines.identity_management_behaviour:79"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:79" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:79" class="ju-code-link ju-function"><span class="ju-function">name</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/identities.html#arch.node.types.identities:23" class="ju-code-link ju-function"><span class="ju-function">nameGen</span></a></span> <span class="ju-string">&quot;committer&quot;</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/engine_environment.html#arch.node.types.engine_environment:11" class="ju-code-link ju-function"><span class="ju-function"><span class="ju-delimiter">(</span>EngineEnvironment<span class="ju-delimiter">.</span>name</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:75" class="ju-code-link ju-var"><span class="ju-var">env</span></a></span><span class="ju-delimiter">)</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:77" class="ju-code-link ju-var"><span class="ju-var">addr</span></a></span><span class="ju-delimiter">;</span><br/>    <span id="arch.node.engines.identity_management_behaviour:80"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:80" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:80" class="ju-code-link ju-function"><span class="ju-function">localState</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>      <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/commitment_environment.html#arch.node.engines.commitment_environment:3" class="ju-code-link ju-constructor"><span class="ju-constructor">mkCommitmentLocalState</span></a></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span><br/>        <span id="arch.node.engines.identity_management_behaviour:84"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:84" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:84" class="ju-code-link ju-function"><span class="ju-function">signer</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_environment.html#arch.node.engines.identity_management_environment:21" class="ju-code-link ju-function"><span class="ju-function">IdentityManagementLocalState<span class="ju-delimiter">.</span>genSigner</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:78" class="ju-code-link ju-function"><span class="ju-function">local</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:76" class="ju-code-link ju-var"><span class="ju-var">backend&#39;</span></a></span><span class="ju-delimiter">;</span><br/>        <span id="arch.node.engines.identity_management_behaviour:85"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:85" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:85" class="ju-code-link ju-function"><span class="ju-function">backend</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:76" class="ju-code-link ju-var"><span class="ju-var">backend&#39;</span></a></span><br/>      <span class="ju-delimiter">}</span><span class="ju-delimiter">;</span><br/>    <span id="arch.node.engines.identity_management_behaviour:81"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:81" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:81" class="ju-code-link ju-function"><span class="ju-function">mailboxCluster</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>      <span class="annot"><a href="https://anoma.github.io/nspec/v2/Data/Map.html#Data.Map:34" class="ju-code-link ju-function"><span class="ju-function">fromList</span></a></span><br/>        <span class="ju-keyword">[</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:5" class="ju-code-link ju-var"><span class="ju-constructor">mkPair</span></a></span><br/>          <span class="ju-number">0</span><br/>          <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/messages.html#arch.node.types.messages:6" class="ju-code-link ju-constructor"><span class="ju-constructor">mkMailbox</span></a></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span><br/>            <span id="arch.node.engines.identity_management_behaviour:86"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:86" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:86" class="ju-code-link ju-function"><span class="ju-function">messages</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="ju-keyword">[</span><span class="ju-keyword">]</span><span class="ju-delimiter">;</span><br/>            <span id="arch.node.engines.identity_management_behaviour:87"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:87" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:87" class="ju-code-link ju-function"><span class="ju-function">mailboxState</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:24" class="ju-code-link ju-var"><span class="ju-constructor">none</span></a></span><br/>          <span class="ju-delimiter">}</span><br/>        <span class="ju-keyword">]</span><span class="ju-delimiter">;</span><br/>    <span id="arch.node.engines.identity_management_behaviour:82"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:82" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:82" class="ju-code-link ju-function"><span class="ju-function">acquaintances</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/Data/Set/AVL.html#Data.Set.AVL:31" class="ju-code-link ju-function"><span class="ju-function">Set<span class="ju-delimiter">.</span>fromList</span></a></span> <span class="ju-keyword">[</span><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/identities.html#arch.node.types.identities:22" class="ju-code-link ju-function"><span class="ju-function">nameStr</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:77" class="ju-code-link ju-var"><span class="ju-var">addr</span></a></span><span class="ju-keyword">]</span><span class="ju-delimiter">;</span><br/>    <span id="arch.node.engines.identity_management_behaviour:83"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:83" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:83" class="ju-code-link ju-function"><span class="ju-function">timers</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="ju-keyword">[</span><span class="ju-keyword">]</span><br/>  <span class="ju-delimiter">}</span><span class="ju-delimiter">;</span></pre></code></pre>

<pre class="highlight"><code class="juvix"><pre class="src-content"><span id="arch.node.engines.identity_management_behaviour:27"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:27" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:27" class="ju-code-link ju-function"><span class="ju-function">hasCommitCapability</span></a></span></a></span></span> <span class="ju-delimiter">(</span><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:88" class="ju-code-link ju-var"><span class="ju-var">capabilities</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/identities.html#arch.node.types.identities:34" class="ju-code-link ju-inductive"><span class="ju-inductive">Capabilities</span></a></span><span class="ju-delimiter">)</span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/Juvix/Builtin/V1/Bool.html#Juvix.Builtin.V1.Bool:1" class="ju-code-link ju-inductive"><span class="ju-inductive">Bool</span></a></span> <span class="ju-keyword">:=</span><br/>  <span class="ju-keyword">case</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:88" class="ju-code-link ju-var"><span class="ju-var">capabilities</span></a></span> <span class="ju-keyword">of</span><br/>    <span class="ju-keyword">|</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/identities.html#arch.node.types.identities:35" class="ju-code-link ju-constructor"><span class="ju-constructor">CapabilityCommit</span></a></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/Juvix/Builtin/V1/Bool.html#Juvix.Builtin.V1.Bool:2" class="ju-code-link ju-constructor"><span class="ju-constructor">true</span></a></span><br/>    <span class="ju-keyword">|</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/identities.html#arch.node.types.identities:37" class="ju-code-link ju-constructor"><span class="ju-constructor">CapabilityCommitAndDecrypt</span></a></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/Juvix/Builtin/V1/Bool.html#Juvix.Builtin.V1.Bool:2" class="ju-code-link ju-constructor"><span class="ju-constructor">true</span></a></span><br/>    <span class="ju-keyword">|</span> <span class="ju-keyword">_</span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/Juvix/Builtin/V1/Bool.html#Juvix.Builtin.V1.Bool:3" class="ju-code-link ju-constructor"><span class="ju-constructor">false</span></a></span><span class="ju-delimiter">;</span></pre></code></pre>

<pre class="highlight"><code class="juvix"><pre class="src-content"><span id="arch.node.engines.identity_management_behaviour:28"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:28" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:28" class="ju-code-link ju-function"><span class="ju-function">hasDecryptCapability</span></a></span></a></span></span> <span class="ju-delimiter">(</span><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:89" class="ju-code-link ju-var"><span class="ju-var">capabilities</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/identities.html#arch.node.types.identities:34" class="ju-code-link ju-inductive"><span class="ju-inductive">Capabilities</span></a></span><span class="ju-delimiter">)</span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/Juvix/Builtin/V1/Bool.html#Juvix.Builtin.V1.Bool:1" class="ju-code-link ju-inductive"><span class="ju-inductive">Bool</span></a></span> <span class="ju-keyword">:=</span><br/>  <span class="ju-keyword">case</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:89" class="ju-code-link ju-var"><span class="ju-var">capabilities</span></a></span> <span class="ju-keyword">of</span><br/>    <span class="ju-keyword">|</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/identities.html#arch.node.types.identities:36" class="ju-code-link ju-constructor"><span class="ju-constructor">CapabilityDecrypt</span></a></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/Juvix/Builtin/V1/Bool.html#Juvix.Builtin.V1.Bool:2" class="ju-code-link ju-constructor"><span class="ju-constructor">true</span></a></span><br/>    <span class="ju-keyword">|</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/identities.html#arch.node.types.identities:37" class="ju-code-link ju-constructor"><span class="ju-constructor">CapabilityCommitAndDecrypt</span></a></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/Juvix/Builtin/V1/Bool.html#Juvix.Builtin.V1.Bool:2" class="ju-code-link ju-constructor"><span class="ju-constructor">true</span></a></span><br/>    <span class="ju-keyword">|</span> <span class="ju-keyword">_</span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/Juvix/Builtin/V1/Bool.html#Juvix.Builtin.V1.Bool:3" class="ju-code-link ju-constructor"><span class="ju-constructor">false</span></a></span><span class="ju-delimiter">;</span></pre></code></pre>

<pre class="highlight"><code class="juvix"><pre class="src-content"><span id="arch.node.engines.identity_management_behaviour:29"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:29" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:29" class="ju-code-link ju-function"><span class="ju-function">isSubsetCapabilities</span></a></span></a></span></span><br/>  <span class="ju-delimiter">(</span><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:90" class="ju-code-link ju-var"><span class="ju-var">requested</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/identities.html#arch.node.types.identities:34" class="ju-code-link ju-inductive"><span class="ju-inductive">Capabilities</span></a></span><span class="ju-delimiter">)</span> <span class="ju-delimiter">(</span><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:91" class="ju-code-link ju-var"><span class="ju-var">available</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/identities.html#arch.node.types.identities:34" class="ju-code-link ju-inductive"><span class="ju-inductive">Capabilities</span></a></span><span class="ju-delimiter">)</span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/Juvix/Builtin/V1/Bool.html#Juvix.Builtin.V1.Bool:1" class="ju-code-link ju-inductive"><span class="ju-inductive">Bool</span></a></span> <span class="ju-keyword">:=</span><br/>  <span class="annot"><a href="https://anoma.github.io/nspec/v2/Stdlib/Data/Bool/Base.html#Stdlib.Data.Bool.Base:1" class="ju-code-link ju-function"><span class="ju-function"><span class="ju-delimiter">(</span>not</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:27" class="ju-code-link ju-function"><span class="ju-function"><span class="ju-delimiter">(</span>hasCommitCapability</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:90" class="ju-code-link ju-var"><span class="ju-var">requested</span></a></span><span class="ju-delimiter">)</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/Stdlib/Data/Bool/Base.html#Stdlib.Data.Bool.Base:2" class="ju-code-link ju-function"><span class="ju-function">||</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:27" class="ju-code-link ju-function"><span class="ju-function">hasCommitCapability</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:91" class="ju-code-link ju-var"><span class="ju-var">available</span></a></span><span class="ju-delimiter">)</span><br/>    <span class="annot"><a href="https://anoma.github.io/nspec/v2/Stdlib/Data/Bool/Base.html#Stdlib.Data.Bool.Base:3" class="ju-code-link ju-function"><span class="ju-function">&amp;&amp;</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/Stdlib/Data/Bool/Base.html#Stdlib.Data.Bool.Base:1" class="ju-code-link ju-function"><span class="ju-function">not</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:28" class="ju-code-link ju-function"><span class="ju-function"><span class="ju-delimiter">(</span>hasDecryptCapability</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:90" class="ju-code-link ju-var"><span class="ju-var">requested</span></a></span><span class="ju-delimiter">)</span><br/>    <span class="annot"><a href="https://anoma.github.io/nspec/v2/Stdlib/Data/Bool/Base.html#Stdlib.Data.Bool.Base:2" class="ju-code-link ju-function"><span class="ju-function">||</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:28" class="ju-code-link ju-function"><span class="ju-function">hasDecryptCapability</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:91" class="ju-code-link ju-var"><span class="ju-var">available</span></a></span><span class="ju-delimiter">;</span></pre></code></pre>

<pre class="highlight"><code class="juvix"><pre class="src-content"><span id="arch.node.engines.identity_management_behaviour:30"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:30" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:30" class="ju-code-link ju-function"><span class="ju-function">updateIdentityAndSpawnEngines</span></a></span></a></span></span><br/>  <span class="ju-delimiter">(</span><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:92" class="ju-code-link ju-var"><span class="ju-var">env</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_environment.html#arch.node.engines.identity_management_environment:23" class="ju-code-link ju-function"><span class="ju-function">IdentityManagementEnvironment</span></a></span><span class="ju-delimiter">)</span><br/>  <span class="ju-delimiter">(</span><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:93" class="ju-code-link ju-var"><span class="ju-var">backend&#39;</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/identities.html#arch.node.types.identities:30" class="ju-code-link ju-inductive"><span class="ju-inductive">Backend</span></a></span><span class="ju-delimiter">)</span><br/>  <span class="ju-delimiter">(</span><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:94" class="ju-code-link ju-var"><span class="ju-var">whoAsked</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/identities.html#arch.node.types.identities:18" class="ju-code-link ju-function"><span class="ju-function">EngineID</span></a></span><span class="ju-delimiter">)</span><br/>  <span class="ju-delimiter">(</span><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:95" class="ju-code-link ju-var"><span class="ju-var">identityInfo</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_environment.html#arch.node.engines.identity_management_environment:2" class="ju-code-link ju-inductive"><span class="ju-inductive">IdentityInfo</span></a></span><span class="ju-delimiter">)</span><br/>  <span class="ju-delimiter">(</span><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:96" class="ju-code-link ju-var"><span class="ju-var">capabilities&#39;</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/identities.html#arch.node.types.identities:34" class="ju-code-link ju-inductive"><span class="ju-inductive">Capabilities</span></a></span><span class="ju-delimiter">)</span><br/>  <span class="ju-keyword">:</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/Stdlib/Data/Pair/Base.html#Stdlib.Data.Pair.Base:1" class="ju-code-link ju-inductive"><span class="ju-inductive">Pair</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_environment.html#arch.node.engines.identity_management_environment:2" class="ju-code-link ju-inductive"><span class="ju-inductive">IdentityInfo</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/Juvix/Builtin/V1/List.html#Juvix.Builtin.V1.List:1" class="ju-code-link ju-inductive"><span class="ju-inductive"><span class="ju-delimiter">(</span>List</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/anoma_environment.html#arch.node.types.anoma_environment:1" class="ju-code-link ju-inductive"><span class="ju-inductive">Env</span></a></span><span class="ju-delimiter">)</span> <span class="ju-keyword">:=</span><br/>  <span class="ju-keyword">case</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:96" class="ju-code-link ju-var"><span class="ju-var">capabilities&#39;</span></a></span> <span class="ju-keyword">of</span><br/>    <span class="ju-keyword">|</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/identities.html#arch.node.types.identities:37" class="ju-code-link ju-constructor"><span class="ju-constructor">CapabilityCommitAndDecrypt</span></a></span> <span class="ju-keyword">:=</span><br/>      <span class="ju-keyword">let</span><br/>        <span id="arch.node.engines.identity_management_behaviour:97"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:97" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:97" class="ju-code-link ju-function"><span class="ju-function">commitmentEnv</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:26" class="ju-code-link ju-function"><span class="ju-function">makeCommitmentEnv</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:92" class="ju-code-link ju-var"><span class="ju-var">env</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:93" class="ju-code-link ju-var"><span class="ju-var">backend&#39;</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:94" class="ju-code-link ju-var"><span class="ju-var">whoAsked</span></a></span><span class="ju-delimiter">;</span><br/>        <span id="arch.node.engines.identity_management_behaviour:98"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:98" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:98" class="ju-code-link ju-function"><span class="ju-function">commitmentEngineName</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/engine_environment.html#arch.node.types.engine_environment:11" class="ju-code-link ju-function"><span class="ju-function">EngineEnvironment<span class="ju-delimiter">.</span>name</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:97" class="ju-code-link ju-function"><span class="ju-function">commitmentEnv</span></a></span><span class="ju-delimiter">;</span><br/>        <span id="arch.node.engines.identity_management_behaviour:99"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:99" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:99" class="ju-code-link ju-function"><span class="ju-function">decryptionEnv</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:25" class="ju-code-link ju-function"><span class="ju-function">makeDecryptEnv</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:92" class="ju-code-link ju-var"><span class="ju-var">env</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:93" class="ju-code-link ju-var"><span class="ju-var">backend&#39;</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:94" class="ju-code-link ju-var"><span class="ju-var">whoAsked</span></a></span><span class="ju-delimiter">;</span><br/>        <span id="arch.node.engines.identity_management_behaviour:100"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:100" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:100" class="ju-code-link ju-function"><span class="ju-function">decryptionEngineName</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/engine_environment.html#arch.node.types.engine_environment:11" class="ju-code-link ju-function"><span class="ju-function">EngineEnvironment<span class="ju-delimiter">.</span>name</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:99" class="ju-code-link ju-function"><span class="ju-function">decryptionEnv</span></a></span><span class="ju-delimiter">;</span><br/>        <span id="arch.node.engines.identity_management_behaviour:101"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:101" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:101" class="ju-code-link ju-function"><span class="ju-function">spawnedEngines</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>          <span class="ju-keyword">[</span><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/anoma_environment.html#arch.node.types.anoma_environment:6" class="ju-code-link ju-constructor"><span class="ju-constructor">EnvCommitment</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:97" class="ju-code-link ju-function"><span class="ju-function">commitmentEnv</span></a></span><span class="ju-delimiter">;</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/anoma_environment.html#arch.node.types.anoma_environment:4" class="ju-code-link ju-constructor"><span class="ju-constructor">EnvDecryption</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:99" class="ju-code-link ju-function"><span class="ju-function">decryptionEnv</span></a></span><span class="ju-keyword">]</span><span class="ju-delimiter">;</span><br/>        <span id="arch.node.engines.identity_management_behaviour:102"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:102" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:102" class="ju-code-link ju-function"><span class="ju-function">updatedIdentityInfo1</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>          <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:95" class="ju-code-link ju-var"><span class="ju-var">identityInfo</span></a></span><span class="ju-keyword">@</span><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_environment.html#arch.node.engines.identity_management_environment:2" class="ju-code-link ju-inductive"><span class="ju-inductive">IdentityInfo</span></a></span><span class="ju-delimiter">{</span><br/>            commitmentEngine <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:23" class="ju-code-link ju-var"><span class="ju-constructor">some</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:5" class="ju-code-link ju-var"><span class="ju-constructor"><span class="ju-delimiter">(</span>mkPair</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:24" class="ju-code-link ju-var"><span class="ju-constructor">none</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:23" class="ju-code-link ju-var"><span class="ju-constructor"><span class="ju-delimiter">(</span>some</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:98" class="ju-code-link ju-function"><span class="ju-function">commitmentEngineName</span></a></span><span class="ju-delimiter">)</span><span class="ju-delimiter">)</span><span class="ju-delimiter">;</span><br/>            decryptionEngine <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:23" class="ju-code-link ju-var"><span class="ju-constructor">some</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:5" class="ju-code-link ju-var"><span class="ju-constructor"><span class="ju-delimiter">(</span>mkPair</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:24" class="ju-code-link ju-var"><span class="ju-constructor">none</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:23" class="ju-code-link ju-var"><span class="ju-constructor"><span class="ju-delimiter">(</span>some</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:100" class="ju-code-link ju-function"><span class="ju-function">decryptionEngineName</span></a></span><span class="ju-delimiter">)</span><span class="ju-delimiter">)</span><br/>          <span class="ju-delimiter">}</span><span class="ju-delimiter">;</span><br/>      <span class="ju-keyword">in</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:5" class="ju-code-link ju-var"><span class="ju-constructor">mkPair</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:102" class="ju-code-link ju-function"><span class="ju-function">updatedIdentityInfo1</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:101" class="ju-code-link ju-function"><span class="ju-function">spawnedEngines</span></a></span><br/>    <span class="ju-keyword">|</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/identities.html#arch.node.types.identities:35" class="ju-code-link ju-constructor"><span class="ju-constructor">CapabilityCommit</span></a></span> <span class="ju-keyword">:=</span><br/>      <span class="ju-keyword">let</span><br/>        <span id="arch.node.engines.identity_management_behaviour:107"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:107" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:107" class="ju-code-link ju-function"><span class="ju-function">commitmentEnv</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:26" class="ju-code-link ju-function"><span class="ju-function">makeCommitmentEnv</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:92" class="ju-code-link ju-var"><span class="ju-var">env</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:93" class="ju-code-link ju-var"><span class="ju-var">backend&#39;</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:94" class="ju-code-link ju-var"><span class="ju-var">whoAsked</span></a></span><span class="ju-delimiter">;</span><br/>        <span id="arch.node.engines.identity_management_behaviour:108"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:108" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:108" class="ju-code-link ju-function"><span class="ju-function">commitmentEngineName</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/engine_environment.html#arch.node.types.engine_environment:11" class="ju-code-link ju-function"><span class="ju-function">EngineEnvironment<span class="ju-delimiter">.</span>name</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:107" class="ju-code-link ju-function"><span class="ju-function">commitmentEnv</span></a></span><span class="ju-delimiter">;</span><br/>        <span id="arch.node.engines.identity_management_behaviour:109"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:109" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:109" class="ju-code-link ju-function"><span class="ju-function">spawnedEngines</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="ju-keyword">[</span><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/anoma_environment.html#arch.node.types.anoma_environment:6" class="ju-code-link ju-constructor"><span class="ju-constructor">EnvCommitment</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:107" class="ju-code-link ju-function"><span class="ju-function">commitmentEnv</span></a></span><span class="ju-keyword">]</span><span class="ju-delimiter">;</span><br/>        <span id="arch.node.engines.identity_management_behaviour:110"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:110" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:110" class="ju-code-link ju-function"><span class="ju-function">updatedIdentityInfo1</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>          <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:95" class="ju-code-link ju-var"><span class="ju-var">identityInfo</span></a></span><span class="ju-keyword">@</span><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_environment.html#arch.node.engines.identity_management_environment:2" class="ju-code-link ju-inductive"><span class="ju-inductive">IdentityInfo</span></a></span><span class="ju-delimiter">{</span>commitmentEngine <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:23" class="ju-code-link ju-var"><span class="ju-constructor">some</span></a></span><br/>            <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:5" class="ju-code-link ju-var"><span class="ju-constructor"><span class="ju-delimiter">(</span>mkPair</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:24" class="ju-code-link ju-var"><span class="ju-constructor">none</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:23" class="ju-code-link ju-var"><span class="ju-constructor"><span class="ju-delimiter">(</span>some</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:108" class="ju-code-link ju-function"><span class="ju-function">commitmentEngineName</span></a></span><span class="ju-delimiter">)</span><span class="ju-delimiter">)</span><span class="ju-delimiter">}</span><span class="ju-delimiter">;</span><br/>      <span class="ju-keyword">in</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:5" class="ju-code-link ju-var"><span class="ju-constructor">mkPair</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:110" class="ju-code-link ju-function"><span class="ju-function">updatedIdentityInfo1</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:109" class="ju-code-link ju-function"><span class="ju-function">spawnedEngines</span></a></span><br/>    <span class="ju-keyword">|</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/identities.html#arch.node.types.identities:36" class="ju-code-link ju-constructor"><span class="ju-constructor">CapabilityDecrypt</span></a></span> <span class="ju-keyword">:=</span><br/>      <span class="ju-keyword">let</span><br/>        <span id="arch.node.engines.identity_management_behaviour:115"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:115" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:115" class="ju-code-link ju-function"><span class="ju-function">decryptionEnv</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:25" class="ju-code-link ju-function"><span class="ju-function">makeDecryptEnv</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:92" class="ju-code-link ju-var"><span class="ju-var">env</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:93" class="ju-code-link ju-var"><span class="ju-var">backend&#39;</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:94" class="ju-code-link ju-var"><span class="ju-var">whoAsked</span></a></span><span class="ju-delimiter">;</span><br/>        <span id="arch.node.engines.identity_management_behaviour:116"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:116" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:116" class="ju-code-link ju-function"><span class="ju-function">decryptionEngineName</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/engine_environment.html#arch.node.types.engine_environment:11" class="ju-code-link ju-function"><span class="ju-function">EngineEnvironment<span class="ju-delimiter">.</span>name</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:115" class="ju-code-link ju-function"><span class="ju-function">decryptionEnv</span></a></span><span class="ju-delimiter">;</span><br/>        <span id="arch.node.engines.identity_management_behaviour:117"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:117" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:117" class="ju-code-link ju-function"><span class="ju-function">spawnedEngines</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="ju-keyword">[</span><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/anoma_environment.html#arch.node.types.anoma_environment:4" class="ju-code-link ju-constructor"><span class="ju-constructor">EnvDecryption</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:115" class="ju-code-link ju-function"><span class="ju-function">decryptionEnv</span></a></span><span class="ju-keyword">]</span><span class="ju-delimiter">;</span><br/>        <span id="arch.node.engines.identity_management_behaviour:118"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:118" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:118" class="ju-code-link ju-function"><span class="ju-function">updatedIdentityInfo1</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>          <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:95" class="ju-code-link ju-var"><span class="ju-var">identityInfo</span></a></span><span class="ju-keyword">@</span><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_environment.html#arch.node.engines.identity_management_environment:2" class="ju-code-link ju-inductive"><span class="ju-inductive">IdentityInfo</span></a></span><span class="ju-delimiter">{</span>decryptionEngine <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:23" class="ju-code-link ju-var"><span class="ju-constructor">some</span></a></span><br/>            <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:5" class="ju-code-link ju-var"><span class="ju-constructor"><span class="ju-delimiter">(</span>mkPair</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:24" class="ju-code-link ju-var"><span class="ju-constructor">none</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:23" class="ju-code-link ju-var"><span class="ju-constructor"><span class="ju-delimiter">(</span>some</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:116" class="ju-code-link ju-function"><span class="ju-function">decryptionEngineName</span></a></span><span class="ju-delimiter">)</span><span class="ju-delimiter">)</span><span class="ju-delimiter">}</span><span class="ju-delimiter">;</span><br/>      <span class="ju-keyword">in</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:5" class="ju-code-link ju-var"><span class="ju-constructor">mkPair</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:118" class="ju-code-link ju-function"><span class="ju-function">updatedIdentityInfo1</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:117" class="ju-code-link ju-function"><span class="ju-function">spawnedEngines</span></a></span><span class="ju-delimiter">;</span></pre></code></pre>

<pre class="highlight"><code class="juvix"><pre class="src-content"><span id="arch.node.engines.identity_management_behaviour:31"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:31" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:31" class="ju-code-link ju-function"><span class="ju-function">copyEnginesForCapabilities</span></a></span></a></span></span><br/>  <span class="ju-delimiter">(</span><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:123" class="ju-code-link ju-var"><span class="ju-var">env</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_environment.html#arch.node.engines.identity_management_environment:23" class="ju-code-link ju-function"><span class="ju-function">IdentityManagementEnvironment</span></a></span><span class="ju-delimiter">)</span><br/>  <span class="ju-delimiter">(</span><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:124" class="ju-code-link ju-var"><span class="ju-var">whoAsked</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/identities.html#arch.node.types.identities:18" class="ju-code-link ju-function"><span class="ju-function">EngineID</span></a></span><span class="ju-delimiter">)</span><br/>  <span class="ju-delimiter">(</span><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:125" class="ju-code-link ju-var"><span class="ju-var">externalIdentityInfo</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_environment.html#arch.node.engines.identity_management_environment:2" class="ju-code-link ju-inductive"><span class="ju-inductive">IdentityInfo</span></a></span><span class="ju-delimiter">)</span><br/>  <span class="ju-delimiter">(</span><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:126" class="ju-code-link ju-var"><span class="ju-var">requestedCapabilities</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/identities.html#arch.node.types.identities:34" class="ju-code-link ju-inductive"><span class="ju-inductive">Capabilities</span></a></span><span class="ju-delimiter">)</span><br/>  <span class="ju-keyword">:</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_environment.html#arch.node.engines.identity_management_environment:2" class="ju-code-link ju-inductive"><span class="ju-inductive">IdentityInfo</span></a></span> <span class="ju-keyword">:=</span><br/>  <span class="ju-keyword">let</span><br/>    <span id="arch.node.engines.identity_management_behaviour:127"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:127" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:127" class="ju-code-link ju-function"><span class="ju-function">newIdentityInfo</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>      <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_environment.html#arch.node.engines.identity_management_environment:3" class="ju-code-link ju-constructor"><span class="ju-constructor">mkIdentityInfo</span></a></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span><br/>        <span id="arch.node.engines.identity_management_behaviour:128"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:128" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:128" class="ju-code-link ju-function"><span class="ju-function">backend</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_environment.html#arch.node.engines.identity_management_environment:14" class="ju-code-link ju-function"><span class="ju-function">IdentityInfo<span class="ju-delimiter">.</span>backend</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:125" class="ju-code-link ju-var"><span class="ju-var">externalIdentityInfo</span></a></span><span class="ju-delimiter">;</span><br/>        <span id="arch.node.engines.identity_management_behaviour:129"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:129" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:129" class="ju-code-link ju-function"><span class="ju-function">capabilities</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:126" class="ju-code-link ju-var"><span class="ju-var">requestedCapabilities</span></a></span><span class="ju-delimiter">;</span><br/>        <span id="arch.node.engines.identity_management_behaviour:130"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:130" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:130" class="ju-code-link ju-function"><span class="ju-function">commitmentEngine</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>          <span class="ju-keyword">case</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:27" class="ju-code-link ju-function"><span class="ju-function">hasCommitCapability</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:126" class="ju-code-link ju-var"><span class="ju-var">requestedCapabilities</span></a></span> <span class="ju-keyword">of</span><br/>            <span class="ju-keyword">|</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/Juvix/Builtin/V1/Bool.html#Juvix.Builtin.V1.Bool:2" class="ju-code-link ju-constructor"><span class="ju-constructor">true</span></a></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_environment.html#arch.node.engines.identity_management_environment:16" class="ju-code-link ju-function"><span class="ju-function">IdentityInfo<span class="ju-delimiter">.</span>commitmentEngine</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:125" class="ju-code-link ju-var"><span class="ju-var">externalIdentityInfo</span></a></span><br/>            <span class="ju-keyword">|</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/Juvix/Builtin/V1/Bool.html#Juvix.Builtin.V1.Bool:3" class="ju-code-link ju-constructor"><span class="ju-constructor">false</span></a></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:24" class="ju-code-link ju-var"><span class="ju-constructor">none</span></a></span><span class="ju-delimiter">;</span><br/>        <span id="arch.node.engines.identity_management_behaviour:131"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:131" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:131" class="ju-code-link ju-function"><span class="ju-function">decryptionEngine</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>          <span class="ju-keyword">case</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:28" class="ju-code-link ju-function"><span class="ju-function">hasDecryptCapability</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:126" class="ju-code-link ju-var"><span class="ju-var">requestedCapabilities</span></a></span> <span class="ju-keyword">of</span><br/>            <span class="ju-keyword">|</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/Juvix/Builtin/V1/Bool.html#Juvix.Builtin.V1.Bool:2" class="ju-code-link ju-constructor"><span class="ju-constructor">true</span></a></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_environment.html#arch.node.engines.identity_management_environment:17" class="ju-code-link ju-function"><span class="ju-function">IdentityInfo<span class="ju-delimiter">.</span>decryptionEngine</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:125" class="ju-code-link ju-var"><span class="ju-var">externalIdentityInfo</span></a></span><br/>            <span class="ju-keyword">|</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/Juvix/Builtin/V1/Bool.html#Juvix.Builtin.V1.Bool:3" class="ju-code-link ju-constructor"><span class="ju-constructor">false</span></a></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:24" class="ju-code-link ju-var"><span class="ju-constructor">none</span></a></span><br/>      <span class="ju-delimiter">}</span><span class="ju-delimiter">;</span><br/>  <span class="ju-keyword">in</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:127" class="ju-code-link ju-function"><span class="ju-function">newIdentityInfo</span></a></span><span class="ju-delimiter">;</span></pre></code></pre>

<pre class="highlight"><code class="juvix"><pre class="src-content"><span id="arch.node.engines.identity_management_behaviour:32"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:32" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:32" class="ju-code-link ju-function"><span class="ju-function">identityManagementAction</span></a></span></a></span></span><br/>  <span class="ju-delimiter">(</span><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:132" class="ju-code-link ju-var"><span class="ju-var">input</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:23" class="ju-code-link ju-function"><span class="ju-function">IdentityManagementActionInput</span></a></span><span class="ju-delimiter">)</span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:24" class="ju-code-link ju-function"><span class="ju-function">IdentityManagementActionEffect</span></a></span> <span class="ju-keyword">:=</span><br/>  <span class="ju-keyword">let</span><br/>    <span id="arch.node.engines.identity_management_behaviour:133"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:133" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:133" class="ju-code-link ju-function"><span class="ju-function">env</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/engine_behaviour.html#arch.node.types.engine_behaviour:34" class="ju-code-link ju-function"><span class="ju-function">ActionInput<span class="ju-delimiter">.</span>env</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:132" class="ju-code-link ju-var"><span class="ju-var">input</span></a></span><span class="ju-delimiter">;</span><br/>    <span id="arch.node.engines.identity_management_behaviour:134"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:134" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:134" class="ju-code-link ju-function"><span class="ju-function">out</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/engine_behaviour.html#arch.node.types.engine_behaviour:33" class="ju-code-link ju-function"><span class="ju-function">ActionInput<span class="ju-delimiter">.</span>guardOutput</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:132" class="ju-code-link ju-var"><span class="ju-var">input</span></a></span><span class="ju-delimiter">;</span><br/>    <span id="arch.node.engines.identity_management_behaviour:135"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:135" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:135" class="ju-code-link ju-function"><span class="ju-function">local</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/engine_environment.html#arch.node.types.engine_environment:12" class="ju-code-link ju-function"><span class="ju-function">EngineEnvironment<span class="ju-delimiter">.</span>localState</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:133" class="ju-code-link ju-function"><span class="ju-function">env</span></a></span><span class="ju-delimiter">;</span><br/>    <span id="arch.node.engines.identity_management_behaviour:136"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:136" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:136" class="ju-code-link ju-function"><span class="ju-function">identities</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_environment.html#arch.node.engines.identity_management_environment:19" class="ju-code-link ju-function"><span class="ju-function">IdentityManagementLocalState<span class="ju-delimiter">.</span>identities</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:135" class="ju-code-link ju-function"><span class="ju-function">local</span></a></span><span class="ju-delimiter">;</span><br/>  <span class="ju-keyword">in</span> <span class="ju-keyword">case</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/engine_behaviour.html#arch.node.types.engine_behaviour:10" class="ju-code-link ju-function"><span class="ju-function">GuardOutput<span class="ju-delimiter">.</span>actionLabel</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:134" class="ju-code-link ju-function"><span class="ju-function">out</span></a></span> <span class="ju-keyword">of</span><br/>       <span class="ju-keyword">|</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:2" class="ju-code-link ju-constructor"><span class="ju-constructor">DoGenerateIdentity</span></a></span> <span id="arch.node.engines.identity_management_behaviour:137"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:137" class="ju-code-link ju-var"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:137" class="ju-code-link ju-var"><span class="ju-var">backend&#39;</span></a></span></a></span></span> <span id="arch.node.engines.identity_management_behaviour:138"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:138" class="ju-code-link ju-var"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:138" class="ju-code-link ju-var"><span class="ju-var">params&#39;</span></a></span></a></span></span> <span id="arch.node.engines.identity_management_behaviour:139"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:139" class="ju-code-link ju-var"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:139" class="ju-code-link ju-var"><span class="ju-var">capabilities&#39;</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>         <span class="ju-keyword">case</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/engine_behaviour.html#arch.node.types.engine_behaviour:9" class="ju-code-link ju-function"><span class="ju-function">GuardOutput<span class="ju-delimiter">.</span>matchedArgs</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:134" class="ju-code-link ju-function"><span class="ju-function">out</span></a></span> <span class="ju-keyword">of</span> <span class="ju-delimiter">{</span><br/>           <span class="ju-keyword">|</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:6" class="ju-code-link ju-constructor"><span class="ju-constructor">MessageFrom</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:23" class="ju-code-link ju-var"><span class="ju-constructor"><span class="ju-delimiter">(</span>some</span></a></span> <span id="arch.node.engines.identity_management_behaviour:140"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:140" class="ju-code-link ju-var"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:140" class="ju-code-link ju-var"><span class="ju-var">whoAsked</span></a></span></a></span></span><span class="ju-delimiter">)</span> <span class="ju-keyword">_</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/Juvix/Builtin/V1/List.html#Juvix.Builtin.V1.List:3" class="ju-code-link ju-constructor"><span class="ju-constructor">::</span></a></span> <span class="ju-keyword">_</span> <span class="ju-keyword">:=</span><br/>             <span class="ju-keyword">case</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/Data/Map.html#Data.Map:32" class="ju-code-link ju-function"><span class="ju-function">Map<span class="ju-delimiter">.</span>lookup</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:140" class="ju-code-link ju-var"><span class="ju-var">whoAsked</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:136" class="ju-code-link ju-function"><span class="ju-function">identities</span></a></span> <span class="ju-keyword">of</span> <span class="ju-delimiter">{</span><br/>               <span class="ju-keyword">|</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:23" class="ju-code-link ju-var"><span class="ju-constructor">some</span></a></span> <span class="ju-keyword">_</span> <span class="ju-keyword">:=</span><br/>                 <span class="ju-keyword">let</span><br/>                   <span id="arch.node.engines.identity_management_behaviour:141"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:141" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:141" class="ju-code-link ju-function"><span class="ju-function">responseMsg</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>                     <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_messages.html#arch.node.engines.identity_management_messages:3" class="ju-code-link ju-constructor"><span class="ju-constructor">GenerateIdentityResponse</span></a></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span><br/>                       <span id="arch.node.engines.identity_management_behaviour:142"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:142" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:142" class="ju-code-link ju-function"><span class="ju-function">commitmentEngine</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:24" class="ju-code-link ju-var"><span class="ju-constructor">none</span></a></span><span class="ju-delimiter">;</span><br/>                       <span id="arch.node.engines.identity_management_behaviour:143"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:143" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:143" class="ju-code-link ju-function"><span class="ju-function">decryptionEngine</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:24" class="ju-code-link ju-var"><span class="ju-constructor">none</span></a></span><span class="ju-delimiter">;</span><br/>                       <span id="arch.node.engines.identity_management_behaviour:144"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:144" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:144" class="ju-code-link ju-function"><span class="ju-function">externalIdentity</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:140" class="ju-code-link ju-var"><span class="ju-var">whoAsked</span></a></span><span class="ju-delimiter">;</span><br/>                       <span id="arch.node.engines.identity_management_behaviour:145"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:145" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:145" class="ju-code-link ju-function"><span class="ju-function">err</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:23" class="ju-code-link ju-var"><span class="ju-constructor">some</span></a></span> <span class="ju-string">&quot;Identity already exists&quot;</span><br/>                     <span class="ju-delimiter">}</span><span class="ju-delimiter">;</span><br/>                 <span class="ju-keyword">in</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/engine_behaviour.html#arch.node.types.engine_behaviour:41" class="ju-code-link ju-constructor"><span class="ju-constructor">mkActionEffect</span></a></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span><br/>                   <span id="arch.node.engines.identity_management_behaviour:146"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:146" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:146" class="ju-code-link ju-function"><span class="ju-function">newEnv</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:133" class="ju-code-link ju-function"><span class="ju-function">env</span></a></span><span class="ju-delimiter">;</span><br/>                   <span id="arch.node.engines.identity_management_behaviour:147"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:147" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:147" class="ju-code-link ju-function"><span class="ju-function">producedMessages</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>                     <span class="ju-keyword">[</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/messages.html#arch.node.types.messages:3" class="ju-code-link ju-constructor"><span class="ju-constructor">mkEngineMessage</span></a></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span><br/>                       <span id="arch.node.engines.identity_management_behaviour:150"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:150" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:150" class="ju-code-link ju-function"><span class="ju-function">sender</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>                         <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:5" class="ju-code-link ju-var"><span class="ju-constructor">mkPair</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:24" class="ju-code-link ju-var"><span class="ju-constructor">none</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:23" class="ju-code-link ju-var"><span class="ju-constructor"><span class="ju-delimiter">(</span>some</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/engine_environment.html#arch.node.types.engine_environment:11" class="ju-code-link ju-function"><span class="ju-function"><span class="ju-delimiter">(</span>EngineEnvironment<span class="ju-delimiter">.</span>name</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:133" class="ju-code-link ju-function"><span class="ju-function">env</span></a></span><span class="ju-delimiter">)</span><span class="ju-delimiter">)</span><span class="ju-delimiter">;</span><br/>                       <span id="arch.node.engines.identity_management_behaviour:151"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:151" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:151" class="ju-code-link ju-function"><span class="ju-function">target</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:140" class="ju-code-link ju-var"><span class="ju-var">whoAsked</span></a></span><span class="ju-delimiter">;</span><br/>                       <span id="arch.node.engines.identity_management_behaviour:152"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:152" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:152" class="ju-code-link ju-function"><span class="ju-function">mailbox</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:23" class="ju-code-link ju-var"><span class="ju-constructor">some</span></a></span> <span class="ju-number">0</span><span class="ju-delimiter">;</span><br/>                       <span id="arch.node.engines.identity_management_behaviour:153"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:153" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:153" class="ju-code-link ju-function"><span class="ju-function">msg</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/anoma_message.html#arch.node.types.anoma_message:3" class="ju-code-link ju-constructor"><span class="ju-constructor">MsgIdentityManagement</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:141" class="ju-code-link ju-function"><span class="ju-function">responseMsg</span></a></span><br/>                     <span class="ju-delimiter">}</span><br/>                     <span class="ju-keyword">]</span><span class="ju-delimiter">;</span><br/>                   <span id="arch.node.engines.identity_management_behaviour:148"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:148" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:148" class="ju-code-link ju-function"><span class="ju-function">timers</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="ju-keyword">[</span><span class="ju-keyword">]</span><span class="ju-delimiter">;</span><br/>                   <span id="arch.node.engines.identity_management_behaviour:149"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:149" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:149" class="ju-code-link ju-function"><span class="ju-function">spawnedEngines</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="ju-keyword">[</span><span class="ju-keyword">]</span><br/>                 <span class="ju-delimiter">}</span><br/>               <span class="ju-keyword">|</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:24" class="ju-code-link ju-var"><span class="ju-constructor">none</span></a></span> <span class="ju-keyword">:=</span><br/>                 <span class="ju-keyword">let</span><br/>                   <span id="arch.node.engines.identity_management_behaviour:154"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:154" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:154" class="ju-code-link ju-function"><span class="ju-function">identityInfo</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>                     <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_environment.html#arch.node.engines.identity_management_environment:3" class="ju-code-link ju-constructor"><span class="ju-constructor">mkIdentityInfo</span></a></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span><br/>                       <span id="arch.node.engines.identity_management_behaviour:162"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:162" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:162" class="ju-code-link ju-function"><span class="ju-function">backend</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:137" class="ju-code-link ju-var"><span class="ju-var">backend&#39;</span></a></span><span class="ju-delimiter">;</span><br/>                       <span id="arch.node.engines.identity_management_behaviour:163"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:163" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:163" class="ju-code-link ju-function"><span class="ju-function">capabilities</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:139" class="ju-code-link ju-var"><span class="ju-var">capabilities&#39;</span></a></span><span class="ju-delimiter">;</span><br/>                       <span id="arch.node.engines.identity_management_behaviour:164"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:164" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:164" class="ju-code-link ju-function"><span class="ju-function">commitmentEngine</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:24" class="ju-code-link ju-var"><span class="ju-constructor">none</span></a></span><span class="ju-delimiter">;</span><br/>                       <span id="arch.node.engines.identity_management_behaviour:165"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:165" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:165" class="ju-code-link ju-function"><span class="ju-function">decryptionEngine</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:24" class="ju-code-link ju-var"><span class="ju-constructor">none</span></a></span><br/>                     <span class="ju-delimiter">}</span><span class="ju-delimiter">;</span><br/>                   <span id="arch.node.engines.identity_management_behaviour:155"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:155" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:155" class="ju-code-link ju-function"><span class="ju-function">pair&#39;</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>                     <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:30" class="ju-code-link ju-function"><span class="ju-function">updateIdentityAndSpawnEngines</span></a></span><br/>                       <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:133" class="ju-code-link ju-function"><span class="ju-function">env</span></a></span><br/>                       <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:137" class="ju-code-link ju-var"><span class="ju-var">backend&#39;</span></a></span><br/>                       <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:140" class="ju-code-link ju-var"><span class="ju-var">whoAsked</span></a></span><br/>                       <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:154" class="ju-code-link ju-function"><span class="ju-function">identityInfo</span></a></span><br/>                       <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:139" class="ju-code-link ju-var"><span class="ju-var">capabilities&#39;</span></a></span><span class="ju-delimiter">;</span><br/>                   <span id="arch.node.engines.identity_management_behaviour:156"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:156" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:156" class="ju-code-link ju-function"><span class="ju-function">updatedIdentityInfo</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:7" class="ju-code-link ju-function"><span class="ju-function">fst</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:155" class="ju-code-link ju-function"><span class="ju-function">pair&#39;</span></a></span><span class="ju-delimiter">;</span><br/>                   <span id="arch.node.engines.identity_management_behaviour:157"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:157" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:157" class="ju-code-link ju-function"><span class="ju-function">spawnedEnginesFinal</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:8" class="ju-code-link ju-function"><span class="ju-function">snd</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:155" class="ju-code-link ju-function"><span class="ju-function">pair&#39;</span></a></span><span class="ju-delimiter">;</span><br/>                   <span id="arch.node.engines.identity_management_behaviour:158"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:158" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:158" class="ju-code-link ju-function"><span class="ju-function">updatedIdentities</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>                     <span class="annot"><a href="https://anoma.github.io/nspec/v2/Data/Map.html#Data.Map:31" class="ju-code-link ju-function"><span class="ju-function">Map<span class="ju-delimiter">.</span>insert</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:140" class="ju-code-link ju-var"><span class="ju-var">whoAsked</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:156" class="ju-code-link ju-function"><span class="ju-function">updatedIdentityInfo</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:136" class="ju-code-link ju-function"><span class="ju-function">identities</span></a></span><span class="ju-delimiter">;</span><br/>                   <span id="arch.node.engines.identity_management_behaviour:159"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:159" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:159" class="ju-code-link ju-function"><span class="ju-function">newLocalState</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>                     <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:135" class="ju-code-link ju-function"><span class="ju-function">local</span></a></span><span class="ju-keyword">@</span><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_environment.html#arch.node.engines.identity_management_environment:4" class="ju-code-link ju-inductive"><span class="ju-inductive">IdentityManagementLocalState</span></a></span><span class="ju-delimiter">{</span>identities <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:158" class="ju-code-link ju-function"><span class="ju-function">updatedIdentities</span></a></span><span class="ju-delimiter">}</span><span class="ju-delimiter">;</span><br/>                   <span id="arch.node.engines.identity_management_behaviour:160"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:160" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:160" class="ju-code-link ju-function"><span class="ju-function">newEnv&#39;</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>                     <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:133" class="ju-code-link ju-function"><span class="ju-function">env</span></a></span><span class="ju-keyword">@</span><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/engine_environment.html#arch.node.types.engine_environment:1" class="ju-code-link ju-inductive"><span class="ju-inductive">EngineEnvironment</span></a></span><span class="ju-delimiter">{</span>localState <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:159" class="ju-code-link ju-function"><span class="ju-function">newLocalState</span></a></span><span class="ju-delimiter">}</span><span class="ju-delimiter">;</span><br/>                   <span id="arch.node.engines.identity_management_behaviour:161"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:161" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:161" class="ju-code-link ju-function"><span class="ju-function">responseMsg</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>                     <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_messages.html#arch.node.engines.identity_management_messages:3" class="ju-code-link ju-constructor"><span class="ju-constructor">GenerateIdentityResponse</span></a></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span><br/>                       <span id="arch.node.engines.identity_management_behaviour:174"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:174" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:174" class="ju-code-link ju-function"><span class="ju-function">commitmentEngine</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>                         <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_environment.html#arch.node.engines.identity_management_environment:16" class="ju-code-link ju-function"><span class="ju-function">IdentityInfo<span class="ju-delimiter">.</span>commitmentEngine</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:156" class="ju-code-link ju-function"><span class="ju-function">updatedIdentityInfo</span></a></span><span class="ju-delimiter">;</span><br/>                       <span id="arch.node.engines.identity_management_behaviour:175"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:175" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:175" class="ju-code-link ju-function"><span class="ju-function">decryptionEngine</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>                         <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_environment.html#arch.node.engines.identity_management_environment:17" class="ju-code-link ju-function"><span class="ju-function">IdentityInfo<span class="ju-delimiter">.</span>decryptionEngine</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:156" class="ju-code-link ju-function"><span class="ju-function">updatedIdentityInfo</span></a></span><span class="ju-delimiter">;</span><br/>                       <span id="arch.node.engines.identity_management_behaviour:176"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:176" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:176" class="ju-code-link ju-function"><span class="ju-function">externalIdentity</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:140" class="ju-code-link ju-var"><span class="ju-var">whoAsked</span></a></span><span class="ju-delimiter">;</span><br/>                       <span id="arch.node.engines.identity_management_behaviour:177"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:177" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:177" class="ju-code-link ju-function"><span class="ju-function">err</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:24" class="ju-code-link ju-var"><span class="ju-constructor">none</span></a></span><br/>                     <span class="ju-delimiter">}</span><span class="ju-delimiter">;</span><br/>                 <span class="ju-keyword">in</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/engine_behaviour.html#arch.node.types.engine_behaviour:41" class="ju-code-link ju-constructor"><span class="ju-constructor">mkActionEffect</span></a></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span><br/>                   <span id="arch.node.engines.identity_management_behaviour:178"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:178" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:178" class="ju-code-link ju-function"><span class="ju-function">newEnv</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:160" class="ju-code-link ju-function"><span class="ju-function">newEnv&#39;</span></a></span><span class="ju-delimiter">;</span><br/>                   <span id="arch.node.engines.identity_management_behaviour:179"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:179" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:179" class="ju-code-link ju-function"><span class="ju-function">producedMessages</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>                     <span class="ju-keyword">[</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/messages.html#arch.node.types.messages:3" class="ju-code-link ju-constructor"><span class="ju-constructor">mkEngineMessage</span></a></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span><br/>                       <span id="arch.node.engines.identity_management_behaviour:182"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:182" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:182" class="ju-code-link ju-function"><span class="ju-function">sender</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>                         <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:5" class="ju-code-link ju-var"><span class="ju-constructor">mkPair</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:24" class="ju-code-link ju-var"><span class="ju-constructor">none</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:23" class="ju-code-link ju-var"><span class="ju-constructor"><span class="ju-delimiter">(</span>some</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/engine_environment.html#arch.node.types.engine_environment:11" class="ju-code-link ju-function"><span class="ju-function"><span class="ju-delimiter">(</span>EngineEnvironment<span class="ju-delimiter">.</span>name</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:133" class="ju-code-link ju-function"><span class="ju-function">env</span></a></span><span class="ju-delimiter">)</span><span class="ju-delimiter">)</span><span class="ju-delimiter">;</span><br/>                       <span id="arch.node.engines.identity_management_behaviour:183"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:183" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:183" class="ju-code-link ju-function"><span class="ju-function">target</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:140" class="ju-code-link ju-var"><span class="ju-var">whoAsked</span></a></span><span class="ju-delimiter">;</span><br/>                       <span id="arch.node.engines.identity_management_behaviour:184"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:184" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:184" class="ju-code-link ju-function"><span class="ju-function">mailbox</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:23" class="ju-code-link ju-var"><span class="ju-constructor">some</span></a></span> <span class="ju-number">0</span><span class="ju-delimiter">;</span><br/>                       <span id="arch.node.engines.identity_management_behaviour:185"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:185" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:185" class="ju-code-link ju-function"><span class="ju-function">msg</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/anoma_message.html#arch.node.types.anoma_message:3" class="ju-code-link ju-constructor"><span class="ju-constructor">MsgIdentityManagement</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:161" class="ju-code-link ju-function"><span class="ju-function">responseMsg</span></a></span><br/>                     <span class="ju-delimiter">}</span><br/>                     <span class="ju-keyword">]</span><span class="ju-delimiter">;</span><br/>                   <span id="arch.node.engines.identity_management_behaviour:180"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:180" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:180" class="ju-code-link ju-function"><span class="ju-function">timers</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="ju-keyword">[</span><span class="ju-keyword">]</span><span class="ju-delimiter">;</span><br/>                   <span id="arch.node.engines.identity_management_behaviour:181"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:181" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:181" class="ju-code-link ju-function"><span class="ju-function">spawnedEngines</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:157" class="ju-code-link ju-function"><span class="ju-function">spawnedEnginesFinal</span></a></span><br/>                 <span class="ju-delimiter">}</span><br/>             <span class="ju-delimiter">}</span><br/>           <span class="ju-keyword">|</span> <span class="ju-keyword">_</span> <span class="ju-keyword">:=</span><br/>             <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/engine_behaviour.html#arch.node.types.engine_behaviour:41" class="ju-code-link ju-constructor"><span class="ju-constructor">mkActionEffect</span></a></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span><br/>               <span id="arch.node.engines.identity_management_behaviour:186"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:186" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:186" class="ju-code-link ju-function"><span class="ju-function">newEnv</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:133" class="ju-code-link ju-function"><span class="ju-function">env</span></a></span><span class="ju-delimiter">;</span><br/>               <span id="arch.node.engines.identity_management_behaviour:187"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:187" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:187" class="ju-code-link ju-function"><span class="ju-function">producedMessages</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="ju-keyword">[</span><span class="ju-keyword">]</span><span class="ju-delimiter">;</span><br/>               <span id="arch.node.engines.identity_management_behaviour:188"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:188" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:188" class="ju-code-link ju-function"><span class="ju-function">timers</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="ju-keyword">[</span><span class="ju-keyword">]</span><span class="ju-delimiter">;</span><br/>               <span id="arch.node.engines.identity_management_behaviour:189"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:189" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:189" class="ju-code-link ju-function"><span class="ju-function">spawnedEngines</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="ju-keyword">[</span><span class="ju-keyword">]</span><br/>             <span class="ju-delimiter">}</span><br/>         <span class="ju-delimiter">}</span><br/>       <span class="ju-keyword">|</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:3" class="ju-code-link ju-constructor"><span class="ju-constructor">DoConnectIdentity</span></a></span> <span id="arch.node.engines.identity_management_behaviour:190"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:190" class="ju-code-link ju-var"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:190" class="ju-code-link ju-var"><span class="ju-var">externalIdentity&#39;</span></a></span></a></span></span> <span id="arch.node.engines.identity_management_behaviour:191"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:191" class="ju-code-link ju-var"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:191" class="ju-code-link ju-var"><span class="ju-var">backend&#39;</span></a></span></a></span></span> <span id="arch.node.engines.identity_management_behaviour:192"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:192" class="ju-code-link ju-var"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:192" class="ju-code-link ju-var"><span class="ju-var">capabilities&#39;</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>         <span class="ju-keyword">case</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/engine_behaviour.html#arch.node.types.engine_behaviour:9" class="ju-code-link ju-function"><span class="ju-function">GuardOutput<span class="ju-delimiter">.</span>matchedArgs</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:134" class="ju-code-link ju-function"><span class="ju-function">out</span></a></span> <span class="ju-keyword">of</span> <span class="ju-delimiter">{</span><br/>           <span class="ju-keyword">|</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:6" class="ju-code-link ju-constructor"><span class="ju-constructor">MessageFrom</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:23" class="ju-code-link ju-var"><span class="ju-constructor"><span class="ju-delimiter">(</span>some</span></a></span> <span id="arch.node.engines.identity_management_behaviour:193"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:193" class="ju-code-link ju-var"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:193" class="ju-code-link ju-var"><span class="ju-var">whoAsked</span></a></span></a></span></span><span class="ju-delimiter">)</span> <span class="ju-keyword">_</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/Juvix/Builtin/V1/List.html#Juvix.Builtin.V1.List:3" class="ju-code-link ju-constructor"><span class="ju-constructor">::</span></a></span> <span class="ju-keyword">_</span> <span class="ju-keyword">:=</span><br/>             <span class="ju-keyword">case</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/Data/Map.html#Data.Map:32" class="ju-code-link ju-function"><span class="ju-function">Map<span class="ju-delimiter">.</span>lookup</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:193" class="ju-code-link ju-var"><span class="ju-var">whoAsked</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:136" class="ju-code-link ju-function"><span class="ju-function">identities</span></a></span> <span class="ju-keyword">of</span> <span class="ju-delimiter">{</span><br/>               <span class="ju-keyword">|</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:23" class="ju-code-link ju-var"><span class="ju-constructor">some</span></a></span> <span class="ju-keyword">_</span> <span class="ju-keyword">:=</span><br/>                 <span class="ju-keyword">let</span><br/>                   <span id="arch.node.engines.identity_management_behaviour:194"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:194" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:194" class="ju-code-link ju-function"><span class="ju-function">responseMsg</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>                     <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_messages.html#arch.node.engines.identity_management_messages:5" class="ju-code-link ju-constructor"><span class="ju-constructor">ConnectIdentityResponse</span></a></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span><br/>                       <span id="arch.node.engines.identity_management_behaviour:195"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:195" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:195" class="ju-code-link ju-function"><span class="ju-function">commitmentEngine</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:24" class="ju-code-link ju-var"><span class="ju-constructor">none</span></a></span><span class="ju-delimiter">;</span><br/>                       <span id="arch.node.engines.identity_management_behaviour:196"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:196" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:196" class="ju-code-link ju-function"><span class="ju-function">decryptionEngine</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:24" class="ju-code-link ju-var"><span class="ju-constructor">none</span></a></span><span class="ju-delimiter">;</span><br/>                       <span id="arch.node.engines.identity_management_behaviour:197"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:197" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:197" class="ju-code-link ju-function"><span class="ju-function">err</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:23" class="ju-code-link ju-var"><span class="ju-constructor">some</span></a></span> <span class="ju-string">&quot;Identity already exists&quot;</span><br/>                     <span class="ju-delimiter">}</span><span class="ju-delimiter">;</span><br/>                 <span class="ju-keyword">in</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/engine_behaviour.html#arch.node.types.engine_behaviour:41" class="ju-code-link ju-constructor"><span class="ju-constructor">mkActionEffect</span></a></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span><br/>                   <span id="arch.node.engines.identity_management_behaviour:198"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:198" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:198" class="ju-code-link ju-function"><span class="ju-function">newEnv</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:133" class="ju-code-link ju-function"><span class="ju-function">env</span></a></span><span class="ju-delimiter">;</span><br/>                   <span id="arch.node.engines.identity_management_behaviour:199"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:199" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:199" class="ju-code-link ju-function"><span class="ju-function">producedMessages</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>                     <span class="ju-keyword">[</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/messages.html#arch.node.types.messages:3" class="ju-code-link ju-constructor"><span class="ju-constructor">mkEngineMessage</span></a></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span><br/>                       <span id="arch.node.engines.identity_management_behaviour:202"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:202" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:202" class="ju-code-link ju-function"><span class="ju-function">sender</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>                         <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:5" class="ju-code-link ju-var"><span class="ju-constructor">mkPair</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:24" class="ju-code-link ju-var"><span class="ju-constructor">none</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:23" class="ju-code-link ju-var"><span class="ju-constructor"><span class="ju-delimiter">(</span>some</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/engine_environment.html#arch.node.types.engine_environment:11" class="ju-code-link ju-function"><span class="ju-function"><span class="ju-delimiter">(</span>EngineEnvironment<span class="ju-delimiter">.</span>name</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:133" class="ju-code-link ju-function"><span class="ju-function">env</span></a></span><span class="ju-delimiter">)</span><span class="ju-delimiter">)</span><span class="ju-delimiter">;</span><br/>                       <span id="arch.node.engines.identity_management_behaviour:203"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:203" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:203" class="ju-code-link ju-function"><span class="ju-function">target</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:193" class="ju-code-link ju-var"><span class="ju-var">whoAsked</span></a></span><span class="ju-delimiter">;</span><br/>                       <span id="arch.node.engines.identity_management_behaviour:204"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:204" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:204" class="ju-code-link ju-function"><span class="ju-function">mailbox</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:23" class="ju-code-link ju-var"><span class="ju-constructor">some</span></a></span> <span class="ju-number">0</span><span class="ju-delimiter">;</span><br/>                       <span id="arch.node.engines.identity_management_behaviour:205"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:205" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:205" class="ju-code-link ju-function"><span class="ju-function">msg</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/anoma_message.html#arch.node.types.anoma_message:3" class="ju-code-link ju-constructor"><span class="ju-constructor">MsgIdentityManagement</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:194" class="ju-code-link ju-function"><span class="ju-function">responseMsg</span></a></span><br/>                     <span class="ju-delimiter">}</span><br/>                     <span class="ju-keyword">]</span><span class="ju-delimiter">;</span><br/>                   <span id="arch.node.engines.identity_management_behaviour:200"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:200" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:200" class="ju-code-link ju-function"><span class="ju-function">timers</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="ju-keyword">[</span><span class="ju-keyword">]</span><span class="ju-delimiter">;</span><br/>                   <span id="arch.node.engines.identity_management_behaviour:201"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:201" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:201" class="ju-code-link ju-function"><span class="ju-function">spawnedEngines</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="ju-keyword">[</span><span class="ju-keyword">]</span><br/>                 <span class="ju-delimiter">}</span><br/>               <span class="ju-keyword">|</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:24" class="ju-code-link ju-var"><span class="ju-constructor">none</span></a></span> <span class="ju-keyword">:=</span><br/>                 <span class="ju-keyword">case</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/Data/Map.html#Data.Map:32" class="ju-code-link ju-function"><span class="ju-function">Map<span class="ju-delimiter">.</span>lookup</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:190" class="ju-code-link ju-var"><span class="ju-var">externalIdentity&#39;</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:136" class="ju-code-link ju-function"><span class="ju-function">identities</span></a></span> <span class="ju-keyword">of</span> <span class="ju-delimiter">{</span><br/>                   <span class="ju-keyword">|</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:24" class="ju-code-link ju-var"><span class="ju-constructor">none</span></a></span> <span class="ju-keyword">:=</span><br/>                     <span class="ju-keyword">let</span><br/>                       <span id="arch.node.engines.identity_management_behaviour:206"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:206" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:206" class="ju-code-link ju-function"><span class="ju-function">responseMsg</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>                         <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_messages.html#arch.node.engines.identity_management_messages:5" class="ju-code-link ju-constructor"><span class="ju-constructor">ConnectIdentityResponse</span></a></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span><br/>                           <span id="arch.node.engines.identity_management_behaviour:207"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:207" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:207" class="ju-code-link ju-function"><span class="ju-function">commitmentEngine</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:24" class="ju-code-link ju-var"><span class="ju-constructor">none</span></a></span><span class="ju-delimiter">;</span><br/>                           <span id="arch.node.engines.identity_management_behaviour:208"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:208" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:208" class="ju-code-link ju-function"><span class="ju-function">decryptionEngine</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:24" class="ju-code-link ju-var"><span class="ju-constructor">none</span></a></span><span class="ju-delimiter">;</span><br/>                           <span id="arch.node.engines.identity_management_behaviour:209"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:209" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:209" class="ju-code-link ju-function"><span class="ju-function">err</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:23" class="ju-code-link ju-var"><span class="ju-constructor">some</span></a></span> <span class="ju-string">&quot;External identity not found&quot;</span><br/>                         <span class="ju-delimiter">}</span><span class="ju-delimiter">;</span><br/>                     <span class="ju-keyword">in</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/engine_behaviour.html#arch.node.types.engine_behaviour:41" class="ju-code-link ju-constructor"><span class="ju-constructor">mkActionEffect</span></a></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span><br/>                       <span id="arch.node.engines.identity_management_behaviour:210"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:210" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:210" class="ju-code-link ju-function"><span class="ju-function">newEnv</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:133" class="ju-code-link ju-function"><span class="ju-function">env</span></a></span><span class="ju-delimiter">;</span><br/>                       <span id="arch.node.engines.identity_management_behaviour:211"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:211" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:211" class="ju-code-link ju-function"><span class="ju-function">producedMessages</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>                         <span class="ju-keyword">[</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/messages.html#arch.node.types.messages:3" class="ju-code-link ju-constructor"><span class="ju-constructor">mkEngineMessage</span></a></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span><br/>                           <span id="arch.node.engines.identity_management_behaviour:214"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:214" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:214" class="ju-code-link ju-function"><span class="ju-function">sender</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>                             <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:5" class="ju-code-link ju-var"><span class="ju-constructor">mkPair</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:24" class="ju-code-link ju-var"><span class="ju-constructor">none</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:23" class="ju-code-link ju-var"><span class="ju-constructor"><span class="ju-delimiter">(</span>some</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/engine_environment.html#arch.node.types.engine_environment:11" class="ju-code-link ju-function"><span class="ju-function"><span class="ju-delimiter">(</span>EngineEnvironment<span class="ju-delimiter">.</span>name</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:133" class="ju-code-link ju-function"><span class="ju-function">env</span></a></span><span class="ju-delimiter">)</span><span class="ju-delimiter">)</span><span class="ju-delimiter">;</span><br/>                           <span id="arch.node.engines.identity_management_behaviour:215"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:215" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:215" class="ju-code-link ju-function"><span class="ju-function">target</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:193" class="ju-code-link ju-var"><span class="ju-var">whoAsked</span></a></span><span class="ju-delimiter">;</span><br/>                           <span id="arch.node.engines.identity_management_behaviour:216"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:216" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:216" class="ju-code-link ju-function"><span class="ju-function">mailbox</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:23" class="ju-code-link ju-var"><span class="ju-constructor">some</span></a></span> <span class="ju-number">0</span><span class="ju-delimiter">;</span><br/>                           <span id="arch.node.engines.identity_management_behaviour:217"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:217" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:217" class="ju-code-link ju-function"><span class="ju-function">msg</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/anoma_message.html#arch.node.types.anoma_message:3" class="ju-code-link ju-constructor"><span class="ju-constructor">MsgIdentityManagement</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:206" class="ju-code-link ju-function"><span class="ju-function">responseMsg</span></a></span><br/>                         <span class="ju-delimiter">}</span><br/>                         <span class="ju-keyword">]</span><span class="ju-delimiter">;</span><br/>                       <span id="arch.node.engines.identity_management_behaviour:212"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:212" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:212" class="ju-code-link ju-function"><span class="ju-function">timers</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="ju-keyword">[</span><span class="ju-keyword">]</span><span class="ju-delimiter">;</span><br/>                       <span id="arch.node.engines.identity_management_behaviour:213"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:213" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:213" class="ju-code-link ju-function"><span class="ju-function">spawnedEngines</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="ju-keyword">[</span><span class="ju-keyword">]</span><br/>                     <span class="ju-delimiter">}</span><br/>                   <span class="ju-keyword">|</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:23" class="ju-code-link ju-var"><span class="ju-constructor">some</span></a></span> <span id="arch.node.engines.identity_management_behaviour:218"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:218" class="ju-code-link ju-var"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:218" class="ju-code-link ju-var"><span class="ju-var">externalIdentityInfo</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>                     <span class="ju-keyword">let</span><br/>                       <span id="arch.node.engines.identity_management_behaviour:219"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:219" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:219" class="ju-code-link ju-function"><span class="ju-function">externalCapabilities</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>                         <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_environment.html#arch.node.engines.identity_management_environment:15" class="ju-code-link ju-function"><span class="ju-function">IdentityInfo<span class="ju-delimiter">.</span>capabilities</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:218" class="ju-code-link ju-var"><span class="ju-var">externalIdentityInfo</span></a></span><span class="ju-delimiter">;</span><br/>                       <span id="arch.node.engines.identity_management_behaviour:220"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:220" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:220" class="ju-code-link ju-function"><span class="ju-function">requestedCapabilities</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:192" class="ju-code-link ju-var"><span class="ju-var">capabilities&#39;</span></a></span><span class="ju-delimiter">;</span><br/>                       <span id="arch.node.engines.identity_management_behaviour:221"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:221" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:221" class="ju-code-link ju-function"><span class="ju-function">isSubset</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>                         <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:29" class="ju-code-link ju-function"><span class="ju-function">isSubsetCapabilities</span></a></span><br/>                           <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:220" class="ju-code-link ju-function"><span class="ju-function">requestedCapabilities</span></a></span><br/>                           <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:219" class="ju-code-link ju-function"><span class="ju-function">externalCapabilities</span></a></span><span class="ju-delimiter">;</span><br/>                     <span class="ju-keyword">in</span> <span class="ju-keyword">case</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:221" class="ju-code-link ju-function"><span class="ju-function">isSubset</span></a></span> <span class="ju-keyword">of</span> <span class="ju-delimiter">{</span><br/>                          <span class="ju-keyword">|</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/Juvix/Builtin/V1/Bool.html#Juvix.Builtin.V1.Bool:2" class="ju-code-link ju-constructor"><span class="ju-constructor">true</span></a></span> <span class="ju-keyword">:=</span><br/>                            <span class="ju-keyword">let</span><br/>                              <span id="arch.node.engines.identity_management_behaviour:222"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:222" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:222" class="ju-code-link ju-function"><span class="ju-function">newIdentityInfo</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>                                <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:31" class="ju-code-link ju-function"><span class="ju-function">copyEnginesForCapabilities</span></a></span><br/>                                  <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:133" class="ju-code-link ju-function"><span class="ju-function">env</span></a></span><br/>                                  <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:193" class="ju-code-link ju-var"><span class="ju-var">whoAsked</span></a></span><br/>                                  <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:218" class="ju-code-link ju-var"><span class="ju-var">externalIdentityInfo</span></a></span><br/>                                  <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:220" class="ju-code-link ju-function"><span class="ju-function">requestedCapabilities</span></a></span><span class="ju-delimiter">;</span><br/>                              <span id="arch.node.engines.identity_management_behaviour:223"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:223" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:223" class="ju-code-link ju-function"><span class="ju-function">updatedIdentities</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>                                <span class="annot"><a href="https://anoma.github.io/nspec/v2/Data/Map.html#Data.Map:31" class="ju-code-link ju-function"><span class="ju-function">Map<span class="ju-delimiter">.</span>insert</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:193" class="ju-code-link ju-var"><span class="ju-var">whoAsked</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:222" class="ju-code-link ju-function"><span class="ju-function">newIdentityInfo</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:136" class="ju-code-link ju-function"><span class="ju-function">identities</span></a></span><span class="ju-delimiter">;</span><br/>                              <span id="arch.node.engines.identity_management_behaviour:224"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:224" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:224" class="ju-code-link ju-function"><span class="ju-function">newLocalState</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>                                <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:135" class="ju-code-link ju-function"><span class="ju-function">local</span></a></span><span class="ju-keyword">@</span><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_environment.html#arch.node.engines.identity_management_environment:4" class="ju-code-link ju-inductive"><span class="ju-inductive">IdentityManagementLocalState</span></a></span><span class="ju-delimiter">{</span>identities <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:223" class="ju-code-link ju-function"><span class="ju-function">updatedIdentities</span></a></span><span class="ju-delimiter">}</span><span class="ju-delimiter">;</span><br/>                              <span id="arch.node.engines.identity_management_behaviour:225"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:225" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:225" class="ju-code-link ju-function"><span class="ju-function">newEnv&#39;</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>                                <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:133" class="ju-code-link ju-function"><span class="ju-function">env</span></a></span><span class="ju-keyword">@</span><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/engine_environment.html#arch.node.types.engine_environment:1" class="ju-code-link ju-inductive"><span class="ju-inductive">EngineEnvironment</span></a></span><span class="ju-delimiter">{</span>localState <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:224" class="ju-code-link ju-function"><span class="ju-function">newLocalState</span></a></span><span class="ju-delimiter">}</span><span class="ju-delimiter">;</span><br/>                              <span id="arch.node.engines.identity_management_behaviour:226"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:226" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:226" class="ju-code-link ju-function"><span class="ju-function">responseMsg</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>                                <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_messages.html#arch.node.engines.identity_management_messages:5" class="ju-code-link ju-constructor"><span class="ju-constructor">ConnectIdentityResponse</span></a></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span><br/>                                  <span id="arch.node.engines.identity_management_behaviour:235"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:235" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:235" class="ju-code-link ju-function"><span class="ju-function">commitmentEngine</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>                                    <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_environment.html#arch.node.engines.identity_management_environment:16" class="ju-code-link ju-function"><span class="ju-function">IdentityInfo<span class="ju-delimiter">.</span>commitmentEngine</span></a></span><br/>                                      <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:222" class="ju-code-link ju-function"><span class="ju-function">newIdentityInfo</span></a></span><span class="ju-delimiter">;</span><br/>                                  <span id="arch.node.engines.identity_management_behaviour:236"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:236" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:236" class="ju-code-link ju-function"><span class="ju-function">decryptionEngine</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>                                    <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_environment.html#arch.node.engines.identity_management_environment:17" class="ju-code-link ju-function"><span class="ju-function">IdentityInfo<span class="ju-delimiter">.</span>decryptionEngine</span></a></span><br/>                                      <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:222" class="ju-code-link ju-function"><span class="ju-function">newIdentityInfo</span></a></span><span class="ju-delimiter">;</span><br/>                                  <span id="arch.node.engines.identity_management_behaviour:237"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:237" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:237" class="ju-code-link ju-function"><span class="ju-function">err</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:24" class="ju-code-link ju-var"><span class="ju-constructor">none</span></a></span><br/>                                <span class="ju-delimiter">}</span><span class="ju-delimiter">;</span><br/>                            <span class="ju-keyword">in</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/engine_behaviour.html#arch.node.types.engine_behaviour:41" class="ju-code-link ju-constructor"><span class="ju-constructor">mkActionEffect</span></a></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span><br/>                              <span id="arch.node.engines.identity_management_behaviour:238"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:238" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:238" class="ju-code-link ju-function"><span class="ju-function">newEnv</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:225" class="ju-code-link ju-function"><span class="ju-function">newEnv&#39;</span></a></span><span class="ju-delimiter">;</span><br/>                              <span id="arch.node.engines.identity_management_behaviour:239"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:239" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:239" class="ju-code-link ju-function"><span class="ju-function">producedMessages</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>                                <span class="ju-keyword">[</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/messages.html#arch.node.types.messages:3" class="ju-code-link ju-constructor"><span class="ju-constructor">mkEngineMessage</span></a></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span><br/>                                  <span id="arch.node.engines.identity_management_behaviour:242"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:242" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:242" class="ju-code-link ju-function"><span class="ju-function">sender</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>                                    <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:5" class="ju-code-link ju-var"><span class="ju-constructor">mkPair</span></a></span><br/>                                      <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:24" class="ju-code-link ju-var"><span class="ju-constructor">none</span></a></span><br/>                                      <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:23" class="ju-code-link ju-var"><span class="ju-constructor"><span class="ju-delimiter">(</span>some</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/engine_environment.html#arch.node.types.engine_environment:11" class="ju-code-link ju-function"><span class="ju-function"><span class="ju-delimiter">(</span>EngineEnvironment<span class="ju-delimiter">.</span>name</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:133" class="ju-code-link ju-function"><span class="ju-function">env</span></a></span><span class="ju-delimiter">)</span><span class="ju-delimiter">)</span><span class="ju-delimiter">;</span><br/>                                  <span id="arch.node.engines.identity_management_behaviour:243"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:243" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:243" class="ju-code-link ju-function"><span class="ju-function">target</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:193" class="ju-code-link ju-var"><span class="ju-var">whoAsked</span></a></span><span class="ju-delimiter">;</span><br/>                                  <span id="arch.node.engines.identity_management_behaviour:244"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:244" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:244" class="ju-code-link ju-function"><span class="ju-function">mailbox</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:23" class="ju-code-link ju-var"><span class="ju-constructor">some</span></a></span> <span class="ju-number">0</span><span class="ju-delimiter">;</span><br/>                                  <span id="arch.node.engines.identity_management_behaviour:245"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:245" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:245" class="ju-code-link ju-function"><span class="ju-function">msg</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/anoma_message.html#arch.node.types.anoma_message:3" class="ju-code-link ju-constructor"><span class="ju-constructor">MsgIdentityManagement</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:226" class="ju-code-link ju-function"><span class="ju-function">responseMsg</span></a></span><br/>                                <span class="ju-delimiter">}</span><br/>                                <span class="ju-keyword">]</span><span class="ju-delimiter">;</span><br/>                              <span id="arch.node.engines.identity_management_behaviour:240"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:240" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:240" class="ju-code-link ju-function"><span class="ju-function">timers</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="ju-keyword">[</span><span class="ju-keyword">]</span><span class="ju-delimiter">;</span><br/>                              <span id="arch.node.engines.identity_management_behaviour:241"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:241" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:241" class="ju-code-link ju-function"><span class="ju-function">spawnedEngines</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="ju-keyword">[</span><span class="ju-keyword">]</span><br/>                            <span class="ju-delimiter">}</span><br/>                          <span class="ju-keyword">|</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/Juvix/Builtin/V1/Bool.html#Juvix.Builtin.V1.Bool:3" class="ju-code-link ju-constructor"><span class="ju-constructor">false</span></a></span> <span class="ju-keyword">:=</span><br/>                            <span class="ju-keyword">let</span><br/>                              <span id="arch.node.engines.identity_management_behaviour:246"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:246" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:246" class="ju-code-link ju-function"><span class="ju-function">responseMsg</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>                                <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_messages.html#arch.node.engines.identity_management_messages:5" class="ju-code-link ju-constructor"><span class="ju-constructor">ConnectIdentityResponse</span></a></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span><br/>                                  <span id="arch.node.engines.identity_management_behaviour:247"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:247" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:247" class="ju-code-link ju-function"><span class="ju-function">commitmentEngine</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:24" class="ju-code-link ju-var"><span class="ju-constructor">none</span></a></span><span class="ju-delimiter">;</span><br/>                                  <span id="arch.node.engines.identity_management_behaviour:248"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:248" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:248" class="ju-code-link ju-function"><span class="ju-function">decryptionEngine</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:24" class="ju-code-link ju-var"><span class="ju-constructor">none</span></a></span><span class="ju-delimiter">;</span><br/>                                  <span id="arch.node.engines.identity_management_behaviour:249"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:249" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:249" class="ju-code-link ju-function"><span class="ju-function">err</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>                                    <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:23" class="ju-code-link ju-var"><span class="ju-constructor">some</span></a></span> <span class="ju-string">&quot;Requested capabilities not available&quot;</span><br/>                                <span class="ju-delimiter">}</span><span class="ju-delimiter">;</span><br/>                            <span class="ju-keyword">in</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/engine_behaviour.html#arch.node.types.engine_behaviour:41" class="ju-code-link ju-constructor"><span class="ju-constructor">mkActionEffect</span></a></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span><br/>                              <span id="arch.node.engines.identity_management_behaviour:250"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:250" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:250" class="ju-code-link ju-function"><span class="ju-function">newEnv</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:133" class="ju-code-link ju-function"><span class="ju-function">env</span></a></span><span class="ju-delimiter">;</span><br/>                              <span id="arch.node.engines.identity_management_behaviour:251"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:251" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:251" class="ju-code-link ju-function"><span class="ju-function">producedMessages</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>                                <span class="ju-keyword">[</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/messages.html#arch.node.types.messages:3" class="ju-code-link ju-constructor"><span class="ju-constructor">mkEngineMessage</span></a></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span><br/>                                  <span id="arch.node.engines.identity_management_behaviour:254"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:254" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:254" class="ju-code-link ju-function"><span class="ju-function">sender</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>                                    <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:5" class="ju-code-link ju-var"><span class="ju-constructor">mkPair</span></a></span><br/>                                      <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:24" class="ju-code-link ju-var"><span class="ju-constructor">none</span></a></span><br/>                                      <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:23" class="ju-code-link ju-var"><span class="ju-constructor"><span class="ju-delimiter">(</span>some</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/engine_environment.html#arch.node.types.engine_environment:11" class="ju-code-link ju-function"><span class="ju-function"><span class="ju-delimiter">(</span>EngineEnvironment<span class="ju-delimiter">.</span>name</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:133" class="ju-code-link ju-function"><span class="ju-function">env</span></a></span><span class="ju-delimiter">)</span><span class="ju-delimiter">)</span><span class="ju-delimiter">;</span><br/>                                  <span id="arch.node.engines.identity_management_behaviour:255"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:255" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:255" class="ju-code-link ju-function"><span class="ju-function">target</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:193" class="ju-code-link ju-var"><span class="ju-var">whoAsked</span></a></span><span class="ju-delimiter">;</span><br/>                                  <span id="arch.node.engines.identity_management_behaviour:256"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:256" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:256" class="ju-code-link ju-function"><span class="ju-function">mailbox</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:23" class="ju-code-link ju-var"><span class="ju-constructor">some</span></a></span> <span class="ju-number">0</span><span class="ju-delimiter">;</span><br/>                                  <span id="arch.node.engines.identity_management_behaviour:257"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:257" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:257" class="ju-code-link ju-function"><span class="ju-function">msg</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/anoma_message.html#arch.node.types.anoma_message:3" class="ju-code-link ju-constructor"><span class="ju-constructor">MsgIdentityManagement</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:246" class="ju-code-link ju-function"><span class="ju-function">responseMsg</span></a></span><br/>                                <span class="ju-delimiter">}</span><br/>                                <span class="ju-keyword">]</span><span class="ju-delimiter">;</span><br/>                              <span id="arch.node.engines.identity_management_behaviour:252"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:252" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:252" class="ju-code-link ju-function"><span class="ju-function">timers</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="ju-keyword">[</span><span class="ju-keyword">]</span><span class="ju-delimiter">;</span><br/>                              <span id="arch.node.engines.identity_management_behaviour:253"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:253" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:253" class="ju-code-link ju-function"><span class="ju-function">spawnedEngines</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="ju-keyword">[</span><span class="ju-keyword">]</span><br/>                            <span class="ju-delimiter">}</span><br/>                        <span class="ju-delimiter">}</span><br/>                 <span class="ju-delimiter">}</span><br/>             <span class="ju-delimiter">}</span><br/>           <span class="ju-keyword">|</span> <span class="ju-keyword">_</span> <span class="ju-keyword">:=</span><br/>             <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/engine_behaviour.html#arch.node.types.engine_behaviour:41" class="ju-code-link ju-constructor"><span class="ju-constructor">mkActionEffect</span></a></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span><br/>               <span id="arch.node.engines.identity_management_behaviour:258"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:258" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:258" class="ju-code-link ju-function"><span class="ju-function">newEnv</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:133" class="ju-code-link ju-function"><span class="ju-function">env</span></a></span><span class="ju-delimiter">;</span><br/>               <span id="arch.node.engines.identity_management_behaviour:259"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:259" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:259" class="ju-code-link ju-function"><span class="ju-function">producedMessages</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="ju-keyword">[</span><span class="ju-keyword">]</span><span class="ju-delimiter">;</span><br/>               <span id="arch.node.engines.identity_management_behaviour:260"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:260" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:260" class="ju-code-link ju-function"><span class="ju-function">timers</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="ju-keyword">[</span><span class="ju-keyword">]</span><span class="ju-delimiter">;</span><br/>               <span id="arch.node.engines.identity_management_behaviour:261"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:261" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:261" class="ju-code-link ju-function"><span class="ju-function">spawnedEngines</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="ju-keyword">[</span><span class="ju-keyword">]</span><br/>             <span class="ju-delimiter">}</span><br/>         <span class="ju-delimiter">}</span><br/>       <span class="ju-keyword">|</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:4" class="ju-code-link ju-constructor"><span class="ju-constructor">DoDeleteIdentity</span></a></span> <span id="arch.node.engines.identity_management_behaviour:262"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:262" class="ju-code-link ju-var"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:262" class="ju-code-link ju-var"><span class="ju-var">externalIdentity</span></a></span></a></span></span> <span id="arch.node.engines.identity_management_behaviour:263"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:263" class="ju-code-link ju-var"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:263" class="ju-code-link ju-var"><span class="ju-var">backend&#39;</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>         <span class="ju-keyword">case</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/engine_behaviour.html#arch.node.types.engine_behaviour:9" class="ju-code-link ju-function"><span class="ju-function">GuardOutput<span class="ju-delimiter">.</span>matchedArgs</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:134" class="ju-code-link ju-function"><span class="ju-function">out</span></a></span> <span class="ju-keyword">of</span><br/>           <span class="ju-keyword">|</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:6" class="ju-code-link ju-constructor"><span class="ju-constructor">MessageFrom</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:23" class="ju-code-link ju-var"><span class="ju-constructor"><span class="ju-delimiter">(</span>some</span></a></span> <span id="arch.node.engines.identity_management_behaviour:264"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:264" class="ju-code-link ju-var"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:264" class="ju-code-link ju-var"><span class="ju-var">whoAsked</span></a></span></a></span></span><span class="ju-delimiter">)</span> <span class="ju-keyword">_</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/Juvix/Builtin/V1/List.html#Juvix.Builtin.V1.List:3" class="ju-code-link ju-constructor"><span class="ju-constructor">::</span></a></span> <span class="ju-keyword">_</span> <span class="ju-keyword">:=</span><br/>             <span class="ju-keyword">case</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/Data/Map.html#Data.Map:32" class="ju-code-link ju-function"><span class="ju-function">Map<span class="ju-delimiter">.</span>lookup</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:262" class="ju-code-link ju-var"><span class="ju-var">externalIdentity</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:136" class="ju-code-link ju-function"><span class="ju-function">identities</span></a></span> <span class="ju-keyword">of</span> <span class="ju-delimiter">{</span><br/>               <span class="ju-keyword">|</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:24" class="ju-code-link ju-var"><span class="ju-constructor">none</span></a></span> <span class="ju-keyword">:=</span><br/>                 <span class="ju-keyword">let</span><br/>                   <span id="arch.node.engines.identity_management_behaviour:265"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:265" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:265" class="ju-code-link ju-function"><span class="ju-function">responseMsg</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>                     <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_messages.html#arch.node.engines.identity_management_messages:7" class="ju-code-link ju-constructor"><span class="ju-constructor">DeleteIdentityResponse</span></a></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span><br/>                       <span id="arch.node.engines.identity_management_behaviour:266"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:266" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:266" class="ju-code-link ju-function"><span class="ju-function">err</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:23" class="ju-code-link ju-var"><span class="ju-constructor">some</span></a></span> <span class="ju-string">&quot;Identity does not exist&quot;</span><br/>                     <span class="ju-delimiter">}</span><span class="ju-delimiter">;</span><br/>                 <span class="ju-keyword">in</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/engine_behaviour.html#arch.node.types.engine_behaviour:41" class="ju-code-link ju-constructor"><span class="ju-constructor">mkActionEffect</span></a></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span><br/>                   <span id="arch.node.engines.identity_management_behaviour:267"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:267" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:267" class="ju-code-link ju-function"><span class="ju-function">newEnv</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:133" class="ju-code-link ju-function"><span class="ju-function">env</span></a></span><span class="ju-delimiter">;</span><br/>                   <span id="arch.node.engines.identity_management_behaviour:268"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:268" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:268" class="ju-code-link ju-function"><span class="ju-function">producedMessages</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>                     <span class="ju-keyword">[</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/messages.html#arch.node.types.messages:3" class="ju-code-link ju-constructor"><span class="ju-constructor">mkEngineMessage</span></a></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span><br/>                       <span id="arch.node.engines.identity_management_behaviour:271"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:271" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:271" class="ju-code-link ju-function"><span class="ju-function">sender</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>                         <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:5" class="ju-code-link ju-var"><span class="ju-constructor">mkPair</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:24" class="ju-code-link ju-var"><span class="ju-constructor">none</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:23" class="ju-code-link ju-var"><span class="ju-constructor"><span class="ju-delimiter">(</span>some</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/engine_environment.html#arch.node.types.engine_environment:11" class="ju-code-link ju-function"><span class="ju-function"><span class="ju-delimiter">(</span>EngineEnvironment<span class="ju-delimiter">.</span>name</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:133" class="ju-code-link ju-function"><span class="ju-function">env</span></a></span><span class="ju-delimiter">)</span><span class="ju-delimiter">)</span><span class="ju-delimiter">;</span><br/>                       <span id="arch.node.engines.identity_management_behaviour:272"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:272" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:272" class="ju-code-link ju-function"><span class="ju-function">target</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:264" class="ju-code-link ju-var"><span class="ju-var">whoAsked</span></a></span><span class="ju-delimiter">;</span><br/>                       <span id="arch.node.engines.identity_management_behaviour:273"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:273" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:273" class="ju-code-link ju-function"><span class="ju-function">mailbox</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:23" class="ju-code-link ju-var"><span class="ju-constructor">some</span></a></span> <span class="ju-number">0</span><span class="ju-delimiter">;</span><br/>                       <span id="arch.node.engines.identity_management_behaviour:274"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:274" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:274" class="ju-code-link ju-function"><span class="ju-function">msg</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/anoma_message.html#arch.node.types.anoma_message:3" class="ju-code-link ju-constructor"><span class="ju-constructor">MsgIdentityManagement</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:265" class="ju-code-link ju-function"><span class="ju-function">responseMsg</span></a></span><br/>                     <span class="ju-delimiter">}</span><br/>                     <span class="ju-keyword">]</span><span class="ju-delimiter">;</span><br/>                   <span id="arch.node.engines.identity_management_behaviour:269"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:269" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:269" class="ju-code-link ju-function"><span class="ju-function">timers</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="ju-keyword">[</span><span class="ju-keyword">]</span><span class="ju-delimiter">;</span><br/>                   <span id="arch.node.engines.identity_management_behaviour:270"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:270" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:270" class="ju-code-link ju-function"><span class="ju-function">spawnedEngines</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="ju-keyword">[</span><span class="ju-keyword">]</span><br/>                 <span class="ju-delimiter">}</span><br/>               <span class="ju-keyword">|</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:23" class="ju-code-link ju-var"><span class="ju-constructor">some</span></a></span> <span class="ju-keyword">_</span> <span class="ju-keyword">:=</span><br/>                 <span class="ju-keyword">let</span><br/>                   <span id="arch.node.engines.identity_management_behaviour:275"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:275" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:275" class="ju-code-link ju-function"><span class="ju-function">updatedIdentities</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/Data/Map.html#Data.Map:37" class="ju-code-link ju-function"><span class="ju-function">Map<span class="ju-delimiter">.</span>delete</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:262" class="ju-code-link ju-var"><span class="ju-var">externalIdentity</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:136" class="ju-code-link ju-function"><span class="ju-function">identities</span></a></span><span class="ju-delimiter">;</span><br/>                   <span id="arch.node.engines.identity_management_behaviour:276"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:276" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:276" class="ju-code-link ju-function"><span class="ju-function">newLocalState</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>                     <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:135" class="ju-code-link ju-function"><span class="ju-function">local</span></a></span><span class="ju-keyword">@</span><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_environment.html#arch.node.engines.identity_management_environment:4" class="ju-code-link ju-inductive"><span class="ju-inductive">IdentityManagementLocalState</span></a></span><span class="ju-delimiter">{</span>identities <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:275" class="ju-code-link ju-function"><span class="ju-function">updatedIdentities</span></a></span><span class="ju-delimiter">}</span><span class="ju-delimiter">;</span><br/>                   <span id="arch.node.engines.identity_management_behaviour:277"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:277" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:277" class="ju-code-link ju-function"><span class="ju-function">newEnv&#39;</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>                     <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:133" class="ju-code-link ju-function"><span class="ju-function">env</span></a></span><span class="ju-keyword">@</span><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/engine_environment.html#arch.node.types.engine_environment:1" class="ju-code-link ju-inductive"><span class="ju-inductive">EngineEnvironment</span></a></span><span class="ju-delimiter">{</span>localState <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:276" class="ju-code-link ju-function"><span class="ju-function">newLocalState</span></a></span><span class="ju-delimiter">}</span><span class="ju-delimiter">;</span><br/>                   <span id="arch.node.engines.identity_management_behaviour:278"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:278" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:278" class="ju-code-link ju-function"><span class="ju-function">responseMsg</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>                     <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_messages.html#arch.node.engines.identity_management_messages:7" class="ju-code-link ju-constructor"><span class="ju-constructor">DeleteIdentityResponse</span></a></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span><br/>                       <span id="arch.node.engines.identity_management_behaviour:287"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:287" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:287" class="ju-code-link ju-function"><span class="ju-function">err</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:24" class="ju-code-link ju-var"><span class="ju-constructor">none</span></a></span><br/>                     <span class="ju-delimiter">}</span><span class="ju-delimiter">;</span><br/>                 <span class="ju-keyword">in</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/engine_behaviour.html#arch.node.types.engine_behaviour:41" class="ju-code-link ju-constructor"><span class="ju-constructor">mkActionEffect</span></a></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span><br/>                   <span id="arch.node.engines.identity_management_behaviour:288"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:288" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:288" class="ju-code-link ju-function"><span class="ju-function">newEnv</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:277" class="ju-code-link ju-function"><span class="ju-function">newEnv&#39;</span></a></span><span class="ju-delimiter">;</span><br/>                   <span id="arch.node.engines.identity_management_behaviour:289"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:289" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:289" class="ju-code-link ju-function"><span class="ju-function">producedMessages</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>                     <span class="ju-keyword">[</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/messages.html#arch.node.types.messages:3" class="ju-code-link ju-constructor"><span class="ju-constructor">mkEngineMessage</span></a></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span><br/>                       <span id="arch.node.engines.identity_management_behaviour:292"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:292" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:292" class="ju-code-link ju-function"><span class="ju-function">sender</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>                         <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:5" class="ju-code-link ju-var"><span class="ju-constructor">mkPair</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:24" class="ju-code-link ju-var"><span class="ju-constructor">none</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:23" class="ju-code-link ju-var"><span class="ju-constructor"><span class="ju-delimiter">(</span>some</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/engine_environment.html#arch.node.types.engine_environment:11" class="ju-code-link ju-function"><span class="ju-function"><span class="ju-delimiter">(</span>EngineEnvironment<span class="ju-delimiter">.</span>name</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:133" class="ju-code-link ju-function"><span class="ju-function">env</span></a></span><span class="ju-delimiter">)</span><span class="ju-delimiter">)</span><span class="ju-delimiter">;</span><br/>                       <span id="arch.node.engines.identity_management_behaviour:293"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:293" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:293" class="ju-code-link ju-function"><span class="ju-function">target</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:264" class="ju-code-link ju-var"><span class="ju-var">whoAsked</span></a></span><span class="ju-delimiter">;</span><br/>                       <span id="arch.node.engines.identity_management_behaviour:294"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:294" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:294" class="ju-code-link ju-function"><span class="ju-function">mailbox</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/prelude.html#prelude:23" class="ju-code-link ju-var"><span class="ju-constructor">some</span></a></span> <span class="ju-number">0</span><span class="ju-delimiter">;</span><br/>                       <span id="arch.node.engines.identity_management_behaviour:295"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:295" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:295" class="ju-code-link ju-function"><span class="ju-function">msg</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/anoma_message.html#arch.node.types.anoma_message:3" class="ju-code-link ju-constructor"><span class="ju-constructor">MsgIdentityManagement</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:278" class="ju-code-link ju-function"><span class="ju-function">responseMsg</span></a></span><br/>                     <span class="ju-delimiter">}</span><br/>                     <span class="ju-keyword">]</span><span class="ju-delimiter">;</span><br/>                   <span id="arch.node.engines.identity_management_behaviour:290"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:290" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:290" class="ju-code-link ju-function"><span class="ju-function">timers</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="ju-keyword">[</span><span class="ju-keyword">]</span><span class="ju-delimiter">;</span><br/>                   <span id="arch.node.engines.identity_management_behaviour:291"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:291" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:291" class="ju-code-link ju-function"><span class="ju-function">spawnedEngines</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="ju-keyword">[</span><span class="ju-keyword">]</span><br/>                 <span class="ju-delimiter">}</span><br/>             <span class="ju-delimiter">}</span><br/>           <span class="ju-keyword">|</span> <span class="ju-keyword">_</span> <span class="ju-keyword">:=</span><br/>             <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/engine_behaviour.html#arch.node.types.engine_behaviour:41" class="ju-code-link ju-constructor"><span class="ju-constructor">mkActionEffect</span></a></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span><br/>               <span id="arch.node.engines.identity_management_behaviour:296"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:296" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:296" class="ju-code-link ju-function"><span class="ju-function">newEnv</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:133" class="ju-code-link ju-function"><span class="ju-function">env</span></a></span><span class="ju-delimiter">;</span><br/>               <span id="arch.node.engines.identity_management_behaviour:297"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:297" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:297" class="ju-code-link ju-function"><span class="ju-function">producedMessages</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="ju-keyword">[</span><span class="ju-keyword">]</span><span class="ju-delimiter">;</span><br/>               <span id="arch.node.engines.identity_management_behaviour:298"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:298" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:298" class="ju-code-link ju-function"><span class="ju-function">timers</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="ju-keyword">[</span><span class="ju-keyword">]</span><span class="ju-delimiter">;</span><br/>               <span id="arch.node.engines.identity_management_behaviour:299"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:299" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:299" class="ju-code-link ju-function"><span class="ju-function">spawnedEngines</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="ju-keyword">[</span><span class="ju-keyword">]</span><br/>             <span class="ju-delimiter">}</span><span class="ju-delimiter">;</span></pre></code></pre>
<!-- --8<-- [end:action-function] -->

<h2 id="conflict-solver">Conflict solver<a class="headerlink" href="#conflict-solver" title="Permanent link">&para;</a></h2>
<pre class="highlight"><code class="juvix"><pre class="src-content"><span id="arch.node.engines.identity_management_behaviour:33"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:33" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:33" class="ju-code-link ju-function"><span class="ju-function">identityManagementConflictSolver</span></a></span></a></span></span><br/>  <span class="ju-keyword">:</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/Data/Set.html#Data.Set:1" class="ju-code-link ju-var"><span class="ju-inductive">Set</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:5" class="ju-code-link ju-inductive"><span class="ju-inductive">IdentityManagementMatchableArgument</span></a></span><br/>    <span class="ju-keyword">-&gt;</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/Juvix/Builtin/V1/List.html#Juvix.Builtin.V1.List:1" class="ju-code-link ju-inductive"><span class="ju-inductive">List</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/Data/Set.html#Data.Set:1" class="ju-code-link ju-var"><span class="ju-inductive"><span class="ju-delimiter">(</span>Set</span></a></span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:5" class="ju-code-link ju-inductive"><span class="ju-inductive">IdentityManagementMatchableArgument</span></a></span><span class="ju-delimiter">)</span><br/>  <span class="ju-keyword">|</span> <span class="ju-keyword">_</span> <span class="ju-keyword">:=</span> <span class="ju-keyword">[</span><span class="ju-keyword">]</span><span class="ju-delimiter">;</span></pre></code></pre>

<h2 id="identitymanagementbehaviour-type">IdentityManagementBehaviour type<a class="headerlink" href="#identitymanagementbehaviour-type" title="Permanent link">&para;</a></h2>
<!-- --8<-- [start:IdentityManagementBehaviour] -->
<pre class="highlight"><code class="juvix"><pre class="src-content"><span id="arch.node.engines.identity_management_behaviour:34"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:34" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:34" class="ju-code-link ju-function"><span class="ju-function">IdentityManagementBehaviour</span></a></span></a></span></span> <span class="ju-keyword">:</span> <span class="ju-keyword">Type</span> <span class="ju-keyword">:=</span><br/>  <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/engine_behaviour.html#arch.node.types.engine_behaviour:79" class="ju-code-link ju-inductive"><span class="ju-inductive">EngineBehaviour</span></a></span><br/>    <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_environment.html#arch.node.engines.identity_management_environment:4" class="ju-code-link ju-inductive"><span class="ju-inductive">IdentityManagementLocalState</span></a></span><br/>    <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_environment.html#arch.node.engines.identity_management_environment:1" class="ju-code-link ju-var"><span class="ju-inductive">IdentityManagementMailboxState</span></a></span><br/>    <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_environment.html#arch.node.engines.identity_management_environment:6" class="ju-code-link ju-var"><span class="ju-inductive">IdentityManagementTimerHandle</span></a></span><br/>    <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:5" class="ju-code-link ju-inductive"><span class="ju-inductive">IdentityManagementMatchableArgument</span></a></span><br/>    <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:1" class="ju-code-link ju-inductive"><span class="ju-inductive">IdentityManagementActionLabel</span></a></span><br/>    <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:7" class="ju-code-link ju-var"><span class="ju-inductive">IdentityManagementPrecomputation</span></a></span><span class="ju-delimiter">;</span></pre></code></pre>
<!-- --8<-- [end:IdentityManagementBehaviour] -->

<h2 id="identitymanagementbehaviour-instance">IdentityManagementBehaviour instance<a class="headerlink" href="#identitymanagementbehaviour-instance" title="Permanent link">&para;</a></h2>
<!-- --8<-- [start:IdentityManagementBehaviour-instance] -->
<pre class="highlight"><code class="juvix"><pre class="src-content"><span id="arch.node.engines.identity_management_behaviour:35"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:35" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:35" class="ju-code-link ju-function"><span class="ju-function">identityManagementBehaviour</span></a></span></a></span></span> <span class="ju-keyword">:</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:34" class="ju-code-link ju-function"><span class="ju-function">IdentityManagementBehaviour</span></a></span> <span class="ju-keyword">:=</span><br/>  <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/types/engine_behaviour.html#arch.node.types.engine_behaviour:80" class="ju-code-link ju-constructor"><span class="ju-constructor">mkEngineBehaviour</span></a></span><span class="ju-keyword">@</span><span class="ju-delimiter">{</span><br/>    <span id="arch.node.engines.identity_management_behaviour:300"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:300" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:300" class="ju-code-link ju-function"><span class="ju-function">guards</span></a></span></a></span></span> <span class="ju-keyword">:=</span><br/>      <span class="ju-keyword">[</span><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:20" class="ju-code-link ju-function"><span class="ju-function">generateIdentityGuard</span></a></span><span class="ju-delimiter">;</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:21" class="ju-code-link ju-function"><span class="ju-function">connectIdentityGuard</span></a></span><span class="ju-delimiter">;</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:22" class="ju-code-link ju-function"><span class="ju-function">deleteIdentityGuard</span></a></span><span class="ju-keyword">]</span><span class="ju-delimiter">;</span><br/>    <span id="arch.node.engines.identity_management_behaviour:301"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:301" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:301" class="ju-code-link ju-function"><span class="ju-function">action</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:32" class="ju-code-link ju-function"><span class="ju-function">identityManagementAction</span></a></span><span class="ju-delimiter">;</span><br/>    <span id="arch.node.engines.identity_management_behaviour:302"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:302" class="ju-code-link ju-function"><span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:302" class="ju-code-link ju-function"><span class="ju-function">conflictSolver</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="https://anoma.github.io/nspec/v2/arch/node/engines/identity_management_behaviour.html#arch.node.engines.identity_management_behaviour:33" class="ju-code-link ju-function"><span class="ju-function">identityManagementConflictSolver</span></a></span><br/>  <span class="ju-delimiter">}</span><span class="ju-delimiter">;</span></pre></code></pre>
<!-- --8<-- [end:IdentityManagementBehaviour-instance] -->

<!-- list_wikilinks -->

<!-- mermaid_wikilinks -->







  
    
  
  
    
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class="timeago" datetime="2024-11-06T04:55:17+01:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2024-11-06</span>
  </span>

    
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Created">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class="timeago" datetime="2024-11-06T01:08:53+01:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2024-11-06</span>
  </span>

    
    
    
  </aside>


  



  <form class="md-feedback" name="feedback" hidden>
    <fieldset>
      <legend class="md-feedback__title">
        Was this page helpful?
      </legend>
      <div class="md-feedback__inner">
        <div class="md-feedback__list">
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page was helpful" data-md-value="1">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12 21.35-1.45-1.32C5.4 15.36 2 12.27 2 8.5 2 5.41 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.08C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.41 22 8.5c0 3.77-3.4 6.86-8.55 11.53z"/></svg>
            </button>
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page could be improved" data-md-value="0">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12 21.35-1.45-1.32C5.4 15.36 2 12.27 2 8.5 2 5.41 4.42 3 7.5 3c.67 0 1.32.12 1.94.33L13 9.35l-4 5zM16.5 3C19.58 3 22 5.41 22 8.5c0 3.77-3.4 6.86-8.55 11.53L12 21.35l-1-7 4.5-5-2.65-5.08C13.87 3.47 15.17 3 16.5 3"/></svg>
            </button>
          
        </div>
        <div class="md-feedback__note">
          
            <div data-md-value="1" hidden>
              
              
                
              
              Thanks for your feedback!
            </div>
          
            <div data-md-value="0" hidden>
              
              
                
              
              Thanks for your feedback! We'll try to improve this page in the future.
            </div>
          
        </div>
      </div>
    </fieldset>
  </form>


                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  <div class="md-copyright__highlight">
    Powered by Mkdocs, Material 9.5.37-insiders-4.53.13 and Juvix v0.6.6 - Last updated: December 03, 2024 at 01:26 PM UTC
  </div>
  

  <ul>
    <li><a href="https://anoma.net/" target="_blank">Anoma Official Website</a> </li>
    <li><a href="https://art.anoma.net" target="_blank">Anoma Research Topics (ART)</a></li>
    <li><a href="https://anoma.net/blog" target="_blank">Anoma Blog</a></li>
    <li><a href="https://anoma.net/talks" target="_blank">Anoma Talks</a></li>
  </ul>
  <ul>
    <span class="md-copyright__highlight">Extra resources for Anoma
      Specification collaborators</span>
      
      <li><a href="https://anoma.github.io/nspec/v2/indexes/links.html">Quick links</a></li>
      <li><a href="https://anoma.github.io/nspec/v2/indexes/juvix_modules.html">Juvix modules</a></li>
      <li><a href="https://anoma.github.io/nspec/v2/tutorial/index.html">Markdown tutorials for writing Anoma
          Specification</a></li>
      <li><a href="https://anoma.github.io/nspec/v2/tutorial/engines/index.html">On engines in Anoma</a></li>
  </ul>
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://x.com/anoma" target="_blank" rel="noopener" title="x.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8l164.9-188.5L26.8 48h145.6l100.5 132.9zm-24.8 373.8h39.1L151.1 88h-42z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://github.com/anoma" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://anoma.net/blog" target="_blank" rel="noopener" title="anoma.net" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M192 32c0 17.7 14.3 32 32 32 123.7 0 224 100.3 224 224 0 17.7 14.3 32 32 32s32-14.3 32-32C512 128.9 383.1 0 224 0c-17.7 0-32 14.3-32 32m0 96c0 17.7 14.3 32 32 32 70.7 0 128 57.3 128 128 0 17.7 14.3 32 32 32s32-14.3 32-32c0-106-86-192-192-192-17.7 0-32 14.3-32 32m-96 16c0-26.5-21.5-48-48-48S0 117.5 0 144v224c0 79.5 64.5 144 144 144s144-64.5 144-144-64.5-144-144-144h-16v96h16c26.5 0 48 21.5 48 48s-21.5 48-48 48-48-21.5-48-48z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://research.anoma.net" target="_blank" rel="noopener" title="research.anoma.net" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M225.9 32C103.3 32 0 130.5 0 252.1 0 256 .1 480 .1 480l225.8-.2c122.7 0 222.1-102.3 222.1-223.9S348.6 32 225.9 32M224 384c-19.4 0-37.9-4.3-54.4-12.1L88.5 392l22.9-75c-9.8-18.1-15.4-38.9-15.4-61 0-70.7 57.3-128 128-128s128 57.3 128 128-57.3 128-128 128"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://youtube.com/anoma" target="_blank" rel="noopener" title="youtube.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305m-317.51 213.508V175.185l142.739 81.205z"/></svg>
    </a>
  
    
    
    
    
    <a href="mailto:arts@heliax.dev" target="_blank" rel="noopener" title="" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m20 8-8 5-8-5V6l8 5 8-5m0-2H4c-1.11 0-2 .89-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["announce.dismiss", "content.code.annotate", "content.code.copy", "content.tooltips", "search.highlight", "search.suggest", "search.sharing", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.instant.preview", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.prune", "navigation.indexes", "navigation.top", "toc.follow", "toc.integrate"], "search": "../../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.d6f25eb3.min.js"></script>
      
        <script src="../../../js/timeago.min.js"></script>
      
        <script src="../../../js/timeago_mkdocs_material.js"></script>
      
        <script src="../../../assets/js/extra.js"></script>
      
        <script src="../../../assets/js/highlight.js"></script>
      
        <script src="../../../assets/js/mathjax.js"></script>
      
        <script src="../../../assets/js/tex-svg-full.js"></script>
      
    
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>