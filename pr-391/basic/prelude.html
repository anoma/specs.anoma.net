
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="The Anoma specs is a collection of documents that describe the architecture, design, and implementation of the Anoma Network." name="description"/>
<meta content="Anoma Foundation" name="author"/>
<link href="https://specs.anoma.net/pr-391/prelude.juvix.html" rel="canonical"/>
<link href="assets/logo.svg" rel="icon"/>
<meta content="mkdocs-1.6.1, mkdocs-material-9.6.12" name="generator"/>
<title>Prelude - Anoma specs</title>
<link href="assets/stylesheets/main.2afb09e1.min.css" rel="stylesheet"/>
<link href="assets/stylesheets/palette.06af60db.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Inter";--md-code-font:"JetBrains Mono"}</style>
<link href="assets/css/juvix-material-style.css" rel="stylesheet"/>
<link href="assets/css/juvix-highlighting.css" rel="stylesheet"/>
<link href="assets/css/juvix_codeblock_footer.css" rel="stylesheet"/>
<link href="assets/css/latte-light.css" rel="stylesheet"/>
<link href="assets/css/extra.css" rel="stylesheet"/>
<script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
<link href="assets/stylesheets/glightbox.min.css" rel="stylesheet"><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="assets/javascripts/glightbox.min.js"></script></link></head>
<body data-md-color-accent="indigo" data-md-color-primary="white" data-md-color-scheme="default" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#juvix-specs-prelude">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
<aside class="md-banner">
<div class="md-banner__inner md-grid md-typeset">
<button aria-label="Don't show this again" class="md-banner__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
</button>
            
            
  For updates follow <strong>@anoma</strong> on
  <a href="https://x.com/anoma" rel="me">
<span class="twemoji x-twitter">
<svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8l164.9-188.5L26.8 48h145.6l100.5 132.9zm-24.8 373.8h39.1L151.1 88h-42z"></path></svg>
</span>
<strong></strong>
</a>
  and discuss on our
  <a href="https://research.anoma.net">
<span class="twemoji discourse">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M225.9 32C103.3 32 0 130.5 0 252.1 0 256 .1 480 .1 480l225.8-.2c122.7 0 222.1-102.3 222.1-223.9S348.6 32 225.9 32M224 384c-19.4 0-37.9-4.3-54.4-12.1L88.5 392l22.9-75c-9.8-18.1-15.4-38.9-15.4-61 0-70.7 57.3-128 128-128s128 57.3 128 128-57.3 128-128 128"></path></svg>
</span>
<strong>forum</strong>
</a>
</div>
<script>var el=document.querySelector("[data-md-component=announce]");if(el){var content=el.querySelector(".md-typeset");__md_hash(content.innerHTML)===__md_get("__announce")&&(el.hidden=!0)}</script>
</aside>
</div>
<header class="md-header md-header--shadow" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="Anoma specs" class="md-header__button md-logo" data-md-component="logo" href="index.html" title="Anoma specs">
<img alt="logo" src="assets/logo.svg"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
<span class="first-letter">A</span>noma 
              
                <span class="first-letter">s</span>pecs
              
              
                <span class="md-header__topic-version">(PR 391)</span>
</span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
              
                Prelude
              
            </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Switch to light mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme)" data-md-color-primary="white" data-md-color-scheme="default" id="__palette_0" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to light mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"></path></svg>
</label>
<input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="red" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="white" data-md-color-scheme="default" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_2" hidden="" title="Switch to dark mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
</label>
<input aria-label="Switch to system preference" class="md-option" data-md-color-accent="red" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="black" data-md-color-scheme="slate" id="__palette_2" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_0" hidden="" title="Switch to system preference">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
</label>
</form>
<script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M10.68 11.74a6 6 0 0 1-7.922-8.982 6 6 0 0 1 8.982 7.922l3.04 3.04a.749.749 0 0 1-.326 1.275.75.75 0 0 1-.734-.215ZM11.5 7a4.499 4.499 0 1 0-8.997 0A4.499 4.499 0 0 0 11.5 7"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M10.68 11.74a6 6 0 0 1-7.922-8.982 6 6 0 0 1 8.982 7.922l3.04 3.04a.749.749 0 0 1-.326 1.275.75.75 0 0 1-.734-.215ZM11.5 7a4.499 4.499 0 1 0-8.997 0A4.499 4.499 0 0 0 11.5 7"></path></svg>
<svg viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M7.78 12.53a.75.75 0 0 1-1.06 0L2.47 8.28a.75.75 0 0 1 0-1.06l4.25-4.25a.75.75 0 0 1 1.042.018.75.75 0 0 1 .018 1.042L4.81 7h7.44a.75.75 0 0 1 0 1.5H4.81l2.97 2.97a.75.75 0 0 1 0 1.06"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
</button>
</nav>
<div class="md-search__suggest" data-md-component="search-suggest"></div>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="" tabindex="0">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/anoma/nspec" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg>
</div>
<div class="md-source__repository">
    anoma/nspec
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<!--
  This is a modified version of the original mkdocs-material theme.
  Copyright (c) 2016-2025 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->
<!-- Determine classes -->
<!-- Navigation -->
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<!-- Site title -->
<label class="md-nav__title" for="__drawer">
<a aria-label="Anoma specs" class="md-nav__button md-logo" data-md-component="logo" href="index.html" title="Anoma specs">
<img alt="logo" src="assets/logo.svg"/>
</a>
    Anoma specs
  </label>
<!-- List of Versions -->
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="https://specs.anoma.net/latest" target="_blank">
     Latest version ((PR 391))
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="https://specs.anoma.net/main">
        Development version
      </a>
</li>
</ul>
<!-- Navigation list -->
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="index.html">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"></path></svg>
<span class="md-ellipsis">
    Home
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="arch/overview.html">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M24 18.714v4.8c0 .288-.192.48-.48.48h-4.8c-.288 0-.48-.192-.48-.48v-4.8c0-.288.192-.48.48-.48h1.92v-1.92h-8.16v1.92h1.92c.288 0 .48.192.48.48v4.8c0 .288-.192.48-.48.48H9.6c-.288 0-.48-.192-.48-.48v-4.8c0-.288.192-.48.48-.48h1.92v-1.92H3.36v1.92h1.92c.288 0 .48.192.48.48v4.8c0 .288-.192.48-.48.48H.48c-.288 0-.48-.192-.48-.48v-4.8c0-.288.192-.48.48-.48H2.4v-2.4c0-.288.192-.48.48-.48h8.64v-1.44h.96v1.44h8.64c.288 0 .48.192.48.48v2.4h1.92c.288 0 .48.192.48.48m-13.92 4.32h3.84v-3.84h-3.84zm-9.12 0H4.8v-3.84H.96Zm18.24 0h3.84v-3.84H19.2ZM6.24 9.642V3.546c0-.192.096-.336.24-.432L11.76.042a.8.8 0 0 1 .48 0l5.28 3.072c.144.096.24.24.24.432v6.096c0 .144-.096.288-.24.384l-5.28 3.072q-.096.048-.24.048t-.24-.048l-5.28-3.072c-.144-.096-.24-.24-.24-.384m10.56-.288V4.362l-4.32 2.496v4.992zm-9.6 0 4.32 2.496V6.858L7.2 4.362Zm.48-5.808L12 5.994l4.32-2.448L12 1.05Z"></path></svg>
<span class="md-ellipsis">
    Anoma architecture
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="changelog.html">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 21.5c-1.35-.85-3.8-1.5-5.5-1.5-1.65 0-3.35.3-4.75 1.05-.1.05-.15.05-.25.05-.25 0-.5-.25-.5-.5V6c.6-.45 1.25-.75 2-1 1.11-.35 2.33-.5 3.5-.5 1.95 0 4.05.4 5.5 1.5 1.45-1.1 3.55-1.5 5.5-1.5 1.17 0 2.39.15 3.5.5.75.25 1.4.55 2 1v14.6c0 .25-.25.5-.5.5-.1 0-.15 0-.25-.05-1.4-.75-3.1-1.05-4.75-1.05-1.7 0-4.15.65-5.5 1.5M12 8v11.5c1.35-.85 3.8-1.5 5.5-1.5 1.2 0 2.4.15 3.5.5V7c-1.1-.35-2.3-.5-3.5-.5-1.7 0-4.15.65-5.5 1.5m1 3.5c1.11-.68 2.6-1 4.5-1 .91 0 1.76.09 2.5.28V9.23c-.87-.15-1.71-.23-2.5-.23q-2.655 0-4.5.84zm4.5.17c-1.71 0-3.21.26-4.5.79v1.69c1.11-.65 2.6-.99 4.5-.99 1.04 0 1.88.08 2.5.24v-1.5c-.87-.16-1.71-.23-2.5-.23m2.5 2.9c-.87-.16-1.71-.24-2.5-.24-1.83 0-3.33.27-4.5.8v1.69c1.11-.66 2.6-.99 4.5-.99 1.04 0 1.88.08 2.5.24z"></path></svg>
<span class="md-ellipsis">
    Changelog
    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
<span class="md-ellipsis">
    Indexes
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
            Indexes
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="indexes/tags.html">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M5.5 7A1.5 1.5 0 0 1 4 5.5 1.5 1.5 0 0 1 5.5 4 1.5 1.5 0 0 1 7 5.5 1.5 1.5 0 0 1 5.5 7m15.91 4.58-9-9C12.05 2.22 11.55 2 11 2H4c-1.11 0-2 .89-2 2v7c0 .55.22 1.05.59 1.41l8.99 9c.37.36.87.59 1.42.59s1.05-.23 1.41-.59l7-7c.37-.36.59-.86.59-1.41 0-.56-.23-1.06-.59-1.42"></path></svg>
<span class="md-ellipsis">
    List of tags
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="indexes/modules.html">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 10h-2V8h2m0 5h-2v-2h2m-3-1h-2V8h2m0 5h-2v-2h2m0 6H8v-2h8m-9-5H5V8h2m0 5H5v-2h2m1 0h2v2H8m0-5h2v2H8m3 1h2v2h-2m0-5h2v2h-2m9-5H4c-1.11 0-2 .89-2 2v10a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2"></path></svg>
<span class="md-ellipsis">
    List of modules
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
<span class="md-ellipsis">
    System architecture
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_5_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_5">
<span class="md-nav__icon md-icon"></span>
            System architecture
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="arch/system/identity/identity.html">
<span class="md-ellipsis">
    Identity Architecture
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="arch/system/state/resource_machine/index.html">
<span class="md-ellipsis">
    State Architecture
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
<span class="md-ellipsis">
    Integrations
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_6_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_6">
<span class="md-nav__icon md-icon"></span>
            Integrations
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="arch/integrations/adapters/index.html">
<span class="md-ellipsis">
    Protocol Adapters
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_7" type="checkbox"/>
<label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="">
<span class="md-ellipsis">
    Tutorials
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_7_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_7">
<span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="tutorial/principles_and_guidelines.html">
<span class="md-ellipsis">
    Contributor guidelines
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#combinators">
<span class="md-ellipsis">
      Combinators
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#useful-type-classes">
<span class="md-ellipsis">
      Useful Type Classes
    </span>
</a>
<nav aria-label="Useful Type Classes" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#functor">
<span class="md-ellipsis">
      Functor
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#applicative">
<span class="md-ellipsis">
      Applicative
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#monad">
<span class="md-ellipsis">
      Monad
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#bifunctor">
<span class="md-ellipsis">
      Bifunctor
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#associativeproduct">
<span class="md-ellipsis">
      AssociativeProduct
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#commutativeproduct">
<span class="md-ellipsis">
      CommutativeProduct
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#unitalproduct">
<span class="md-ellipsis">
      UnitalProduct
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#traversable">
<span class="md-ellipsis">
      Traversable
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#bool">
<span class="md-ellipsis">
      Bool
    </span>
</a>
<nav aria-label="Bool" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#xor">
<span class="md-ellipsis">
      xor
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#nand">
<span class="md-ellipsis">
      nand
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#nor">
<span class="md-ellipsis">
      nor
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#nat">
<span class="md-ellipsis">
      Nat
    </span>
</a>
<nav aria-label="Nat" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#pred">
<span class="md-ellipsis">
      pred
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#booltonat">
<span class="md-ellipsis">
      boolToNat
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#iszero">
<span class="md-ellipsis">
      isZero
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#iseven-and-isodd">
<span class="md-ellipsis">
      isEven and isOdd
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#foldnat">
<span class="md-ellipsis">
      foldNat
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#iter">
<span class="md-ellipsis">
      iter
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#exp">
<span class="md-ellipsis">
      exp
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#factorial">
<span class="md-ellipsis">
      factorial
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#gcd">
<span class="md-ellipsis">
      gcd
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lcm">
<span class="md-ellipsis">
      lcm
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#string">
<span class="md-ellipsis">
      String
    </span>
</a>
<nav aria-label="String" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#comparison-instance-for-string">
<span class="md-ellipsis">
      Comparison instance for String
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#bytestring">
<span class="md-ellipsis">
      ByteString
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#unit">
<span class="md-ellipsis">
      Unit
    </span>
</a>
<nav aria-label="Unit" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#trivial">
<span class="md-ellipsis">
      trivial
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#empty">
<span class="md-ellipsis">
      Empty
    </span>
</a>
<nav aria-label="Empty" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#explode">
<span class="md-ellipsis">
      explode
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#pair-a-b">
<span class="md-ellipsis">
      Pair A B
    </span>
</a>
<nav aria-label="Pair A B" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#fst-and-snd">
<span class="md-ellipsis">
      fst and snd
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#paircommutativeproduct">
<span class="md-ellipsis">
      PairCommutativeProduct
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#pairassociativeproduct">
<span class="md-ellipsis">
      PairAssociativeProduct
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#pairunitalproduct">
<span class="md-ellipsis">
      PairUnitalProduct
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#pairbifunctor">
<span class="md-ellipsis">
      PairBifunctor
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#fork">
<span class="md-ellipsis">
      fork
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#result-a-b">
<span class="md-ellipsis">
      Result A B
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#either-a-b">
<span class="md-ellipsis">
      Either A B
    </span>
</a>
<nav aria-label="Either A B" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#isleft-and-isright">
<span class="md-ellipsis">
      isLeft and isRight
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#fromleft">
<span class="md-ellipsis">
      fromLeft
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#fromright">
<span class="md-ellipsis">
      fromRight
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#eithercommutativeproduct">
<span class="md-ellipsis">
      EitherCommutativeProduct
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#eitherbifunctor">
<span class="md-ellipsis">
      EitherBifunctor
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#eitherunitalproduct">
<span class="md-ellipsis">
      EitherUnitalProduct
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#fuse">
<span class="md-ellipsis">
      fuse
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#eitherassociativeproduct">
<span class="md-ellipsis">
      EitherAssociativeProduct
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#option-a">
<span class="md-ellipsis">
      Option A
    </span>
</a>
<nav aria-label="Option A" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#isnone">
<span class="md-ellipsis">
      isNone
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#issome">
<span class="md-ellipsis">
      isSome
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#fromoption">
<span class="md-ellipsis">
      fromOption
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#option">
<span class="md-ellipsis">
      option
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#filteroption">
<span class="md-ellipsis">
      filterOption
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#list-a">
<span class="md-ellipsis">
      List A
    </span>
</a>
<nav aria-label="List A" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#findindex">
<span class="md-ellipsis">
      findIndex
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#last">
<span class="md-ellipsis">
      last
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#most">
<span class="md-ellipsis">
      most
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#snoc">
<span class="md-ellipsis">
      snoc
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#uncons">
<span class="md-ellipsis">
      uncons
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#unsnoc">
<span class="md-ellipsis">
      unsnoc
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#unfold">
<span class="md-ellipsis">
      unfold
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#unzip">
<span class="md-ellipsis">
      unzip
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#catoptions">
<span class="md-ellipsis">
      catOptions
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#maximumby">
<span class="md-ellipsis">
      maximumBy
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#minimumby">
<span class="md-ellipsis">
      minimumBy
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#chunksof">
<span class="md-ellipsis">
      chunksOf
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#sliding">
<span class="md-ellipsis">
      sliding
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#span">
<span class="md-ellipsis">
      span
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#groupby-and-group">
<span class="md-ellipsis">
      groupBy and group
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#powerlists">
<span class="md-ellipsis">
      powerlists
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#set-a">
<span class="md-ellipsis">
      Set A
    </span>
</a>
<nav aria-label="Set A" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#cartesianproduct">
<span class="md-ellipsis">
      cartesianProduct
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#powerset">
<span class="md-ellipsis">
      powerset
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ispropersubset">
<span class="md-ellipsis">
      isProperSubset
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#map-k-v">
<span class="md-ellipsis">
      Map K V
    </span>
</a>
<nav aria-label="Map K V" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#updatelookupwithkey">
<span class="md-ellipsis">
      updateLookupWithKey
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#mapkeys">
<span class="md-ellipsis">
      mapKeys
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#restrictkeys">
<span class="md-ellipsis">
      restrictKeys
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#withoutkeys">
<span class="md-ellipsis">
      withoutKeys
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#mappartition">
<span class="md-ellipsis">
      mapPartition
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#partitionwithkey">
<span class="md-ellipsis">
      partitionWithKey
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#mapoption">
<span class="md-ellipsis">
      mapOption
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#mapoptionwithkey">
<span class="md-ellipsis">
      mapOptionWithKey
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#mapeither">
<span class="md-ellipsis">
      mapEither
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#mapeitherwithkey">
<span class="md-ellipsis">
      mapEitherWithKey
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#undefined-values">
<span class="md-ellipsis">
      Undefined values
    </span>
</a>
<nav aria-label="Undefined values" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#undef">
<span class="md-ellipsis">
      undef
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#todo">
<span class="md-ellipsis">
      TODO
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#omap-k-v">
<span class="md-ellipsis">
      OMap K V
    </span>
</a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<!--
  This is a modified version of the original mkdocs-material theme.
  Copyright (c) 2016-2025 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->
<!-- Tags -->
<nav class="md-tags">
<span class="md-tag">index</span>
<span class="md-tag">prelude</span>
</nav>
<!-- Actions -->
<!--
  Copyright (c) 2016-2025 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->
<!-- Actions -->
<!-- Edit button -->
<a class="md-content__button md-icon" href="https://github.com/anoma/nspec/edit/main/docs/prelude.juvix.md" title="Edit this page">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M6 2c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-1.9l10-10V8l-6-6zm7 1.5L18.5 9H13zm7.1 9.5c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-2 1.8L12 20.9V23h2.1l6.1-6.1z"></path></svg>
</a>
<!-- View button -->
<a class="md-content__button md-icon" href="https://github.com/anoma/nspec/raw/main/docs/prelude.juvix.md" title="View source of this page">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20.56 18H3.44C2.65 18 2 17.37 2 16.59V7.41C2 6.63 2.65 6 3.44 6h17.12c.79 0 1.44.63 1.44 1.41v9.18c0 .78-.65 1.41-1.44 1.41M6.81 15.19v-3.66l1.92 2.35 1.92-2.35v3.66h1.93V8.81h-1.93l-1.92 2.35-1.92-2.35H4.89v6.38zM19.69 12h-1.92V8.81h-1.92V12h-1.93l2.89 3.28z"></path></svg>
</a>
<!-- If the page source ends with .juvix.md, we show a button to view the raw code -->
<a class="md-content__button md-icon" href="prelude-src.html" title="View Raw Juvix Code">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M8 3a2 2 0 0 0-2 2v4a2 2 0 0 1-2 2H3v2h1a2 2 0 0 1 2 2v4a2 2 0 0 0 2 2h2v-2H8v-5a2 2 0 0 0-2-2 2 2 0 0 0 2-2V5h2V3m6 0a2 2 0 0 1 2 2v4a2 2 0 0 0 2 2h1v2h-1a2 2 0 0 0-2 2v4a2 2 0 0 1-2 2h-2v-2h2v-5a2 2 0 0 1 2-2 2 2 0 0 1-2-2V5h-2V3z"></path></svg>
</a>
<!--
  Hack: check whether the content contains a h1 headline. If it doesn't, the
  page title (or respectively site name) is used as the main headline.
-->
<!-- Page content -->
<details class="code">
<summary>Juvix imports</summary>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-0-1">module prelude;
</span><span id="__ispan-0-2">import Stdlib.Trait open public;
</span><span id="__ispan-0-3">import Stdlib.Trait.Ord open using {Ordering; module Ordering; Equal; isEqual} public;
</span><span id="__ispan-0-4">import Stdlib.Trait.Eq open using {==} public;
</span><span id="__ispan-0-5">import Stdlib.Debug.Fail open using {failwith};
</span><span id="__ispan-0-6">import Stdlib.Data.Fixity open public;
</span></code></pre></div>
</details>
<h1 id="juvix-specs-prelude">Juvix Specs Prelude<a class="headerlink" href="#juvix-specs-prelude" title="Anchor link to this section for reference">¶</a></h1>
<p>The following are frequent and basic abstractions used in the Anoma
specification.</p>
<h2 id="combinators">Combinators<a class="headerlink" href="#combinators" title="Anchor link to this section for reference">¶</a></h2>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-1-1">import Stdlib.Function open
</span><span id="__ispan-1-2">  using {
</span><span id="__ispan-1-3">    &lt;&lt;;
</span><span id="__ispan-1-4">    &gt;&gt;;
</span><span id="__ispan-1-5">    const;
</span><span id="__ispan-1-6">    id;
</span><span id="__ispan-1-7">    flip;
</span><span id="__ispan-1-8">    &lt;|;
</span><span id="__ispan-1-9">    |&gt;;
</span><span id="__ispan-1-10">    iterate;
</span><span id="__ispan-1-11">    &gt;-&gt;;
</span><span id="__ispan-1-12">  } public;
</span></code></pre></div>
<h2 id="useful-type-classes">Useful Type Classes<a class="headerlink" href="#useful-type-classes" title="Anchor link to this section for reference">¶</a></h2>
<h3 id="functor"><code>Functor</code><a class="headerlink" href="#functor" title="Anchor link to this section for reference">¶</a></h3>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-2-1">import Stdlib.Trait.Functor.Polymorphic as Functor;
</span></code></pre></div>
<h3 id="applicative"><code>Applicative</code><a class="headerlink" href="#applicative" title="Anchor link to this section for reference">¶</a></h3>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-3-1">import Stdlib.Trait.Applicative as Applicative
</span><span id="__ispan-3-2">  open using
</span><span id="__ispan-3-3">  { Applicative;
</span><span id="__ispan-3-4">  } public;
</span><span id="__ispan-3-5">import Stdlib.Trait.Applicative as Applicative
</span><span id="__ispan-3-6">  open using
</span><span id="__ispan-3-7">  { Applicative;
</span><span id="__ispan-3-8">  } public;
</span></code></pre></div>
<h3 id="monad"><code>Monad</code><a class="headerlink" href="#monad" title="Anchor link to this section for reference">¶</a></h3>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-4-1">import Stdlib.Trait.Monad as Monad
</span><span id="__ispan-4-2">  open using {Monad} public;
</span><span id="__ispan-4-3">import Stdlib.Trait.Monad as Monad
</span><span id="__ispan-4-4">  open using {Monad} public;
</span></code></pre></div>
<h4 id="join"><code>join</code><a class="headerlink" href="#join" title="Anchor link to this section for reference">¶</a></h4>
<p>Join function for monads</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-5-1">join
</span><span id="__ispan-5-2">  {M : Type -&gt; Type}
</span><span id="__ispan-5-3">  {A}
</span><span id="__ispan-5-4">  {{Monad M}}
</span><span id="__ispan-5-5">  (mma : M (M A)) : M A :=
</span><span id="__ispan-5-6">  bind mma id;  -- using the built-in `bind`
</span></code></pre></div>
<h3 id="bifunctor"><code>Bifunctor</code><a class="headerlink" href="#bifunctor" title="Anchor link to this section for reference">¶</a></h3>
<p>Two-argument functor</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-6-1">trait
</span><span id="__ispan-6-2">type Bifunctor (F : Type -&gt; Type -&gt; Type) :=
</span><span id="__ispan-6-3">  mk@{
</span><span id="__ispan-6-4">    bimap {A B C D} :  (A -&gt; C) -&gt; (B -&gt; D) -&gt; F A B -&gt; F C D
</span><span id="__ispan-6-5">  };
</span></code></pre></div>
<h3 id="associativeproduct"><code>AssociativeProduct</code><a class="headerlink" href="#associativeproduct" title="Anchor link to this section for reference">¶</a></h3>
<p>Product with associators</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-7-1">trait
</span><span id="__ispan-7-2">type AssociativeProduct (F : Type -&gt; Type -&gt; Type) :=
</span><span id="__ispan-7-3">  mk@{
</span><span id="__ispan-7-4">    assocLeft {A B C} : F A (F B C) -&gt; F (F A B) C;
</span><span id="__ispan-7-5">    assocRight {A B C} : F (F A B) C -&gt; F A (F B C)
</span><span id="__ispan-7-6">  };
</span></code></pre></div>
<h3 id="commutativeproduct"><code>CommutativeProduct</code><a class="headerlink" href="#commutativeproduct" title="Anchor link to this section for reference">¶</a></h3>
<p>Product with commuters</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-8-1">trait
</span><span id="__ispan-8-2">type CommutativeProduct (F : Type -&gt; Type -&gt; Type) :=
</span><span id="__ispan-8-3">  mk@{
</span><span id="__ispan-8-4">    swap {A B} : F A B -&gt; F B A;
</span><span id="__ispan-8-5">  };
</span></code></pre></div>
<h3 id="unitalproduct"><code>UnitalProduct</code><a class="headerlink" href="#unitalproduct" title="Anchor link to this section for reference">¶</a></h3>
<p>Product with units</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-9-1">trait
</span><span id="__ispan-9-2">type UnitalProduct U (F : Type -&gt; Type -&gt; Type) :=
</span><span id="__ispan-9-3">  mk@{
</span><span id="__ispan-9-4">    unitLeft {A} : A -&gt; F U A;
</span><span id="__ispan-9-5">    unUnitLeft {A} : F U A -&gt; A;
</span><span id="__ispan-9-6">    unitRight {A} : A -&gt; F A U;
</span><span id="__ispan-9-7">    unUnitRight {A} : F A U -&gt; A;
</span><span id="__ispan-9-8">  };
</span></code></pre></div>
<h3 id="traversable"><code>Traversable</code><a class="headerlink" href="#traversable" title="Anchor link to this section for reference">¶</a></h3>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-10-1">import Stdlib.Trait.Traversable as Traversable
</span><span id="__ispan-10-2">  open using {
</span><span id="__ispan-10-3">    Traversable;
</span><span id="__ispan-10-4">    sequenceA;
</span><span id="__ispan-10-5">    traverse;
</span><span id="__ispan-10-6">    } public;
</span><span id="__ispan-10-7">import Stdlib.Trait.Traversable as Traversable
</span><span id="__ispan-10-8">  open using {
</span><span id="__ispan-10-9">    Traversable;
</span><span id="__ispan-10-10">    sequenceA;
</span><span id="__ispan-10-11">    traverse;
</span><span id="__ispan-10-12">    } public;
</span></code></pre></div>
<h2 id="bool">Bool<a class="headerlink" href="#bool" title="Anchor link to this section for reference">¶</a></h2>
<p>The type <code>Bool</code> represents boolean values (<code>true</code> or <code>false</code>). Used for logical operations and conditions.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-11-1">import Stdlib.Data.Bool as Bool
</span><span id="__ispan-11-2">  open using
</span><span id="__ispan-11-3">  { Bool;
</span><span id="__ispan-11-4">    true;
</span><span id="__ispan-11-5">    false;
</span><span id="__ispan-11-6">    &amp;&amp;;
</span><span id="__ispan-11-7">    ||;
</span><span id="__ispan-11-8">    not;
</span><span id="__ispan-11-9">    or;
</span><span id="__ispan-11-10">    and;
</span><span id="__ispan-11-11">  } public;
</span></code></pre></div>
<p>For example,</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-12-1">verdad : Bool := true;
</span></code></pre></div>
<h3 id="xor"><code>xor</code><a class="headerlink" href="#xor" title="Anchor link to this section for reference">¶</a></h3>
<p>Exlusive or</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-13-1">xor (a b : Bool) : Bool :=
</span><span id="__ispan-13-2">  if
</span><span id="__ispan-13-3">    | a := not b
</span><span id="__ispan-13-4">    | else := b
</span><span id="__ispan-13-5">  ;
</span></code></pre></div>
<h3 id="nand"><code>nand</code><a class="headerlink" href="#nand" title="Anchor link to this section for reference">¶</a></h3>
<p>Not and</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-14-1">nand (a b : Bool) : Bool := not (and a b);
</span></code></pre></div>
<h3 id="nor"><code>nor</code><a class="headerlink" href="#nor" title="Anchor link to this section for reference">¶</a></h3>
<p>Not or</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-15-1">nor (a b : Bool) : Bool := not (or a b);
</span></code></pre></div>
<h2 id="nat"><code>Nat</code><a class="headerlink" href="#nat" title="Anchor link to this section for reference">¶</a></h2>
<p>The type <code>Nat</code> represents natural numbers (non-negative integers). Used for
counting and indexing.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-16-1">import Stdlib.Data.Nat as Nat
</span><span id="__ispan-16-2">  open using
</span><span id="__ispan-16-3">  { Nat;
</span><span id="__ispan-16-4">    zero;
</span><span id="__ispan-16-5">    suc;
</span><span id="__ispan-16-6">    natToString;
</span><span id="__ispan-16-7">    +;
</span><span id="__ispan-16-8">    sub;
</span><span id="__ispan-16-9">    *;
</span><span id="__ispan-16-10">    div;
</span><span id="__ispan-16-11">    mod;
</span><span id="__ispan-16-12">    ==;
</span><span id="__ispan-16-13">    &lt;=;
</span><span id="__ispan-16-14">    &gt;;
</span><span id="__ispan-16-15">    &lt;;
</span><span id="__ispan-16-16">    min;
</span><span id="__ispan-16-17">    max;
</span><span id="__ispan-16-18">  } public;
</span></code></pre></div>
<p>For example,</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-17-1">ten : Nat := 10;
</span></code></pre></div>
<h3 id="pred"><code>pred</code><a class="headerlink" href="#pred" title="Anchor link to this section for reference">¶</a></h3>
<p>Predecessor function for natural numbers.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-18-1">pred (n : Nat) : Nat :=
</span><span id="__ispan-18-2">  case n of {
</span><span id="__ispan-18-3">    | zero := zero
</span><span id="__ispan-18-4">    | suc k := k
</span><span id="__ispan-18-5">  };
</span></code></pre></div>
<h3 id="booltonat"><code>boolToNat</code><a class="headerlink" href="#booltonat" title="Anchor link to this section for reference">¶</a></h3>
<p>Convert boolean to a Bool to a Nat in the standard way of circuits.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-19-1">boolToNat (b : Bool) : Nat :=
</span><span id="__ispan-19-2">  if
</span><span id="__ispan-19-3">    | b := 0
</span><span id="__ispan-19-4">    | else := 1
</span><span id="__ispan-19-5">  ;
</span></code></pre></div>
<h3 id="iszero"><code>isZero</code><a class="headerlink" href="#iszero" title="Anchor link to this section for reference">¶</a></h3>
<p>Check if a natural number is zero.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-20-1">isZero (n : Nat) : Bool :=
</span><span id="__ispan-20-2">  case n of {
</span><span id="__ispan-20-3">    | zero := true
</span><span id="__ispan-20-4">    | suc k := false
</span><span id="__ispan-20-5">  };
</span></code></pre></div>
<h3 id="iseven-and-isodd"><code>isEven</code> and <code>isOdd</code><a class="headerlink" href="#iseven-and-isodd" title="Anchor link to this section for reference">¶</a></h3>
<p>Parity checking functions</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-21-1">isEven (n : Nat) : Bool := mod n 2 == 0;
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-22-1">isOdd (n : Nat) : Bool := not (isEven n);
</span></code></pre></div>
<h3 id="foldnat"><code>foldNat</code><a class="headerlink" href="#foldnat" title="Anchor link to this section for reference">¶</a></h3>
<p>Fold over natural numbers.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-23-1">terminating
</span><span id="__ispan-23-2">foldNat {B} (z : B) (f : Nat -&gt; B -&gt; B) (n : Nat) : B :=
</span><span id="__ispan-23-3">  case n of {
</span><span id="__ispan-23-4">    | zero := z
</span><span id="__ispan-23-5">    | suc k := f k (foldNat z f k)
</span><span id="__ispan-23-6">  };
</span></code></pre></div>
<h3 id="iter"><code>iter</code><a class="headerlink" href="#iter" title="Anchor link to this section for reference">¶</a></h3>
<p>Iteration of a function.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-24-1">iter {A} (f : A -&gt; A) (n : Nat) (x : A) : A :=
</span><span id="__ispan-24-2">  foldNat x \{_ y := f y} n;
</span></code></pre></div>
<h3 id="exp"><code>exp</code><a class="headerlink" href="#exp" title="Anchor link to this section for reference">¶</a></h3>
<p>The exponentiation function.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-25-1">exp (base : Nat) (exponent : Nat) : Nat :=
</span><span id="__ispan-25-2">  iter \{product := base * product} exponent 1;
</span></code></pre></div>
<h3 id="factorial"><code>factorial</code><a class="headerlink" href="#factorial" title="Anchor link to this section for reference">¶</a></h3>
<p>The factorial function.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-26-1">factorial : Nat -&gt; Nat := foldNat 1 \{k r := suc k * r};
</span></code></pre></div>
<h3 id="gcd"><code>gcd</code><a class="headerlink" href="#gcd" title="Anchor link to this section for reference">¶</a></h3>
<p>Greatest common divisor function.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-27-1">terminating
</span><span id="__ispan-27-2">gcd (a b : Nat) : Nat :=
</span><span id="__ispan-27-3">  case b of {
</span><span id="__ispan-27-4">    | zero := a
</span><span id="__ispan-27-5">    | suc _ := gcd b (mod a b)
</span><span id="__ispan-27-6">  };
</span></code></pre></div>
<h3 id="lcm"><code>lcm</code><a class="headerlink" href="#lcm" title="Anchor link to this section for reference">¶</a></h3>
<p>Least common multiple function.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-28-1">lcm (a b : Nat) : Nat :=
</span><span id="__ispan-28-2">  case b of {
</span><span id="__ispan-28-3">    | zero := zero
</span><span id="__ispan-28-4">    | suc _ :=
</span><span id="__ispan-28-5">      case a of {
</span><span id="__ispan-28-6">        | zero := zero
</span><span id="__ispan-28-7">        | suc _ := div (a * b) (gcd a b)
</span><span id="__ispan-28-8">      }
</span><span id="__ispan-28-9">    };
</span></code></pre></div>
<h2 id="string"><code>String</code><a class="headerlink" href="#string" title="Anchor link to this section for reference">¶</a></h2>
<p>The type <code>String</code> represents sequences of characters. Used for text and
communication.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-29-1">import Stdlib.Data.String
</span><span id="__ispan-29-2">  as String
</span><span id="__ispan-29-3">  open using
</span><span id="__ispan-29-4">  { String;
</span><span id="__ispan-29-5">    ++str;
</span><span id="__ispan-29-6">  } public;
</span></code></pre></div>
<p>For example,</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-30-1">hello : String := "Hello, World!";
</span></code></pre></div>
<h3 id="comparison-instance-for-string">Comparison instance for <code>String</code><a class="headerlink" href="#comparison-instance-for-string" title="Anchor link to this section for reference">¶</a></h3>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-31-1">stringCmp (s1 s2 : String) : Ordering :=
</span><span id="__ispan-31-2">  if
</span><span id="__ispan-31-3">    | s1 == s2 := Ordering.Equal
</span><span id="__ispan-31-4">    | else := Ordering.GreaterThan
</span><span id="__ispan-31-5">  ;
</span><span id="__ispan-31-6">
</span><span id="__ispan-31-7">instance
</span><span id="__ispan-31-8">StringOrd : Ord String :=
</span><span id="__ispan-31-9">  Ord.mk@{
</span><span id="__ispan-31-10">    compare := stringCmp;
</span><span id="__ispan-31-11">  };
</span></code></pre></div>
<h2 id="bytestring"><code>ByteString</code><a class="headerlink" href="#bytestring" title="Anchor link to this section for reference">¶</a></h2>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-32-1">ByteString : Type := String;
</span></code></pre></div>
<p>A basic type for representing binary data.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-33-1">emptyByteString : ByteString := "";
</span></code></pre></div>
<h2 id="unit"><code>Unit</code><a class="headerlink" href="#unit" title="Anchor link to this section for reference">¶</a></h2>
<p>The type <code>Unit</code> represents a type with a single value. Often used when a
function does not return any meaningful value.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-34-1">import Stdlib.Data.Unit
</span><span id="__ispan-34-2">  as Unit
</span><span id="__ispan-34-3">  open using {
</span><span id="__ispan-34-4">    Unit;
</span><span id="__ispan-34-5">    unit
</span><span id="__ispan-34-6">  } public;
</span></code></pre></div>
<p>For example,</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-35-1">unitValue : Unit := unit;
</span></code></pre></div>
<h3 id="trivial"><code>trivial</code><a class="headerlink" href="#trivial" title="Anchor link to this section for reference">¶</a></h3>
<p>Unique function to the unit. Universal property of terminal object.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-36-1">trivial {A} : A -&gt; Unit := const unit;
</span></code></pre></div>
<h2 id="empty"><code>Empty</code><a class="headerlink" href="#empty" title="Anchor link to this section for reference">¶</a></h2>
<p>The type <code>Empty</code> represents a type with a single value. Often used when a
function does not return any meaningful value.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-37-1">axiom Empty : Type;
</span></code></pre></div>
<h3 id="explode"><code>explode</code><a class="headerlink" href="#explode" title="Anchor link to this section for reference">¶</a></h3>
<p>Unique function from empty. Universal property of initial object.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-38-1">axiom explode {A} : Empty -&gt; A;
</span></code></pre></div>
<h2 id="pair-a-b"><code>Pair A B</code><a class="headerlink" href="#pair-a-b" title="Anchor link to this section for reference">¶</a></h2>
<p>The type <code>Pair A B</code> represents a tuple containing two elements of types <code>A</code> and
<code>B</code>. Useful for grouping related values together.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-39-1">import Stdlib.Data.Pair as Pair;
</span><span id="__ispan-39-2">open Pair using { Pair } public;
</span><span id="__ispan-39-3">open Pair using { , };
</span><span id="__ispan-39-4">
</span><span id="__ispan-39-5">import Stdlib.Data.Pair as Pair
</span><span id="__ispan-39-6">  open using
</span><span id="__ispan-39-7">  { ordProductI;
</span><span id="__ispan-39-8">    eqProductI
</span><span id="__ispan-39-9">  } public;
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-40-1">import Stdlib.Data.Fixity open;
</span><span id="__ispan-40-2">syntax alias mkPair := ,;
</span></code></pre></div>
<p>For example,</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-41-1">pair : Pair Nat Bool := mkPair 42 true;
</span></code></pre></div>
<h3 id="fst-and-snd"><code>fst</code> and <code>snd</code><a class="headerlink" href="#fst-and-snd" title="Anchor link to this section for reference">¶</a></h3>
<p>Projections</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-42-1">fst {A B} : Pair A B -&gt; A
</span><span id="__ispan-42-2">  | (mkPair a _) := a;
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-43-1">snd {A B} : Pair A B -&gt; B
</span><span id="__ispan-43-2">  | (mkPair _ b) := b;
</span></code></pre></div>
<h3 id="paircommutativeproduct"><code>PairCommutativeProduct</code><a class="headerlink" href="#paircommutativeproduct" title="Anchor link to this section for reference">¶</a></h3>
<p>Swap components</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-44-1">instance
</span><span id="__ispan-44-2">PairCommutativeProduct : CommutativeProduct Pair :=
</span><span id="__ispan-44-3">  CommutativeProduct.mk@{
</span><span id="__ispan-44-4">    swap := \{p := mkPair (snd p) (fst p)}
</span><span id="__ispan-44-5">  };
</span></code></pre></div>
<h3 id="pairassociativeproduct"><code>PairAssociativeProduct</code><a class="headerlink" href="#pairassociativeproduct" title="Anchor link to this section for reference">¶</a></h3>
<p>Pair associations</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-45-1">instance
</span><span id="__ispan-45-2">PairAssociativeProduct : AssociativeProduct Pair :=
</span><span id="__ispan-45-3">  AssociativeProduct.mk@{
</span><span id="__ispan-45-4">    assocLeft := \{p :=
</span><span id="__ispan-45-5">      let pbc := snd p;
</span><span id="__ispan-45-6">      in mkPair (mkPair (fst p) (fst pbc)) (snd pbc)
</span><span id="__ispan-45-7">    };
</span><span id="__ispan-45-8">    assocRight := \{p :=
</span><span id="__ispan-45-9">      let pab := fst p;
</span><span id="__ispan-45-10">      in mkPair (fst pab) (mkPair (snd pab) (snd p))
</span><span id="__ispan-45-11">    }
</span><span id="__ispan-45-12">  };
</span></code></pre></div>
<h3 id="pairunitalproduct"><code>PairUnitalProduct</code><a class="headerlink" href="#pairunitalproduct" title="Anchor link to this section for reference">¶</a></h3>
<p>Unit maps for pairs and units</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-46-1">instance
</span><span id="__ispan-46-2">PairUnitalProduct : UnitalProduct Unit Pair :=
</span><span id="__ispan-46-3">  UnitalProduct.mk@{
</span><span id="__ispan-46-4">    unitLeft := \{a := mkPair unit a};
</span><span id="__ispan-46-5">    unUnitLeft := snd;
</span><span id="__ispan-46-6">    unitRight := \{a := mkPair a unit};
</span><span id="__ispan-46-7">    unUnitRight := \{{A} := fst};
</span><span id="__ispan-46-8">  };
</span></code></pre></div>
<h3 id="pairbifunctor"><code>PairBifunctor</code><a class="headerlink" href="#pairbifunctor" title="Anchor link to this section for reference">¶</a></h3>
<p>Map functions over pairs</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-47-1">instance
</span><span id="__ispan-47-2">PairBifunctor : Bifunctor Pair :=
</span><span id="__ispan-47-3">  Bifunctor.mk@{
</span><span id="__ispan-47-4">    bimap := \{f g p := mkPair (f (fst p)) (g (snd p))};
</span><span id="__ispan-47-5">  };
</span></code></pre></div>
<h3 id="fork"><code>fork</code><a class="headerlink" href="#fork" title="Anchor link to this section for reference">¶</a></h3>
<p>Universal property of pairs</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-48-1">fork
</span><span id="__ispan-48-2">  {A B C}
</span><span id="__ispan-48-3">  (f : C -&gt; A)
</span><span id="__ispan-48-4">  (g : C -&gt; B)
</span><span id="__ispan-48-5">  (c : C) : Pair A B :=
</span><span id="__ispan-48-6">  mkPair (f c) (g c);
</span></code></pre></div>
<h2 id="result-a-b"><code>Result A B</code><a class="headerlink" href="#result-a-b" title="Anchor link to this section for reference">¶</a></h2>
<p>The <code>Result A B</code> type represents either a success with a value of <code>ok x</code> with
<code>x</code> of type <code>A</code> or an error with value <code>error e</code> with <code>e</code> of type <code>B</code>.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-49-1">import Stdlib.Data.Result.Base as Result;
</span><span id="__ispan-49-2">open Result using { Result; ok; error } public;
</span></code></pre></div>
<h2 id="either-a-b"><code>Either A B</code><a class="headerlink" href="#either-a-b" title="Anchor link to this section for reference">¶</a></h2>
<p>The type <code>Either A B</code>, or sum type of <code>A</code> and <code>B</code>, represents a value of type
<code>A</code> or <code>B</code>. It is equivalent to <code>Result A B</code>, however, the meaning of the values
is different. There is no such thing as an error or success value in the
<code>Either</code> type, instead the values are either <code>left a</code> of type <code>A</code> or <code>right b</code>
of type <code>B</code>.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-50-1">syntax alias Either := Result;
</span><span id="__ispan-50-2">syntax alias left := error;
</span><span id="__ispan-50-3">syntax alias right := ok;
</span></code></pre></div>
<p>For example,</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-51-1">thisString : Either String Nat := left "Error!";
</span><span id="__ispan-51-2">thisNumber : Either String Nat := right 42;
</span></code></pre></div>
<h3 id="isleft-and-isright"><code>isLeft</code> and <code>isRight</code><a class="headerlink" href="#isleft-and-isright" title="Anchor link to this section for reference">¶</a></h3>
<p>Check components of either.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-52-1">isLeft {A B} (e : Either A B) : Bool :=
</span><span id="__ispan-52-2">  case e of {
</span><span id="__ispan-52-3">    | left _ := true
</span><span id="__ispan-52-4">    | right _ := false
</span><span id="__ispan-52-5">  };
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-53-1">isRight {A B} (e : Either A B) : Bool :=
</span><span id="__ispan-53-2">  case e of {
</span><span id="__ispan-53-3">    | left _ := false
</span><span id="__ispan-53-4">    | right _ := true
</span><span id="__ispan-53-5">  };
</span></code></pre></div>
<h3 id="fromleft"><code>fromLeft</code><a class="headerlink" href="#fromleft" title="Anchor link to this section for reference">¶</a></h3>
<p>Get left element (with default)</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-54-1">fromLeft {A B} (e : Either A B) (d : A) : A :=
</span><span id="__ispan-54-2">  case e of {
</span><span id="__ispan-54-3">    | (left x) := x
</span><span id="__ispan-54-4">    | (right _) := d
</span><span id="__ispan-54-5">  };
</span></code></pre></div>
<h3 id="fromright"><code>fromRight</code><a class="headerlink" href="#fromright" title="Anchor link to this section for reference">¶</a></h3>
<p>Get right element (with default)</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-55-1">fromRight {A B} (e : Either A B) (d : B) : B :=
</span><span id="__ispan-55-2">  case e of {
</span><span id="__ispan-55-3">    | (left _) := d
</span><span id="__ispan-55-4">    | (right x) := x
</span><span id="__ispan-55-5">  };
</span></code></pre></div>
<h3 id="eithercommutativeproduct"><code>EitherCommutativeProduct</code><a class="headerlink" href="#eithercommutativeproduct" title="Anchor link to this section for reference">¶</a></h3>
<p>Swap elements</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-56-1">swapEither {A B} (e : Either A B) : Either B A :=
</span><span id="__ispan-56-2">  case e of {
</span><span id="__ispan-56-3">    | (left x) := right x
</span><span id="__ispan-56-4">    | (right x) := left x
</span><span id="__ispan-56-5">  };
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-57-1">instance
</span><span id="__ispan-57-2">EitherCommutativeProduct : CommutativeProduct Either :=
</span><span id="__ispan-57-3">  CommutativeProduct.mk@{ swap := swapEither };
</span></code></pre></div>
<h3 id="eitherbifunctor"><code>EitherBifunctor</code><a class="headerlink" href="#eitherbifunctor" title="Anchor link to this section for reference">¶</a></h3>
<p>Map onto elements of either</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-58-1">eitherBimap
</span><span id="__ispan-58-2">  {A B C D}
</span><span id="__ispan-58-3">  (f : A -&gt; C)
</span><span id="__ispan-58-4">  (g : B -&gt; D)
</span><span id="__ispan-58-5">  (e : Either A B) : Either C D :=
</span><span id="__ispan-58-6">  case e of {
</span><span id="__ispan-58-7">    | (left a) := left (f a)
</span><span id="__ispan-58-8">    | (right b) := right (g b)
</span><span id="__ispan-58-9">  };
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-59-1">instance
</span><span id="__ispan-59-2">EitherBifunctor : Bifunctor Either :=
</span><span id="__ispan-59-3">  Bifunctor.mk@{
</span><span id="__ispan-59-4">    bimap := eitherBimap
</span><span id="__ispan-59-5">  };
</span></code></pre></div>
<h3 id="eitherunitalproduct"><code>EitherUnitalProduct</code><a class="headerlink" href="#eitherunitalproduct" title="Anchor link to this section for reference">¶</a></h3>
<p>Unit maps for Either and Empty</p>
<h4 id="ununitlefteither"><code>unUnitLeftEither</code><a class="headerlink" href="#ununitlefteither" title="Anchor link to this section for reference">¶</a></h4>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-60-1">unUnitLeftEither {A} (e : Either Empty A) : A :=
</span><span id="__ispan-60-2">  case e of {
</span><span id="__ispan-60-3">    | left x := explode x
</span><span id="__ispan-60-4">    | right x := x
</span><span id="__ispan-60-5">  };
</span></code></pre></div>
<h4 id="ununitrighteither"><code>unUnitRightEither</code><a class="headerlink" href="#ununitrighteither" title="Anchor link to this section for reference">¶</a></h4>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-61-1">unUnitRightEither {A} (e : Either A Empty) : A :=
</span><span id="__ispan-61-2">  case e of {
</span><span id="__ispan-61-3">    | left x := x
</span><span id="__ispan-61-4">    | (right x) := explode x
</span><span id="__ispan-61-5">  };
</span></code></pre></div>
<h4 id="eitherunitalproduct_1"><code>EitherUnitalProduct</code><a class="headerlink" href="#eitherunitalproduct_1" title="Anchor link to this section for reference">¶</a></h4>
<p>Unit maps for Either and Empty</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-62-1">instance
</span><span id="__ispan-62-2">EitherUnitalProduct : UnitalProduct Empty Either :=
</span><span id="__ispan-62-3">  UnitalProduct.mk@{
</span><span id="__ispan-62-4">    unitLeft := right;
</span><span id="__ispan-62-5">    unUnitLeft := unUnitLeftEither;
</span><span id="__ispan-62-6">    unitRight := \{{A} := left};
</span><span id="__ispan-62-7">    unUnitRight := unUnitRightEither;
</span><span id="__ispan-62-8">  };
</span></code></pre></div>
<h3 id="fuse"><code>fuse</code><a class="headerlink" href="#fuse" title="Anchor link to this section for reference">¶</a></h3>
<p>Universal property of coproduct</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-63-1">fuse
</span><span id="__ispan-63-2">  {A B C}
</span><span id="__ispan-63-3">  (f : A -&gt; C)
</span><span id="__ispan-63-4">  (g : B -&gt; C)
</span><span id="__ispan-63-5">  (e : Either A B) : C :=
</span><span id="__ispan-63-6">  case e of {
</span><span id="__ispan-63-7">    | (left x) := f x
</span><span id="__ispan-63-8">    | (right x) := g x
</span><span id="__ispan-63-9">  };
</span></code></pre></div>
<h3 id="eitherassociativeproduct"><code>EitherAssociativeProduct</code><a class="headerlink" href="#eitherassociativeproduct" title="Anchor link to this section for reference">¶</a></h3>
<p>Association functions for either</p>
<h4 id="assoclefteither"><code>assocLeftEither</code><a class="headerlink" href="#assoclefteither" title="Anchor link to this section for reference">¶</a></h4>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-64-1">assocLeftEither
</span><span id="__ispan-64-2">  {A B C}
</span><span id="__ispan-64-3">  (e : Either A (Either B C)) : Either (Either A B) C :=
</span><span id="__ispan-64-4">  case e of {
</span><span id="__ispan-64-5">    | (left x) := left (left x)
</span><span id="__ispan-64-6">    | (right ebc) :=
</span><span id="__ispan-64-7">      case ebc of {
</span><span id="__ispan-64-8">        | (left y) := left (right y)
</span><span id="__ispan-64-9">        | (right z) := right z
</span><span id="__ispan-64-10">      }
</span><span id="__ispan-64-11">  };
</span></code></pre></div>
<h4 id="assocrighteither"><code>assocRightEither</code><a class="headerlink" href="#assocrighteither" title="Anchor link to this section for reference">¶</a></h4>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-65-1">assocRightEither
</span><span id="__ispan-65-2">  {A B C}
</span><span id="__ispan-65-3">  (e : Either (Either A B) C)
</span><span id="__ispan-65-4">  : Either A (Either B C) :=
</span><span id="__ispan-65-5">  case e of {
</span><span id="__ispan-65-6">    | (left eab) :=
</span><span id="__ispan-65-7">      case eab of {
</span><span id="__ispan-65-8">        | (left x) := left x
</span><span id="__ispan-65-9">        | (right y) := right (left y)
</span><span id="__ispan-65-10">      }
</span><span id="__ispan-65-11">    | (right z) := right (right z)
</span><span id="__ispan-65-12">  };
</span></code></pre></div>
<h4 id="eitherassociativeproduct_1"><code>EitherAssociativeProduct</code><a class="headerlink" href="#eitherassociativeproduct_1" title="Anchor link to this section for reference">¶</a></h4>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-66-1">instance
</span><span id="__ispan-66-2">EitherAssociativeProduct : AssociativeProduct Either :=
</span><span id="__ispan-66-3">  AssociativeProduct.mk@{
</span><span id="__ispan-66-4">    assocLeft := assocLeftEither;
</span><span id="__ispan-66-5">    assocRight := assocRightEither;
</span><span id="__ispan-66-6">  };
</span></code></pre></div>
<h2 id="option-a"><code>Option A</code><a class="headerlink" href="#option-a" title="Anchor link to this section for reference">¶</a></h2>
<p>The type <code>Option A</code> represents an optional value of type <code>A</code>. It can be either
<code>Some A</code> (containing a value) or <code>None</code> (no value). This type is an alias for
<code>Maybe A</code> from the standard library.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-67-1">import Stdlib.Data.Maybe as Maybe;
</span><span id="__ispan-67-2">open Maybe using {
</span><span id="__ispan-67-3">    Maybe;
</span><span id="__ispan-67-4">    just;
</span><span id="__ispan-67-5">    nothing
</span><span id="__ispan-67-6">  };
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-68-1">syntax alias Option := Maybe;
</span><span id="__ispan-68-2">syntax alias some := just;
</span><span id="__ispan-68-3">syntax alias none := nothing;
</span></code></pre></div>
<h3 id="isnone"><code>isNone</code><a class="headerlink" href="#isnone" title="Anchor link to this section for reference">¶</a></h3>
<p>Check if an optional value is <code>none</code>:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-69-1">isNone {A} (x : Option A) : Bool
</span><span id="__ispan-69-2">  := case x of {
</span><span id="__ispan-69-3">  | none := true
</span><span id="__ispan-69-4">  | some _ := false
</span><span id="__ispan-69-5">  }
</span></code></pre></div>
<h3 id="issome"><code>isSome</code><a class="headerlink" href="#issome" title="Anchor link to this section for reference">¶</a></h3>
<p>Check if an optional value is <code>some</code>:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-70-1">isSome {A} (x : Option A) : Bool := not (isNone x);
</span></code></pre></div>
<h3 id="fromoption"><code>fromOption</code><a class="headerlink" href="#fromoption" title="Anchor link to this section for reference">¶</a></h3>
<p>Extract the value from an <code>Option</code> term:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-71-1">fromOption {A} (x : Option A) (default : A) : A :=
</span><span id="__ispan-71-2">  case x of {
</span><span id="__ispan-71-3">  | none := default
</span><span id="__ispan-71-4">  | some x := x
</span><span id="__ispan-71-5">};
</span></code></pre></div>
<h3 id="option"><code>option</code><a class="headerlink" href="#option" title="Anchor link to this section for reference">¶</a></h3>
<p>Map over option with default</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-72-1">option
</span><span id="__ispan-72-2">  {A B}
</span><span id="__ispan-72-3">  (o : Option A)
</span><span id="__ispan-72-4">  (default : B)
</span><span id="__ispan-72-5">  (f : A -&gt; B)
</span><span id="__ispan-72-6">  : B :=
</span><span id="__ispan-72-7">  case o of {
</span><span id="__ispan-72-8">    | none := default
</span><span id="__ispan-72-9">    | some x := f x
</span><span id="__ispan-72-10">  };
</span></code></pre></div>
<h3 id="filteroption"><code>filterOption</code><a class="headerlink" href="#filteroption" title="Anchor link to this section for reference">¶</a></h3>
<p>Filter option according to predicate</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-73-1">filterOption
</span><span id="__ispan-73-2">  {A}
</span><span id="__ispan-73-3">  (p : A -&gt; Bool)
</span><span id="__ispan-73-4">  (opt : Option A) : Option A :=
</span><span id="__ispan-73-5">  case opt of {
</span><span id="__ispan-73-6">    | none := none
</span><span id="__ispan-73-7">    | some x :=
</span><span id="__ispan-73-8">      if
</span><span id="__ispan-73-9">        | p x := some x
</span><span id="__ispan-73-10">        | else := none
</span><span id="__ispan-73-11">  };
</span></code></pre></div>
<h2 id="list-a"><code>List A</code><a class="headerlink" href="#list-a" title="Anchor link to this section for reference">¶</a></h2>
<p>The type <code>List A</code> represents a <em>sequence</em> of elements of type <code>A</code>. Used for collections and ordered data.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-74-1">import Stdlib.Data.List as List
</span><span id="__ispan-74-2">  open using {
</span><span id="__ispan-74-3">  List;
</span><span id="__ispan-74-4">  nil;
</span><span id="__ispan-74-5">  ::;
</span><span id="__ispan-74-6">  isElement;
</span><span id="__ispan-74-7">  head;
</span><span id="__ispan-74-8">  tail;
</span><span id="__ispan-74-9">  length;
</span><span id="__ispan-74-10">  take;
</span><span id="__ispan-74-11">  drop;
</span><span id="__ispan-74-12">  ++;
</span><span id="__ispan-74-13">  reverse;
</span><span id="__ispan-74-14">  any;
</span><span id="__ispan-74-15">  all;
</span><span id="__ispan-74-16">  zip;
</span><span id="__ispan-74-17">} public;
</span></code></pre></div>
<p>For example,</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-75-1">numbers : List Nat := 1 :: 2 :: 3 :: nil;
</span><span id="__ispan-75-2">-- alternative syntax:
</span><span id="__ispan-75-3">niceNumbers : List Nat := [1 ; 2 ; 3];
</span></code></pre></div>
<h3 id="findindex"><code>findIndex</code><a class="headerlink" href="#findindex" title="Anchor link to this section for reference">¶</a></h3>
<p>Get the first index of an element satisfying a predicate if such an index exists and none, otherwise.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-76-1">findIndex {A} (predicate : A -&gt; Bool) : List A -&gt; Option Nat
</span><span id="__ispan-76-2">  | nil := none
</span><span id="__ispan-76-3">  | (x :: xs) :=
</span><span id="__ispan-76-4">    if
</span><span id="__ispan-76-5">      | predicate x := some zero
</span><span id="__ispan-76-6">      | else := case findIndex predicate xs of
</span><span id="__ispan-76-7">        | none := none
</span><span id="__ispan-76-8">        | some i := some (suc i);
</span></code></pre></div>
<h3 id="last"><code>last</code><a class="headerlink" href="#last" title="Anchor link to this section for reference">¶</a></h3>
<p>Get last element of a list</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-77-1">last {A} (lst : List A) (default : A) : A :=
</span><span id="__ispan-77-2">  head default (reverse lst);
</span></code></pre></div>
<h3 id="most"><code>most</code><a class="headerlink" href="#most" title="Anchor link to this section for reference">¶</a></h3>
<p>Get list with last element dropped</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-78-1">most {A} (lst : List A) : List A :=
</span><span id="__ispan-78-2">  tail (reverse lst);
</span></code></pre></div>
<h3 id="snoc"><code>snoc</code><a class="headerlink" href="#snoc" title="Anchor link to this section for reference">¶</a></h3>
<p>Prepend element to a list</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-79-1">snoc {A} (xs : List A) (x : A) : List A :=
</span><span id="__ispan-79-2">  xs ++ [x];
</span></code></pre></div>
<h3 id="uncons"><code>uncons</code><a class="headerlink" href="#uncons" title="Anchor link to this section for reference">¶</a></h3>
<p>Split one layer of list</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-80-1">uncons {A} : List A -&gt; Option (Pair A (List A))
</span><span id="__ispan-80-2">  | nil := none
</span><span id="__ispan-80-3">  | (x :: xs) := some (mkPair x xs)
</span></code></pre></div>
<h3 id="unsnoc"><code>unsnoc</code><a class="headerlink" href="#unsnoc" title="Anchor link to this section for reference">¶</a></h3>
<p>Split one layer of list from the end</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-81-1">unsnoc {A} : List A -&gt; Option (Pair (List A) A)
</span><span id="__ispan-81-2">  | nil := none
</span><span id="__ispan-81-3">  | (x :: xs) := some (mkPair (most (x :: xs)) (last xs x))
</span></code></pre></div>
<h3 id="unfold"><code>unfold</code><a class="headerlink" href="#unfold" title="Anchor link to this section for reference">¶</a></h3>
<p>Unfold a list, layerwise</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-82-1">terminating
</span><span id="__ispan-82-2">unfold {A B}
</span><span id="__ispan-82-3">  (step : B -&gt; Option (Pair A B))
</span><span id="__ispan-82-4">  (seed : B) : List A :=
</span><span id="__ispan-82-5">  case step seed of
</span><span id="__ispan-82-6">    | none := nil
</span><span id="__ispan-82-7">    | some (x, seed') := x :: unfold step seed';
</span></code></pre></div>
<h3 id="unzip"><code>unzip</code><a class="headerlink" href="#unzip" title="Anchor link to this section for reference">¶</a></h3>
<p>Unzip a list of pairs into two lists</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-83-1">terminating
</span><span id="__ispan-83-2">unzip {A B}
</span><span id="__ispan-83-3">  (xs : List (Pair A B)) : Pair (List A) (List B) :=
</span><span id="__ispan-83-4">  case xs of {
</span><span id="__ispan-83-5">    | nil := mkPair nil nil
</span><span id="__ispan-83-6">    | p :: ps :=
</span><span id="__ispan-83-7">      let unzipped := unzip ps
</span><span id="__ispan-83-8">      in mkPair (fst p :: fst unzipped) (snd p :: snd unzipped)
</span><span id="__ispan-83-9">  };
</span></code></pre></div>
<h4 id="partitioneither"><code>partitionEither</code><a class="headerlink" href="#partitioneither" title="Anchor link to this section for reference">¶</a></h4>
<p>Partition a list</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-84-1">partitionEither
</span><span id="__ispan-84-2">  {A B} (es : List (Either A B)) : Pair (List A) (List B) :=
</span><span id="__ispan-84-3">  foldr
</span><span id="__ispan-84-4">    (\{e acc :=
</span><span id="__ispan-84-5">      case e of {
</span><span id="__ispan-84-6">        | left a := mkPair (a :: (fst acc)) (snd acc)
</span><span id="__ispan-84-7">        | right b := mkPair (fst acc) (b :: (snd acc))
</span><span id="__ispan-84-8">      }})
</span><span id="__ispan-84-9">    (mkPair nil nil)
</span><span id="__ispan-84-10">    es;
</span></code></pre></div>
<h4 id="partitioneitherwith"><code>partitionEitherWith</code><a class="headerlink" href="#partitioneitherwith" title="Anchor link to this section for reference">¶</a></h4>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-85-1">partitionEitherWith
</span><span id="__ispan-85-2">  {A B C}
</span><span id="__ispan-85-3">  (f : C -&gt; Either A B)
</span><span id="__ispan-85-4">  (es : List C) : Pair (List A) (List B) :=
</span><span id="__ispan-85-5">  partitionEither (map f es);
</span></code></pre></div>
<h3 id="catoptions"><code>catOptions</code><a class="headerlink" href="#catoptions" title="Anchor link to this section for reference">¶</a></h3>
<p>Collapse list of options</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-86-1">catOptions {A} : List (Option A) -&gt; List A :=
</span><span id="__ispan-86-2">  foldr
</span><span id="__ispan-86-3">    (\{opt acc :=
</span><span id="__ispan-86-4">      case opt of {
</span><span id="__ispan-86-5">        | none := acc
</span><span id="__ispan-86-6">        | some x := x :: acc
</span><span id="__ispan-86-7">      }})
</span><span id="__ispan-86-8">    nil;
</span></code></pre></div>
<h3 id="maximumby"><code>maximumBy</code><a class="headerlink" href="#maximumby" title="Anchor link to this section for reference">¶</a></h3>
<p>Get the maximal element of a list.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-87-1">maximumBy {A B} {{Ord B}}
</span><span id="__ispan-87-2">  (f : A -&gt; B)
</span><span id="__ispan-87-3">  (lst : List A)
</span><span id="__ispan-87-4">  : Option A :=
</span><span id="__ispan-87-5">  let maxHelper := \{curr acc :=
</span><span id="__ispan-87-6">    case acc of {
</span><span id="__ispan-87-7">      | none := some curr
</span><span id="__ispan-87-8">      | some maxVal :=
</span><span id="__ispan-87-9">        if
</span><span id="__ispan-87-10">          | f curr &gt; f maxVal := some curr
</span><span id="__ispan-87-11">          | else := some maxVal
</span><span id="__ispan-87-12">    }
</span><span id="__ispan-87-13">  };
</span><span id="__ispan-87-14">  in foldr maxHelper none lst;
</span></code></pre></div>
<h3 id="minimumby"><code>minimumBy</code><a class="headerlink" href="#minimumby" title="Anchor link to this section for reference">¶</a></h3>
<p>Get the minimal element of a list.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-88-1">minimalBy {A B} {{Ord B}}
</span><span id="__ispan-88-2">  (f : A -&gt; B)
</span><span id="__ispan-88-3">  (lst : List A)
</span><span id="__ispan-88-4">  : Option A :=
</span><span id="__ispan-88-5">  let minHelper := \{curr acc :=
</span><span id="__ispan-88-6">    case acc of {
</span><span id="__ispan-88-7">      | none := some curr
</span><span id="__ispan-88-8">      | some minVal :=
</span><span id="__ispan-88-9">        if
</span><span id="__ispan-88-10">          | f curr &lt; f minVal := some curr
</span><span id="__ispan-88-11">          | else := some minVal
</span><span id="__ispan-88-12">    }
</span><span id="__ispan-88-13">  };
</span><span id="__ispan-88-14">  in foldr minHelper none lst;
</span></code></pre></div>
<h3 id="chunksof"><code>chunksOf</code><a class="headerlink" href="#chunksof" title="Anchor link to this section for reference">¶</a></h3>
<p>Splits a list into chunks of size <code>n</code>. The last chunk may be smaller than <code>n</code> if the
length of the list is not divisible by <code>n</code>.</p>
<p>Example:</p>
<ul>
<li>chunksOf 2 [1;2;3;4;5] = [[1;2]; [3;4]; [5]]</li>
</ul>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-89-1">terminating
</span><span id="__ispan-89-2">chunksOf {A} : (chunkSize : Nat) -&gt; (list : List A) -&gt; List (List A)
</span><span id="__ispan-89-3">  | zero _ := nil
</span><span id="__ispan-89-4">  | _ nil := nil
</span><span id="__ispan-89-5">  | n xs := take n xs :: chunksOf n (drop n xs);
</span></code></pre></div>
<h3 id="sliding"><code>sliding</code><a class="headerlink" href="#sliding" title="Anchor link to this section for reference">¶</a></h3>
<p>Returns all contiguous sublists of size <code>n</code>. If <code>n</code> is larger than the list length,
returns empty list. If <code>n</code> is zero, returns empty list.</p>
<p>Example:
- sliding 2 [1;2;3;4] = [[1;2]; [2;3]; [3;4]]</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-90-1">sliding {A} : (windowSize : Nat) -&gt; (list : List A) -&gt; List (List A)
</span><span id="__ispan-90-2">  | zero _ := nil
</span><span id="__ispan-90-3">  | n xs :=
</span><span id="__ispan-90-4">    let
</span><span id="__ispan-90-5">      len : Nat := length xs;
</span><span id="__ispan-90-6">      terminating
</span><span id="__ispan-90-7">      go : List A -&gt; List (List A)
</span><span id="__ispan-90-8">        | nil := nil
</span><span id="__ispan-90-9">        | ys :=
</span><span id="__ispan-90-10">          if
</span><span id="__ispan-90-11">            | length ys &lt; n := nil
</span><span id="__ispan-90-12">            | else := take n ys :: go (tail ys);
</span><span id="__ispan-90-13">    in if
</span><span id="__ispan-90-14">      | n &gt; len := nil
</span><span id="__ispan-90-15">      | else := go xs;
</span></code></pre></div>
<h3 id="span"><code>span</code><a class="headerlink" href="#span" title="Anchor link to this section for reference">¶</a></h3>
<p>Takes a predicate and a list, and returns a tuple where:</p>
<ul>
<li>First element is the longest prefix of the list that satisfies the predicate</li>
<li>Second element is the remainder of the list</li>
</ul>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-91-1">span {A} (p : A -&gt; Bool) : List A -&gt; Pair (List A) (List A)
</span><span id="__ispan-91-2">  | nil := mkPair nil nil
</span><span id="__ispan-91-3">  | (x :: xs) :=
</span><span id="__ispan-91-4">    if
</span><span id="__ispan-91-5">      | p x :=
</span><span id="__ispan-91-6">        let
</span><span id="__ispan-91-7">          (ys1, ys2) := span p xs;
</span><span id="__ispan-91-8">        in mkPair (x :: ys1) ys2
</span><span id="__ispan-91-9">      | else := mkPair nil (x :: xs);
</span></code></pre></div>
<h3 id="groupby-and-group"><code>groupBy</code> and <code>group</code><a class="headerlink" href="#groupby-and-group" title="Anchor link to this section for reference">¶</a></h3>
<p>Groups consecutive elements in a list that satisfy a given equality predicate.</p>
<p>Example:</p>
<ul>
<li>groupBy (==) [1;1;2;2;2;3;1;1] = [[1;1];[2;2;2];[3];[1;1]]</li>
</ul>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-92-1">terminating
</span><span id="__ispan-92-2">groupBy {A} (eq : A -&gt; A -&gt; Bool) : List A -&gt; List (List A)
</span><span id="__ispan-92-3">  | nil := nil
</span><span id="__ispan-92-4">  | (x :: xs) :=
</span><span id="__ispan-92-5">    case span (eq x) xs of
</span><span id="__ispan-92-6">      ys1, ys2 := (x :: ys1) :: groupBy eq ys2;
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-93-1">group {A} {{Eq A}} : List A -&gt; List (List A) := groupBy (==)
</span></code></pre></div>
<h4 id="nubby"><code>nubBy</code><a class="headerlink" href="#nubby" title="Anchor link to this section for reference">¶</a></h4>
<p>Returns a list with duplicates removed according to the given equivalence
function, keeping the first occurrence of each element. Unlike regular ;nub;,
this function allows specifying a custom equality predicate.</p>
<p>Examples:</p>
<ul>
<li>nubBy ({x y := mod x 3 == mod y 3}) [1;2;3;4;5;6] = [1;2;3]</li>
<li>nub [1;1;2;2;3;3] = [1;2;3]</li>
</ul>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-94-1">nubBy {A} (eq : A -&gt; A -&gt; Bool) : List A -&gt; List A :=
</span><span id="__ispan-94-2">  let
</span><span id="__ispan-94-3">    -- Checks if an element is already in the accumulator
</span><span id="__ispan-94-4">    elemBy (x : A) : List A -&gt; Bool
</span><span id="__ispan-94-5">      | nil := false
</span><span id="__ispan-94-6">      | (y :: ys) := eq x y || elemBy x ys;
</span><span id="__ispan-94-7">
</span><span id="__ispan-94-8">    go : List A -&gt; List A -&gt; List A
</span><span id="__ispan-94-9">      | acc nil := reverse acc
</span><span id="__ispan-94-10">      | acc (x :: xs) :=
</span><span id="__ispan-94-11">        if
</span><span id="__ispan-94-12">          | elemBy x acc := go acc xs
</span><span id="__ispan-94-13">          | else := go (x :: acc) xs;
</span><span id="__ispan-94-14">  in go nil;
</span></code></pre></div>
<h4 id="nub"><code>nub</code><a class="headerlink" href="#nub" title="Anchor link to this section for reference">¶</a></h4>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-95-1">nub {A} {{Eq A}} : List A -&gt; List A := nubBy (==);
</span></code></pre></div>
<h3 id="powerlists"><code>powerlists</code><a class="headerlink" href="#powerlists" title="Anchor link to this section for reference">¶</a></h3>
<p>Generate all possible sublists of a list. Each element can either be included or not.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-96-1">powerlists {A} : List A -&gt; List (List A)
</span><span id="__ispan-96-2">  | nil := nil :: nil
</span><span id="__ispan-96-3">  | (x :: xs) :=
</span><span id="__ispan-96-4">    let
</span><span id="__ispan-96-5">      rest : List (List A) := powerlists xs;
</span><span id="__ispan-96-6">      withX : List (List A) := map ((::) x) rest;
</span><span id="__ispan-96-7">    in rest ++ withX;
</span></code></pre></div>
<h2 id="set-a"><code>Set A</code><a class="headerlink" href="#set-a" title="Anchor link to this section for reference">¶</a></h2>
<p>The type <code>Set A</code> represents a collection of unique elements of type <code>A</code>. Used
for sets of values.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-97-1">import Stdlib.Data.Set as Set open using {
</span><span id="__ispan-97-2">    Set; module Set;
</span><span id="__ispan-97-3">    difference;
</span><span id="__ispan-97-4">    union;
</span><span id="__ispan-97-5">    insert;
</span><span id="__ispan-97-6">    eqSetI;
</span><span id="__ispan-97-7">    ordSetI;
</span><span id="__ispan-97-8">    isSubset;
</span><span id="__ispan-97-9">  } public;
</span></code></pre></div>
<p>For example,</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-98-1">uniqueNumbers : Set Nat := Set.fromList [1 ; 2 ; 2 ; 2; 3];
</span></code></pre></div>
<h4 id="setmap"><code>setMap</code><a class="headerlink" href="#setmap" title="Anchor link to this section for reference">¶</a></h4>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-99-1">setMap {A B} {{Ord B}} (f : A -&gt; B) (set : Set A) : Set B :=
</span><span id="__ispan-99-2">  Set.fromList (map f (Set.toList set));
</span></code></pre></div>
<h4 id="setjoin"><code>setJoin</code><a class="headerlink" href="#setjoin" title="Anchor link to this section for reference">¶</a></h4>
<p>Collapse a set of sets into a set</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-100-1">setJoin {A} {{Ord A}} (sets : Set (Set A)) : Set A :=
</span><span id="__ispan-100-2">  for (acc := Set.empty) (innerSet in sets) {
</span><span id="__ispan-100-3">    Set.union acc innerSet
</span><span id="__ispan-100-4">  };
</span></code></pre></div>
<h4 id="disjointunion"><code>disjointUnion</code><a class="headerlink" href="#disjointunion" title="Anchor link to this section for reference">¶</a></h4>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-101-1">--- Computes the disjoint union of two ;Set;s.
</span><span id="__ispan-101-2">disjointUnion {T} {{Ord T}} (s1 s2 : Set T) : Result (Set T) (Set T) :=
</span><span id="__ispan-101-3">  case Set.intersection s1 s2 of
</span><span id="__ispan-101-4">    | Set.empty := ok (Set.union s1 s2)
</span><span id="__ispan-101-5">    | s := error s;
</span></code></pre></div>
<h4 id="symmetricdifference"><code>symmetricDifference</code><a class="headerlink" href="#symmetricdifference" title="Anchor link to this section for reference">¶</a></h4>
<p>Caclulate the symmetric difference of two sets.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-102-1">symmetricDifference
</span><span id="__ispan-102-2">  {A} {{Ord A}} (s1 s2 : Set A) : Set A :=
</span><span id="__ispan-102-3">  let
</span><span id="__ispan-102-4">    in1not2 := difference s1 s2;
</span><span id="__ispan-102-5">    in2not1 := difference s2 s1;
</span><span id="__ispan-102-6">  in union in1not2 in2not1;
</span></code></pre></div>
<h3 id="cartesianproduct"><code>cartesianProduct</code><a class="headerlink" href="#cartesianproduct" title="Anchor link to this section for reference">¶</a></h3>
<p>Generate the set of all cartesian products of a set.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-103-1">cartesianProduct
</span><span id="__ispan-103-2">  {A B}
</span><span id="__ispan-103-3">  {{Ord A}} {{Ord B}}
</span><span id="__ispan-103-4">  (s1 : Set A)
</span><span id="__ispan-103-5">  (s2 : Set B)
</span><span id="__ispan-103-6">  : Set (Pair A B) :=
</span><span id="__ispan-103-7">  let
</span><span id="__ispan-103-8">    -- For a fixed element from set1, create a set of all pairs with elements from s2
</span><span id="__ispan-103-9">    pairsForElement (a : A) : Set (Pair A B) :=
</span><span id="__ispan-103-10">      for (acc := Set.empty) (b in s2) {
</span><span id="__ispan-103-11">        insert (mkPair a b) acc
</span><span id="__ispan-103-12">      };
</span><span id="__ispan-103-13">
</span><span id="__ispan-103-14">    -- Create set of sets, each containing pairs for one element from s1
</span><span id="__ispan-103-15">    pairSets : Set (Set (Pair A B)) :=
</span><span id="__ispan-103-16">      for (acc := Set.empty) (a in s1) {
</span><span id="__ispan-103-17">        insert (pairsForElement a) acc
</span><span id="__ispan-103-18">      };
</span><span id="__ispan-103-19">  in setJoin pairSets;
</span></code></pre></div>
<h3 id="powerset"><code>powerset</code><a class="headerlink" href="#powerset" title="Anchor link to this section for reference">¶</a></h3>
<p>Generate the powerset (set of all subsets) of a set.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-104-1">powerset {A} {{Ord A}} (s : Set A) : Set (Set A) :=
</span><span id="__ispan-104-2">  let
</span><span id="__ispan-104-3">    elements := Set.toList s;
</span><span id="__ispan-104-4">    subLists := powerlists elements;
</span><span id="__ispan-104-5">  in Set.fromList (map Set.fromList subLists);
</span></code></pre></div>
<h3 id="ispropersubset"><code>isProperSubset</code><a class="headerlink" href="#ispropersubset" title="Anchor link to this section for reference">¶</a></h3>
<p>Checks if all elements of <code>set1</code> are in <code>set2</code>, and that the two sets are not the same.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-105-1">isProperSubset {A} {{Eq A}} {{Ord A}} (set1 set2 : Set A) : Bool :=
</span><span id="__ispan-105-2">  isSubset set1 set2 &amp;&amp; not (set1 == set2)
</span></code></pre></div>
<h2 id="map-k-v"><code>Map K V</code><a class="headerlink" href="#map-k-v" title="Anchor link to this section for reference">¶</a></h2>
<p>The type <code>Map K V</code> represents a collection of key-value pairs, sometimes called
a dictionary, where keys are of type <code>K</code> and values are of type <code>V</code>.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-106-1">import Stdlib.Data.Map as Map public;
</span><span id="__ispan-106-2">open Map using {
</span><span id="__ispan-106-3">    Map
</span><span id="__ispan-106-4">  } public;
</span></code></pre></div>
<p>For example,</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-107-1">codeToken : Map Nat String := Map.fromList [ (1 , "BTC") ; (2 , "ETH") ; (3, "ANM")];
</span></code></pre></div>
<h3 id="updatelookupwithkey"><code>updateLookupWithKey</code><a class="headerlink" href="#updatelookupwithkey" title="Anchor link to this section for reference">¶</a></h3>
<p>Updates a value at a specific key using the update function and returns both the
old value (if the key existed) and the updated map.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-108-1">updateLookupWithKey
</span><span id="__ispan-108-2">  {Key Value}
</span><span id="__ispan-108-3">  {{Ord Key}}
</span><span id="__ispan-108-4">  (updateFn : Key -&gt; Value -&gt; Option Value)
</span><span id="__ispan-108-5">  (k : Key)
</span><span id="__ispan-108-6">  (map : Map Key Value)
</span><span id="__ispan-108-7">  : Pair (Option Value) (Map Key Value) :=
</span><span id="__ispan-108-8">  let
</span><span id="__ispan-108-9">    oldValue : Option Value := Map.lookup k map;
</span><span id="__ispan-108-10">    newMap : Map Key Value :=
</span><span id="__ispan-108-11">      case oldValue of {
</span><span id="__ispan-108-12">        | none := map
</span><span id="__ispan-108-13">        | some v :=
</span><span id="__ispan-108-14">          case updateFn k v of {
</span><span id="__ispan-108-15">            | none := Map.delete k map
</span><span id="__ispan-108-16">            | some newV := Map.insert k newV map
</span><span id="__ispan-108-17">          }
</span><span id="__ispan-108-18">      };
</span><span id="__ispan-108-19">  in oldValue, newMap;
</span></code></pre></div>
<h3 id="mapkeys"><code>mapKeys</code><a class="headerlink" href="#mapkeys" title="Anchor link to this section for reference">¶</a></h3>
<p>Maps all keys in the Map to new keys using the provided function. If the mapping
function is not injective (maps different keys to the same key), later entries
in the map will overwrite earlier ones with the same new key.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-109-1">mapKeys
</span><span id="__ispan-109-2">  {Key1 Key2 Value}
</span><span id="__ispan-109-3">  {{Ord Key2}}
</span><span id="__ispan-109-4">  (fun : Key1 -&gt; Key2)
</span><span id="__ispan-109-5">  (map : Map Key1 Value)
</span><span id="__ispan-109-6">  : Map Key2 Value :=
</span><span id="__ispan-109-7">  Map.fromList
</span><span id="__ispan-109-8">    (for (acc := nil) ((k, v) in Map.toList map) {
</span><span id="__ispan-109-9">      (fun k, v) :: acc
</span><span id="__ispan-109-10">    });
</span></code></pre></div>
<h3 id="restrictkeys"><code>restrictKeys</code><a class="headerlink" href="#restrictkeys" title="Anchor link to this section for reference">¶</a></h3>
<p>Restrict a map to only contain keys from the given set.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-110-1">restrictKeys
</span><span id="__ispan-110-2">  {Key Value}
</span><span id="__ispan-110-3">  {{Ord Key}}
</span><span id="__ispan-110-4">  (map : Map Key Value)
</span><span id="__ispan-110-5">  (validKeys : Set.Set Key)
</span><span id="__ispan-110-6">  : Map Key Value :=
</span><span id="__ispan-110-7">  for (acc := Map.empty) (k, v in map) {
</span><span id="__ispan-110-8">    if
</span><span id="__ispan-110-9">      | Set.isMember k validKeys := Map.insert k v acc
</span><span id="__ispan-110-10">      | else := acc
</span><span id="__ispan-110-11">  };
</span></code></pre></div>
<h3 id="withoutkeys"><code>withoutKeys</code><a class="headerlink" href="#withoutkeys" title="Anchor link to this section for reference">¶</a></h3>
<p>Remove all entries from a map whose keys appear in the given set.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-111-1">withoutKeys
</span><span id="__ispan-111-2">  {Key Value}
</span><span id="__ispan-111-3">  {{Ord Key}}
</span><span id="__ispan-111-4">  (map : Map Key Value)
</span><span id="__ispan-111-5">  (invalidKeys : Set.Set Key)
</span><span id="__ispan-111-6">  : Map Key Value :=
</span><span id="__ispan-111-7">  for (acc := Map.empty) (k, v in map) {
</span><span id="__ispan-111-8">    if
</span><span id="__ispan-111-9">      | Set.isMember k invalidKeys := acc
</span><span id="__ispan-111-10">      | else := Map.insert k v acc
</span><span id="__ispan-111-11">  };
</span></code></pre></div>
<h3 id="mappartition"><code>mapPartition</code><a class="headerlink" href="#mappartition" title="Anchor link to this section for reference">¶</a></h3>
<p>Split a map according to a predicate on values.
Returns a pair of maps, (matching, non-matching).</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-112-1">mapPartition
</span><span id="__ispan-112-2">  {Key Value}
</span><span id="__ispan-112-3">  {{Ord Key}}
</span><span id="__ispan-112-4">  (predicate : Value -&gt; Bool)
</span><span id="__ispan-112-5">  (map : Map Key Value)
</span><span id="__ispan-112-6">  : Pair (Map Key Value) (Map Key Value) :=
</span><span id="__ispan-112-7">  for (matching, nonMatching := Map.empty, Map.empty) (k, v in map) {
</span><span id="__ispan-112-8">    if
</span><span id="__ispan-112-9">      | predicate v := Map.insert k v matching, nonMatching
</span><span id="__ispan-112-10">      | else := matching, Map.insert k v nonMatching
</span><span id="__ispan-112-11">  };
</span></code></pre></div>
<h3 id="partitionwithkey"><code>partitionWithKey</code><a class="headerlink" href="#partitionwithkey" title="Anchor link to this section for reference">¶</a></h3>
<p>Split a map according to a predicate that can examine both key and value.
Returns a pair of maps, (matching, non-matching).</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-113-1">partitionWithKey
</span><span id="__ispan-113-2">  {Key Value}
</span><span id="__ispan-113-3">  {{Ord Key}}
</span><span id="__ispan-113-4">  (predicate : Key -&gt; Value -&gt; Bool)
</span><span id="__ispan-113-5">  (map : Map Key Value)
</span><span id="__ispan-113-6">  : Pair (Map Key Value) (Map Key Value) :=
</span><span id="__ispan-113-7">  for (matching, nonMatching := Map.empty, Map.empty) (k, v in map) {
</span><span id="__ispan-113-8">    if
</span><span id="__ispan-113-9">      | predicate k v := Map.insert k v matching, nonMatching
</span><span id="__ispan-113-10">      | else := matching, Map.insert k v nonMatching
</span><span id="__ispan-113-11">  };
</span></code></pre></div>
<h3 id="mapoption"><code>mapOption</code><a class="headerlink" href="#mapoption" title="Anchor link to this section for reference">¶</a></h3>
<p>Apply a partial function to all values in the map, keeping only the entries where the function returns 'some'.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-114-1">mapOption
</span><span id="__ispan-114-2">  {Key Value1 Value2} {{Ord Key}}
</span><span id="__ispan-114-3">  (f : Value1 -&gt; Option Value2)
</span><span id="__ispan-114-4">  (map : Map Key Value1)
</span><span id="__ispan-114-5">  : Map Key Value2 :=
</span><span id="__ispan-114-6">  for (acc := Map.empty) (k, v in map) {
</span><span id="__ispan-114-7">    case f v of {
</span><span id="__ispan-114-8">      | none := acc
</span><span id="__ispan-114-9">      | some v' := Map.insert k v' acc
</span><span id="__ispan-114-10">    }
</span><span id="__ispan-114-11">  };
</span></code></pre></div>
<h3 id="mapoptionwithkey"><code>mapOptionWithKey</code><a class="headerlink" href="#mapoptionwithkey" title="Anchor link to this section for reference">¶</a></h3>
<p>Same as mapOption but allows the function to examine the key as well.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-115-1">mapOptionWithKey
</span><span id="__ispan-115-2">  {Key Value1 Value2} {{Ord Key}}
</span><span id="__ispan-115-3">  (f : Key -&gt; Value1 -&gt; Option Value2)
</span><span id="__ispan-115-4">  (map : Map Key Value1)
</span><span id="__ispan-115-5">  : Map Key Value2 :=
</span><span id="__ispan-115-6">  for (acc := Map.empty) (k, v in map) {
</span><span id="__ispan-115-7">    case f k v of {
</span><span id="__ispan-115-8">      | none := acc
</span><span id="__ispan-115-9">      | some v' := Map.insert k v' acc
</span><span id="__ispan-115-10">    }
</span><span id="__ispan-115-11">  };
</span></code></pre></div>
<h3 id="mapeither"><code>mapEither</code><a class="headerlink" href="#mapeither" title="Anchor link to this section for reference">¶</a></h3>
<p>Apply a function that returns Either to all values in the map.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-116-1">mapEither
</span><span id="__ispan-116-2">  {Key Value Error Result}
</span><span id="__ispan-116-3">  {{Ord Key}}
</span><span id="__ispan-116-4">  (f : Value -&gt; Either Error Result)
</span><span id="__ispan-116-5">  (map : Map Key Value)
</span><span id="__ispan-116-6">  : Pair (Map Key Error) (Map Key Result) :=
</span><span id="__ispan-116-7">  for (lefts, rights := Map.empty, Map.empty) (k, v in map) {
</span><span id="__ispan-116-8">    case f v of {
</span><span id="__ispan-116-9">      | error e := Map.insert k e lefts, rights
</span><span id="__ispan-116-10">      | ok r := lefts, Map.insert k r rights
</span><span id="__ispan-116-11">    }
</span><span id="__ispan-116-12">  };
</span></code></pre></div>
<h3 id="mapeitherwithkey"><code>mapEitherWithKey</code><a class="headerlink" href="#mapeitherwithkey" title="Anchor link to this section for reference">¶</a></h3>
<p>Same as mapEither but allows the function to examine the key as well.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-117-1">mapEitherWithKey
</span><span id="__ispan-117-2">  {Key Value Error Result}
</span><span id="__ispan-117-3">  {{Ord Key}}
</span><span id="__ispan-117-4">  (f : Key -&gt; Value -&gt; Either Error Result)
</span><span id="__ispan-117-5">  (map : Map Key Value)
</span><span id="__ispan-117-6">  : Pair (Map Key Error) (Map Key Result) :=
</span><span id="__ispan-117-7">  for (lefts, rights := Map.empty, Map.empty) (k, v in map) {
</span><span id="__ispan-117-8">    case f k v of {
</span><span id="__ispan-117-9">      | error e := Map.insert k e lefts, rights
</span><span id="__ispan-117-10">      | ok r := lefts, Map.insert k r rights
</span><span id="__ispan-117-11">    }
</span><span id="__ispan-117-12">  };
</span></code></pre></div>
<h2 id="undefined-values">Undefined values<a class="headerlink" href="#undefined-values" title="Anchor link to this section for reference">¶</a></h2>
<p>The term <code>undef</code> is a placeholder for unspecified values.</p>
<h3 id="undef"><code>undef</code><a class="headerlink" href="#undef" title="Anchor link to this section for reference">¶</a></h3>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-118-1">axiom undef {A} : A;
</span></code></pre></div>
<h3 id="todo"><code>TODO</code><a class="headerlink" href="#todo" title="Anchor link to this section for reference">¶</a></h3>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-119-1">axiom TODO {A} : A;
</span></code></pre></div>
<h2 id="omap-k-v"><code>OMap K V</code><a class="headerlink" href="#omap-k-v" title="Anchor link to this section for reference">¶</a></h2>
<p>A simple map implementation represented as a function from keys to optional values.
Note: Unlike <code>Stdlib.Data.Map</code>, this implementation does not require an <code>Ord</code>
instance for the key type <code>K</code>. However, operations like <code>insert</code>, <code>delete</code>, and
<code>fromList</code> require an <code>Eq</code> instance instead of an <code>Ord</code> instance.</p>
<p>Meant for usage with <code>String</code> which does not have a working <code>Ord</code> instance but does
have a working <code>Eq</code> instance.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__ispan-120-1">module OMap;
</span><span id="__ispan-120-2">
</span><span id="__ispan-120-3">  type OMap K V := mk@{
</span><span id="__ispan-120-4">    omap : K -&gt; Option V
</span><span id="__ispan-120-5">  };
</span><span id="__ispan-120-6">
</span><span id="__ispan-120-7">  -- The empty map maps every key to `none`.
</span><span id="__ispan-120-8">  empty {K V} : OMap K V := OMap.mk \{_ := none};
</span><span id="__ispan-120-9">
</span><span id="__ispan-120-10">  -- Look up a key in the map.
</span><span id="__ispan-120-11">  lookup {K V} (k : K) (m : OMap K V) : Option V := OMap.omap m k;
</span><span id="__ispan-120-12">
</span><span id="__ispan-120-13">  -- Insert a key-value pair. Requires an equality function for the key type.
</span><span id="__ispan-120-14">  insert {K V} {{Eq K}} (k : K) (v : V) (m : OMap K V) : OMap K V :=
</span><span id="__ispan-120-15">    OMap.mk@{omap := \{k' := if | k == k' := some v
</span><span id="__ispan-120-16">                                | else := OMap.omap m k'}};
</span><span id="__ispan-120-17">
</span><span id="__ispan-120-18">  -- Delete a key. Requires an equality function for the key type.
</span><span id="__ispan-120-19">  delete {K V} {{Eq K}} (k : K) (m : OMap K V) : OMap K V :=
</span><span id="__ispan-120-20">    OMap.mk@{omap := \{k' := if | k == k' := none
</span><span id="__ispan-120-21">                                | else := OMap.omap m k'}};
</span><span id="__ispan-120-22">
</span><span id="__ispan-120-23">  -- Create a map from a list of key-value pairs. Requires an equality function.
</span><span id="__ispan-120-24">  fromList {K V} {{Eq K}} (pairs : List (Pair K V)) : OMap K V :=
</span><span id="__ispan-120-25">    foldl (\{m (k, v) := insert k v m}) empty pairs;
</span><span id="__ispan-120-26">
</span><span id="__ispan-120-27">  -- Map a function over the values of the map.
</span><span id="__ispan-120-28">  map {K V1 V2} (f : V1 -&gt; V2) (m : OMap K V1) : OMap K V2 :=
</span><span id="__ispan-120-29">    OMap.mk@{omap := \{k := Functor.map f (OMap.omap m k)}};
</span><span id="__ispan-120-30">
</span><span id="__ispan-120-31">  -- Apply a function that returns an Option to values, keeping only `some` results.
</span><span id="__ispan-120-32">  mapOption {K V1 V2} (f : V1 -&gt; Option V2) (m : OMap K V1) : OMap K V2 :=
</span><span id="__ispan-120-33">    OMap.mk@{omap := \{k := case OMap.omap m k of { none := none | some v1 := f v1 }}};
</span><span id="__ispan-120-34">
</span><span id="__ispan-120-35">  -- Apply a function that returns an Option to keys and values, keeping only `some` results.
</span><span id="__ispan-120-36">  mapOptionWithKey {K V1 V2} (f : K -&gt; V1 -&gt; Option V2) (m : OMap K V1) : OMap K V2 :=
</span><span id="__ispan-120-37">    OMap.mk@{omap := \{k := case OMap.omap m k of { none := none | some v1 := f k v1 }}};
</span><span id="__ispan-120-38">
</span><span id="__ispan-120-39">  -- Fold over the map *given a specific list of keys*.
</span><span id="__ispan-120-40">  -- Note: A true fold isn't possible without knowing the domain.
</span><span id="__ispan-120-41">  foldWithKeys {K V Acc} (f : K -&gt; V -&gt; Acc -&gt; Acc) (init : Acc) (keys : List K) (m : OMap K V) : Acc :=
</span><span id="__ispan-120-42">    foldl
</span><span id="__ispan-120-43">      (\{acc k := case OMap.omap m k of { none := acc | some v := f k v acc }})
</span><span id="__ispan-120-44">      init
</span><span id="__ispan-120-45">      keys;
</span><span id="__ispan-120-46">
</span><span id="__ispan-120-47">  -- Create a map with a single key-value pair.
</span><span id="__ispan-120-48">  singleton {K V} {{Eq K}} (k : K) (v : V) : OMap K V :=
</span><span id="__ispan-120-49">    OMap.mk@{omap := \{k' := if | k == k' := some v | else := none}};
</span><span id="__ispan-120-50">
</span><span id="__ispan-120-51">end;
</span></code></pre></div>
<!-- list_wikilinks -->
<!-- Source file information -->
<!-- Was this page helpful? -->
<!-- Comment system -->
</article>
</div>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
<div class="md-copyright__highlight">
      © 2025 <a href="https://anoma.net">Anoma Foundation</a>
</div>
<strong>Version: (PR 391) - Updated: November 14,
    2025 at 01:35 PM UTC</strong>
<br/>
<strong>Latest version: <a href="https://specs.anoma.net/latest">
    https://specs.anoma.net/latest</a></strong>
<br/>
<strong>Development version: <a href="https://specs.anoma.net/main">
    https://specs.anoma.net/main</a></strong>
<br/>
<strong>Anoma Official Resources:</strong>
<small> <a href="https://anoma.net/" target="_blank">Website</a> | <a href="https://art.anoma.net" target="_blank">Research</a> | <a href="https://anoma.net/blog" target="_blank">Blog</a> | <a href="https://anoma.net/talks" target="_blank">Talks</a> </small>
<br/>
<strong>For Specification Authors:</strong>
<small>
<a href="https://specs.anoma.net/pr-391/indexes/tags.html">Tags</a>
    | <a href="https://specs.anoma.net/pr-391/indexes/links.html">Quick links</a>
    | <a href="https://specs.anoma.net/pr-391/indexes/juvix_modules.html">Juvix modules</a>
    | <a href="https://specs.anoma.net/pr-391/tutorial/index.html">Guides</a>
</small>
</div>
<div class="md-social">
<a class="md-social__link" href="https://x.com/anoma" rel="noopener" target="_blank" title="x.com">
<svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8l164.9-188.5L26.8 48h145.6l100.5 132.9zm-24.8 373.8h39.1L151.1 88h-42z"></path></svg>
</a>
<a class="md-social__link" href="https://github.com/anoma" rel="noopener" target="_blank" title="github.com">
<svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg>
</a>
<a class="md-social__link" href="https://anoma.net/blog" rel="noopener" target="_blank" title="anoma.net">
<svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M192 32c0 17.7 14.3 32 32 32 123.7 0 224 100.3 224 224 0 17.7 14.3 32 32 32s32-14.3 32-32C512 128.9 383.1 0 224 0c-17.7 0-32 14.3-32 32m0 96c0 17.7 14.3 32 32 32 70.7 0 128 57.3 128 128 0 17.7 14.3 32 32 32s32-14.3 32-32c0-106-86-192-192-192-17.7 0-32 14.3-32 32m-96 16c0-26.5-21.5-48-48-48S0 117.5 0 144v224c0 79.5 64.5 144 144 144s144-64.5 144-144-64.5-144-144-144h-16v96h16c26.5 0 48 21.5 48 48s-21.5 48-48 48-48-21.5-48-48z"></path></svg>
</a>
<a class="md-social__link" href="https://research.anoma.net" rel="noopener" target="_blank" title="research.anoma.net">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M225.9 32C103.3 32 0 130.5 0 252.1 0 256 .1 480 .1 480l225.8-.2c122.7 0 222.1-102.3 222.1-223.9S348.6 32 225.9 32M224 384c-19.4 0-37.9-4.3-54.4-12.1L88.5 392l22.9-75c-9.8-18.1-15.4-38.9-15.4-61 0-70.7 57.3-128 128-128s128 57.3 128 128-57.3 128-128 128"></path></svg>
</a>
<a class="md-social__link" href="https://youtube.com/anoma" rel="noopener" target="_blank" title="youtube.com">
<svg viewbox="0 0 576 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305m-317.51 213.508V175.185l142.739 81.205z"></path></svg>
</a>
<a class="md-social__link" href="mailto:arts@heliax.dev" rel="noopener" target="_blank" title="">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m20 8-8 5-8-5V6l8 5 8-5m0-2H4c-1.11 0-2 .89-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2"></path></svg>
</a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": ".", "features": ["announce.dismiss", "content.code.annotate", "content.code.copy", "content.tooltips", "content.action.edit", "content.action.view", "search.highlight", "search.suggest", "search.sharing", "navigation.instant.preview", "navigation.tracking", "navigation.prune", "navigation.indexes", "navigation.sections", "navigation.footer", "navigation.path", "toc.follow"], "search": "assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
<script src="assets/javascripts/bundle.c8b220af.min.js"></script>
<script src="assets/js/extra.js"></script>
<script src="assets/js/highlight.js"></script>
<script src="assets/js/mathjax.js"></script>
<script src="assets/js/tex-svg-full.js"></script>
<script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>